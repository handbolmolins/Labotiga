(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function YC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ew={exports:{}},yc={},Tw={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qa=Symbol.for("react.element"),QC=Symbol.for("react.portal"),XC=Symbol.for("react.fragment"),ZC=Symbol.for("react.strict_mode"),eA=Symbol.for("react.profiler"),tA=Symbol.for("react.provider"),nA=Symbol.for("react.context"),rA=Symbol.for("react.forward_ref"),sA=Symbol.for("react.suspense"),iA=Symbol.for("react.memo"),oA=Symbol.for("react.lazy"),Xg=Symbol.iterator;function aA(t){return t===null||typeof t!="object"?null:(t=Xg&&t[Xg]||t["@@iterator"],typeof t=="function"?t:null)}var xw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Iw=Object.assign,Sw={};function oo(t,e,n){this.props=t,this.context=e,this.refs=Sw,this.updater=n||xw}oo.prototype.isReactComponent={};oo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};oo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Cw(){}Cw.prototype=oo.prototype;function Qh(t,e,n){this.props=t,this.context=e,this.refs=Sw,this.updater=n||xw}var Xh=Qh.prototype=new Cw;Xh.constructor=Qh;Iw(Xh,oo.prototype);Xh.isPureReactComponent=!0;var Zg=Array.isArray,Aw=Object.prototype.hasOwnProperty,Zh={current:null},Nw={key:!0,ref:!0,__self:!0,__source:!0};function Rw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Aw.call(e,r)&&!Nw.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Qa,type:t,key:i,ref:o,props:s,_owner:Zh.current}}function lA(t,e){return{$$typeof:Qa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ep(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qa}function uA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ey=/\/+/g;function Ad(t,e){return typeof t=="object"&&t!==null&&t.key!=null?uA(""+t.key):e.toString(36)}function Kl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Qa:case QC:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Ad(o,0):r,Zg(s)?(n="",t!=null&&(n=t.replace(ey,"$&/")+"/"),Kl(s,e,n,"",function(u){return u})):s!=null&&(ep(s)&&(s=lA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ey,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Zg(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Ad(i,a);o+=Kl(i,e,n,l,s)}else if(l=aA(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Ad(i,a++),o+=Kl(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Il(t,e,n){if(t==null)return t;var r=[],s=0;return Kl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function cA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Pt={current:null},Jl={transition:null},dA={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:Jl,ReactCurrentOwner:Zh};function Pw(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:Il,forEach:function(t,e,n){Il(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Il(t,function(){e++}),e},toArray:function(t){return Il(t,function(e){return e})||[]},only:function(t){if(!ep(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=oo;he.Fragment=XC;he.Profiler=eA;he.PureComponent=Qh;he.StrictMode=ZC;he.Suspense=sA;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dA;he.act=Pw;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Iw({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Zh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Aw.call(e,l)&&!Nw.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Qa,type:t.type,key:s,ref:i,props:r,_owner:o}};he.createContext=function(t){return t={$$typeof:nA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tA,_context:t},t.Consumer=t};he.createElement=Rw;he.createFactory=function(t){var e=Rw.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:rA,render:t}};he.isValidElement=ep;he.lazy=function(t){return{$$typeof:oA,_payload:{_status:-1,_result:t},_init:cA}};he.memo=function(t,e){return{$$typeof:iA,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=Jl.transition;Jl.transition={};try{t()}finally{Jl.transition=e}};he.unstable_act=Pw;he.useCallback=function(t,e){return Pt.current.useCallback(t,e)};he.useContext=function(t){return Pt.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return Pt.current.useDeferredValue(t)};he.useEffect=function(t,e){return Pt.current.useEffect(t,e)};he.useId=function(){return Pt.current.useId()};he.useImperativeHandle=function(t,e,n){return Pt.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return Pt.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return Pt.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return Pt.current.useMemo(t,e)};he.useReducer=function(t,e,n){return Pt.current.useReducer(t,e,n)};he.useRef=function(t){return Pt.current.useRef(t)};he.useState=function(t){return Pt.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return Pt.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return Pt.current.useTransition()};he.version="18.3.1";Tw.exports=he;var V=Tw.exports;const kw=YC(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA=V,hA=Symbol.for("react.element"),pA=Symbol.for("react.fragment"),mA=Object.prototype.hasOwnProperty,gA=fA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yA={key:!0,ref:!0,__self:!0,__source:!0};function bw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)mA.call(e,r)&&!yA.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:hA,type:t,key:i,ref:o,props:s,_owner:gA.current}}yc.Fragment=pA;yc.jsx=bw;yc.jsxs=bw;Ew.exports=yc;var h=Ew.exports,vu={},Mw={exports:{}},Qt={},Dw={exports:{}},Lw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,se){var ue=Q.length;Q.push(se);e:for(;0<ue;){var xe=ue-1>>>1,Ae=Q[xe];if(0<s(Ae,se))Q[xe]=se,Q[ue]=Ae,ue=xe;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var se=Q[0],ue=Q.pop();if(ue!==se){Q[0]=ue;e:for(var xe=0,Ae=Q.length,fn=Ae>>>1;xe<fn;){var pt=2*(xe+1)-1,hn=Q[pt],Ct=pt+1,Zt=Q[Ct];if(0>s(hn,ue))Ct<Ae&&0>s(Zt,hn)?(Q[xe]=Zt,Q[Ct]=ue,xe=Ct):(Q[xe]=hn,Q[pt]=ue,xe=pt);else if(Ct<Ae&&0>s(Zt,ue))Q[xe]=Zt,Q[Ct]=ue,xe=Ct;else break e}}return se}function s(Q,se){var ue=Q.sortIndex-se.sortIndex;return ue!==0?ue:Q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],p=1,m=null,g=3,_=!1,T=!1,R=!1,x=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(Q){for(var se=n(u);se!==null;){if(se.callback===null)r(u);else if(se.startTime<=Q)r(u),se.sortIndex=se.expirationTime,e(l,se);else break;se=n(u)}}function D(Q){if(R=!1,A(Q),!T)if(n(l)!==null)T=!0,je(U);else{var se=n(u);se!==null&&Bt(D,se.startTime-Q)}}function U(Q,se){T=!1,R&&(R=!1,C(E),E=-1),_=!0;var ue=g;try{for(A(se),m=n(l);m!==null&&(!(m.expirationTime>se)||Q&&!k());){var xe=m.callback;if(typeof xe=="function"){m.callback=null,g=m.priorityLevel;var Ae=xe(m.expirationTime<=se);se=t.unstable_now(),typeof Ae=="function"?m.callback=Ae:m===n(l)&&r(l),A(se)}else r(l);m=n(l)}if(m!==null)var fn=!0;else{var pt=n(u);pt!==null&&Bt(D,pt.startTime-se),fn=!1}return fn}finally{m=null,g=ue,_=!1}}var F=!1,w=null,E=-1,N=5,b=-1;function k(){return!(t.unstable_now()-b<N)}function M(){if(w!==null){var Q=t.unstable_now();b=Q;var se=!0;try{se=w(!0,Q)}finally{se?P():(F=!1,w=null)}}else F=!1}var P;if(typeof I=="function")P=function(){I(M)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,$e=fe.port2;fe.port1.onmessage=M,P=function(){$e.postMessage(null)}}else P=function(){x(M,0)};function je(Q){w=Q,F||(F=!0,P())}function Bt(Q,se){E=x(function(){Q(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){T||_||(T=!0,je(U))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Q){switch(g){case 1:case 2:case 3:var se=3;break;default:se=g}var ue=g;g=se;try{return Q()}finally{g=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ue=g;g=Q;try{return se()}finally{g=ue}},t.unstable_scheduleCallback=function(Q,se,ue){var xe=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?xe+ue:xe):ue=xe,Q){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ue+Ae,Q={id:p++,callback:se,priorityLevel:Q,startTime:ue,expirationTime:Ae,sortIndex:-1},ue>xe?(Q.sortIndex=ue,e(u,Q),n(l)===null&&Q===n(u)&&(R?(C(E),E=-1):R=!0,Bt(D,ue-xe))):(Q.sortIndex=Ae,e(l,Q),T||_||(T=!0,je(U))),Q},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Q){var se=g;return function(){var ue=g;g=se;try{return Q.apply(this,arguments)}finally{g=ue}}}})(Lw);Dw.exports=Lw;var vA=Dw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _A=V,Yt=vA;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vw=new Set,Ta={};function ei(t,e){zi(t,e),zi(t+"Capture",e)}function zi(t,e){for(Ta[t]=e,t=0;t<e.length;t++)Vw.add(e[t])}var ir=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ef=Object.prototype.hasOwnProperty,wA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ty={},ny={};function EA(t){return Ef.call(ny,t)?!0:Ef.call(ty,t)?!1:wA.test(t)?ny[t]=!0:(ty[t]=!0,!1)}function TA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function xA(t,e,n,r){if(e===null||typeof e>"u"||TA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ft[t]=new kt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ft[e]=new kt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ft[t]=new kt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ft[t]=new kt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ft[t]=new kt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ft[t]=new kt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ft[t]=new kt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ft[t]=new kt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ft[t]=new kt(t,5,!1,t.toLowerCase(),null,!1,!1)});var tp=/[\-:]([a-z])/g;function np(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(tp,np);ft[e]=new kt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(tp,np);ft[e]=new kt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(tp,np);ft[e]=new kt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ft[t]=new kt(t,1,!1,t.toLowerCase(),null,!1,!1)});ft.xlinkHref=new kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ft[t]=new kt(t,1,!1,t.toLowerCase(),null,!0,!0)});function rp(t,e,n,r){var s=ft.hasOwnProperty(e)?ft[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xA(e,n,s,r)&&(n=null),r||s===null?EA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var mr=_A.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sl=Symbol.for("react.element"),yi=Symbol.for("react.portal"),vi=Symbol.for("react.fragment"),sp=Symbol.for("react.strict_mode"),Tf=Symbol.for("react.profiler"),Uw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),ip=Symbol.for("react.forward_ref"),xf=Symbol.for("react.suspense"),If=Symbol.for("react.suspense_list"),op=Symbol.for("react.memo"),Rr=Symbol.for("react.lazy"),Ow=Symbol.for("react.offscreen"),ry=Symbol.iterator;function Bo(t){return t===null||typeof t!="object"?null:(t=ry&&t[ry]||t["@@iterator"],typeof t=="function"?t:null)}var Ve=Object.assign,Nd;function Yo(t){if(Nd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nd=e&&e[1]||""}return`
`+Nd+t}var Rd=!1;function Pd(t,e){if(!t||Rd)return"";Rd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Rd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Yo(t):""}function IA(t){switch(t.tag){case 5:return Yo(t.type);case 16:return Yo("Lazy");case 13:return Yo("Suspense");case 19:return Yo("SuspenseList");case 0:case 2:case 15:return t=Pd(t.type,!1),t;case 11:return t=Pd(t.type.render,!1),t;case 1:return t=Pd(t.type,!0),t;default:return""}}function Sf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vi:return"Fragment";case yi:return"Portal";case Tf:return"Profiler";case sp:return"StrictMode";case xf:return"Suspense";case If:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Fw:return(t.displayName||"Context")+".Consumer";case Uw:return(t._context.displayName||"Context")+".Provider";case ip:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case op:return e=t.displayName||null,e!==null?e:Sf(t.type)||"Memo";case Rr:e=t._payload,t=t._init;try{return Sf(t(e))}catch{}}return null}function SA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sf(e);case 8:return e===sp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function CA(t){var e=qw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cl(t){t._valueTracker||(t._valueTracker=CA(t))}function Bw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=qw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function _u(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Cf(t,e){var n=e.checked;return Ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function sy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jw(t,e){e=e.checked,e!=null&&rp(t,"checked",e,!1)}function Af(t,e){jw(t,e);var n=Xr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Nf(t,e.type,n):e.hasOwnProperty("defaultValue")&&Nf(t,e.type,Xr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function iy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Nf(t,e,n){(e!=="number"||_u(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Qo=Array.isArray;function ki(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Rf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return Ve({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function oy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(Qo(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xr(n)}}function Gw(t,e){var n=Xr(e.value),r=Xr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ay(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Hw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Hw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Al,$w=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Al=Al||document.createElement("div"),Al.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Al.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var oa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AA=["Webkit","ms","Moz","O"];Object.keys(oa).forEach(function(t){AA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),oa[e]=oa[t]})});function zw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||oa.hasOwnProperty(t)&&oa[t]?(""+e).trim():e+"px"}function Ww(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=zw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var NA=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kf(t,e){if(e){if(NA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function bf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mf=null;function ap(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Df=null,bi=null,Mi=null;function ly(t){if(t=el(t)){if(typeof Df!="function")throw Error(K(280));var e=t.stateNode;e&&(e=Tc(e),Df(t.stateNode,t.type,e))}}function Kw(t){bi?Mi?Mi.push(t):Mi=[t]:bi=t}function Jw(){if(bi){var t=bi,e=Mi;if(Mi=bi=null,ly(t),e)for(t=0;t<e.length;t++)ly(e[t])}}function Yw(t,e){return t(e)}function Qw(){}var kd=!1;function Xw(t,e,n){if(kd)return t(e,n);kd=!0;try{return Yw(t,e,n)}finally{kd=!1,(bi!==null||Mi!==null)&&(Qw(),Jw())}}function Ia(t,e){var n=t.stateNode;if(n===null)return null;var r=Tc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var Lf=!1;if(ir)try{var jo={};Object.defineProperty(jo,"passive",{get:function(){Lf=!0}}),window.addEventListener("test",jo,jo),window.removeEventListener("test",jo,jo)}catch{Lf=!1}function RA(t,e,n,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(p){this.onError(p)}}var aa=!1,wu=null,Eu=!1,Vf=null,PA={onError:function(t){aa=!0,wu=t}};function kA(t,e,n,r,s,i,o,a,l){aa=!1,wu=null,RA.apply(PA,arguments)}function bA(t,e,n,r,s,i,o,a,l){if(kA.apply(this,arguments),aa){if(aa){var u=wu;aa=!1,wu=null}else throw Error(K(198));Eu||(Eu=!0,Vf=u)}}function ti(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Zw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function uy(t){if(ti(t)!==t)throw Error(K(188))}function MA(t){var e=t.alternate;if(!e){if(e=ti(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return uy(s),t;if(i===r)return uy(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function eE(t){return t=MA(t),t!==null?tE(t):null}function tE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=tE(t);if(e!==null)return e;t=t.sibling}return null}var nE=Yt.unstable_scheduleCallback,cy=Yt.unstable_cancelCallback,DA=Yt.unstable_shouldYield,LA=Yt.unstable_requestPaint,He=Yt.unstable_now,VA=Yt.unstable_getCurrentPriorityLevel,lp=Yt.unstable_ImmediatePriority,rE=Yt.unstable_UserBlockingPriority,Tu=Yt.unstable_NormalPriority,UA=Yt.unstable_LowPriority,sE=Yt.unstable_IdlePriority,vc=null,Ln=null;function FA(t){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(vc,t,void 0,(t.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:BA,OA=Math.log,qA=Math.LN2;function BA(t){return t>>>=0,t===0?32:31-(OA(t)/qA|0)|0}var Nl=64,Rl=4194304;function Xo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Xo(a):(i&=o,i!==0&&(r=Xo(i)))}else o=n&~s,o!==0?r=Xo(o):i!==0&&(r=Xo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_n(e),s=1<<n,r|=t[n],e&=~s;return r}function jA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-_n(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=jA(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Uf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function iE(){var t=Nl;return Nl<<=1,!(Nl&4194240)&&(Nl=64),t}function bd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Xa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_n(e),t[e]=n}function HA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-_n(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function up(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_n(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Te=0;function oE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var aE,cp,lE,uE,cE,Ff=!1,Pl=[],Br=null,jr=null,Gr=null,Sa=new Map,Ca=new Map,kr=[],$A="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dy(t,e){switch(t){case"focusin":case"focusout":Br=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":Sa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ca.delete(e.pointerId)}}function Go(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=el(e),e!==null&&cp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function zA(t,e,n,r,s){switch(e){case"focusin":return Br=Go(Br,t,e,n,r,s),!0;case"dragenter":return jr=Go(jr,t,e,n,r,s),!0;case"mouseover":return Gr=Go(Gr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Sa.set(i,Go(Sa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ca.set(i,Go(Ca.get(i)||null,t,e,n,r,s)),!0}return!1}function dE(t){var e=bs(t.target);if(e!==null){var n=ti(e);if(n!==null){if(e=n.tag,e===13){if(e=Zw(n),e!==null){t.blockedOn=e,cE(t.priority,function(){lE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Of(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Mf=r,n.target.dispatchEvent(r),Mf=null}else return e=el(n),e!==null&&cp(e),t.blockedOn=n,!1;e.shift()}return!0}function fy(t,e,n){Yl(t)&&n.delete(e)}function WA(){Ff=!1,Br!==null&&Yl(Br)&&(Br=null),jr!==null&&Yl(jr)&&(jr=null),Gr!==null&&Yl(Gr)&&(Gr=null),Sa.forEach(fy),Ca.forEach(fy)}function Ho(t,e){t.blockedOn===e&&(t.blockedOn=null,Ff||(Ff=!0,Yt.unstable_scheduleCallback(Yt.unstable_NormalPriority,WA)))}function Aa(t){function e(s){return Ho(s,t)}if(0<Pl.length){Ho(Pl[0],t);for(var n=1;n<Pl.length;n++){var r=Pl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Br!==null&&Ho(Br,t),jr!==null&&Ho(jr,t),Gr!==null&&Ho(Gr,t),Sa.forEach(e),Ca.forEach(e),n=0;n<kr.length;n++)r=kr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<kr.length&&(n=kr[0],n.blockedOn===null);)dE(n),n.blockedOn===null&&kr.shift()}var Di=mr.ReactCurrentBatchConfig,Iu=!0;function KA(t,e,n,r){var s=Te,i=Di.transition;Di.transition=null;try{Te=1,dp(t,e,n,r)}finally{Te=s,Di.transition=i}}function JA(t,e,n,r){var s=Te,i=Di.transition;Di.transition=null;try{Te=4,dp(t,e,n,r)}finally{Te=s,Di.transition=i}}function dp(t,e,n,r){if(Iu){var s=Of(t,e,n,r);if(s===null)jd(t,e,r,Su,n),dy(t,r);else if(zA(s,t,e,n,r))r.stopPropagation();else if(dy(t,r),e&4&&-1<$A.indexOf(t)){for(;s!==null;){var i=el(s);if(i!==null&&aE(i),i=Of(t,e,n,r),i===null&&jd(t,e,r,Su,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else jd(t,e,r,null,n)}}var Su=null;function Of(t,e,n,r){if(Su=null,t=ap(r),t=bs(t),t!==null)if(e=ti(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Zw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Su=t,null}function fE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VA()){case lp:return 1;case rE:return 4;case Tu:case UA:return 16;case sE:return 536870912;default:return 16}default:return 16}}var Ur=null,fp=null,Ql=null;function hE(){if(Ql)return Ql;var t,e=fp,n=e.length,r,s="value"in Ur?Ur.value:Ur.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ql=s.slice(t,1<r?1-r:void 0)}function Xl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function kl(){return!0}function hy(){return!1}function Xt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?kl:hy,this.isPropagationStopped=hy,this}return Ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kl)},persist:function(){},isPersistent:kl}),e}var ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hp=Xt(ao),Za=Ve({},ao,{view:0,detail:0}),YA=Xt(Za),Md,Dd,$o,_c=Ve({},Za,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$o&&($o&&t.type==="mousemove"?(Md=t.screenX-$o.screenX,Dd=t.screenY-$o.screenY):Dd=Md=0,$o=t),Md)},movementY:function(t){return"movementY"in t?t.movementY:Dd}}),py=Xt(_c),QA=Ve({},_c,{dataTransfer:0}),XA=Xt(QA),ZA=Ve({},Za,{relatedTarget:0}),Ld=Xt(ZA),e1=Ve({},ao,{animationName:0,elapsedTime:0,pseudoElement:0}),t1=Xt(e1),n1=Ve({},ao,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),r1=Xt(n1),s1=Ve({},ao,{data:0}),my=Xt(s1),i1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=a1[t])?!!e[t]:!1}function pp(){return l1}var u1=Ve({},Za,{key:function(t){if(t.key){var e=i1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?o1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pp,charCode:function(t){return t.type==="keypress"?Xl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),c1=Xt(u1),d1=Ve({},_c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gy=Xt(d1),f1=Ve({},Za,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pp}),h1=Xt(f1),p1=Ve({},ao,{propertyName:0,elapsedTime:0,pseudoElement:0}),m1=Xt(p1),g1=Ve({},_c,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),y1=Xt(g1),v1=[9,13,27,32],mp=ir&&"CompositionEvent"in window,la=null;ir&&"documentMode"in document&&(la=document.documentMode);var _1=ir&&"TextEvent"in window&&!la,pE=ir&&(!mp||la&&8<la&&11>=la),yy=" ",vy=!1;function mE(t,e){switch(t){case"keyup":return v1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var _i=!1;function w1(t,e){switch(t){case"compositionend":return gE(e);case"keypress":return e.which!==32?null:(vy=!0,yy);case"textInput":return t=e.data,t===yy&&vy?null:t;default:return null}}function E1(t,e){if(_i)return t==="compositionend"||!mp&&mE(t,e)?(t=hE(),Ql=fp=Ur=null,_i=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return pE&&e.locale!=="ko"?null:e.data;default:return null}}var T1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _y(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!T1[t.type]:e==="textarea"}function yE(t,e,n,r){Kw(r),e=Cu(e,"onChange"),0<e.length&&(n=new hp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ua=null,Na=null;function x1(t){NE(t,0)}function wc(t){var e=Ti(t);if(Bw(e))return t}function I1(t,e){if(t==="change")return e}var vE=!1;if(ir){var Vd;if(ir){var Ud="oninput"in document;if(!Ud){var wy=document.createElement("div");wy.setAttribute("oninput","return;"),Ud=typeof wy.oninput=="function"}Vd=Ud}else Vd=!1;vE=Vd&&(!document.documentMode||9<document.documentMode)}function Ey(){ua&&(ua.detachEvent("onpropertychange",_E),Na=ua=null)}function _E(t){if(t.propertyName==="value"&&wc(Na)){var e=[];yE(e,Na,t,ap(t)),Xw(x1,e)}}function S1(t,e,n){t==="focusin"?(Ey(),ua=e,Na=n,ua.attachEvent("onpropertychange",_E)):t==="focusout"&&Ey()}function C1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wc(Na)}function A1(t,e){if(t==="click")return wc(e)}function N1(t,e){if(t==="input"||t==="change")return wc(e)}function R1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var En=typeof Object.is=="function"?Object.is:R1;function Ra(t,e){if(En(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ef.call(e,s)||!En(t[s],e[s]))return!1}return!0}function Ty(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xy(t,e){var n=Ty(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ty(n)}}function wE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function EE(){for(var t=window,e=_u();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=_u(t.document)}return e}function gp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function P1(t){var e=EE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&wE(n.ownerDocument.documentElement,n)){if(r!==null&&gp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=xy(n,i);var o=xy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var k1=ir&&"documentMode"in document&&11>=document.documentMode,wi=null,qf=null,ca=null,Bf=!1;function Iy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bf||wi==null||wi!==_u(r)||(r=wi,"selectionStart"in r&&gp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ca&&Ra(ca,r)||(ca=r,r=Cu(qf,"onSelect"),0<r.length&&(e=new hp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=wi)))}function bl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ei={animationend:bl("Animation","AnimationEnd"),animationiteration:bl("Animation","AnimationIteration"),animationstart:bl("Animation","AnimationStart"),transitionend:bl("Transition","TransitionEnd")},Fd={},TE={};ir&&(TE=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);function Ec(t){if(Fd[t])return Fd[t];if(!Ei[t])return t;var e=Ei[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in TE)return Fd[t]=e[n];return t}var xE=Ec("animationend"),IE=Ec("animationiteration"),SE=Ec("animationstart"),CE=Ec("transitionend"),AE=new Map,Sy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function us(t,e){AE.set(t,e),ei(e,[t])}for(var Od=0;Od<Sy.length;Od++){var qd=Sy[Od],b1=qd.toLowerCase(),M1=qd[0].toUpperCase()+qd.slice(1);us(b1,"on"+M1)}us(xE,"onAnimationEnd");us(IE,"onAnimationIteration");us(SE,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(CE,"onTransitionEnd");zi("onMouseEnter",["mouseout","mouseover"]);zi("onMouseLeave",["mouseout","mouseover"]);zi("onPointerEnter",["pointerout","pointerover"]);zi("onPointerLeave",["pointerout","pointerover"]);ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ei("onBeforeInput",["compositionend","keypress","textInput","paste"]);ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zo));function Cy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bA(r,e,void 0,t),t.currentTarget=null}function NE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Cy(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Cy(s,a,u),i=l}}}if(Eu)throw t=Vf,Eu=!1,Vf=null,t}function Re(t,e){var n=e[zf];n===void 0&&(n=e[zf]=new Set);var r=t+"__bubble";n.has(r)||(RE(e,t,2,!1),n.add(r))}function Bd(t,e,n){var r=0;e&&(r|=4),RE(n,t,r,e)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function Pa(t){if(!t[Ml]){t[Ml]=!0,Vw.forEach(function(n){n!=="selectionchange"&&(D1.has(n)||Bd(n,!1,t),Bd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ml]||(e[Ml]=!0,Bd("selectionchange",!1,e))}}function RE(t,e,n,r){switch(fE(e)){case 1:var s=KA;break;case 4:s=JA;break;default:s=dp}n=s.bind(null,e,n,t),s=void 0,!Lf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function jd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=bs(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Xw(function(){var u=i,p=ap(n),m=[];e:{var g=AE.get(t);if(g!==void 0){var _=hp,T=t;switch(t){case"keypress":if(Xl(n)===0)break e;case"keydown":case"keyup":_=c1;break;case"focusin":T="focus",_=Ld;break;case"focusout":T="blur",_=Ld;break;case"beforeblur":case"afterblur":_=Ld;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=py;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=XA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=h1;break;case xE:case IE:case SE:_=t1;break;case CE:_=m1;break;case"scroll":_=YA;break;case"wheel":_=y1;break;case"copy":case"cut":case"paste":_=r1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=gy}var R=(e&4)!==0,x=!R&&t==="scroll",C=R?g!==null?g+"Capture":null:g;R=[];for(var I=u,A;I!==null;){A=I;var D=A.stateNode;if(A.tag===5&&D!==null&&(A=D,C!==null&&(D=Ia(I,C),D!=null&&R.push(ka(I,D,A)))),x)break;I=I.return}0<R.length&&(g=new _(g,T,null,n,p),m.push({event:g,listeners:R}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",g&&n!==Mf&&(T=n.relatedTarget||n.fromElement)&&(bs(T)||T[or]))break e;if((_||g)&&(g=p.window===p?p:(g=p.ownerDocument)?g.defaultView||g.parentWindow:window,_?(T=n.relatedTarget||n.toElement,_=u,T=T?bs(T):null,T!==null&&(x=ti(T),T!==x||T.tag!==5&&T.tag!==6)&&(T=null)):(_=null,T=u),_!==T)){if(R=py,D="onMouseLeave",C="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(R=gy,D="onPointerLeave",C="onPointerEnter",I="pointer"),x=_==null?g:Ti(_),A=T==null?g:Ti(T),g=new R(D,I+"leave",_,n,p),g.target=x,g.relatedTarget=A,D=null,bs(p)===u&&(R=new R(C,I+"enter",T,n,p),R.target=A,R.relatedTarget=x,D=R),x=D,_&&T)t:{for(R=_,C=T,I=0,A=R;A;A=fi(A))I++;for(A=0,D=C;D;D=fi(D))A++;for(;0<I-A;)R=fi(R),I--;for(;0<A-I;)C=fi(C),A--;for(;I--;){if(R===C||C!==null&&R===C.alternate)break t;R=fi(R),C=fi(C)}R=null}else R=null;_!==null&&Ay(m,g,_,R,!1),T!==null&&x!==null&&Ay(m,x,T,R,!0)}}e:{if(g=u?Ti(u):window,_=g.nodeName&&g.nodeName.toLowerCase(),_==="select"||_==="input"&&g.type==="file")var U=I1;else if(_y(g))if(vE)U=N1;else{U=C1;var F=S1}else(_=g.nodeName)&&_.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(U=A1);if(U&&(U=U(t,u))){yE(m,U,n,p);break e}F&&F(t,g,u),t==="focusout"&&(F=g._wrapperState)&&F.controlled&&g.type==="number"&&Nf(g,"number",g.value)}switch(F=u?Ti(u):window,t){case"focusin":(_y(F)||F.contentEditable==="true")&&(wi=F,qf=u,ca=null);break;case"focusout":ca=qf=wi=null;break;case"mousedown":Bf=!0;break;case"contextmenu":case"mouseup":case"dragend":Bf=!1,Iy(m,n,p);break;case"selectionchange":if(k1)break;case"keydown":case"keyup":Iy(m,n,p)}var w;if(mp)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else _i?mE(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(pE&&n.locale!=="ko"&&(_i||E!=="onCompositionStart"?E==="onCompositionEnd"&&_i&&(w=hE()):(Ur=p,fp="value"in Ur?Ur.value:Ur.textContent,_i=!0)),F=Cu(u,E),0<F.length&&(E=new my(E,t,null,n,p),m.push({event:E,listeners:F}),w?E.data=w:(w=gE(n),w!==null&&(E.data=w)))),(w=_1?w1(t,n):E1(t,n))&&(u=Cu(u,"onBeforeInput"),0<u.length&&(p=new my("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:u}),p.data=w))}NE(m,e)})}function ka(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Cu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ia(t,n),i!=null&&r.unshift(ka(t,i,s)),i=Ia(t,e),i!=null&&r.push(ka(t,i,s))),t=t.return}return r}function fi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ay(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=Ia(n,i),l!=null&&o.unshift(ka(n,l,a))):s||(l=Ia(n,i),l!=null&&o.push(ka(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var L1=/\r\n?/g,V1=/\u0000|\uFFFD/g;function Ny(t){return(typeof t=="string"?t:""+t).replace(L1,`
`).replace(V1,"")}function Dl(t,e,n){if(e=Ny(e),Ny(t)!==e&&n)throw Error(K(425))}function Au(){}var jf=null,Gf=null;function Hf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $f=typeof setTimeout=="function"?setTimeout:void 0,U1=typeof clearTimeout=="function"?clearTimeout:void 0,Ry=typeof Promise=="function"?Promise:void 0,F1=typeof queueMicrotask=="function"?queueMicrotask:typeof Ry<"u"?function(t){return Ry.resolve(null).then(t).catch(O1)}:$f;function O1(t){setTimeout(function(){throw t})}function Gd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Aa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Aa(e)}function Hr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Py(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var lo=Math.random().toString(36).slice(2),kn="__reactFiber$"+lo,ba="__reactProps$"+lo,or="__reactContainer$"+lo,zf="__reactEvents$"+lo,q1="__reactListeners$"+lo,B1="__reactHandles$"+lo;function bs(t){var e=t[kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[or]||n[kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Py(t);t!==null;){if(n=t[kn])return n;t=Py(t)}return e}t=n,n=t.parentNode}return null}function el(t){return t=t[kn]||t[or],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ti(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function Tc(t){return t[ba]||null}var Wf=[],xi=-1;function cs(t){return{current:t}}function be(t){0>xi||(t.current=Wf[xi],Wf[xi]=null,xi--)}function Ce(t,e){xi++,Wf[xi]=t.current,t.current=e}var Zr={},It=cs(Zr),Ut=cs(!1),Bs=Zr;function Wi(t,e){var n=t.type.contextTypes;if(!n)return Zr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ft(t){return t=t.childContextTypes,t!=null}function Nu(){be(Ut),be(It)}function ky(t,e,n){if(It.current!==Zr)throw Error(K(168));Ce(It,e),Ce(Ut,n)}function PE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,SA(t)||"Unknown",s));return Ve({},n,r)}function Ru(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zr,Bs=It.current,Ce(It,t),Ce(Ut,Ut.current),!0}function by(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=PE(t,e,Bs),r.__reactInternalMemoizedMergedChildContext=t,be(Ut),be(It),Ce(It,t)):be(Ut),Ce(Ut,n)}var Yn=null,xc=!1,Hd=!1;function kE(t){Yn===null?Yn=[t]:Yn.push(t)}function j1(t){xc=!0,kE(t)}function ds(){if(!Hd&&Yn!==null){Hd=!0;var t=0,e=Te;try{var n=Yn;for(Te=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Yn=null,xc=!1}catch(s){throw Yn!==null&&(Yn=Yn.slice(t+1)),nE(lp,ds),s}finally{Te=e,Hd=!1}}return null}var Ii=[],Si=0,Pu=null,ku=0,en=[],tn=0,js=null,Qn=1,Xn="";function Rs(t,e){Ii[Si++]=ku,Ii[Si++]=Pu,Pu=t,ku=e}function bE(t,e,n){en[tn++]=Qn,en[tn++]=Xn,en[tn++]=js,js=t;var r=Qn;t=Xn;var s=32-_n(r)-1;r&=~(1<<s),n+=1;var i=32-_n(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Qn=1<<32-_n(e)+s|n<<s|r,Xn=i+t}else Qn=1<<i|n<<s|r,Xn=t}function yp(t){t.return!==null&&(Rs(t,1),bE(t,1,0))}function vp(t){for(;t===Pu;)Pu=Ii[--Si],Ii[Si]=null,ku=Ii[--Si],Ii[Si]=null;for(;t===js;)js=en[--tn],en[tn]=null,Xn=en[--tn],en[tn]=null,Qn=en[--tn],en[tn]=null}var Jt=null,Wt=null,Me=!1,yn=null;function ME(t,e){var n=sn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function My(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jt=t,Wt=Hr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jt=t,Wt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=js!==null?{id:Qn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=sn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jt=t,Wt=null,!0):!1;default:return!1}}function Kf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jf(t){if(Me){var e=Wt;if(e){var n=e;if(!My(t,e)){if(Kf(t))throw Error(K(418));e=Hr(n.nextSibling);var r=Jt;e&&My(t,e)?ME(r,n):(t.flags=t.flags&-4097|2,Me=!1,Jt=t)}}else{if(Kf(t))throw Error(K(418));t.flags=t.flags&-4097|2,Me=!1,Jt=t}}}function Dy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jt=t}function Ll(t){if(t!==Jt)return!1;if(!Me)return Dy(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Hf(t.type,t.memoizedProps)),e&&(e=Wt)){if(Kf(t))throw DE(),Error(K(418));for(;e;)ME(t,e),e=Hr(e.nextSibling)}if(Dy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Wt=Hr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Wt=null}}else Wt=Jt?Hr(t.stateNode.nextSibling):null;return!0}function DE(){for(var t=Wt;t;)t=Hr(t.nextSibling)}function Ki(){Wt=Jt=null,Me=!1}function _p(t){yn===null?yn=[t]:yn.push(t)}var G1=mr.ReactCurrentBatchConfig;function zo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function Vl(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ly(t){var e=t._init;return e(t._payload)}function LE(t){function e(C,I){if(t){var A=C.deletions;A===null?(C.deletions=[I],C.flags|=16):A.push(I)}}function n(C,I){if(!t)return null;for(;I!==null;)e(C,I),I=I.sibling;return null}function r(C,I){for(C=new Map;I!==null;)I.key!==null?C.set(I.key,I):C.set(I.index,I),I=I.sibling;return C}function s(C,I){return C=Kr(C,I),C.index=0,C.sibling=null,C}function i(C,I,A){return C.index=A,t?(A=C.alternate,A!==null?(A=A.index,A<I?(C.flags|=2,I):A):(C.flags|=2,I)):(C.flags|=1048576,I)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function a(C,I,A,D){return I===null||I.tag!==6?(I=Qd(A,C.mode,D),I.return=C,I):(I=s(I,A),I.return=C,I)}function l(C,I,A,D){var U=A.type;return U===vi?p(C,I,A.props.children,D,A.key):I!==null&&(I.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Rr&&Ly(U)===I.type)?(D=s(I,A.props),D.ref=zo(C,I,A),D.return=C,D):(D=iu(A.type,A.key,A.props,null,C.mode,D),D.ref=zo(C,I,A),D.return=C,D)}function u(C,I,A,D){return I===null||I.tag!==4||I.stateNode.containerInfo!==A.containerInfo||I.stateNode.implementation!==A.implementation?(I=Xd(A,C.mode,D),I.return=C,I):(I=s(I,A.children||[]),I.return=C,I)}function p(C,I,A,D,U){return I===null||I.tag!==7?(I=Fs(A,C.mode,D,U),I.return=C,I):(I=s(I,A),I.return=C,I)}function m(C,I,A){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Qd(""+I,C.mode,A),I.return=C,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Sl:return A=iu(I.type,I.key,I.props,null,C.mode,A),A.ref=zo(C,null,I),A.return=C,A;case yi:return I=Xd(I,C.mode,A),I.return=C,I;case Rr:var D=I._init;return m(C,D(I._payload),A)}if(Qo(I)||Bo(I))return I=Fs(I,C.mode,A,null),I.return=C,I;Vl(C,I)}return null}function g(C,I,A,D){var U=I!==null?I.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return U!==null?null:a(C,I,""+A,D);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Sl:return A.key===U?l(C,I,A,D):null;case yi:return A.key===U?u(C,I,A,D):null;case Rr:return U=A._init,g(C,I,U(A._payload),D)}if(Qo(A)||Bo(A))return U!==null?null:p(C,I,A,D,null);Vl(C,A)}return null}function _(C,I,A,D,U){if(typeof D=="string"&&D!==""||typeof D=="number")return C=C.get(A)||null,a(I,C,""+D,U);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Sl:return C=C.get(D.key===null?A:D.key)||null,l(I,C,D,U);case yi:return C=C.get(D.key===null?A:D.key)||null,u(I,C,D,U);case Rr:var F=D._init;return _(C,I,A,F(D._payload),U)}if(Qo(D)||Bo(D))return C=C.get(A)||null,p(I,C,D,U,null);Vl(I,D)}return null}function T(C,I,A,D){for(var U=null,F=null,w=I,E=I=0,N=null;w!==null&&E<A.length;E++){w.index>E?(N=w,w=null):N=w.sibling;var b=g(C,w,A[E],D);if(b===null){w===null&&(w=N);break}t&&w&&b.alternate===null&&e(C,w),I=i(b,I,E),F===null?U=b:F.sibling=b,F=b,w=N}if(E===A.length)return n(C,w),Me&&Rs(C,E),U;if(w===null){for(;E<A.length;E++)w=m(C,A[E],D),w!==null&&(I=i(w,I,E),F===null?U=w:F.sibling=w,F=w);return Me&&Rs(C,E),U}for(w=r(C,w);E<A.length;E++)N=_(w,C,E,A[E],D),N!==null&&(t&&N.alternate!==null&&w.delete(N.key===null?E:N.key),I=i(N,I,E),F===null?U=N:F.sibling=N,F=N);return t&&w.forEach(function(k){return e(C,k)}),Me&&Rs(C,E),U}function R(C,I,A,D){var U=Bo(A);if(typeof U!="function")throw Error(K(150));if(A=U.call(A),A==null)throw Error(K(151));for(var F=U=null,w=I,E=I=0,N=null,b=A.next();w!==null&&!b.done;E++,b=A.next()){w.index>E?(N=w,w=null):N=w.sibling;var k=g(C,w,b.value,D);if(k===null){w===null&&(w=N);break}t&&w&&k.alternate===null&&e(C,w),I=i(k,I,E),F===null?U=k:F.sibling=k,F=k,w=N}if(b.done)return n(C,w),Me&&Rs(C,E),U;if(w===null){for(;!b.done;E++,b=A.next())b=m(C,b.value,D),b!==null&&(I=i(b,I,E),F===null?U=b:F.sibling=b,F=b);return Me&&Rs(C,E),U}for(w=r(C,w);!b.done;E++,b=A.next())b=_(w,C,E,b.value,D),b!==null&&(t&&b.alternate!==null&&w.delete(b.key===null?E:b.key),I=i(b,I,E),F===null?U=b:F.sibling=b,F=b);return t&&w.forEach(function(M){return e(C,M)}),Me&&Rs(C,E),U}function x(C,I,A,D){if(typeof A=="object"&&A!==null&&A.type===vi&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Sl:e:{for(var U=A.key,F=I;F!==null;){if(F.key===U){if(U=A.type,U===vi){if(F.tag===7){n(C,F.sibling),I=s(F,A.props.children),I.return=C,C=I;break e}}else if(F.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Rr&&Ly(U)===F.type){n(C,F.sibling),I=s(F,A.props),I.ref=zo(C,F,A),I.return=C,C=I;break e}n(C,F);break}else e(C,F);F=F.sibling}A.type===vi?(I=Fs(A.props.children,C.mode,D,A.key),I.return=C,C=I):(D=iu(A.type,A.key,A.props,null,C.mode,D),D.ref=zo(C,I,A),D.return=C,C=D)}return o(C);case yi:e:{for(F=A.key;I!==null;){if(I.key===F)if(I.tag===4&&I.stateNode.containerInfo===A.containerInfo&&I.stateNode.implementation===A.implementation){n(C,I.sibling),I=s(I,A.children||[]),I.return=C,C=I;break e}else{n(C,I);break}else e(C,I);I=I.sibling}I=Xd(A,C.mode,D),I.return=C,C=I}return o(C);case Rr:return F=A._init,x(C,I,F(A._payload),D)}if(Qo(A))return T(C,I,A,D);if(Bo(A))return R(C,I,A,D);Vl(C,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,I!==null&&I.tag===6?(n(C,I.sibling),I=s(I,A),I.return=C,C=I):(n(C,I),I=Qd(A,C.mode,D),I.return=C,C=I),o(C)):n(C,I)}return x}var Ji=LE(!0),VE=LE(!1),bu=cs(null),Mu=null,Ci=null,wp=null;function Ep(){wp=Ci=Mu=null}function Tp(t){var e=bu.current;be(bu),t._currentValue=e}function Yf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Li(t,e){Mu=t,wp=Ci=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Vt=!0),t.firstContext=null)}function cn(t){var e=t._currentValue;if(wp!==t)if(t={context:t,memoizedValue:e,next:null},Ci===null){if(Mu===null)throw Error(K(308));Ci=t,Mu.dependencies={lanes:0,firstContext:t}}else Ci=Ci.next=t;return e}var Ms=null;function xp(t){Ms===null?Ms=[t]:Ms.push(t)}function UE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,xp(e)):(n.next=s.next,s.next=n),e.interleaved=n,ar(t,r)}function ar(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pr=!1;function Ip(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function FE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function tr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $r(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ar(t,n)}return s=r.interleaved,s===null?(e.next=e,xp(r)):(e.next=s.next,s.next=e),r.interleaved=e,ar(t,n)}function Zl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,up(t,n)}}function Vy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Du(t,e,n,r){var s=t.updateQueue;Pr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var p=t.alternate;p!==null&&(p=p.updateQueue,a=p.lastBaseUpdate,a!==o&&(a===null?p.firstBaseUpdate=u:a.next=u,p.lastBaseUpdate=l))}if(i!==null){var m=s.baseState;o=0,p=u=l=null,a=i;do{var g=a.lane,_=a.eventTime;if((r&g)===g){p!==null&&(p=p.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,R=a;switch(g=e,_=n,R.tag){case 1:if(T=R.payload,typeof T=="function"){m=T.call(_,m,g);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=R.payload,g=typeof T=="function"?T.call(_,m,g):T,g==null)break e;m=Ve({},m,g);break e;case 2:Pr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else _={eventTime:_,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},p===null?(u=p=_,l=m):p=p.next=_,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(p===null&&(l=m),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Hs|=o,t.lanes=o,t.memoizedState=m}}function Uy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var tl={},Vn=cs(tl),Ma=cs(tl),Da=cs(tl);function Ds(t){if(t===tl)throw Error(K(174));return t}function Sp(t,e){switch(Ce(Da,e),Ce(Ma,t),Ce(Vn,tl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pf(e,t)}be(Vn),Ce(Vn,e)}function Yi(){be(Vn),be(Ma),be(Da)}function OE(t){Ds(Da.current);var e=Ds(Vn.current),n=Pf(e,t.type);e!==n&&(Ce(Ma,t),Ce(Vn,n))}function Cp(t){Ma.current===t&&(be(Vn),be(Ma))}var De=cs(0);function Lu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $d=[];function Ap(){for(var t=0;t<$d.length;t++)$d[t]._workInProgressVersionPrimary=null;$d.length=0}var eu=mr.ReactCurrentDispatcher,zd=mr.ReactCurrentBatchConfig,Gs=0,Le=null,tt=null,ot=null,Vu=!1,da=!1,La=0,H1=0;function mt(){throw Error(K(321))}function Np(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!En(t[n],e[n]))return!1;return!0}function Rp(t,e,n,r,s,i){if(Gs=i,Le=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,eu.current=t===null||t.memoizedState===null?K1:J1,t=n(r,s),da){i=0;do{if(da=!1,La=0,25<=i)throw Error(K(301));i+=1,ot=tt=null,e.updateQueue=null,eu.current=Y1,t=n(r,s)}while(da)}if(eu.current=Uu,e=tt!==null&&tt.next!==null,Gs=0,ot=tt=Le=null,Vu=!1,e)throw Error(K(300));return t}function Pp(){var t=La!==0;return La=0,t}function Rn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ot===null?Le.memoizedState=ot=t:ot=ot.next=t,ot}function dn(){if(tt===null){var t=Le.alternate;t=t!==null?t.memoizedState:null}else t=tt.next;var e=ot===null?Le.memoizedState:ot.next;if(e!==null)ot=e,tt=t;else{if(t===null)throw Error(K(310));tt=t,t={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},ot===null?Le.memoizedState=ot=t:ot=ot.next=t}return ot}function Va(t,e){return typeof e=="function"?e(t):e}function Wd(t){var e=dn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=tt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var p=u.lane;if((Gs&p)===p)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:p,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,Le.lanes|=p,Hs|=p}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,En(r,e.memoizedState)||(Vt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Le.lanes|=i,Hs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Kd(t){var e=dn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);En(i,e.memoizedState)||(Vt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function qE(){}function BE(t,e){var n=Le,r=dn(),s=e(),i=!En(r.memoizedState,s);if(i&&(r.memoizedState=s,Vt=!0),r=r.queue,kp(HE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ot!==null&&ot.memoizedState.tag&1){if(n.flags|=2048,Ua(9,GE.bind(null,n,r,s,e),void 0,null),at===null)throw Error(K(349));Gs&30||jE(n,e,s)}return s}function jE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function GE(t,e,n,r){e.value=n,e.getSnapshot=r,$E(e)&&zE(t)}function HE(t,e,n){return n(function(){$E(e)&&zE(t)})}function $E(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!En(t,n)}catch{return!0}}function zE(t){var e=ar(t,1);e!==null&&wn(e,t,1,-1)}function Fy(t){var e=Rn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:t},e.queue=t,t=t.dispatch=W1.bind(null,Le,t),[e.memoizedState,t]}function Ua(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function WE(){return dn().memoizedState}function tu(t,e,n,r){var s=Rn();Le.flags|=t,s.memoizedState=Ua(1|e,n,void 0,r===void 0?null:r)}function Ic(t,e,n,r){var s=dn();r=r===void 0?null:r;var i=void 0;if(tt!==null){var o=tt.memoizedState;if(i=o.destroy,r!==null&&Np(r,o.deps)){s.memoizedState=Ua(e,n,i,r);return}}Le.flags|=t,s.memoizedState=Ua(1|e,n,i,r)}function Oy(t,e){return tu(8390656,8,t,e)}function kp(t,e){return Ic(2048,8,t,e)}function KE(t,e){return Ic(4,2,t,e)}function JE(t,e){return Ic(4,4,t,e)}function YE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function QE(t,e,n){return n=n!=null?n.concat([t]):null,Ic(4,4,YE.bind(null,e,t),n)}function bp(){}function XE(t,e){var n=dn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Np(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ZE(t,e){var n=dn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Np(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function eT(t,e,n){return Gs&21?(En(n,e)||(n=iE(),Le.lanes|=n,Hs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Vt=!0),t.memoizedState=n)}function $1(t,e){var n=Te;Te=n!==0&&4>n?n:4,t(!0);var r=zd.transition;zd.transition={};try{t(!1),e()}finally{Te=n,zd.transition=r}}function tT(){return dn().memoizedState}function z1(t,e,n){var r=Wr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nT(t))rT(e,n);else if(n=UE(t,e,n,r),n!==null){var s=Rt();wn(n,t,r,s),sT(n,e,r)}}function W1(t,e,n){var r=Wr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nT(t))rT(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,En(a,o)){var l=e.interleaved;l===null?(s.next=s,xp(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=UE(t,e,s,r),n!==null&&(s=Rt(),wn(n,t,r,s),sT(n,e,r))}}function nT(t){var e=t.alternate;return t===Le||e!==null&&e===Le}function rT(t,e){da=Vu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function sT(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,up(t,n)}}var Uu={readContext:cn,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},K1={readContext:cn,useCallback:function(t,e){return Rn().memoizedState=[t,e===void 0?null:e],t},useContext:cn,useEffect:Oy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,tu(4194308,4,YE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return tu(4194308,4,t,e)},useInsertionEffect:function(t,e){return tu(4,2,t,e)},useMemo:function(t,e){var n=Rn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Rn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=z1.bind(null,Le,t),[r.memoizedState,t]},useRef:function(t){var e=Rn();return t={current:t},e.memoizedState=t},useState:Fy,useDebugValue:bp,useDeferredValue:function(t){return Rn().memoizedState=t},useTransition:function(){var t=Fy(!1),e=t[0];return t=$1.bind(null,t[1]),Rn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Le,s=Rn();if(Me){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),at===null)throw Error(K(349));Gs&30||jE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Oy(HE.bind(null,r,i,t),[t]),r.flags|=2048,Ua(9,GE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Rn(),e=at.identifierPrefix;if(Me){var n=Xn,r=Qn;n=(r&~(1<<32-_n(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=La++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=H1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},J1={readContext:cn,useCallback:XE,useContext:cn,useEffect:kp,useImperativeHandle:QE,useInsertionEffect:KE,useLayoutEffect:JE,useMemo:ZE,useReducer:Wd,useRef:WE,useState:function(){return Wd(Va)},useDebugValue:bp,useDeferredValue:function(t){var e=dn();return eT(e,tt.memoizedState,t)},useTransition:function(){var t=Wd(Va)[0],e=dn().memoizedState;return[t,e]},useMutableSource:qE,useSyncExternalStore:BE,useId:tT,unstable_isNewReconciler:!1},Y1={readContext:cn,useCallback:XE,useContext:cn,useEffect:kp,useImperativeHandle:QE,useInsertionEffect:KE,useLayoutEffect:JE,useMemo:ZE,useReducer:Kd,useRef:WE,useState:function(){return Kd(Va)},useDebugValue:bp,useDeferredValue:function(t){var e=dn();return tt===null?e.memoizedState=t:eT(e,tt.memoizedState,t)},useTransition:function(){var t=Kd(Va)[0],e=dn().memoizedState;return[t,e]},useMutableSource:qE,useSyncExternalStore:BE,useId:tT,unstable_isNewReconciler:!1};function mn(t,e){if(t&&t.defaultProps){e=Ve({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Qf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ve({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sc={isMounted:function(t){return(t=t._reactInternals)?ti(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Rt(),s=Wr(t),i=tr(r,s);i.payload=e,n!=null&&(i.callback=n),e=$r(t,i,s),e!==null&&(wn(e,t,s,r),Zl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Rt(),s=Wr(t),i=tr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=$r(t,i,s),e!==null&&(wn(e,t,s,r),Zl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rt(),r=Wr(t),s=tr(n,r);s.tag=2,e!=null&&(s.callback=e),e=$r(t,s,r),e!==null&&(wn(e,t,r,n),Zl(e,t,r))}};function qy(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ra(n,r)||!Ra(s,i):!0}function iT(t,e,n){var r=!1,s=Zr,i=e.contextType;return typeof i=="object"&&i!==null?i=cn(i):(s=Ft(e)?Bs:It.current,r=e.contextTypes,i=(r=r!=null)?Wi(t,s):Zr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function By(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Sc.enqueueReplaceState(e,e.state,null)}function Xf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ip(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=cn(i):(i=Ft(e)?Bs:It.current,s.context=Wi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Qf(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Sc.enqueueReplaceState(s,s.state,null),Du(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Qi(t,e){try{var n="",r=e;do n+=IA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Jd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Zf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Q1=typeof WeakMap=="function"?WeakMap:Map;function oT(t,e,n){n=tr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ou||(Ou=!0,uh=r),Zf(t,e)},n}function aT(t,e,n){n=tr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Zf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Zf(t,e),typeof r!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function jy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Q1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=dN.bind(null,t,e,n),e.then(t,t))}function Gy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Hy(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=tr(-1,1),e.tag=2,$r(n,e,1))),n.lanes|=1),t)}var X1=mr.ReactCurrentOwner,Vt=!1;function Nt(t,e,n,r){e.child=t===null?VE(e,null,n,r):Ji(e,t.child,n,r)}function $y(t,e,n,r,s){n=n.render;var i=e.ref;return Li(e,s),r=Rp(t,e,n,r,i,s),n=Pp(),t!==null&&!Vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,lr(t,e,s)):(Me&&n&&yp(e),e.flags|=1,Nt(t,e,r,s),e.child)}function zy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!qp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,lT(t,e,i,r,s)):(t=iu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ra,n(o,r)&&t.ref===e.ref)return lr(t,e,s)}return e.flags|=1,t=Kr(i,r),t.ref=e.ref,t.return=e,e.child=t}function lT(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ra(i,r)&&t.ref===e.ref)if(Vt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Vt=!0);else return e.lanes=t.lanes,lr(t,e,s)}return eh(t,e,n,r,s)}function uT(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(Ni,zt),zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ce(Ni,zt),zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ce(Ni,zt),zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ce(Ni,zt),zt|=r;return Nt(t,e,s,n),e.child}function cT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function eh(t,e,n,r,s){var i=Ft(n)?Bs:It.current;return i=Wi(e,i),Li(e,s),n=Rp(t,e,n,r,i,s),r=Pp(),t!==null&&!Vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,lr(t,e,s)):(Me&&r&&yp(e),e.flags|=1,Nt(t,e,n,s),e.child)}function Wy(t,e,n,r,s){if(Ft(n)){var i=!0;Ru(e)}else i=!1;if(Li(e,s),e.stateNode===null)nu(t,e),iT(e,n,r),Xf(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=cn(u):(u=Ft(n)?Bs:It.current,u=Wi(e,u));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&By(e,o,r,u),Pr=!1;var g=e.memoizedState;o.state=g,Du(e,r,o,s),l=e.memoizedState,a!==r||g!==l||Ut.current||Pr?(typeof p=="function"&&(Qf(e,n,p,r),l=e.memoizedState),(a=Pr||qy(e,n,a,r,g,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,FE(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:mn(e.type,a),o.props=u,m=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=cn(l):(l=Ft(n)?Bs:It.current,l=Wi(e,l));var _=n.getDerivedStateFromProps;(p=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==l)&&By(e,o,r,l),Pr=!1,g=e.memoizedState,o.state=g,Du(e,r,o,s);var T=e.memoizedState;a!==m||g!==T||Ut.current||Pr?(typeof _=="function"&&(Qf(e,n,_,r),T=e.memoizedState),(u=Pr||qy(e,n,u,r,g,T,l)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return th(t,e,n,r,i,s)}function th(t,e,n,r,s,i){cT(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&by(e,n,!1),lr(t,e,i);r=e.stateNode,X1.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ji(e,t.child,null,i),e.child=Ji(e,null,a,i)):Nt(t,e,a,i),e.memoizedState=r.state,s&&by(e,n,!0),e.child}function dT(t){var e=t.stateNode;e.pendingContext?ky(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ky(t,e.context,!1),Sp(t,e.containerInfo)}function Ky(t,e,n,r,s){return Ki(),_p(s),e.flags|=256,Nt(t,e,n,r),e.child}var nh={dehydrated:null,treeContext:null,retryLane:0};function rh(t){return{baseLanes:t,cachePool:null,transitions:null}}function fT(t,e,n){var r=e.pendingProps,s=De.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ce(De,s&1),t===null)return Jf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Nc(o,r,0,null),t=Fs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=rh(n),e.memoizedState=nh,t):Mp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Z1(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Kr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Kr(a,i):(i=Fs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?rh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=nh,r}return i=t.child,t=i.sibling,r=Kr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Mp(t,e){return e=Nc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ul(t,e,n,r){return r!==null&&_p(r),Ji(e,t.child,null,n),t=Mp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Z1(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Jd(Error(K(422))),Ul(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Nc({mode:"visible",children:r.children},s,0,null),i=Fs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ji(e,t.child,null,o),e.child.memoizedState=rh(o),e.memoizedState=nh,i);if(!(e.mode&1))return Ul(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(K(419)),r=Jd(i,r,void 0),Ul(t,e,o,r)}if(a=(o&t.childLanes)!==0,Vt||a){if(r=at,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ar(t,s),wn(r,t,s,-1))}return Op(),r=Jd(Error(K(421))),Ul(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=fN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Wt=Hr(s.nextSibling),Jt=e,Me=!0,yn=null,t!==null&&(en[tn++]=Qn,en[tn++]=Xn,en[tn++]=js,Qn=t.id,Xn=t.overflow,js=e),e=Mp(e,r.children),e.flags|=4096,e)}function Jy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Yf(t.return,e,n)}function Yd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function hT(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=De.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Jy(t,n,e);else if(t.tag===19)Jy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ce(De,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Lu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Yd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Lu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Yd(e,!0,n,null,i);break;case"together":Yd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function lr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Hs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Kr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Kr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function eN(t,e,n){switch(e.tag){case 3:dT(e),Ki();break;case 5:OE(e);break;case 1:Ft(e.type)&&Ru(e);break;case 4:Sp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ce(bu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ce(De,De.current&1),e.flags|=128,null):n&e.child.childLanes?fT(t,e,n):(Ce(De,De.current&1),t=lr(t,e,n),t!==null?t.sibling:null);Ce(De,De.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return hT(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(De,De.current),r)break;return null;case 22:case 23:return e.lanes=0,uT(t,e,n)}return lr(t,e,n)}var pT,sh,mT,gT;pT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};sh=function(){};mT=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ds(Vn.current);var i=null;switch(n){case"input":s=Cf(t,s),r=Cf(t,r),i=[];break;case"select":s=Ve({},s,{value:void 0}),r=Ve({},r,{value:void 0}),i=[];break;case"textarea":s=Rf(t,s),r=Rf(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Au)}kf(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ta.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ta.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Re("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};gT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Wo(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function gt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function tN(t,e,n){var r=e.pendingProps;switch(vp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(e),null;case 1:return Ft(e.type)&&Nu(),gt(e),null;case 3:return r=e.stateNode,Yi(),be(Ut),be(It),Ap(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ll(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yn!==null&&(fh(yn),yn=null))),sh(t,e),gt(e),null;case 5:Cp(e);var s=Ds(Da.current);if(n=e.type,t!==null&&e.stateNode!=null)mT(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return gt(e),null}if(t=Ds(Vn.current),Ll(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[kn]=e,r[ba]=i,t=(e.mode&1)!==0,n){case"dialog":Re("cancel",r),Re("close",r);break;case"iframe":case"object":case"embed":Re("load",r);break;case"video":case"audio":for(s=0;s<Zo.length;s++)Re(Zo[s],r);break;case"source":Re("error",r);break;case"img":case"image":case"link":Re("error",r),Re("load",r);break;case"details":Re("toggle",r);break;case"input":sy(r,i),Re("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Re("invalid",r);break;case"textarea":oy(r,i),Re("invalid",r)}kf(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Dl(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Dl(r.textContent,a,t),s=["children",""+a]):Ta.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Re("scroll",r)}switch(n){case"input":Cl(r),iy(r,i,!0);break;case"textarea":Cl(r),ay(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Au)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Hw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[kn]=e,t[ba]=r,pT(t,e,!1,!1),e.stateNode=t;e:{switch(o=bf(n,r),n){case"dialog":Re("cancel",t),Re("close",t),s=r;break;case"iframe":case"object":case"embed":Re("load",t),s=r;break;case"video":case"audio":for(s=0;s<Zo.length;s++)Re(Zo[s],t);s=r;break;case"source":Re("error",t),s=r;break;case"img":case"image":case"link":Re("error",t),Re("load",t),s=r;break;case"details":Re("toggle",t),s=r;break;case"input":sy(t,r),s=Cf(t,r),Re("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ve({},r,{value:void 0}),Re("invalid",t);break;case"textarea":oy(t,r),s=Rf(t,r),Re("invalid",t);break;default:s=r}kf(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Ww(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$w(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&xa(t,l):typeof l=="number"&&xa(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ta.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Re("scroll",t):l!=null&&rp(t,i,l,o))}switch(n){case"input":Cl(t),iy(t,r,!1);break;case"textarea":Cl(t),ay(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ki(t,!!r.multiple,i,!1):r.defaultValue!=null&&ki(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Au)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gt(e),null;case 6:if(t&&e.stateNode!=null)gT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=Ds(Da.current),Ds(Vn.current),Ll(e)){if(r=e.stateNode,n=e.memoizedProps,r[kn]=e,(i=r.nodeValue!==n)&&(t=Jt,t!==null))switch(t.tag){case 3:Dl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Dl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[kn]=e,e.stateNode=r}return gt(e),null;case 13:if(be(De),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&Wt!==null&&e.mode&1&&!(e.flags&128))DE(),Ki(),e.flags|=98560,i=!1;else if(i=Ll(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[kn]=e}else Ki(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gt(e),i=!1}else yn!==null&&(fh(yn),yn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||De.current&1?nt===0&&(nt=3):Op())),e.updateQueue!==null&&(e.flags|=4),gt(e),null);case 4:return Yi(),sh(t,e),t===null&&Pa(e.stateNode.containerInfo),gt(e),null;case 10:return Tp(e.type._context),gt(e),null;case 17:return Ft(e.type)&&Nu(),gt(e),null;case 19:if(be(De),i=e.memoizedState,i===null)return gt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Wo(i,!1);else{if(nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Lu(t),o!==null){for(e.flags|=128,Wo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ce(De,De.current&1|2),e.child}t=t.sibling}i.tail!==null&&He()>Xi&&(e.flags|=128,r=!0,Wo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Lu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Me)return gt(e),null}else 2*He()-i.renderingStartTime>Xi&&n!==1073741824&&(e.flags|=128,r=!0,Wo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=He(),e.sibling=null,n=De.current,Ce(De,r?n&1|2:n&1),e):(gt(e),null);case 22:case 23:return Fp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zt&1073741824&&(gt(e),e.subtreeFlags&6&&(e.flags|=8192)):gt(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function nN(t,e){switch(vp(e),e.tag){case 1:return Ft(e.type)&&Nu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yi(),be(Ut),be(It),Ap(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cp(e),null;case 13:if(be(De),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));Ki()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return be(De),null;case 4:return Yi(),null;case 10:return Tp(e.type._context),null;case 22:case 23:return Fp(),null;case 24:return null;default:return null}}var Fl=!1,wt=!1,rN=typeof WeakSet=="function"?WeakSet:Set,te=null;function Ai(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Oe(t,e,r)}else n.current=null}function ih(t,e,n){try{n()}catch(r){Oe(t,e,r)}}var Yy=!1;function sN(t,e){if(jf=Iu,t=EE(),gp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,p=0,m=t,g=null;t:for(;;){for(var _;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(_=m.firstChild)!==null;)g=m,m=_;for(;;){if(m===t)break t;if(g===n&&++u===s&&(a=o),g===i&&++p===r&&(l=o),(_=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=_}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gf={focusedElem:t,selectionRange:n},Iu=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var R=T.memoizedProps,x=T.memoizedState,C=e.stateNode,I=C.getSnapshotBeforeUpdate(e.elementType===e.type?R:mn(e.type,R),x);C.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(D){Oe(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return T=Yy,Yy=!1,T}function fa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ih(e,n,i)}s=s.next}while(s!==r)}}function Cc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function oh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function yT(t){var e=t.alternate;e!==null&&(t.alternate=null,yT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[kn],delete e[ba],delete e[zf],delete e[q1],delete e[B1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vT(t){return t.tag===5||t.tag===3||t.tag===4}function Qy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ah(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Au));else if(r!==4&&(t=t.child,t!==null))for(ah(t,e,n),t=t.sibling;t!==null;)ah(t,e,n),t=t.sibling}function lh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(lh(t,e,n),t=t.sibling;t!==null;)lh(t,e,n),t=t.sibling}var lt=null,gn=!1;function Ar(t,e,n){for(n=n.child;n!==null;)_T(t,e,n),n=n.sibling}function _T(t,e,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(vc,n)}catch{}switch(n.tag){case 5:wt||Ai(n,e);case 6:var r=lt,s=gn;lt=null,Ar(t,e,n),lt=r,gn=s,lt!==null&&(gn?(t=lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):lt.removeChild(n.stateNode));break;case 18:lt!==null&&(gn?(t=lt,n=n.stateNode,t.nodeType===8?Gd(t.parentNode,n):t.nodeType===1&&Gd(t,n),Aa(t)):Gd(lt,n.stateNode));break;case 4:r=lt,s=gn,lt=n.stateNode.containerInfo,gn=!0,Ar(t,e,n),lt=r,gn=s;break;case 0:case 11:case 14:case 15:if(!wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ih(n,e,o),s=s.next}while(s!==r)}Ar(t,e,n);break;case 1:if(!wt&&(Ai(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Oe(n,e,a)}Ar(t,e,n);break;case 21:Ar(t,e,n);break;case 22:n.mode&1?(wt=(r=wt)||n.memoizedState!==null,Ar(t,e,n),wt=r):Ar(t,e,n);break;default:Ar(t,e,n)}}function Xy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new rN),e.forEach(function(r){var s=hN.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function pn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:lt=a.stateNode,gn=!1;break e;case 3:lt=a.stateNode.containerInfo,gn=!0;break e;case 4:lt=a.stateNode.containerInfo,gn=!0;break e}a=a.return}if(lt===null)throw Error(K(160));_T(i,o,s),lt=null,gn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Oe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wT(e,t),e=e.sibling}function wT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pn(e,t),Nn(t),r&4){try{fa(3,t,t.return),Cc(3,t)}catch(R){Oe(t,t.return,R)}try{fa(5,t,t.return)}catch(R){Oe(t,t.return,R)}}break;case 1:pn(e,t),Nn(t),r&512&&n!==null&&Ai(n,n.return);break;case 5:if(pn(e,t),Nn(t),r&512&&n!==null&&Ai(n,n.return),t.flags&32){var s=t.stateNode;try{xa(s,"")}catch(R){Oe(t,t.return,R)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&jw(s,i),bf(a,o);var u=bf(a,i);for(o=0;o<l.length;o+=2){var p=l[o],m=l[o+1];p==="style"?Ww(s,m):p==="dangerouslySetInnerHTML"?$w(s,m):p==="children"?xa(s,m):rp(s,p,m,u)}switch(a){case"input":Af(s,i);break;case"textarea":Gw(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?ki(s,!!i.multiple,_,!1):g!==!!i.multiple&&(i.defaultValue!=null?ki(s,!!i.multiple,i.defaultValue,!0):ki(s,!!i.multiple,i.multiple?[]:"",!1))}s[ba]=i}catch(R){Oe(t,t.return,R)}}break;case 6:if(pn(e,t),Nn(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(R){Oe(t,t.return,R)}}break;case 3:if(pn(e,t),Nn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Aa(e.containerInfo)}catch(R){Oe(t,t.return,R)}break;case 4:pn(e,t),Nn(t);break;case 13:pn(e,t),Nn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Vp=He())),r&4&&Xy(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(wt=(u=wt)||p,pn(e,t),wt=u):pn(e,t),Nn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!p&&t.mode&1)for(te=t,p=t.child;p!==null;){for(m=te=p;te!==null;){switch(g=te,_=g.child,g.tag){case 0:case 11:case 14:case 15:fa(4,g,g.return);break;case 1:Ai(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(R){Oe(r,n,R)}}break;case 5:Ai(g,g.return);break;case 22:if(g.memoizedState!==null){e0(m);continue}}_!==null?(_.return=g,te=_):e0(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{s=m.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=zw("display",o))}catch(R){Oe(t,t.return,R)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(R){Oe(t,t.return,R)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:pn(e,t),Nn(t),r&4&&Xy(t);break;case 21:break;default:pn(e,t),Nn(t)}}function Nn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(vT(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(xa(s,""),r.flags&=-33);var i=Qy(t);lh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Qy(t);ah(t,a,o);break;default:throw Error(K(161))}}catch(l){Oe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function iN(t,e,n){te=t,ET(t)}function ET(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Fl;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||wt;a=Fl;var u=wt;if(Fl=o,(wt=l)&&!u)for(te=s;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?t0(s):l!==null?(l.return=o,te=l):t0(s);for(;i!==null;)te=i,ET(i),i=i.sibling;te=s,Fl=a,wt=u}Zy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):Zy(t)}}function Zy(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:wt||Cc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!wt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:mn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Uy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Uy(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var p=u.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&Aa(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}wt||e.flags&512&&oh(e)}catch(g){Oe(e,e.return,g)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function e0(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function t0(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cc(4,e)}catch(l){Oe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Oe(e,s,l)}}var i=e.return;try{oh(e)}catch(l){Oe(e,i,l)}break;case 5:var o=e.return;try{oh(e)}catch(l){Oe(e,o,l)}}}catch(l){Oe(e,e.return,l)}if(e===t){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var oN=Math.ceil,Fu=mr.ReactCurrentDispatcher,Dp=mr.ReactCurrentOwner,on=mr.ReactCurrentBatchConfig,ve=0,at=null,Ke=null,dt=0,zt=0,Ni=cs(0),nt=0,Fa=null,Hs=0,Ac=0,Lp=0,ha=null,Dt=null,Vp=0,Xi=1/0,Kn=null,Ou=!1,uh=null,zr=null,Ol=!1,Fr=null,qu=0,pa=0,ch=null,ru=-1,su=0;function Rt(){return ve&6?He():ru!==-1?ru:ru=He()}function Wr(t){return t.mode&1?ve&2&&dt!==0?dt&-dt:G1.transition!==null?(su===0&&(su=iE()),su):(t=Te,t!==0||(t=window.event,t=t===void 0?16:fE(t.type)),t):1}function wn(t,e,n,r){if(50<pa)throw pa=0,ch=null,Error(K(185));Xa(t,n,r),(!(ve&2)||t!==at)&&(t===at&&(!(ve&2)&&(Ac|=n),nt===4&&br(t,dt)),Ot(t,r),n===1&&ve===0&&!(e.mode&1)&&(Xi=He()+500,xc&&ds()))}function Ot(t,e){var n=t.callbackNode;GA(t,e);var r=xu(t,t===at?dt:0);if(r===0)n!==null&&cy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&cy(n),e===1)t.tag===0?j1(n0.bind(null,t)):kE(n0.bind(null,t)),F1(function(){!(ve&6)&&ds()}),n=null;else{switch(oE(r)){case 1:n=lp;break;case 4:n=rE;break;case 16:n=Tu;break;case 536870912:n=sE;break;default:n=Tu}n=RT(n,TT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function TT(t,e){if(ru=-1,su=0,ve&6)throw Error(K(327));var n=t.callbackNode;if(Vi()&&t.callbackNode!==n)return null;var r=xu(t,t===at?dt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Bu(t,r);else{e=r;var s=ve;ve|=2;var i=IT();(at!==t||dt!==e)&&(Kn=null,Xi=He()+500,Us(t,e));do try{uN();break}catch(a){xT(t,a)}while(!0);Ep(),Fu.current=i,ve=s,Ke!==null?e=0:(at=null,dt=0,e=nt)}if(e!==0){if(e===2&&(s=Uf(t),s!==0&&(r=s,e=dh(t,s))),e===1)throw n=Fa,Us(t,0),br(t,r),Ot(t,He()),n;if(e===6)br(t,r);else{if(s=t.current.alternate,!(r&30)&&!aN(s)&&(e=Bu(t,r),e===2&&(i=Uf(t),i!==0&&(r=i,e=dh(t,i))),e===1))throw n=Fa,Us(t,0),br(t,r),Ot(t,He()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:Ps(t,Dt,Kn);break;case 3:if(br(t,r),(r&130023424)===r&&(e=Vp+500-He(),10<e)){if(xu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Rt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=$f(Ps.bind(null,t,Dt,Kn),e);break}Ps(t,Dt,Kn);break;case 4:if(br(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-_n(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=He()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*oN(r/1960))-r,10<r){t.timeoutHandle=$f(Ps.bind(null,t,Dt,Kn),r);break}Ps(t,Dt,Kn);break;case 5:Ps(t,Dt,Kn);break;default:throw Error(K(329))}}}return Ot(t,He()),t.callbackNode===n?TT.bind(null,t):null}function dh(t,e){var n=ha;return t.current.memoizedState.isDehydrated&&(Us(t,e).flags|=256),t=Bu(t,e),t!==2&&(e=Dt,Dt=n,e!==null&&fh(e)),t}function fh(t){Dt===null?Dt=t:Dt.push.apply(Dt,t)}function aN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!En(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function br(t,e){for(e&=~Lp,e&=~Ac,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_n(e),r=1<<n;t[n]=-1,e&=~r}}function n0(t){if(ve&6)throw Error(K(327));Vi();var e=xu(t,0);if(!(e&1))return Ot(t,He()),null;var n=Bu(t,e);if(t.tag!==0&&n===2){var r=Uf(t);r!==0&&(e=r,n=dh(t,r))}if(n===1)throw n=Fa,Us(t,0),br(t,e),Ot(t,He()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ps(t,Dt,Kn),Ot(t,He()),null}function Up(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(Xi=He()+500,xc&&ds())}}function $s(t){Fr!==null&&Fr.tag===0&&!(ve&6)&&Vi();var e=ve;ve|=1;var n=on.transition,r=Te;try{if(on.transition=null,Te=1,t)return t()}finally{Te=r,on.transition=n,ve=e,!(ve&6)&&ds()}}function Fp(){zt=Ni.current,be(Ni)}function Us(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,U1(n)),Ke!==null)for(n=Ke.return;n!==null;){var r=n;switch(vp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Nu();break;case 3:Yi(),be(Ut),be(It),Ap();break;case 5:Cp(r);break;case 4:Yi();break;case 13:be(De);break;case 19:be(De);break;case 10:Tp(r.type._context);break;case 22:case 23:Fp()}n=n.return}if(at=t,Ke=t=Kr(t.current,null),dt=zt=e,nt=0,Fa=null,Lp=Ac=Hs=0,Dt=ha=null,Ms!==null){for(e=0;e<Ms.length;e++)if(n=Ms[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ms=null}return t}function xT(t,e){do{var n=Ke;try{if(Ep(),eu.current=Uu,Vu){for(var r=Le.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Vu=!1}if(Gs=0,ot=tt=Le=null,da=!1,La=0,Dp.current=null,n===null||n.return===null){nt=1,Fa=e,Ke=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=dt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,p=a,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var g=p.alternate;g?(p.updateQueue=g.updateQueue,p.memoizedState=g.memoizedState,p.lanes=g.lanes):(p.updateQueue=null,p.memoizedState=null)}var _=Gy(o);if(_!==null){_.flags&=-257,Hy(_,o,a,i,e),_.mode&1&&jy(i,u,e),e=_,l=u;var T=e.updateQueue;if(T===null){var R=new Set;R.add(l),e.updateQueue=R}else T.add(l);break e}else{if(!(e&1)){jy(i,u,e),Op();break e}l=Error(K(426))}}else if(Me&&a.mode&1){var x=Gy(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Hy(x,o,a,i,e),_p(Qi(l,a));break e}}i=l=Qi(l,a),nt!==4&&(nt=2),ha===null?ha=[i]:ha.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var C=oT(i,l,e);Vy(i,C);break e;case 1:a=l;var I=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof I.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(zr===null||!zr.has(A)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=aT(i,a,e);Vy(i,D);break e}}i=i.return}while(i!==null)}CT(n)}catch(U){e=U,Ke===n&&n!==null&&(Ke=n=n.return);continue}break}while(!0)}function IT(){var t=Fu.current;return Fu.current=Uu,t===null?Uu:t}function Op(){(nt===0||nt===3||nt===2)&&(nt=4),at===null||!(Hs&268435455)&&!(Ac&268435455)||br(at,dt)}function Bu(t,e){var n=ve;ve|=2;var r=IT();(at!==t||dt!==e)&&(Kn=null,Us(t,e));do try{lN();break}catch(s){xT(t,s)}while(!0);if(Ep(),ve=n,Fu.current=r,Ke!==null)throw Error(K(261));return at=null,dt=0,nt}function lN(){for(;Ke!==null;)ST(Ke)}function uN(){for(;Ke!==null&&!DA();)ST(Ke)}function ST(t){var e=NT(t.alternate,t,zt);t.memoizedProps=t.pendingProps,e===null?CT(t):Ke=e,Dp.current=null}function CT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=nN(n,e),n!==null){n.flags&=32767,Ke=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nt=6,Ke=null;return}}else if(n=tN(n,e,zt),n!==null){Ke=n;return}if(e=e.sibling,e!==null){Ke=e;return}Ke=e=t}while(e!==null);nt===0&&(nt=5)}function Ps(t,e,n){var r=Te,s=on.transition;try{on.transition=null,Te=1,cN(t,e,n,r)}finally{on.transition=s,Te=r}return null}function cN(t,e,n,r){do Vi();while(Fr!==null);if(ve&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(HA(t,i),t===at&&(Ke=at=null,dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ol||(Ol=!0,RT(Tu,function(){return Vi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=on.transition,on.transition=null;var o=Te;Te=1;var a=ve;ve|=4,Dp.current=null,sN(t,n),wT(n,t),P1(Gf),Iu=!!jf,Gf=jf=null,t.current=n,iN(n),LA(),ve=a,Te=o,on.transition=i}else t.current=n;if(Ol&&(Ol=!1,Fr=t,qu=s),i=t.pendingLanes,i===0&&(zr=null),FA(n.stateNode),Ot(t,He()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ou)throw Ou=!1,t=uh,uh=null,t;return qu&1&&t.tag!==0&&Vi(),i=t.pendingLanes,i&1?t===ch?pa++:(pa=0,ch=t):pa=0,ds(),null}function Vi(){if(Fr!==null){var t=oE(qu),e=on.transition,n=Te;try{if(on.transition=null,Te=16>t?16:t,Fr===null)var r=!1;else{if(t=Fr,Fr=null,qu=0,ve&6)throw Error(K(331));var s=ve;for(ve|=4,te=t.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(te=u;te!==null;){var p=te;switch(p.tag){case 0:case 11:case 15:fa(8,p,i)}var m=p.child;if(m!==null)m.return=p,te=m;else for(;te!==null;){p=te;var g=p.sibling,_=p.return;if(yT(p),p===u){te=null;break}if(g!==null){g.return=_,te=g;break}te=_}}}var T=i.alternate;if(T!==null){var R=T.child;if(R!==null){T.child=null;do{var x=R.sibling;R.sibling=null,R=x}while(R!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:fa(9,i,i.return)}var C=i.sibling;if(C!==null){C.return=i.return,te=C;break e}te=i.return}}var I=t.current;for(te=I;te!==null;){o=te;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,te=A;else e:for(o=I;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Cc(9,a)}}catch(U){Oe(a,a.return,U)}if(a===o){te=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,te=D;break e}te=a.return}}if(ve=s,ds(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(vc,t)}catch{}r=!0}return r}finally{Te=n,on.transition=e}}return!1}function r0(t,e,n){e=Qi(n,e),e=oT(t,e,1),t=$r(t,e,1),e=Rt(),t!==null&&(Xa(t,1,e),Ot(t,e))}function Oe(t,e,n){if(t.tag===3)r0(t,t,n);else for(;e!==null;){if(e.tag===3){r0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zr===null||!zr.has(r))){t=Qi(n,t),t=aT(e,t,1),e=$r(e,t,1),t=Rt(),e!==null&&(Xa(e,1,t),Ot(e,t));break}}e=e.return}}function dN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Rt(),t.pingedLanes|=t.suspendedLanes&n,at===t&&(dt&n)===n&&(nt===4||nt===3&&(dt&130023424)===dt&&500>He()-Vp?Us(t,0):Lp|=n),Ot(t,e)}function AT(t,e){e===0&&(t.mode&1?(e=Rl,Rl<<=1,!(Rl&130023424)&&(Rl=4194304)):e=1);var n=Rt();t=ar(t,e),t!==null&&(Xa(t,e,n),Ot(t,n))}function fN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),AT(t,n)}function hN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),AT(t,n)}var NT;NT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ut.current)Vt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Vt=!1,eN(t,e,n);Vt=!!(t.flags&131072)}else Vt=!1,Me&&e.flags&1048576&&bE(e,ku,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nu(t,e),t=e.pendingProps;var s=Wi(e,It.current);Li(e,n),s=Rp(null,e,r,t,s,n);var i=Pp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ft(r)?(i=!0,Ru(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ip(e),s.updater=Sc,e.stateNode=s,s._reactInternals=e,Xf(e,r,t,n),e=th(null,e,r,!0,i,n)):(e.tag=0,Me&&i&&yp(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=mN(r),t=mn(r,t),s){case 0:e=eh(null,e,r,t,n);break e;case 1:e=Wy(null,e,r,t,n);break e;case 11:e=$y(null,e,r,t,n);break e;case 14:e=zy(null,e,r,mn(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),eh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),Wy(t,e,r,s,n);case 3:e:{if(dT(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,FE(t,e),Du(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Qi(Error(K(423)),e),e=Ky(t,e,r,n,s);break e}else if(r!==s){s=Qi(Error(K(424)),e),e=Ky(t,e,r,n,s);break e}else for(Wt=Hr(e.stateNode.containerInfo.firstChild),Jt=e,Me=!0,yn=null,n=VE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ki(),r===s){e=lr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return OE(e),t===null&&Jf(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Hf(r,s)?o=null:i!==null&&Hf(r,i)&&(e.flags|=32),cT(t,e),Nt(t,e,o,n),e.child;case 6:return t===null&&Jf(e),null;case 13:return fT(t,e,n);case 4:return Sp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ji(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),$y(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ce(bu,r._currentValue),r._currentValue=o,i!==null)if(En(i.value,o)){if(i.children===s.children&&!Ut.current){e=lr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=tr(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var p=u.pending;p===null?l.next=l:(l.next=p.next,p.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Yf(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Yf(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Li(e,n),s=cn(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=mn(r,e.pendingProps),s=mn(r.type,s),zy(t,e,r,s,n);case 15:return lT(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mn(r,s),nu(t,e),e.tag=1,Ft(r)?(t=!0,Ru(e)):t=!1,Li(e,n),iT(e,r,s),Xf(e,r,s,n),th(null,e,r,!0,t,n);case 19:return hT(t,e,n);case 22:return uT(t,e,n)}throw Error(K(156,e.tag))};function RT(t,e){return nE(t,e)}function pN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(t,e,n,r){return new pN(t,e,n,r)}function qp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function mN(t){if(typeof t=="function")return qp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ip)return 11;if(t===op)return 14}return 2}function Kr(t,e){var n=t.alternate;return n===null?(n=sn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function iu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")qp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case vi:return Fs(n.children,s,i,e);case sp:o=8,s|=8;break;case Tf:return t=sn(12,n,e,s|2),t.elementType=Tf,t.lanes=i,t;case xf:return t=sn(13,n,e,s),t.elementType=xf,t.lanes=i,t;case If:return t=sn(19,n,e,s),t.elementType=If,t.lanes=i,t;case Ow:return Nc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Uw:o=10;break e;case Fw:o=9;break e;case ip:o=11;break e;case op:o=14;break e;case Rr:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=sn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Fs(t,e,n,r){return t=sn(7,t,r,e),t.lanes=n,t}function Nc(t,e,n,r){return t=sn(22,t,r,e),t.elementType=Ow,t.lanes=n,t.stateNode={isHidden:!1},t}function Qd(t,e,n){return t=sn(6,t,null,e),t.lanes=n,t}function Xd(t,e,n){return e=sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function gN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bd(0),this.expirationTimes=bd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Bp(t,e,n,r,s,i,o,a,l){return t=new gN(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=sn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ip(i),t}function yN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function PT(t){if(!t)return Zr;t=t._reactInternals;e:{if(ti(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ft(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Ft(n))return PE(t,n,e)}return e}function kT(t,e,n,r,s,i,o,a,l){return t=Bp(n,r,!0,t,s,i,o,a,l),t.context=PT(null),n=t.current,r=Rt(),s=Wr(n),i=tr(r,s),i.callback=e??null,$r(n,i,s),t.current.lanes=s,Xa(t,s,r),Ot(t,r),t}function Rc(t,e,n,r){var s=e.current,i=Rt(),o=Wr(s);return n=PT(n),e.context===null?e.context=n:e.pendingContext=n,e=tr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$r(s,e,o),t!==null&&(wn(t,s,o,i),Zl(t,s,o)),o}function ju(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function s0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function jp(t,e){s0(t,e),(t=t.alternate)&&s0(t,e)}function vN(){return null}var bT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Gp(t){this._internalRoot=t}Pc.prototype.render=Gp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));Rc(t,e,null,null)};Pc.prototype.unmount=Gp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$s(function(){Rc(null,t,null,null)}),e[or]=null}};function Pc(t){this._internalRoot=t}Pc.prototype.unstable_scheduleHydration=function(t){if(t){var e=uE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<kr.length&&e!==0&&e<kr[n].priority;n++);kr.splice(n,0,t),n===0&&dE(t)}};function Hp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function kc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function i0(){}function _N(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=ju(o);i.call(u)}}var o=kT(e,r,t,0,null,!1,!1,"",i0);return t._reactRootContainer=o,t[or]=o.current,Pa(t.nodeType===8?t.parentNode:t),$s(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=ju(l);a.call(u)}}var l=Bp(t,0,!1,null,null,!1,!1,"",i0);return t._reactRootContainer=l,t[or]=l.current,Pa(t.nodeType===8?t.parentNode:t),$s(function(){Rc(e,l,n,r)}),l}function bc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=ju(o);a.call(l)}}Rc(e,o,t,s)}else o=_N(n,e,t,s,r);return ju(o)}aE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Xo(e.pendingLanes);n!==0&&(up(e,n|1),Ot(e,He()),!(ve&6)&&(Xi=He()+500,ds()))}break;case 13:$s(function(){var r=ar(t,1);if(r!==null){var s=Rt();wn(r,t,1,s)}}),jp(t,1)}};cp=function(t){if(t.tag===13){var e=ar(t,134217728);if(e!==null){var n=Rt();wn(e,t,134217728,n)}jp(t,134217728)}};lE=function(t){if(t.tag===13){var e=Wr(t),n=ar(t,e);if(n!==null){var r=Rt();wn(n,t,e,r)}jp(t,e)}};uE=function(){return Te};cE=function(t,e){var n=Te;try{return Te=t,e()}finally{Te=n}};Df=function(t,e,n){switch(e){case"input":if(Af(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Tc(r);if(!s)throw Error(K(90));Bw(r),Af(r,s)}}}break;case"textarea":Gw(t,n);break;case"select":e=n.value,e!=null&&ki(t,!!n.multiple,e,!1)}};Yw=Up;Qw=$s;var wN={usingClientEntryPoint:!1,Events:[el,Ti,Tc,Kw,Jw,Up]},Ko={findFiberByHostInstance:bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EN={bundleType:Ko.bundleType,version:Ko.version,rendererPackageName:Ko.rendererPackageName,rendererConfig:Ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=eE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ko.findFiberByHostInstance||vN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ql=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ql.isDisabled&&ql.supportsFiber)try{vc=ql.inject(EN),Ln=ql}catch{}}Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wN;Qt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hp(e))throw Error(K(200));return yN(t,e,null,n)};Qt.createRoot=function(t,e){if(!Hp(t))throw Error(K(299));var n=!1,r="",s=bT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Bp(t,1,!1,null,null,n,!1,r,s),t[or]=e.current,Pa(t.nodeType===8?t.parentNode:t),new Gp(e)};Qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=eE(e),t=t===null?null:t.stateNode,t};Qt.flushSync=function(t){return $s(t)};Qt.hydrate=function(t,e,n){if(!kc(e))throw Error(K(200));return bc(null,t,e,!0,n)};Qt.hydrateRoot=function(t,e,n){if(!Hp(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=bT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=kT(e,null,t,1,n??null,s,!1,i,o),t[or]=e.current,Pa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Pc(e)};Qt.render=function(t,e,n){if(!kc(e))throw Error(K(200));return bc(null,t,e,!1,n)};Qt.unmountComponentAtNode=function(t){if(!kc(t))throw Error(K(40));return t._reactRootContainer?($s(function(){bc(null,null,t,!1,function(){t._reactRootContainer=null,t[or]=null})}),!0):!1};Qt.unstable_batchedUpdates=Up;Qt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!kc(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return bc(t,e,n,!1,r)};Qt.version="18.3.1-next-f1338f8080-20240426";function MT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(MT)}catch(t){console.error(t)}}MT(),Mw.exports=Qt;var TN=Mw.exports,o0=TN;vu.createRoot=o0.createRoot,vu.hydrateRoot=o0.hydrateRoot;const $p=t=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),DT=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),es=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),LT=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),xN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),VT=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),zs=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:h.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),IN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),SN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),UT=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),CN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),AN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),NN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),RN=t=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),hh=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),PN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),kN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),bN=t=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),MN=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),FT=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),DN=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>h.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:h.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[h.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),h.jsxs("span",{className:"text-2xl font-bold",children:[h.jsx("span",{className:"text-gray-900",children:"LA"}),h.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),h.jsx("div",{className:"flex items-center gap-4",children:t&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:h.jsx(FT,{className:"w-7 h-7"})}),h.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[h.jsx(hh,{className:"h-5 w-5"}),h.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),h.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[h.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),h.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),a0=({product:t,onSelect:e})=>{const n=t.imageUrls&&t.imageUrls.length>0,r=s=>typeof s!="number"||isNaN(s)?"N/A":s.toFixed(2);return h.jsxs("button",{onClick:e,className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group text-left w-full hover:shadow-lg transition-shadow",children:[h.jsx("div",{className:"w-full aspect-square bg-gray-100 overflow-hidden",children:n&&h.jsx("img",{src:t.imageUrls[0],alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),h.jsxs("div",{className:"p-3",children:[h.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[r(t.price)," "]}),h.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),h.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[h.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),h.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})},LN=({userProducts:t,merchProducts:e,onProductSelect:n})=>{const[r,s]=V.useState(t),[i,o]=V.useState("");V.useEffect(()=>{const l=i.toLowerCase();if(l==="")s(t);else{const u=t.filter(p=>p.title.toLowerCase().includes(l)||p.description.toLowerCase().includes(l));s(u)}},[i,t]);const a=l=>{o(l.target.value)};return h.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Descobreix i estalvia"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"Busca entre els articles de segona m a prop teu."}),h.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:h.jsxs("div",{className:"relative flex-grow",children:[h.jsx(UT,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:i,onChange:a,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&h.jsx("section",{className:"mb-12",children:h.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[h.jsx("div",{className:"flex justify-between items-center mb-6",children:h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club"})}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:e.map(l=>h.jsx(a0,{product:l,onSelect:()=>n(l)},l.id))})]})}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles destacats"}),r.length>0?h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:r.map(l=>h.jsx(a0,{product:l,onSelect:()=>n(l)},l.id))}):h.jsx("div",{className:"text-center py-16",children:h.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},zn=5,VN=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.85))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),UN=({images:t,setImages:e})=>{const[n,r]=V.useState(!1),[s,i]=V.useState(null),[o,a]=V.useState(!1),l=V.useRef(null),u=V.useRef(null),p=async T=>{const R=T.target.files;if(!R)return;const x=Array.from(R).slice(0,zn-t.length);if(R.length>x.length?i(`Noms pots pujar un mxim de ${zn} imatges.`):i(null),x.length!==0){r(!0);try{const C=x.map(A=>VN(A)),I=await Promise.all(C);e([...t,...I])}catch(C){i("No s'ha pogut carregar una o ms imatges."),console.error(C)}finally{r(!1)}T.target.value=""}},m=T=>{e(t.filter((R,x)=>x!==T))},g=()=>{var T;a(!1),(T=l.current)==null||T.click()},_=()=>{var T;a(!1),(T=u.current)==null||T.click()};return h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:h.jsx(hh,{className:"h-6 w-6 text-primary"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),h.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",zn]})]}),h.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((T,R)=>h.jsxs("div",{className:"relative aspect-square group",children:[h.jsx("img",{src:T,alt:`Product image ${R+1}`,className:"w-full h-full object-cover rounded-lg border"}),h.jsx("button",{onClick:()=>m(R),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:h.jsx(es,{className:"w-4 h-4"})})]},R)),n&&h.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:h.jsx(zs,{className:"w-8 h-8 text-primary"})}),t.length<zn&&!n&&h.jsxs("button",{onClick:()=>a(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${zn-t.length} imatges ms`,children:[h.jsx(hh,{className:"mx-auto h-8 w-8 text-gray-400"}),h.jsx("p",{className:"mt-1 text-xs text-gray-600",children:h.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),h.jsx("input",{ref:l,type:"file",onChange:p,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=zn}),h.jsx("input",{ref:u,type:"file",onChange:p,className:"hidden",accept:"image/*",capture:"environment",disabled:t.length>=zn}),s&&h.jsx("p",{className:"text-red-500 text-sm mt-4",children:s}),o&&h.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>a(!1),"aria-modal":"true",role:"dialog",children:[h.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),h.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:T=>T.stopPropagation(),children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),h.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:h.jsx(es,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("button",{onClick:_,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=zn,children:[h.jsx($p,{className:"w-6 h-6 text-primary"}),h.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),h.jsxs("button",{onClick:g,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=zn,children:[h.jsx(VT,{className:"w-6 h-6 text-primary"}),h.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]})]})},FN=({title:t,setTitle:e,description:n,setDescription:r})=>h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:h.jsx(NN,{className:"h-6 w-6 text-primary"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),h.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),h.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),ON=({images:t,title:e,description:n,price:r,onPublish:s,isEditing:i})=>{const o=t.length>0&&e&&r;return h.jsx("div",{className:"sticky top-28",children:h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),h.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?h.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):h.jsx(VT,{className:"w-16 h-16 text-gray-300"})}),h.jsxs("div",{className:"space-y-3",children:[h.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),h.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),h.jsx("div",{className:"border-t pt-3",children:h.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),h.jsx("button",{onClick:s,disabled:!o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:i?"Desa els canvis":"Publica l'anunci"})]})]})})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let qN,BN;function jN(){return{geminiUrl:qN,vertexUrl:BN}}function GN(t,e,n,r){var s,i;if(!(t!=null&&t.baseUrl)){const o=jN();return e?(s=o.vertexUrl)!==null&&s!==void 0?s:n:(i=o.geminiUrl)!==null&&i!==void 0?i:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gr{}function X(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function f(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const p=l[u];f(p,e.slice(i+1),n[u])}else for(const u of l)f(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];f(l[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const s=e[r];if(s.endsWith("[]")){const i=s.slice(0,-2);if(i in t){const o=t[i];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[s]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function HN(t,e){for(const[n,r]of Object.entries(e)){const s=n.split("."),i=r.split("."),o=new Set;let a=-1;for(let l=0;l<s.length;l++)if(s[l]==="*"){a=l;break}if(a!==-1&&i.length>a)for(let l=a;l<i.length;l++){const u=i[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}ph(t,s,i,0,o)}}function ph(t,e,n,r,s){if(r>=e.length||typeof t!="object"||t===null)return;const i=e[r];if(i.endsWith("[]")){const o=i.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])ph(l,e,n,r+1,s)}else if(i==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!s.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,p]of Object.entries(l)){const m=[];for(const g of n.slice(r))g==="*"?m.push(u):m.push(g);f(o,m,p)}for(const u of a)delete o[u]}}else{const o=t;i in o&&ph(o[i],e,n,r+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zp(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $N(t){const e={},n=c(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function zN(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],KN(o)),e}function WN(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response"]);return o!=null&&f(e,["response"],JN(o)),e}function KN(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>YN(o))),f(e,["generatedVideos"],i)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=c(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function JN(t){const e={},n=c(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>QN(o))),f(e,["generatedVideos"],i)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=c(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function YN(t){const e={},n=c(t,["video"]);return n!=null&&f(e,["video"],rR(n)),e}function QN(t){const e={},n=c(t,["_self"]);return n!=null&&f(e,["video"],sR(n)),e}function XN(t){const e={},n=c(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function ZN(t){const e={},n=c(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function eR(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response"]);return o!=null&&f(e,["response"],tR(o)),e}function tR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&f(e,["parent"],r);const s=c(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function OT(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response"]);return o!=null&&f(e,["response"],nR(o)),e}function nR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&f(e,["parent"],r);const s=c(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function rR(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],zp(r));const s=c(t,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function sR(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],zp(r));const s=c(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var l0;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(l0||(l0={}));var u0;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(u0||(u0={}));var c0;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(c0||(c0={}));var Or;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Or||(Or={}));var d0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(d0||(d0={}));var f0;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(f0||(f0={}));var h0;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(h0||(h0={}));var p0;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(p0||(p0={}));var m0;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(m0||(m0={}));var g0;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(g0||(g0={}));var y0;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(y0||(y0={}));var v0;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(v0||(v0={}));var _0;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(_0||(_0={}));var w0;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(w0||(w0={}));var E0;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(E0||(E0={}));var T0;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(T0||(T0={}));var x0;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(x0||(x0={}));var I0;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(I0||(I0={}));var Gu;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Gu||(Gu={}));var S0;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(S0||(S0={}));var C0;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(C0||(C0={}));var A0;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(A0||(A0={}));var mh;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(mh||(mh={}));var N0;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(N0||(N0={}));var R0;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(R0||(R0={}));var P0;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(P0||(P0={}));var k0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(k0||(k0={}));var b0;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(b0||(b0={}));var M0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(M0||(M0={}));var D0;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(D0||(D0={}));var L0;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(L0||(L0={}));var V0;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(V0||(V0={}));var U0;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(U0||(U0={}));var F0;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(F0||(F0={}));var O0;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(O0||(O0={}));var q0;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(q0||(q0={}));var B0;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(B0||(B0={}));var j0;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(j0||(j0={}));var G0;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(G0||(G0={}));var H0;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(H0||(H0={}));var $0;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})($0||($0={}));var z0;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(z0||(z0={}));var W0;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(W0||(W0={}));var K0;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(K0||(K0={}));var J0;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(J0||(J0={}));var Y0;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Y0||(Y0={}));var Q0;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Q0||(Q0={}));var X0;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(X0||(X0={}));var Z0;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Z0||(Z0={}));var ev;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ev||(ev={}));var tv;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(tv||(tv={}));var nv;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(nv||(nv={}));var Ri;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Ri||(Ri={}));class gh{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Jo{get text(){var e,n,r,s,i,o,a,l;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",p=!1;const m=[];for(const g of(l=(a=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[_,T]of Object.entries(g))_!=="text"&&_!=="thought"&&_!=="thoughtSignature"&&(T!==null||T!==void 0)&&m.push(_);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;p=!0,u+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?u:void 0}get data(){var e,n,r,s,i,o,a,l;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const p=[];for(const m of(l=(a=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,_]of Object.entries(m))g!=="inlineData"&&(_!==null||_!==void 0)&&p.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(u+=atob(m.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,a,l;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,a,l,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(l=(a=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,a,l,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(l=(a=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.output}}class rv{}class sv{}class iR{}class oR{}class aR{}class lR{}class iv{}class ov{}class av{}class uR{}class Hu{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Hu;let s;const i=e;return n?s=WN(i):s=zN(i),Object.assign(r,s),r}}class lv{}class uv{}class cv{}class cR{}class dR{}class fR{}class Wp{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Wp,i=eR(e);return Object.assign(r,i),r}}class hR{}class pR{}class mR{}class dv{}class gR{get text(){var e,n,r;let s="",i=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;i=!0,s+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&i.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class yR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Kp{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Kp,i=OT(e);return Object.assign(r,i),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function we(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function qT(t,e){const n=we(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function BT(t){return Array.isArray(t)?t.map(e=>$u(e)):[$u(t)]}function $u(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function jT(t){const e=$u(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function GT(t){const e=$u(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fv(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function HT(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>fv(e)):[fv(t)]}function yh(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function hv(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function pv(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Tt(t){if(t==null)throw new Error("ContentUnion is required");return yh(t)?t:{role:"user",parts:HT(t)}}function Jp(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Tt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Tt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Tt(n)):[Tt(e)]}function an(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(hv(t)||pv(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Tt(t)]}const e=[],n=[],r=yh(t[0]);for(const s of t){const i=yh(s);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(s);else{if(hv(s)||pv(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return r||e.push({role:"user",parts:HT(n)}),e}function vR(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Or).includes(n[0].toUpperCase())?n[0].toUpperCase():Or.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Or).includes(r.toUpperCase())?r.toUpperCase():Or.TYPE_UNSPECIFIED})}}function Ui(t){const e={},n=["items"],r=["anyOf"],s=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&vR(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Or).includes(a.toUpperCase())?a.toUpperCase():Or.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=Ui(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(Ui(u))}e[o]=l}else if(s.includes(o)){const l={};for(const[u,p]of Object.entries(a))l[u]=Ui(p);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function Yp(t){return Ui(t)}function Qp(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Xp(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function uo(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ui(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ui(e.response));return t}function co(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function _R(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function yr(t,e){if(typeof e!="string")throw new Error("name must be a string");return _R(t,e,"cachedContents")}function $T(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function fs(t){return zp(t)}function wR(t){return t!=null&&typeof t=="object"&&"name"in t}function ER(t){return t!=null&&typeof t=="object"&&"video"in t}function TR(t){return t!=null&&typeof t=="object"&&"uri"in t}function zT(t){var e;let n;if(wR(t)&&(n=t.name),!(TR(t)&&(n=t.uri,n===void 0))&&!(ER(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function WT(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function KT(t){for(const e of["models","tunedModels","publisherModels"])if(xR(t,e))return t[e];return[]}function xR(t,e){return t!==null&&typeof t=="object"&&e in t}function IR(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function SR(t,e={}){const n=[],r=new Set;for(const s of t){const i=s.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const o=IR(s,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function JT(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,s=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(s>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function CR(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function YT(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const s=n.inlinedResponses;if(!Array.isArray(s)||s.length===0)return t;let i=!1;for(const o of s){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function fo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function QT(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AR(t){const e={},n=c(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>sP(o))),f(e,["inlinedResponses"],i)}const s=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["inlinedEmbedContentResponses"],i)}return e}function NR(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const s=c(t,["bigqueryDestination","outputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function RR(t){const e={},n=c(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const s=c(t,["bigqueryUri"]);if(s!=null&&f(e,["bigqueryDestination","outputUri"],s),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ou(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const s=c(t,["metadata","state"]);s!=null&&f(e,["state"],QT(s));const i=c(t,["metadata","createTime"]);i!=null&&f(e,["createTime"],i);const o=c(t,["metadata","endTime"]);o!=null&&f(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&f(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&f(e,["dest"],AR(YT(u))),e}function vh(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=c(t,["state"]);s!=null&&f(e,["state"],QT(s));const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["createTime"]);o!=null&&f(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&f(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&f(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&f(e,["updateTime"],u);const p=c(t,["model"]);p!=null&&f(e,["model"],p);const m=c(t,["inputConfig"]);m!=null&&f(e,["src"],PR(m));const g=c(t,["outputConfig"]);g!=null&&f(e,["dest"],NR(YT(g)));const _=c(t,["completionStats"]);return _!=null&&f(e,["completionStats"],_),e}function PR(t){const e={},n=c(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const s=c(t,["bigquerySource","inputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function kR(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&f(n,["fileName"],r);const s=c(e,["inlinedRequests"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>rP(t,o))),f(n,["requests","requests"],i)}return n}function bR(t){const e={},n=c(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const s=c(t,["bigqueryUri"]);if(s!=null&&f(e,["bigquerySource","inputUri"],s),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function MR(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function DR(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],fo(t,r)),n}function LR(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],fo(t,r)),n}function VR(t){const e={},n=c(t,["content"]);n!=null&&f(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],UR(r));const s=c(t,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const i=c(t,["finishReason"]);i!=null&&f(e,["finishReason"],i);const o=c(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=c(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&f(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const p=c(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(_=>_)),f(e,["safetyRatings"],g)}const m=c(t,["urlContextMetadata"]);return m!=null&&f(e,["urlContextMetadata"],m),e}function UR(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["citations"],r)}return e}function XT(t){const e={},n=c(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>dP(i))),f(e,["parts"],s)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function FR(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function OR(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=c(t,["dest"]);return e!==void 0&&s!=null&&f(e,["outputConfig"],RR(CR(s))),n}function mv(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["src"]);s!=null&&f(n,["batch","inputConfig"],kR(t,JT(t,s)));const i=c(e,["config"]);return i!=null&&FR(i,n),n}function qR(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["model"],we(t,r));const s=c(e,["src"]);s!=null&&f(n,["inputConfig"],bR(JT(t,s)));const i=c(e,["config"]);return i!=null&&OR(i,n),n}function BR(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function jR(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["src"]);s!=null&&f(n,["batch","inputConfig"],JR(t,s));const i=c(e,["config"]);return i!=null&&BR(i,n),n}function GR(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],fo(t,r)),n}function HR(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],fo(t,r)),n}function $R(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);return i!=null&&f(e,["error"],i),e}function zR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);return i!=null&&f(e,["error"],i),e}function WR(t,e){const n={},r=c(e,["contents"]);if(r!=null){let i=Jp(t,r);Array.isArray(i)&&(i=i.map(o=>o)),f(n,["requests[]","request","content"],i)}const s=c(e,["config"]);return s!=null&&(f(n,["_self"],KR(s,n)),HN(n,{"requests[].*":"requests[].request.*"})),n}function KR(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const s=c(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const i=c(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&f(e,["requests[]","outputDimensionality"],i),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function JR(t,e){const n={},r=c(e,["fileName"]);r!=null&&f(n,["file_name"],r);const s=c(e,["inlinedRequests"]);return s!=null&&f(n,["requests"],WR(t,s)),n}function YR(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function QR(t,e,n){const r={},s=c(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],XT(Tt(s)));const i=c(e,["temperature"]);i!=null&&f(r,["temperature"],i);const o=c(e,["topP"]);o!=null&&f(r,["topP"],o);const a=c(e,["topK"]);a!=null&&f(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const p=c(e,["stopSequences"]);p!=null&&f(r,["stopSequences"],p);const m=c(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const _=c(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const T=c(e,["frequencyPenalty"]);T!=null&&f(r,["frequencyPenalty"],T);const R=c(e,["seed"]);R!=null&&f(r,["seed"],R);const x=c(e,["responseMimeType"]);x!=null&&f(r,["responseMimeType"],x);const C=c(e,["responseSchema"]);C!=null&&f(r,["responseSchema"],Yp(C));const I=c(e,["responseJsonSchema"]);if(I!=null&&f(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=c(e,["safetySettings"]);if(n!==void 0&&A!=null){let M=A;Array.isArray(M)&&(M=M.map(P=>fP(P))),f(n,["safetySettings"],M)}const D=c(e,["tools"]);if(n!==void 0&&D!=null){let M=co(D);Array.isArray(M)&&(M=M.map(P=>hP(uo(P)))),f(n,["tools"],M)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&f(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=c(e,["cachedContent"]);n!==void 0&&F!=null&&f(n,["cachedContent"],yr(t,F));const w=c(e,["responseModalities"]);w!=null&&f(r,["responseModalities"],w);const E=c(e,["mediaResolution"]);E!=null&&f(r,["mediaResolution"],E);const N=c(e,["speechConfig"]);if(N!=null&&f(r,["speechConfig"],Qp(N)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const b=c(e,["thinkingConfig"]);b!=null&&f(r,["thinkingConfig"],b);const k=c(e,["imageConfig"]);return k!=null&&f(r,["imageConfig"],k),r}function XR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>VR(u))),f(e,["candidates"],l)}const s=c(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const i=c(t,["promptFeedback"]);i!=null&&f(e,["promptFeedback"],i);const o=c(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function ZR(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],fo(t,r)),n}function eP(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],fo(t,r)),n}function tP(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function nP(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function rP(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["request","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let a=an(s);Array.isArray(a)&&(a=a.map(l=>XT(l))),f(n,["request","contents"],a)}const i=c(e,["metadata"]);i!=null&&f(n,["metadata"],i);const o=c(e,["config"]);return o!=null&&f(n,["request","generationConfig"],QR(t,o,c(n,["request"],{}))),n}function sP(t){const e={},n=c(t,["response"]);n!=null&&f(e,["response"],XR(n));const r=c(t,["error"]);return r!=null&&f(e,["error"],r),e}function iP(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);if(e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function oP(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const i=c(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),n}function aP(t){const e={},n=c(t,["config"]);return n!=null&&iP(n,e),e}function lP(t){const e={},n=c(t,["config"]);return n!=null&&oP(n,e),e}function uP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["operations"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>ou(o))),f(e,["batchJobs"],i)}return e}function cP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["batchPredictionJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>vh(o))),f(e,["batchJobs"],i)}return e}function dP(t){const e={},n=c(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=c(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const i=c(t,["fileData"]);i!=null&&f(e,["fileData"],YR(i));const o=c(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&f(e,["inlineData"],MR(a));const l=c(t,["text"]);l!=null&&f(e,["text"],l);const u=c(t,["thought"]);u!=null&&f(e,["thought"],u);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function fP(t){const e={},n=c(t,["category"]);if(n!=null&&f(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function hP(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["functionDeclarations"],p)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const s=c(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const i=c(t,["fileSearch"]);i!=null&&f(e,["fileSearch"],i);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],tP(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],nP(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ur;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(ur||(ur={}));class ni{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pP extends gr{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new ni(ur.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=mv(this.apiClient,e),r=n._url,s=X("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const p of l){const m=Object.assign({},p);if(m.systemInstruction){const g=m.systemInstruction;delete m.systemInstruction;const _=m.request;_.systemInstruction=g,m.request=_}u.push(m)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:s,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},s=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${s}`),r.dest===void 0){const i=this.getGcsUri(e),o=this.getBigqueryUri(e);if(i)i.endsWith(".jsonl")?r.dest=`${i.slice(0,-6)}/dest`:r.dest=`${i}_dest_${s}`;else if(o)r.dest=`${o}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=qR(this.apiClient,e);return a=X("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>vh(p))}else{const u=mv(this.apiClient,e);return a=X("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>ou(p))}}async createEmbeddingsInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=jR(this.apiClient,e);return i=X("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>ou(l))}}async get(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=eP(this.apiClient,e);return a=X("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>vh(p))}else{const u=ZR(this.apiClient,e);return a=X("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>ou(p))}}async cancel(e){var n,r,s,i;let o="",a={};if(this.apiClient.isVertexAI()){const l=LR(this.apiClient,e);o=X("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=DR(this.apiClient,e);o=X("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=lP(e);return a=X("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=cP(p),g=new dv;return Object.assign(g,m),g})}else{const u=aP(e);return a=X("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=uP(p),g=new dv;return Object.assign(g,m),g})}}async delete(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HR(this.apiClient,e);return a=X("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>zR(p))}else{const u=GR(this.apiClient,e);return a=X("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>$R(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mP(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function gv(t){const e={},n=c(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>VP(i))),f(e,["parts"],s)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function gP(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=c(t,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const i=c(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let p=an(o);Array.isArray(p)&&(p=p.map(m=>gv(m))),f(e,["contents"],p)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],gv(Tt(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>UP(m))),f(e,["tools"],p)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],u),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function yP(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=c(t,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const i=c(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let m=an(o);Array.isArray(m)&&(m=m.map(g=>g)),f(e,["contents"],m)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],Tt(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>FP(g))),f(e,["tools"],m)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const p=c(t,["kmsKeyName"]);return e!==void 0&&p!=null&&f(e,["encryption_spec","kmsKeyName"],p),n}function vP(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["model"],qT(t,r));const s=c(e,["config"]);return s!=null&&gP(s,n),n}function _P(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["model"],qT(t,r));const s=c(e,["config"]);return s!=null&&yP(s,n),n}function wP(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],yr(t,r)),n}function EP(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],yr(t,r)),n}function TP(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function xP(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function IP(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function SP(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const s=c(t,["parameters"]);s!=null&&f(e,["parameters"],s);const i=c(t,["parametersJsonSchema"]);i!=null&&f(e,["parametersJsonSchema"],i);const o=c(t,["response"]);o!=null&&f(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function CP(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],yr(t,r)),n}function AP(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],yr(t,r)),n}function NP(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function RP(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function PP(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function kP(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function bP(t){const e={},n=c(t,["config"]);return n!=null&&PP(n,e),e}function MP(t){const e={},n=c(t,["config"]);return n!=null&&kP(n,e),e}function DP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["cachedContents"],i)}return e}function LP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["cachedContents"],i)}return e}function VP(t){const e={},n=c(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=c(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const i=c(t,["fileData"]);i!=null&&f(e,["fileData"],IP(i));const o=c(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&f(e,["inlineData"],mP(a));const l=c(t,["text"]);l!=null&&f(e,["text"],l);const u=c(t,["thought"]);u!=null&&f(e,["thought"],u);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function UP(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["functionDeclarations"],p)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const s=c(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const i=c(t,["fileSearch"]);i!=null&&f(e,["fileSearch"],i);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],NP(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],RP(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function FP(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>SP(g))),f(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const s=c(t,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const i=c(t,["computerUse"]);if(i!=null&&f(e,["computerUse"],i),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=c(t,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=c(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=c(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function OP(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=c(t,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),n}function qP(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=c(t,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),n}function BP(t,e){const n={},r=c(e,["name"]);r!=null&&f(n,["_url","name"],yr(t,r));const s=c(e,["config"]);return s!=null&&OP(s,n),n}function jP(t,e){const n={},r=c(e,["name"]);r!=null&&f(n,["_url","name"],yr(t,r));const s=c(e,["config"]);return s!=null&&qP(s,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GP extends gr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ni(ur.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_P(this.apiClient,e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const u=vP(this.apiClient,e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async get(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=AP(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const u=CP(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async delete(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=EP(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=xP(p),g=new uv;return Object.assign(g,m),g})}else{const u=wP(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=TP(p),g=new uv;return Object.assign(g,m),g})}}async update(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=jP(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>p)}else{const u=BP(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async listInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=MP(e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=LP(p),g=new cv;return Object.assign(g,m),g})}else{const u=bP(e);return a=X("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=DP(p),g=new cv;return Object.assign(g,m),g})}}}function yv(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pe(t){return this instanceof Pe?(this.v=t,this):new Pe(t)}function Fi(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(_){return function(T){return Promise.resolve(T).then(_,m)}}function a(_,T){r[_]&&(s[_]=function(R){return new Promise(function(x,C){i.push([_,R,x,C])>1||l(_,R)})},T&&(s[_]=T(s[_])))}function l(_,T){try{u(r[_](T))}catch(R){g(i[0][3],R)}}function u(_){_.value instanceof Pe?Promise.resolve(_.value.v).then(p,m):g(i[0][2],_)}function p(_){l("next",_)}function m(_){l("throw",_)}function g(_,T){_(T),i.shift(),i.length&&l(i[0][0],i[0][1])}}function ma(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof yv=="function"?yv(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,l){o=t[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(u){i({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HP(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:ZT(n)}function ZT(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function $P(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function vv(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const s=[];let i=!0;for(;r<n&&t[r].role==="model";)s.push(t[r]),i&&!ZT(t[r])&&(i=!1),r++;i?e.push(...s):e.pop()}return e}class zP{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new WP(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class WP{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),$P(i)}async sendMessage(e){var n;await this.sendPromise;const r=Tt(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o,a;const l=await s,u=(o=(i=l.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,p=l.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let g=[];p!=null&&(g=(a=p.slice(m))!==null&&a!==void 0?a:[]);const _=u?[u]:[];this.recordHistory(r,_,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var n;await this.sendPromise;const r=Tt(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?vv(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,s;return Fi(this,arguments,function*(){var o,a,l,u;const p=[];try{for(var m=!0,g=ma(e),_;_=yield Pe(g.next()),o=_.done,!o;m=!0){u=_.value,m=!1;const T=u;if(HP(T)){const R=(s=(r=T.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;R!==void 0&&p.push(R)}yield yield Pe(T)}}catch(T){a={error:T}}finally{try{!m&&!o&&(l=g.return)&&(yield Pe(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(n,p)})}recordHistory(e,n,r){let s=[];n.length>0&&n.every(i=>i.role!==void 0)?s=n:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...vv(r)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Mc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Mc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KP(t){const e={},n=c(t,["file"]);return n!=null&&f(e,["file"],n),e}function JP(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function YP(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","file"],zT(n)),e}function QP(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function XP(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","file"],zT(n)),e}function ZP(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function e2(t){const e={},n=c(t,["config"]);return n!=null&&ZP(n,e),e}function t2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["files"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n2 extends gr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new ni(ur.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=e2(e);return i=X("files",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>{const u=t2(l),p=new hR;return Object.assign(p,u),p})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=KP(e);return i=X("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=JP(l),p=new pR;return Object.assign(p,u),p})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=XP(e);return i=X("files/{file}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=YP(e);return i=X("files/{file}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>{const u=QP(l),p=new mR;return Object.assign(p,u),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function au(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function r2(t){const e={},n=c(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>v2(i))),f(e,["parts"],s)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function s2(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function i2(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const s=c(t,["parameters"]);s!=null&&f(e,["parameters"],s);const i=c(t,["parametersJsonSchema"]);i!=null&&f(e,["parametersJsonSchema"],i);const o=c(t,["response"]);o!=null&&f(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function o2(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=c(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const s=c(t,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const i=c(t,["candidateCount"]);i!=null&&f(e,["candidateCount"],i);const o=c(t,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=c(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=c(t,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const p=c(t,["mediaResolution"]);p!=null&&f(e,["mediaResolution"],p);const m=c(t,["presencePenalty"]);m!=null&&f(e,["presencePenalty"],m);const g=c(t,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const _=c(t,["responseMimeType"]);_!=null&&f(e,["responseMimeType"],_);const T=c(t,["responseModalities"]);T!=null&&f(e,["responseModalities"],T);const R=c(t,["responseSchema"]);R!=null&&f(e,["responseSchema"],R);const x=c(t,["routingConfig"]);x!=null&&f(e,["routingConfig"],x);const C=c(t,["seed"]);C!=null&&f(e,["seed"],C);const I=c(t,["speechConfig"]);I!=null&&f(e,["speechConfig"],ex(I));const A=c(t,["stopSequences"]);A!=null&&f(e,["stopSequences"],A);const D=c(t,["temperature"]);D!=null&&f(e,["temperature"],D);const U=c(t,["thinkingConfig"]);U!=null&&f(e,["thinkingConfig"],U);const F=c(t,["topK"]);F!=null&&f(e,["topK"],F);const w=c(t,["topP"]);if(w!=null&&f(e,["topP"],w),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function a2(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function l2(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function u2(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const s=c(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const i=c(t,["temperature"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","temperature"],i);const o=c(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const p=c(t,["seed"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","seed"],p);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","speechConfig"],Xp(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const _=c(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&f(e,["setup","systemInstruction"],r2(Tt(T)));const R=c(t,["tools"]);if(e!==void 0&&R!=null){let F=co(R);Array.isArray(F)&&(F=F.map(w=>w2(uo(w)))),f(e,["setup","tools"],F)}const x=c(t,["sessionResumption"]);e!==void 0&&x!=null&&f(e,["setup","sessionResumption"],_2(x));const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&f(e,["setup","inputAudioTranscription"],C);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&f(e,["setup","outputAudioTranscription"],I);const A=c(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&f(e,["setup","realtimeInputConfig"],A);const D=c(t,["contextWindowCompression"]);e!==void 0&&D!=null&&f(e,["setup","contextWindowCompression"],D);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&f(e,["setup","proactivity"],U),n}function c2(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],o2(r));const s=c(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const i=c(t,["temperature"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","temperature"],i);const o=c(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const p=c(t,["seed"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","seed"],p);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","speechConfig"],ex(Xp(m)));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const _=c(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&f(e,["setup","systemInstruction"],Tt(T));const R=c(t,["tools"]);if(e!==void 0&&R!=null){let F=co(R);Array.isArray(F)&&(F=F.map(w=>E2(uo(w)))),f(e,["setup","tools"],F)}const x=c(t,["sessionResumption"]);e!==void 0&&x!=null&&f(e,["setup","sessionResumption"],x);const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&f(e,["setup","inputAudioTranscription"],C);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&f(e,["setup","outputAudioTranscription"],I);const A=c(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&f(e,["setup","realtimeInputConfig"],A);const D=c(t,["contextWindowCompression"]);e!==void 0&&D!=null&&f(e,["setup","contextWindowCompression"],D);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&f(e,["setup","proactivity"],U),n}function d2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["setup","model"],we(t,r));const s=c(e,["config"]);return s!=null&&f(n,["config"],u2(s,n)),n}function f2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["setup","model"],we(t,r));const s=c(e,["config"]);return s!=null&&f(n,["config"],c2(s,n)),n}function h2(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function p2(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["weightedPrompts"],r)}return e}function m2(t){const e={},n=c(t,["media"]);if(n!=null){let u=BT(n);Array.isArray(u)&&(u=u.map(p=>au(p))),f(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&f(e,["audio"],au(GT(r)));const s=c(t,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const i=c(t,["video"]);i!=null&&f(e,["video"],au(jT(i)));const o=c(t,["text"]);o!=null&&f(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function g2(t){const e={},n=c(t,["media"]);if(n!=null){let u=BT(n);Array.isArray(u)&&(u=u.map(p=>p)),f(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&f(e,["audio"],GT(r));const s=c(t,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const i=c(t,["video"]);i!=null&&f(e,["video"],jT(i));const o=c(t,["text"]);o!=null&&f(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function y2(t){const e={},n=c(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const s=c(t,["toolCall"]);s!=null&&f(e,["toolCall"],s);const i=c(t,["toolCallCancellation"]);i!=null&&f(e,["toolCallCancellation"],i);const o=c(t,["usageMetadata"]);o!=null&&f(e,["usageMetadata"],T2(o));const a=c(t,["goAway"]);a!=null&&f(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);return l!=null&&f(e,["sessionResumptionUpdate"],l),e}function v2(t){const e={},n=c(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=c(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const i=c(t,["fileData"]);i!=null&&f(e,["fileData"],s2(i));const o=c(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&f(e,["inlineData"],au(a));const l=c(t,["text"]);l!=null&&f(e,["text"],l);const u=c(t,["thought"]);u!=null&&f(e,["thought"],u);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function _2(t){const e={},n=c(t,["handle"]);if(n!=null&&f(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ex(t){const e={},n=c(t,["languageCode"]);n!=null&&f(e,["languageCode"],n);const r=c(t,["voiceConfig"]);if(r!=null&&f(e,["voiceConfig"],r),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function w2(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["functionDeclarations"],p)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const s=c(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const i=c(t,["fileSearch"]);i!=null&&f(e,["fileSearch"],i);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a2(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],l2(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function E2(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>i2(g))),f(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const s=c(t,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const i=c(t,["computerUse"]);if(i!=null&&f(e,["computerUse"],i),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=c(t,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=c(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=c(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function T2(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const s=c(t,["candidatesTokenCount"]);s!=null&&f(e,["responseTokenCount"],s);const i=c(t,["toolUsePromptTokenCount"]);i!=null&&f(e,["toolUsePromptTokenCount"],i);const o=c(t,["thoughtsTokenCount"]);o!=null&&f(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let _=l;Array.isArray(_)&&(_=_.map(T=>T)),f(e,["promptTokensDetails"],_)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let _=u;Array.isArray(_)&&(_=_.map(T=>T)),f(e,["cacheTokensDetails"],_)}const p=c(t,["candidatesTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(T=>T)),f(e,["responseTokensDetails"],_)}const m=c(t,["toolUsePromptTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(T=>T)),f(e,["toolUsePromptTokensDetails"],_)}const g=c(t,["trafficType"]);return g!=null&&f(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x2(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function I2(t){const e={},n=c(t,["content"]);n!=null&&f(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],S2(r));const s=c(t,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const i=c(t,["finishReason"]);i!=null&&f(e,["finishReason"],i);const o=c(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=c(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&f(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const p=c(t,["safetyRatings"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(_=>_)),f(e,["safetyRatings"],g)}const m=c(t,["urlContextMetadata"]);return m!=null&&f(e,["urlContextMetadata"],m),e}function S2(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["citations"],r)}return e}function C2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let i=an(s);Array.isArray(i)&&(i=i.map(o=>o)),f(n,["contents"],i)}return n}function A2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["tokensInfo"],s)}return e}function N2(t){const e={},n=c(t,["values"]);n!=null&&f(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&f(e,["statistics"],R2(r)),e}function R2(t){const e={},n=c(t,["truncated"]);n!=null&&f(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&f(e,["tokenCount"],r),e}function Dc(t){const e={},n=c(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>Dk(i))),f(e,["parts"],s)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function P2(t){const e={},n=c(t,["controlType"]);n!=null&&f(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&f(e,["computeControl"],r),e}function k2(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function b2(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&f(e,["systemInstruction"],Tt(r));const s=c(t,["tools"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>ix(a))),f(e,["tools"],o)}const i=c(t,["generationConfig"]);return e!==void 0&&i!=null&&f(e,["generationConfig"],Ek(i)),n}function M2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let o=an(s);Array.isArray(o)&&(o=o.map(a=>Dc(a))),f(n,["contents"],o)}const i=c(e,["config"]);return i!=null&&k2(i),n}function D2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let o=an(s);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const i=c(e,["config"]);return i!=null&&b2(i,n),n}function L2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&f(e,["totalTokens"],r);const s=c(t,["cachedContentTokenCount"]);return s!=null&&f(e,["cachedContentTokenCount"],s),e}function V2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&f(e,["totalTokens"],r),e}function U2(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function F2(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function O2(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function q2(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function B2(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=c(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const i=c(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const p=c(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const _=c(t,["language"]);e!==void 0&&_!=null&&f(e,["parameters","language"],_);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&f(e,["parameters","outputOptions","mimeType"],T);const R=c(t,["outputCompressionQuality"]);e!==void 0&&R!=null&&f(e,["parameters","outputOptions","compressionQuality"],R);const x=c(t,["addWatermark"]);e!==void 0&&x!=null&&f(e,["parameters","addWatermark"],x);const C=c(t,["labels"]);e!==void 0&&C!=null&&f(e,["labels"],C);const I=c(t,["editMode"]);e!==void 0&&I!=null&&f(e,["parameters","editMode"],I);const A=c(t,["baseSteps"]);return e!==void 0&&A!=null&&f(e,["parameters","editConfig","baseSteps"],A),n}function j2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const i=c(e,["referenceImages"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>qk(l))),f(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&B2(o,n),n}function G2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Lc(i))),f(e,["generatedImages"],s)}return e}function H2(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const s=c(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const i=c(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&f(e,["requests[]","outputDimensionality"],i),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function $2(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&f(e,["instances[]","task_type"],r);const s=c(t,["title"]);e!==void 0&&s!=null&&f(e,["instances[]","title"],s);const i=c(t,["outputDimensionality"]);e!==void 0&&i!=null&&f(e,["parameters","outputDimensionality"],i);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&f(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),n}function z2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let a=Jp(t,s);Array.isArray(a)&&(a=a.map(l=>l)),f(n,["requests[]","content"],a)}const i=c(e,["config"]);i!=null&&H2(i,n);const o=c(e,["model"]);return o!==void 0&&f(n,["requests[]","model"],we(t,o)),n}function W2(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let o=Jp(t,s);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["instances[]","content"],o)}const i=c(e,["config"]);return i!=null&&$2(i,n),n}function K2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["embeddings"],i)}const s=c(t,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function J2(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>N2(o))),f(e,["embeddings"],i)}const s=c(t,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function Y2(t){const e={},n=c(t,["endpoint"]);n!=null&&f(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&f(e,["deployedModelId"],r),e}function Q2(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function X2(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const s=c(t,["parameters"]);s!=null&&f(e,["parameters"],s);const i=c(t,["parametersJsonSchema"]);i!=null&&f(e,["parametersJsonSchema"],i);const o=c(t,["response"]);o!=null&&f(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function Z2(t,e,n){const r={},s=c(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],Dc(Tt(s)));const i=c(e,["temperature"]);i!=null&&f(r,["temperature"],i);const o=c(e,["topP"]);o!=null&&f(r,["topP"],o);const a=c(e,["topK"]);a!=null&&f(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const p=c(e,["stopSequences"]);p!=null&&f(r,["stopSequences"],p);const m=c(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const _=c(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const T=c(e,["frequencyPenalty"]);T!=null&&f(r,["frequencyPenalty"],T);const R=c(e,["seed"]);R!=null&&f(r,["seed"],R);const x=c(e,["responseMimeType"]);x!=null&&f(r,["responseMimeType"],x);const C=c(e,["responseSchema"]);C!=null&&f(r,["responseSchema"],Yp(C));const I=c(e,["responseJsonSchema"]);if(I!=null&&f(r,["responseJsonSchema"],I),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=c(e,["safetySettings"]);if(n!==void 0&&A!=null){let M=A;Array.isArray(M)&&(M=M.map(P=>Bk(P))),f(n,["safetySettings"],M)}const D=c(e,["tools"]);if(n!==void 0&&D!=null){let M=co(D);Array.isArray(M)&&(M=M.map(P=>Wk(uo(P)))),f(n,["tools"],M)}const U=c(e,["toolConfig"]);if(n!==void 0&&U!=null&&f(n,["toolConfig"],U),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=c(e,["cachedContent"]);n!==void 0&&F!=null&&f(n,["cachedContent"],yr(t,F));const w=c(e,["responseModalities"]);w!=null&&f(r,["responseModalities"],w);const E=c(e,["mediaResolution"]);E!=null&&f(r,["mediaResolution"],E);const N=c(e,["speechConfig"]);if(N!=null&&f(r,["speechConfig"],Qp(N)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const b=c(e,["thinkingConfig"]);b!=null&&f(r,["thinkingConfig"],b);const k=c(e,["imageConfig"]);return k!=null&&f(r,["imageConfig"],k),r}function ek(t,e,n){const r={},s=c(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],Tt(s));const i=c(e,["temperature"]);i!=null&&f(r,["temperature"],i);const o=c(e,["topP"]);o!=null&&f(r,["topP"],o);const a=c(e,["topK"]);a!=null&&f(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const p=c(e,["stopSequences"]);p!=null&&f(r,["stopSequences"],p);const m=c(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=c(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const _=c(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const T=c(e,["frequencyPenalty"]);T!=null&&f(r,["frequencyPenalty"],T);const R=c(e,["seed"]);R!=null&&f(r,["seed"],R);const x=c(e,["responseMimeType"]);x!=null&&f(r,["responseMimeType"],x);const C=c(e,["responseSchema"]);C!=null&&f(r,["responseSchema"],Yp(C));const I=c(e,["responseJsonSchema"]);I!=null&&f(r,["responseJsonSchema"],I);const A=c(e,["routingConfig"]);A!=null&&f(r,["routingConfig"],A);const D=c(e,["modelSelectionConfig"]);D!=null&&f(r,["modelConfig"],D);const U=c(e,["safetySettings"]);if(n!==void 0&&U!=null){let je=U;Array.isArray(je)&&(je=je.map(Bt=>Bt)),f(n,["safetySettings"],je)}const F=c(e,["tools"]);if(n!==void 0&&F!=null){let je=co(F);Array.isArray(je)&&(je=je.map(Bt=>ix(uo(Bt)))),f(n,["tools"],je)}const w=c(e,["toolConfig"]);n!==void 0&&w!=null&&f(n,["toolConfig"],w);const E=c(e,["labels"]);n!==void 0&&E!=null&&f(n,["labels"],E);const N=c(e,["cachedContent"]);n!==void 0&&N!=null&&f(n,["cachedContent"],yr(t,N));const b=c(e,["responseModalities"]);b!=null&&f(r,["responseModalities"],b);const k=c(e,["mediaResolution"]);k!=null&&f(r,["mediaResolution"],k);const M=c(e,["speechConfig"]);M!=null&&f(r,["speechConfig"],sx(Qp(M)));const P=c(e,["audioTimestamp"]);P!=null&&f(r,["audioTimestamp"],P);const fe=c(e,["thinkingConfig"]);fe!=null&&f(r,["thinkingConfig"],fe);const $e=c(e,["imageConfig"]);return $e!=null&&f(r,["imageConfig"],$e),r}function _v(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let o=an(s);Array.isArray(o)&&(o=o.map(a=>Dc(a))),f(n,["contents"],o)}const i=c(e,["config"]);return i!=null&&f(n,["generationConfig"],Z2(t,i,n)),n}function wv(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["contents"]);if(s!=null){let o=an(s);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const i=c(e,["config"]);return i!=null&&f(n,["generationConfig"],ek(t,i,n)),n}function Ev(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>I2(u))),f(e,["candidates"],l)}const s=c(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const i=c(t,["promptFeedback"]);i!=null&&f(e,["promptFeedback"],i);const o=c(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function Tv(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>p)),f(e,["candidates"],u)}const s=c(t,["createTime"]);s!=null&&f(e,["createTime"],s);const i=c(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const o=c(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&f(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function tk(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const i=c(t,["guidanceScale"]);if(e!==void 0&&i!=null&&f(e,["parameters","guidanceScale"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&f(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&f(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const p=c(t,["language"]);e!==void 0&&p!=null&&f(e,["parameters","language"],p);const m=c(t,["outputMimeType"]);e!==void 0&&m!=null&&f(e,["parameters","outputOptions","mimeType"],m);const g=c(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&f(e,["parameters","outputOptions","compressionQuality"],g),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const _=c(t,["imageSize"]);if(e!==void 0&&_!=null&&f(e,["parameters","sampleImageSize"],_),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function nk(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=c(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const i=c(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const p=c(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=c(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const g=c(t,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const _=c(t,["language"]);e!==void 0&&_!=null&&f(e,["parameters","language"],_);const T=c(t,["outputMimeType"]);e!==void 0&&T!=null&&f(e,["parameters","outputOptions","mimeType"],T);const R=c(t,["outputCompressionQuality"]);e!==void 0&&R!=null&&f(e,["parameters","outputOptions","compressionQuality"],R);const x=c(t,["addWatermark"]);e!==void 0&&x!=null&&f(e,["parameters","addWatermark"],x);const C=c(t,["labels"]);e!==void 0&&C!=null&&f(e,["labels"],C);const I=c(t,["imageSize"]);e!==void 0&&I!=null&&f(e,["parameters","sampleImageSize"],I);const A=c(t,["enhancePrompt"]);return e!==void 0&&A!=null&&f(e,["parameters","enhancePrompt"],A),n}function rk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const i=c(e,["config"]);return i!=null&&tk(i,n),n}function sk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const i=c(e,["config"]);return i!=null&&nk(i,n),n}function ik(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>yk(o))),f(e,["generatedImages"],i)}const s=c(t,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],nx(s)),e}function ok(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Lc(o))),f(e,["generatedImages"],i)}const s=c(t,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],rx(s)),e}function ak(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=c(t,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const o=c(t,["resolution"]);e!==void 0&&o!=null&&f(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&f(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const p=c(t,["lastFrame"]);e!==void 0&&p!=null&&f(e,["instances[0]","lastFrame"],Vc(p));const m=c(t,["referenceImages"]);if(e!==void 0&&m!=null){let g=m;Array.isArray(g)&&(g=g.map(_=>ob(_))),f(e,["instances[0]","referenceImages"],g)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function lk(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const i=c(t,["fps"]);e!==void 0&&i!=null&&f(e,["parameters","fps"],i);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&f(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&f(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const p=c(t,["personGeneration"]);e!==void 0&&p!=null&&f(e,["parameters","personGeneration"],p);const m=c(t,["pubsubTopic"]);e!==void 0&&m!=null&&f(e,["parameters","pubsubTopic"],m);const g=c(t,["negativePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","negativePrompt"],g);const _=c(t,["enhancePrompt"]);e!==void 0&&_!=null&&f(e,["parameters","enhancePrompt"],_);const T=c(t,["generateAudio"]);e!==void 0&&T!=null&&f(e,["parameters","generateAudio"],T);const R=c(t,["lastFrame"]);e!==void 0&&R!=null&&f(e,["instances[0]","lastFrame"],Sn(R));const x=c(t,["referenceImages"]);if(e!==void 0&&x!=null){let A=x;Array.isArray(A)&&(A=A.map(D=>ab(D))),f(e,["instances[0]","referenceImages"],A)}const C=c(t,["mask"]);e!==void 0&&C!=null&&f(e,["instances[0]","mask"],ib(C));const I=c(t,["compressionQuality"]);return e!==void 0&&I!=null&&f(e,["parameters","compressionQuality"],I),n}function uk(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],hk(o)),e}function ck(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response"]);return o!=null&&f(e,["response"],pk(o)),e}function dk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const i=c(e,["image"]);i!=null&&f(n,["instances[0]","image"],Vc(i));const o=c(e,["video"]);o!=null&&f(n,["instances[0]","video"],ox(o));const a=c(e,["source"]);a!=null&&mk(a,n);const l=c(e,["config"]);return l!=null&&ak(l,n),n}function fk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const i=c(e,["image"]);i!=null&&f(n,["instances[0]","image"],Sn(i));const o=c(e,["video"]);o!=null&&f(n,["instances[0]","video"],ax(o));const a=c(e,["source"]);a!=null&&gk(a,n);const l=c(e,["config"]);return l!=null&&lk(l,n),n}function hk(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>_k(o))),f(e,["generatedVideos"],i)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=c(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function pk(t){const e={},n=c(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>wk(o))),f(e,["generatedVideos"],i)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=c(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function mk(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=c(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Vc(s));const i=c(t,["video"]);return e!==void 0&&i!=null&&f(e,["instances[0]","video"],ox(i)),n}function gk(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=c(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Sn(s));const i=c(t,["video"]);return e!==void 0&&i!=null&&f(e,["instances[0]","video"],ax(i)),n}function yk(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["image"],Ck(n));const r=c(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const s=c(t,["_self"]);return s!=null&&f(e,["safetyAttributes"],nx(s)),e}function Lc(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["image"],tx(n));const r=c(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const s=c(t,["_self"]);s!=null&&f(e,["safetyAttributes"],rx(s));const i=c(t,["prompt"]);return i!=null&&f(e,["enhancedPrompt"],i),e}function vk(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["mask"],tx(n));const r=c(t,["labels"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>i)),f(e,["labels"],s)}return e}function _k(t){const e={},n=c(t,["video"]);return n!=null&&f(e,["video"],rb(n)),e}function wk(t){const e={},n=c(t,["_self"]);return n!=null&&f(e,["video"],sb(n)),e}function Ek(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=c(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const s=c(t,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const i=c(t,["candidateCount"]);i!=null&&f(e,["candidateCount"],i);const o=c(t,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=c(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=c(t,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const p=c(t,["mediaResolution"]);p!=null&&f(e,["mediaResolution"],p);const m=c(t,["presencePenalty"]);m!=null&&f(e,["presencePenalty"],m);const g=c(t,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const _=c(t,["responseMimeType"]);_!=null&&f(e,["responseMimeType"],_);const T=c(t,["responseModalities"]);T!=null&&f(e,["responseModalities"],T);const R=c(t,["responseSchema"]);R!=null&&f(e,["responseSchema"],R);const x=c(t,["routingConfig"]);x!=null&&f(e,["routingConfig"],x);const C=c(t,["seed"]);C!=null&&f(e,["seed"],C);const I=c(t,["speechConfig"]);I!=null&&f(e,["speechConfig"],sx(I));const A=c(t,["stopSequences"]);A!=null&&f(e,["stopSequences"],A);const D=c(t,["temperature"]);D!=null&&f(e,["temperature"],D);const U=c(t,["thinkingConfig"]);U!=null&&f(e,["thinkingConfig"],U);const F=c(t,["topK"]);F!=null&&f(e,["topK"],F);const w=c(t,["topP"]);if(w!=null&&f(e,["topP"],w),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Tk(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function xk(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],we(t,r)),n}function Ik(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function Sk(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function Ck(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],fs(n));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function tx(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&f(e,["imageBytes"],fs(r));const s=c(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function Vc(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],fs(n));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Sn(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&f(e,["bytesBase64Encoded"],fs(r));const s=c(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function Ak(t,e,n){const r={},s=c(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const i=c(e,["pageToken"]);n!==void 0&&i!=null&&f(n,["_query","pageToken"],i);const o=c(e,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],WT(t,a)),r}function Nk(t,e,n){const r={},s=c(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const i=c(e,["pageToken"]);n!==void 0&&i!=null&&f(n,["_query","pageToken"],i);const o=c(e,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],WT(t,a)),r}function Rk(t,e){const n={},r=c(e,["config"]);return r!=null&&Ak(t,r,n),n}function Pk(t,e){const n={},r=c(e,["config"]);return r!=null&&Nk(t,r,n),n}function kk(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["_self"]);if(s!=null){let i=KT(s);Array.isArray(i)&&(i=i.map(o=>_h(o))),f(e,["models"],i)}return e}function bk(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["_self"]);if(s!=null){let i=KT(s);Array.isArray(i)&&(i=i.map(o=>wh(o))),f(e,["models"],i)}return e}function Mk(t){const e={},n=c(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&f(e,["maskClasses"],r);const s=c(t,["maskDilation"]);return s!=null&&f(e,["dilation"],s),e}function _h(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=c(t,["description"]);s!=null&&f(e,["description"],s);const i=c(t,["version"]);i!=null&&f(e,["version"],i);const o=c(t,["_self"]);o!=null&&f(e,["tunedModelInfo"],Kk(o));const a=c(t,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&f(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);u!=null&&f(e,["supportedActions"],u);const p=c(t,["temperature"]);p!=null&&f(e,["temperature"],p);const m=c(t,["maxTemperature"]);m!=null&&f(e,["maxTemperature"],m);const g=c(t,["topP"]);g!=null&&f(e,["topP"],g);const _=c(t,["topK"]);_!=null&&f(e,["topK"],_);const T=c(t,["thinking"]);return T!=null&&f(e,["thinking"],T),e}function wh(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=c(t,["description"]);s!=null&&f(e,["description"],s);const i=c(t,["versionId"]);i!=null&&f(e,["version"],i);const o=c(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(g=>Y2(g))),f(e,["endpoints"],m)}const a=c(t,["labels"]);a!=null&&f(e,["labels"],a);const l=c(t,["_self"]);l!=null&&f(e,["tunedModelInfo"],Jk(l));const u=c(t,["defaultCheckpointId"]);u!=null&&f(e,["defaultCheckpointId"],u);const p=c(t,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["checkpoints"],m)}return e}function Dk(t){const e={},n=c(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=c(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const i=c(t,["fileData"]);i!=null&&f(e,["fileData"],Q2(i));const o=c(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&f(e,["inlineData"],x2(a));const l=c(t,["text"]);l!=null&&f(e,["text"],l);const u=c(t,["thought"]);u!=null&&f(e,["thought"],u);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function Lk(t){const e={},n=c(t,["productImage"]);return n!=null&&f(e,["image"],Sn(n)),e}function Vk(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=c(t,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const o=c(t,["seed"]);e!==void 0&&o!=null&&f(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const p=c(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=c(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m);const g=c(t,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const _=c(t,["labels"]);return e!==void 0&&_!=null&&f(e,["labels"],_),n}function Uk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["source"]);s!=null&&Ok(s,n);const i=c(e,["config"]);return i!=null&&Vk(i,n),n}function Fk(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>Lc(s))),f(e,["generatedImages"],r)}return e}function Ok(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=c(t,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],Sn(s));const i=c(t,["productImages"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Lk(a))),f(e,["instances[0]","productImages"],o)}return n}function qk(t){const e={},n=c(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],Sn(n));const r=c(t,["referenceId"]);r!=null&&f(e,["referenceId"],r);const s=c(t,["referenceType"]);s!=null&&f(e,["referenceType"],s);const i=c(t,["maskImageConfig"]);i!=null&&f(e,["maskImageConfig"],Mk(i));const o=c(t,["controlImageConfig"]);o!=null&&f(e,["controlImageConfig"],P2(o));const a=c(t,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&f(e,["subjectImageConfig"],l),e}function nx(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const s=c(t,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function rx(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const s=c(t,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function Bk(t){const e={},n=c(t,["category"]);if(n!=null&&f(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function jk(t){const e={},n=c(t,["image"]);return n!=null&&f(e,["image"],Sn(n)),e}function Gk(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&f(e,["parameters","mode"],r);const s=c(t,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const i=c(t,["confidenceThreshold"]);e!==void 0&&i!=null&&f(e,["parameters","confidenceThreshold"],i);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&f(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&f(e,["labels"],l),n}function Hk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["source"]);s!=null&&zk(s,n);const i=c(e,["config"]);return i!=null&&Gk(i,n),n}function $k(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>vk(s))),f(e,["generatedMasks"],r)}return e}function zk(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=c(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Sn(s));const i=c(t,["scribbleImage"]);return e!==void 0&&i!=null&&f(e,["instances[0]","scribble"],jk(i)),n}function sx(t){const e={},n=c(t,["languageCode"]);n!=null&&f(e,["languageCode"],n);const r=c(t,["voiceConfig"]);if(r!=null&&f(e,["voiceConfig"],r),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Wk(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["functionDeclarations"],p)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const s=c(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const i=c(t,["fileSearch"]);i!=null&&f(e,["fileSearch"],i);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],Ik(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],Sk(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function ix(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(g=>X2(g))),f(e,["functionDeclarations"],m)}const r=c(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const s=c(t,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const i=c(t,["computerUse"]);if(i!=null&&f(e,["computerUse"],i),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=c(t,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=c(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=c(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function Kk(t){const e={},n=c(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&f(e,["createTime"],r);const s=c(t,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function Jk(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&f(e,["createTime"],r);const s=c(t,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function Yk(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=c(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const i=c(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&f(e,["defaultCheckpointId"],i),n}function Qk(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=c(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const i=c(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&f(e,["defaultCheckpointId"],i),n}function Xk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","name"],we(t,r));const s=c(e,["config"]);return s!=null&&Yk(s,n),n}function Zk(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["config"]);return s!=null&&Qk(s,n),n}function eb(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=c(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const i=c(t,["personGeneration"]);e!==void 0&&i!=null&&f(e,["parameters","personGeneration"],i);const o=c(t,["includeRaiReason"]);e!==void 0&&o!=null&&f(e,["parameters","includeRaiReason"],o);const a=c(t,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const l=c(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","compressionQuality"],l);const u=c(t,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const p=c(t,["imagePreservationFactor"]);e!==void 0&&p!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const m=c(t,["labels"]);e!==void 0&&m!=null&&f(e,["labels"],m);const g=c(t,["numberOfImages"]);e!==void 0&&g!=null&&f(e,["parameters","sampleCount"],g);const _=c(t,["mode"]);return e!==void 0&&_!=null&&f(e,["parameters","mode"],_),n}function tb(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],we(t,r));const s=c(e,["image"]);s!=null&&f(n,["instances[0]","image"],Sn(s));const i=c(e,["upscaleFactor"]);i!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=c(e,["config"]);return o!=null&&eb(o,n),n}function nb(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Lc(i))),f(e,["generatedImages"],s)}return e}function rb(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],fs(r));const s=c(t,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function sb(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],fs(r));const s=c(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function ib(t){const e={},n=c(t,["image"]);n!=null&&f(e,["_self"],Sn(n));const r=c(t,["maskMode"]);return r!=null&&f(e,["maskMode"],r),e}function ob(t){const e={},n=c(t,["image"]);n!=null&&f(e,["image"],Vc(n));const r=c(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function ab(t){const e={},n=c(t,["image"]);n!=null&&f(e,["image"],Sn(n));const r=c(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function ox(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&f(e,["encodedVideo"],fs(r));const s=c(t,["mimeType"]);return s!=null&&f(e,["encoding"],s),e}function ax(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&f(e,["bytesBase64Encoded"],fs(r));const s=c(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lb="Content-Type",ub="X-Server-Timeout",cb="User-Agent",Eh="x-goog-api-client",db="1.29.1",fb=`google-genai-sdk/${db}`,hb="v1beta1",pb="v1beta",xv=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class mb{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:hb,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:pb,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))s.searchParams.append(o,String(a));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,s.toString(),e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,s.toString(),e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,s){if(n&&n.timeout||s){const i=new AbortController,o=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>i.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}s&&s.addEventListener("abort",()=>{i.abort()}),e.signal=o}return n&&n.extraBody!==null&&gb(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await Iv(s),new gh(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await Iv(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return Fi(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield Pe(s.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(l,{stream:!0});try{const m=JSON.parse(u);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),_=g.status,T=g.code,R=`got status: ${_}. ${JSON.stringify(m)}`;if(T>=400&&T<600)throw new Mc({message:R,status:T})}}catch(m){if(m.name==="ApiError")throw m}o+=u;let p=o.match(xv);for(;p;){const m=p[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Pe(new gh(g)),o=o.slice(p[0].length),p=o.match(xv)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=fb+" "+this.clientOptions.userAgentExtra;return e[cb]=n,e[Eh]=n,e[lb]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[s,i]of Object.entries(e.headers))r.append(s,i);e.timeout&&e.timeout>0&&r.append(ub,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=a;const l={file:s},u=this.getFileName(e),p=X("upload/v1beta/files",l._url),m=await this.fetchUploadUrl(p,s.sizeBytes,s.mimeType,u,l,n==null?void 0:n.httpOptions);return i.upload(e,m,this)}async uploadFileToFileSearchStore(e,n,r){var s;const i=this.clientOptions.uploader,o=await i.stat(n),a=String(o.size),l=(s=r==null?void 0:r.mimeType)!==null&&s!==void 0?s:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,p=this.getFileName(n),m={};r!=null&&r.customMetadata&&(m.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(m.chunkingConfig=r.chunkingConfig);const g=await this.fetchUploadUrl(u,a,l,p,m,r==null?void 0:r.httpOptions);return i.uploadToFileSearchStore(n,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,s,i,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},s?{"X-Goog-Upload-File-Name":s}:{})};const u=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(p===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p}}async function Iv(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const s=JSON.stringify(r);throw n>=400&&n<600?new Mc({message:s,status:n}):new Error(s)}}function gb(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,o){const a=Object.assign({},i);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],p=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&p&&typeof p=="object"&&!Array.isArray(p)?a[l]=r(p,u):(p&&u&&typeof p!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof p}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const s=r(n,e);t.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yb="mcp_used/unknown";let vb=!1;function lx(t){for(const e of t)if(_b(e)||typeof e=="object"&&"inputSchema"in e)return!0;return vb}function ux(t){var e;const n=(e=t[Eh])!==null&&e!==void 0?e:"";t[Eh]=(n+` ${yb}`).trimStart()}function _b(t){return t!==null&&typeof t=="object"&&t instanceof Zp}function wb(t,e=100){return Fi(this,arguments,function*(){let r,s=0;for(;s<e;){const i=yield Pe(t.listTools({cursor:r}));for(const o of i.tools)yield yield Pe(o),s++;if(!i.nextCursor)break;r=i.nextCursor}})}class Zp{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Zp(e,n)}async initialize(){var e,n,r,s;if(this.mcpTools.length>0)return;const i={},o=[];for(const p of this.mcpClients)try{for(var a=!0,l=(n=void 0,ma(wb(p))),u;u=await l.next(),e=u.done,!e;a=!0){s=u.value,a=!1;const m=s;o.push(m);const g=m.name;if(i[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);i[g]=p}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),SR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const o=await s.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Eb(t,e,n){const r=new yR;let s;n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),Object.assign(r,s),e(r)}class Tb{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),o=Sb(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${s}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const p=new Promise(A=>{u=A}),m=e.callbacks,g=function(){u({})},_=this.apiClient,T={onopen:g,onmessage:A=>{Eb(_,m.onmessage,A)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(A){}},R=this.webSocketFactory.create(l,Ib(o),T);R.connect(),await p;const I={setup:{model:we(this.apiClient,e.model)}};return R.send(JSON.stringify(I)),new xb(R,this.apiClient)}}class xb{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=p2(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=h2(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ri.PLAY)}pause(){this.sendPlaybackControl(Ri.PAUSE)}stop(){this.sendPlaybackControl(Ri.STOP)}resetContext(){this.sendPlaybackControl(Ri.RESET_CONTEXT)}close(){this.conn.close()}}function Ib(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Sb(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Cb="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Ab(t,e,n){const r=new gR;let s;n.data instanceof Blob?s=await n.data.text():n.data instanceof ArrayBuffer?s=new TextDecoder().decode(n.data):s=n.data;const i=JSON.parse(s);if(t.isVertexAI()){const o=y2(i);Object.assign(r,o)}else Object.assign(r,i);e(r)}class Nb{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new Tb(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,s,i,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let p;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&lx(e.config.tools)&&ux(m);const g=bb(m);if(this.apiClient.isVertexAI())p=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g,p);else{const N=this.apiClient.getApiKey();let b="BidiGenerateContent",k="key";N!=null&&N.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),b="BidiGenerateContentConstrained",k="access_token"),p=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${b}?${k}=${N}`}let _=()=>{};const T=new Promise(N=>{_=N}),R=e.callbacks,x=function(){var N;(N=R==null?void 0:R.onopen)===null||N===void 0||N.call(R),_({})},C=this.apiClient,I={onopen:x,onmessage:N=>{Ab(C,R.onmessage,N)},onerror:(n=R==null?void 0:R.onerror)!==null&&n!==void 0?n:function(N){},onclose:(r=R==null?void 0:R.onclose)!==null&&r!==void 0?r:function(N){}},A=this.webSocketFactory.create(p,kb(g),I);A.connect(),await T;let D=we(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const N=this.apiClient.getProject(),b=this.apiClient.getLocation();D=`projects/${N}/locations/${b}/`+D}let U={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Gu.AUDIO]}:e.config.responseModalities=[Gu.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],w=[];for(const N of F)if(this.isCallableTool(N)){const b=N;w.push(await b.tool())}else w.push(N);w.length>0&&(e.config.tools=w);const E={model:D,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?U=f2(this.apiClient,E):U=d2(this.apiClient,E),delete U.config,A.send(JSON.stringify(U)),new Pb(A,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Rb={turnComplete:!0};class Pb{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=an(n.turns),e.isVertexAI()||(r=r.map(s=>Dc(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(Cb)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},Rb),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:g2(e)}:n={realtimeInput:m2(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function kb(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function bb(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Sv=10;function Cv(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Oi(o)){s=!0;break}if(!s)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function Oi(t){return"callTool"in t&&typeof t.callTool=="function"}function Mb(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(s=>Oi(s)))!==null&&r!==void 0?r:!1}function Av(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,s)=>{if(Oi(r))return;const i=r;i.functionDeclarations&&i.functionDeclarations.length>0&&n.push(s)}),n}function Nv(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Db extends gr{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,s,i,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!Mb(n)||Cv(n.config))return await this.generateContentInternal(l);const u=Av(n);if(u.length>0){const R=u.map(x=>`tools[${x}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${R}.`)}let p,m;const g=an(l.contents),_=(i=(s=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&i!==void 0?i:Sv;let T=0;for(;T<_&&(p=await this.generateContentInternal(l),!(!p.functionCalls||p.functionCalls.length===0));){const R=p.candidates[0].content,x=[];for(const C of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(Oi(C)){const A=await C.callTool(p.functionCalls);x.push(...A)}T++,m={role:"user",parts:x},l.contents=an(l.contents),l.contents.push(R),l.contents.push(m),Nv(l.config)&&(g.push(R),g.push(m))}return Nv(l.config)&&(p.automaticFunctionCallingHistory=g),p},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),Cv(n.config)){const s=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(s)}const r=Av(n);if(r.length>0){const s=r.map(i=>`tools[${i}]`).join(", ");throw new Error(`Incompatible tools found at ${s}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((s=l==null?void 0:l.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=l==null?void 0:l.safetyAttributes:o.push(l);let a;return i?a={generatedImages:o,positivePromptSafetyAttributes:i,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new ni(ur.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)},this.generateVideos=async n=>{var r,s,i,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((s=n.video)===null||s===void 0)&&s.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(i=n.source)===null||i===void 0?void 0:i.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,s;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const o=await Promise.all(i.map(async l=>Oi(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&lx(e.config.tools)){const l=(s=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&s!==void 0?s:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),ux(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,s;const i=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Oi(o)){const a=o,l=await a.tool();for(const u of(s=l.functionDeclarations)!==null&&s!==void 0?s:[]){if(!u.name)throw new Error("Function declaration name is required.");if(i.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);i.set(u.name,a)}}return i}async processAfcStream(e){var n,r,s;const i=(s=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:Sv;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,p,m){var g,_;return Fi(this,arguments,function*(){for(var T,R,x,C;a<i;){o&&(a++,o=!1);const U=yield Pe(u.processParamsMaybeAddMcpUsage(m)),F=yield Pe(u.generateContentStreamInternal(U)),w=[],E=[];try{for(var I=!0,A=(R=void 0,ma(F)),D;D=yield Pe(A.next()),T=D.done,!T;I=!0){C=D.value,I=!1;const N=C;if(yield yield Pe(N),N.candidates&&(!((g=N.candidates[0])===null||g===void 0)&&g.content)){E.push(N.candidates[0].content);for(const b of(_=N.candidates[0].content.parts)!==null&&_!==void 0?_:[])if(a<i&&b.functionCall){if(!b.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(b.functionCall.name)){const k=yield Pe(p.get(b.functionCall.name).callTool([b.functionCall]));w.push(...k)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${b.functionCall.name}`)}}}}catch(N){R={error:N}}finally{try{!I&&!T&&(x=A.return)&&(yield Pe(x.call(A)))}finally{if(R)throw R.error}}if(w.length>0){o=!0;const N=new Jo;N.candidates=[{content:{role:"user",parts:w}}],yield yield Pe(N);const b=[];b.push(...E),b.push({role:"user",parts:w});const k=an(m.contents).concat(b);m.contents=k}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=wv(this.apiClient,e);return a=X("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Tv(p),g=new Jo;return Object.assign(g,m),g})}else{const u=_v(this.apiClient,e);return a=X("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=Ev(p),g=new Jo;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=wv(this.apiClient,e);return a=X("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return Fi(this,arguments,function*(){var g,_,T,R;try{for(var x=!0,C=ma(m),I;I=yield Pe(C.next()),g=I.done,!g;x=!0){R=I.value,x=!1;const A=R,D=Tv(yield Pe(A.json()));D.sdkHttpResponse={headers:A.headers};const U=new Jo;Object.assign(U,D),yield yield Pe(U)}}catch(A){_={error:A}}finally{try{!x&&!g&&(T=C.return)&&(yield Pe(T.call(C)))}finally{if(_)throw _.error}}})})}else{const u=_v(this.apiClient,e);return a=X("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(m){return Fi(this,arguments,function*(){var g,_,T,R;try{for(var x=!0,C=ma(m),I;I=yield Pe(C.next()),g=I.done,!g;x=!0){R=I.value,x=!1;const A=R,D=Ev(yield Pe(A.json()));D.sdkHttpResponse={headers:A.headers};const U=new Jo;Object.assign(U,D),yield yield Pe(U)}}catch(A){_={error:A}}finally{try{!x&&!g&&(T=C.return)&&(yield Pe(T.call(C)))}finally{if(_)throw _.error}}})})}}async embedContent(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=W2(this.apiClient,e);return a=X("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=J2(p),g=new rv;return Object.assign(g,m),g})}else{const u=z2(this.apiClient,e);return a=X("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=K2(p),g=new rv;return Object.assign(g,m),g})}}async generateImagesInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=sk(this.apiClient,e);return a=X("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=ok(p),g=new sv;return Object.assign(g,m),g})}else{const u=rk(this.apiClient,e);return a=X("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=ik(p),g=new sv;return Object.assign(g,m),g})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=j2(this.apiClient,e);return i=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>{const u=G2(l),p=new iR;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=tb(this.apiClient,e);return i=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>{const u=nb(l),p=new oR;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=Uk(this.apiClient,e);return i=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=Fk(l),p=new aR;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=Hk(this.apiClient,e);return i=X("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=$k(l),p=new lR;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=xk(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>wh(p))}else{const u=Tk(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>_h(p))}}async listInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Pk(this.apiClient,e);return a=X("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=bk(p),g=new iv;return Object.assign(g,m),g})}else{const u=Rk(this.apiClient,e);return a=X("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=kk(p),g=new iv;return Object.assign(g,m),g})}}async update(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Zk(this.apiClient,e);return a=X("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>wh(p))}else{const u=Xk(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>_h(p))}}async delete(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=F2(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=q2(p),g=new ov;return Object.assign(g,m),g})}else{const u=U2(this.apiClient,e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=O2(p),g=new ov;return Object.assign(g,m),g})}}async countTokens(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=D2(this.apiClient,e);return a=X("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=V2(p),g=new av;return Object.assign(g,m),g})}else{const u=M2(this.apiClient,e);return a=X("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=L2(p),g=new av;return Object.assign(g,m),g})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=C2(this.apiClient,e);return i=X("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>{const u=A2(l),p=new uR;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=fk(this.apiClient,e);return a=X("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o.then(p=>{const m=ck(p),g=new Hu;return Object.assign(g,m),g})}else{const u=dk(this.apiClient,e);return a=X("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>{const m=uk(p),g=new Hu;return Object.assign(g,m),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lb extends gr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;r&&"httpOptions"in r&&(i=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;r&&"httpOptions"in r&&(i=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=ZN(e);return a=X("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),o}else{const u=XN(e);return a=X("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=$N(e);return i=X("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vb(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Ub(t){const e={},n=c(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>$b(i))),f(e,["parts"],s)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function Fb(t,e,n){const r={},s=c(e,["expireTime"]);n!==void 0&&s!=null&&f(n,["expireTime"],s);const i=c(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&f(n,["newSessionExpireTime"],i);const o=c(e,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],Hb(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&f(n,["fieldMask"],l),r}function Ob(t,e){const n={},r=c(e,["config"]);return r!=null&&f(n,["config"],Fb(t,r,n)),n}function qb(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Bb(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function jb(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function Gb(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const s=c(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const i=c(t,["temperature"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","temperature"],i);const o=c(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const p=c(t,["seed"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","seed"],p);const m=c(t,["speechConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","speechConfig"],Xp(m));const g=c(t,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const _=c(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=c(t,["systemInstruction"]);e!==void 0&&T!=null&&f(e,["setup","systemInstruction"],Ub(Tt(T)));const R=c(t,["tools"]);if(e!==void 0&&R!=null){let F=co(R);Array.isArray(F)&&(F=F.map(w=>Wb(uo(w)))),f(e,["setup","tools"],F)}const x=c(t,["sessionResumption"]);e!==void 0&&x!=null&&f(e,["setup","sessionResumption"],zb(x));const C=c(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&f(e,["setup","inputAudioTranscription"],C);const I=c(t,["outputAudioTranscription"]);e!==void 0&&I!=null&&f(e,["setup","outputAudioTranscription"],I);const A=c(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&f(e,["setup","realtimeInputConfig"],A);const D=c(t,["contextWindowCompression"]);e!==void 0&&D!=null&&f(e,["setup","contextWindowCompression"],D);const U=c(t,["proactivity"]);return e!==void 0&&U!=null&&f(e,["setup","proactivity"],U),n}function Hb(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["setup","model"],we(t,r));const s=c(e,["config"]);return s!=null&&f(n,["config"],Gb(s,n)),n}function $b(t){const e={},n=c(t,["functionCall"]);n!=null&&f(e,["functionCall"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=c(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const i=c(t,["fileData"]);i!=null&&f(e,["fileData"],qb(i));const o=c(t,["functionResponse"]);o!=null&&f(e,["functionResponse"],o);const a=c(t,["inlineData"]);a!=null&&f(e,["inlineData"],Vb(a));const l=c(t,["text"]);l!=null&&f(e,["text"],l);const u=c(t,["thought"]);u!=null&&f(e,["thought"],u);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function zb(t){const e={},n=c(t,["handle"]);if(n!=null&&f(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Wb(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["functionDeclarations"],p)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const s=c(t,["computerUse"]);s!=null&&f(e,["computerUse"],s);const i=c(t,["fileSearch"]);i!=null&&f(e,["fileSearch"],i);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],Bb(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],jb(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kb(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const s=Object.keys(r).map(i=>`${n}.${i}`);e.push(...s)}else e.push(n)}return e.join(",")}function Jb(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const s=t.fieldMask;if(n){const i=Kb(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];s.length>0&&(a=s.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];i&&l.push(i),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?t.fieldMask=s.join(","):delete t.fieldMask;return t}class Yb extends gr{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=Ob(this.apiClient,e);i=X("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=Jb(a,e.config);return s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qb(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function Xb(t){const e={},n=c(t,["config"]);return n!=null&&Qb(n,e),e}function Zb(t,e){const n={},r=c(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function eM(t){const e={},n=c(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=c(t,["config"]);return r!=null&&Zb(r,e),e}function tM(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function nM(t,e){const n={},r=c(t,["customMetadata"]);if(e!==void 0&&r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["customMetadata"],i)}const s=c(t,["chunkingConfig"]);return e!==void 0&&s!=null&&f(e,["chunkingConfig"],s),n}function rM(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=c(t,["done"]);s!=null&&f(e,["done"],s);const i=c(t,["error"]);i!=null&&f(e,["error"],i);const o=c(t,["response"]);return o!=null&&f(e,["response"],iM(o)),e}function sM(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=c(t,["fileName"]);r!=null&&f(e,["fileName"],r);const s=c(t,["config"]);return s!=null&&nM(s,e),e}function iM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&f(e,["parent"],r);const s=c(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function oM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function aM(t){const e={},n=c(t,["config"]);return n!=null&&oM(n,e),e}function lM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["fileSearchStores"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["fileSearchStores"],i)}return e}function uM(t,e){const n={},r=c(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const s=c(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const i=c(t,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),f(e,["customMetadata"],a)}const o=c(t,["chunkingConfig"]);return e!==void 0&&o!=null&&f(e,["chunkingConfig"],o),n}function cM(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=c(t,["config"]);return r!=null&&uM(r,e),e}function dM(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fM(t,e){const n={},r=c(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function hM(t){const e={},n=c(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=c(t,["config"]);return r!=null&&fM(r,e),e}function pM(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function mM(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=c(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function gM(t){const e={},n=c(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=c(t,["config"]);return r!=null&&mM(r,e),e}function yM(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=c(t,["documents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>o)),f(e,["documents"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vM extends gr{constructor(e){super(),this.apiClient=e,this.list=async n=>new ni(ur.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pM(e);return i=X("{name}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var n,r;let s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=hM(e);s=X("{name}",o._url),i=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=gM(e);return i=X("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=yM(l),p=new cR;return Object.assign(p,u),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _M extends gr{constructor(e,n=new vM(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new ni(ur.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Xb(e);return i=X("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tM(e);return i=X("{name}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var n,r;let s="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=eM(e);s=X("{name}",o._url),i=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:i,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=aM(e);return i=X("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=lM(l),p=new dR;return Object.assign(p,u),p})}}async uploadToFileSearchStoreInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cM(e);return i=X("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=dM(l),p=new fR;return Object.assign(p,u),p})}}async importFile(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=sM(e);return i=X("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),s.then(l=>{const u=rM(l),p=new Wp;return Object.assign(p,u),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wM(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function EM(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function TM(t,e,n){const r={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=c(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&f(e,["displayName"],s),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(t,["epochCount"]);e!==void 0&&i!=null&&f(e,["tuningTask","hyperparameters","epochCount"],i);const o=c(t,["learningRateMultiplier"]);if(o!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=c(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=c(t,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(c(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function xM(t,e,n){const r={};let s=c(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const _=c(t,["validationDataset"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec"],Rv(_))}else if(s==="PREFERENCE_TUNING"){const _=c(t,["validationDataset"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec"],Rv(_))}const i=c(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&f(e,["tunedModelDisplayName"],i);const o=c(t,["description"]);e!==void 0&&o!=null&&f(e,["description"],o);let a=c(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const _=c(t,["epochCount"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],_)}else if(a==="PREFERENCE_TUNING"){const _=c(t,["epochCount"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],_)}let l=c(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const _=c(t,["learningRateMultiplier"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],_)}else if(l==="PREFERENCE_TUNING"){const _=c(t,["learningRateMultiplier"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],_)}let u=c(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const _=c(t,["exportLastCheckpointOnly"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],_)}else if(u==="PREFERENCE_TUNING"){const _=c(t,["exportLastCheckpointOnly"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],_)}let p=c(n,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const _=c(t,["adapterSize"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],_)}else if(p==="PREFERENCE_TUNING"){const _=c(t,["adapterSize"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],_)}if(c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=c(t,["labels"]);e!==void 0&&m!=null&&f(e,["labels"],m);const g=c(t,["beta"]);return e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],g),r}function IM(t,e){const n={},r=c(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const s=c(t,["preTunedModel"]);s!=null&&f(n,["preTunedModel"],s);const i=c(t,["trainingDataset"]);i!=null&&LM(i);const o=c(t,["config"]);return o!=null&&TM(o,n),n}function SM(t,e){const n={},r=c(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const s=c(t,["preTunedModel"]);s!=null&&f(n,["preTunedModel"],s);const i=c(t,["trainingDataset"]);i!=null&&VM(i,n,e);const o=c(t,["config"]);return o!=null&&xM(o,n,e),n}function CM(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function AM(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function NM(t,e,n){const r={},s=c(t,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&f(e,["_query","pageToken"],i);const o=c(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function RM(t,e,n){const r={},s=c(t,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&f(e,["_query","pageToken"],i);const o=c(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function PM(t,e){const n={},r=c(t,["config"]);return r!=null&&NM(r,n),n}function kM(t,e){const n={},r=c(t,["config"]);return r!=null&&RM(r,n),n}function bM(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=c(t,["nextPageToken"]);s!=null&&f(n,["nextPageToken"],s);const i=c(t,["tunedModels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>cx(a))),f(n,["tuningJobs"],o)}return n}function MM(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=c(t,["nextPageToken"]);s!=null&&f(n,["nextPageToken"],s);const i=c(t,["tuningJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Th(a))),f(n,["tuningJobs"],o)}return n}function DM(t,e){const n={},r=c(t,["name"]);r!=null&&f(n,["model"],r);const s=c(t,["name"]);return s!=null&&f(n,["endpoint"],s),n}function LM(t,e){const n={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=c(t,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>i)),f(n,["examples","examples"],s)}return n}function VM(t,e,n){const r={};let s=c(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=c(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=c(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=c(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=c(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function cx(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=c(t,["name"]);s!=null&&f(n,["name"],s);const i=c(t,["state"]);i!=null&&f(n,["state"],$T(i));const o=c(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=c(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const l=c(t,["tuningTask","completeTime"]);l!=null&&f(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const p=c(t,["description"]);p!=null&&f(n,["description"],p);const m=c(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const g=c(t,["_self"]);return g!=null&&f(n,["tunedModel"],DM(g)),n}function Th(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=c(t,["name"]);s!=null&&f(n,["name"],s);const i=c(t,["state"]);i!=null&&f(n,["state"],$T(i));const o=c(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=c(t,["startTime"]);a!=null&&f(n,["startTime"],a);const l=c(t,["endTime"]);l!=null&&f(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const p=c(t,["error"]);p!=null&&f(n,["error"],p);const m=c(t,["description"]);m!=null&&f(n,["description"],m);const g=c(t,["baseModel"]);g!=null&&f(n,["baseModel"],g);const _=c(t,["tunedModel"]);_!=null&&f(n,["tunedModel"],_);const T=c(t,["preTunedModel"]);T!=null&&f(n,["preTunedModel"],T);const R=c(t,["supervisedTuningSpec"]);R!=null&&f(n,["supervisedTuningSpec"],R);const x=c(t,["preferenceOptimizationSpec"]);x!=null&&f(n,["preferenceOptimizationSpec"],x);const C=c(t,["tuningDataStats"]);C!=null&&f(n,["tuningDataStats"],C);const I=c(t,["encryptionSpec"]);I!=null&&f(n,["encryptionSpec"],I);const A=c(t,["partnerModelTuningSpec"]);A!=null&&f(n,["partnerModelTuningSpec"],A);const D=c(t,["customBaseModel"]);D!=null&&f(n,["customBaseModel"],D);const U=c(t,["experiment"]);U!=null&&f(n,["experiment"],U);const F=c(t,["labels"]);F!=null&&f(n,["labels"],F);const w=c(t,["outputUri"]);w!=null&&f(n,["outputUri"],w);const E=c(t,["pipelineJob"]);E!=null&&f(n,["pipelineJob"],E);const N=c(t,["serviceAccount"]);N!=null&&f(n,["serviceAccount"],N);const b=c(t,["tunedModelDisplayName"]);b!=null&&f(n,["tunedModelDisplayName"],b);const k=c(t,["veoTuningSpec"]);return k!=null&&f(n,["veoTuningSpec"],k),n}function UM(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=c(t,["name"]);s!=null&&f(n,["name"],s);const i=c(t,["metadata"]);i!=null&&f(n,["metadata"],i);const o=c(t,["done"]);o!=null&&f(n,["done"],o);const a=c(t,["error"]);return a!=null&&f(n,["error"],a),n}function Rv(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const s=c(t,["vertexDatasetResource"]);return s!=null&&f(n,["validationDatasetUri"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FM extends gr{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new ni(ur.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const s={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(s.checkpointId=n.config.preTunedModelCheckpointId);const i=Object.assign(Object.assign({},n),{preTunedModel:s});return i.baseModel=void 0,await this.tuneInternal(i)}else{const s=Object.assign({},n);return await this.tuneInternal(s)}else{const s=Object.assign({},n),i=await this.tuneMldevInternal(s);let o="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?o=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(o=i.name.split("/operations/")[0]),{name:o,state:mh.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=AM(e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>Th(p))}else{const u=CM(e);return a=X("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>cx(p))}}async listInternal(e){var n,r,s,i;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=kM(e);return a=X("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=MM(p),g=new lv;return Object.assign(g,m),g})}else{const u=PM(e);return a=X("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(m=>{const g=m;return g.sdkHttpResponse={headers:p.headers},g})),o.then(p=>{const m=bM(p),g=new lv;return Object.assign(g,m),g})}}async cancel(e){var n,r,s,i;let o="",a={};if(this.apiClient.isVertexAI()){const l=EM(e);o=X("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=wM(e);o=X("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const a=SM(e,e);return i=X("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>Th(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=IM(e);return i=X("tunedModels",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:l.headers},p})),s.then(l=>UM(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OM{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const qM=1024*1024*8,BM=3,jM=1e3,GM=2,zu="x-goog-upload-status";async function HM(t,e,n){var r;const s=await dx(t,e,n),i=await(s==null?void 0:s.json());if(((r=s==null?void 0:s.headers)===null||r===void 0?void 0:r[zu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return i.file}async function $M(t,e,n){var r;const s=await dx(t,e,n),i=await(s==null?void 0:s.json());if(((r=s==null?void 0:s.headers)===null||r===void 0?void 0:r[zu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=OT(i),a=new Kp;return Object.assign(a,o),a}async function dx(t,e,n){var r,s;let i=0,o=0,a=new gh(new Response),l="upload";for(i=t.size;o<i;){const u=Math.min(qM,i-o),p=t.slice(o,o+u);o+u>=i&&(l+=", finalize");let m=0,g=jM;for(;m<BM&&(a=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[zu]));)m++,await WM(g),g=g*GM;if(o+=u,((s=a==null?void 0:a.headers)===null||s===void 0?void 0:s[zu])!=="active")break;if(i<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function zM(t){return{size:t.size,type:t.type}}function WM(t){return new Promise(e=>setTimeout(e,t))}class KM{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await HM(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await $M(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await zM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JM{create(e,n,r){return new YM(e,n,r)}}class YM{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Pv="x-goog-api-key";class QM{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Pv)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Pv,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XM="gl-node/";class fx{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=GN(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new QM(this.apiKey);this.apiClient=new mb({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:XM+"web",uploader:new KM,downloader:new OM}),this.models=new Db(this.apiClient),this.live=new Nb(this.apiClient,s,new JM),this.batches=new pP(this.apiClient),this.chats=new zP(this.models,this.apiClient),this.caches=new GP(this.apiClient),this.files=new n2(this.apiClient),this.operations=new Lb(this.apiClient),this.authTokens=new Yb(this.apiClient),this.tunings=new FM(this.apiClient),this.fileSearchStores=new _M(this.apiClient)}}console.warn("La variable d'entorn VITE_API_KEY no est definida. Les funcionalitats de Gemini no funcionaran.");new fx({apiKey:""});const ZM=async t=>{throw new Error("API_KEY no configurada. No es pot suggerir un preu.")},eD=({title:t,description:e,price:n,setPrice:r})=>{const[s,i]=V.useState(!1),[o,a]=V.useState(null),[l,u]=V.useState([]),[p,m]=V.useState(null),g=async()=>{const _=`${t} ${e}`;if(!_.trim()){m("Si us plau, proporciona primer un ttol o una descripci.");return}i(!0),m(null),a(null),u([]);try{const T=await ZM(_),R=T.suggestion.match(/(\d+([.,]\d{1,2})?)\s*?/),x=R?R[1].replace(",","."):"";a(T.suggestion),r(x),u(T.sources||[])}catch(T){m("No s'ha pogut suggerir un preu. Si us plau, torna-ho a provar."),console.error(T)}finally{i(!1)}};return h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:h.jsx(RN,{className:"h-6 w-6 text-primary"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),h.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Obtn un suggeriment de preu basat en anuncis en lnia o introdueix-lo manualment."}),h.jsxs("button",{onClick:g,disabled:s||!t,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-gray-400 disabled:cursor-not-allowed",children:[s?h.jsx(zs,{className:"w-5 h-5"}):h.jsx(UT,{className:"w-5 h-5"}),h.jsx("span",{className:"ml-2",children:"Suggereix un preu"})]}),p&&h.jsx("p",{className:"text-red-500 text-sm mt-2",children:p}),o&&h.jsx("div",{className:"mt-4 p-4 bg-primary-50 border border-primary-200 rounded-lg",children:h.jsx("p",{className:"text-gray-800 font-medium",children:o})}),l.length>0&&h.jsxs("div",{className:"mt-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Fonts:"}),h.jsx("ul",{className:"mt-2 space-y-1 text-sm list-disc list-inside",children:l.map((_,T)=>_.web?h.jsx("li",{children:h.jsx("a",{href:_.web.uri,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:_.web.title})},T):null)})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),h.jsx("input",{id:"product-price",type:"number",value:n,onChange:_=>r(_.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]})},tD=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=V.useState([]),[i,o]=V.useState(""),[a,l]=V.useState(""),[u,p]=V.useState(""),[m,g]=V.useState(!1),_=!!e;V.useEffect(()=>{var x;_&&e?(o(e.title),l(e.description),p(((x=e.price)==null?void 0:x.toString())||""),s(e.imageUrls||[]),g(e.isMerchandise||!1)):T()},[e,_]);const T=()=>{s([]),o(""),l(""),p(""),g(!1)},R=()=>{if(r.length>0&&i&&u){const x={title:i,description:a,price:parseFloat(u),imageUrls:r,isMerchandise:m};t(x,e==null?void 0:e.id),_||T()}};return h.jsx("main",{className:"container mx-auto p-4 md:p-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:_?"Edita el teu anunci":"Crea el teu anunci"}),h.jsx("p",{className:"text-gray-600 mb-8",children:_?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[h.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[h.jsx(UN,{images:r,setImages:s}),h.jsx(FN,{title:i,setTitle:o,description:a,setDescription:l}),(n==null?void 0:n.role)==="admin"&&h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),h.jsx("div",{className:"mt-4",children:h.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:m,onChange:x=>g(x.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),h.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]})})]}),h.jsx(eD,{title:i,description:a,price:u,setPrice:p})]}),h.jsx("div",{className:"lg:col-span-2",children:h.jsx(ON,{images:r,title:i,description:a,price:u,onPublish:R,isEditing:_})})]})]})})},nD=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return h.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[h.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),h.jsxs("div",{className:`${r} ${s[e]}`,children:[h.jsx("span",{children:t}),h.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:h.jsx(es,{className:"w-4 h-4"})})]})]})},rD=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.9))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),sD=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=V.useState("login"),[a,l]=V.useState(""),[u,p]=V.useState(""),[m,g]=V.useState(""),[_,T]=V.useState(!1),[R,x]=V.useState(null),C=V.useRef(null),[I,A]=V.useState(!1),[D,U]=V.useState(null),[F,w]=V.useState(null),E=async k=>{var P;const M=(P=k.target.files)==null?void 0:P[0];if(M)try{const fe=await rD(M);x(fe)}catch(fe){console.error("Error en llegir el fitxer:",fe),U("No s'ha pogut processar la imatge.")}},N=async k=>{k.preventDefault(),A(!0),U(null),w(null);try{i==="login"?await e(u,m):await n(a,u,m,R)}catch(M){let P="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(M.code)switch(M.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":P="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":P="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":P="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":P="El format del correu electrnic no s vlid.";break}else M.message&&(M.message.includes("Cloudinary")?P="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":P=M.message);U(P),console.error(M)}finally{A(!1)}},b=async k=>{k.preventDefault(),A(!0),U(null),w(null);try{await r(u),w("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(M){let P="Hi ha hagut un error en enviar el correu.";(M.code==="auth/user-not-found"||M.code==="auth/invalid-email")&&(P="No s'ha trobat cap usuari amb aquest correu electrnic."),U(P)}finally{A(!1)}};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:k=>k.stopPropagation(),children:[s&&h.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:h.jsx(es,{className:"w-6 h-6"})}),h.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),h.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),h.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),h.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),h.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:u,onChange:k=>p(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),D&&h.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),F&&h.jsx("p",{className:"text-green-600 text-sm text-center",children:F}),h.jsx("div",{children:h.jsx("button",{type:"submit",disabled:I,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:I?h.jsx(zs,{className:"w-5 h-5"}):"Envia l'enlla"})}),h.jsx("div",{children:h.jsx("button",{type:"button",onClick:()=>{o("login"),U(null),w(null),T(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),h.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?h.jsxs(h.Fragment,{children:["Benvingut/da a LA",h.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),h.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),h.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[h.jsx("button",{onClick:()=>{o("login"),U(null),w(null),T(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),h.jsx("button",{onClick:()=>{o("register"),U(null),w(null),T(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),h.jsxs("form",{onSubmit:N,className:"space-y-4",children:[i==="register"&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-center",children:[h.jsx("input",{type:"file",ref:C,onChange:E,className:"hidden",accept:"image/*"}),h.jsxs("button",{type:"button",onClick:()=>{var k;return(k=C.current)==null?void 0:k.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[R?h.jsx("img",{src:R,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):h.jsx($p,{className:"w-10 h-10"}),h.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),h.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:a,onChange:k=>l(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),h.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:u,onChange:k=>p(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&h.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),U(null),w(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),h.jsxs("div",{className:"relative mt-1",children:[h.jsx("input",{id:"password",name:"password",type:_?"text":"password",autoComplete:"current-password",required:!0,value:m,onChange:k=>g(k.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),h.jsx("button",{type:"button",onClick:()=>T(!_),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":_?"Oculta la contrasenya":"Mostra la contrasenya",children:_?h.jsx(MN,{className:"w-5 h-5"}):h.jsx(bN,{className:"w-5 h-5"})})]})]}),D&&h.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),F&&h.jsx("p",{className:"text-green-600 text-sm text-center",children:F}),h.jsx("div",{children:h.jsx("button",{type:"submit",disabled:I,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:I?h.jsx(zs,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},iD=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.9))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),oD=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=V.useState("all"),[s,i]=V.useState(""),[o,a]=V.useState(!1),l=async u=>{if(u.preventDefault(),!!s.trim()){a(!0);try{await e(n,s),i(""),r("all")}catch{}finally{a(!1)}}};return h.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[h.jsx(IN,{className:"h-10 w-10 text-primary"}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),h.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),h.jsxs("form",{onSubmit:l,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),h.jsxs("select",{id:"recipient",value:n,onChange:u=>r(u.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[h.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(u=>h.jsxs("option",{value:u.id,children:[u.name," (",u.email,")"]},u.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),h.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:u=>i(u.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),h.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?h.jsx(zs,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},aD=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i})=>{const[o,a]=V.useState(t.name),[l,u]=V.useState(null),p=V.useRef(null),[m,g]=V.useState(!1);V.useEffect(()=>{a(t.name)},[t]);const _=async R=>{var C;const x=(C=R.target.files)==null?void 0:C[0];if(x)try{const I=await iD(x);u(I)}catch(I){console.error("Error en llegir el fitxer:",I)}},T=async R=>{R.preventDefault(),g(!0);try{await e(t.id,o,l),u(null)}catch(x){console.error(x)}finally{g(!1)}};return h.jsx("main",{className:"container mx-auto p-4 md:p-8",children:h.jsxs("div",{className:"max-w-2xl mx-auto",children:[h.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[h.jsx(PN,{className:"h-10 w-10 text-primary"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),h.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),h.jsxs("form",{onSubmit:T,className:"space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"flex flex-col items-center gap-4",children:[h.jsx("input",{type:"file",ref:p,onChange:_,className:"hidden",accept:"image/*"}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),h.jsxs("button",{type:"button",onClick:()=>{var R;return(R=p.current)==null?void 0:R.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[h.jsx("img",{src:l||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:h.jsx($p,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),h.jsx("input",{id:"name",type:"text",required:!0,value:o,onChange:R=>a(R.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),h.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),h.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),h.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[h.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),h.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:m?h.jsx(zs,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),h.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:h.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&h.jsx(oD,{allUsers:s,onSendAdminMessage:i})]})})},lD=({onClick:t,unreadCount:e,isOpen:n})=>n?null:h.jsxs(h.Fragment,{children:[h.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),h.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&h.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),h.jsx("div",{className:"w-9 h-9",children:h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),uD=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return h.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:h.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&h.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&h.jsx("div",{className:"mt-2",children:h.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),h.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},cD=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.85))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),dD=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,_,T,R,x;const a=t.participantIds.find(C=>C!==n.id);if(!a)return null;const l=t.participants[a],u=t.unreadCount[n.id]||0,p=((T=(_=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:_.toDate())==null?void 0:T.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",m=()=>{r(t.id),o()};return h.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[h.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[h.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),h.jsx("button",{onClick:m,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),h.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[h.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[h.jsxs("div",{className:"relative flex-shrink-0",children:[h.jsx("img",{src:l.avatarUrl,alt:l.name,className:"w-12 h-12 rounded-full object-cover"}),h.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),h.jsxs("div",{className:"flex-1 overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("p",{className:"font-bold text-gray-800 truncate",children:l.name}),h.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:p})]}),h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((R=t.lastMessage)==null?void 0:R.text)||((x=t.lastMessage)!=null&&x.imageUrl?"Imatge":"Cap missatge encara")}),u>0&&h.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:u})]})]})]}),h.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${l.name}`,children:h.jsx(LT,{className:"w-5 h-5"})})]})]})},fD=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:a,onBackToList:l,onDeleteChat:u})=>{const[p,m]=V.useState(""),[g,_]=V.useState(null),T=V.useRef(null),R=V.useRef(null),x=()=>{var w;(w=R.current)==null||w.scrollIntoView({behavior:"smooth"})};V.useEffect(()=>{t&&r&&x()},[s,t,r]),V.useEffect(()=>{(!t||!r)&&_(null)},[t,r]);const C=()=>{p.trim()&&(o(p),m(""))},I=w=>{w.key==="Enter"&&(w.preventDefault(),C())},A=async w=>{var N;const E=(N=w.target.files)==null?void 0:N[0];if(E)try{const b=await cD(E);o("",b)}catch(b){console.error("No s'ha pogut llegir el fitxer",b)}w.target&&(w.target.value="")},D=()=>{var w;(w=T.current)==null||w.click()};if(!t||!i)return null;const U=r==null?void 0:r.participantIds.find(w=>w!==i.id),F=U?r==null?void 0:r.participants[U]:null;return h.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[h.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),h.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?h.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[h.jsx("button",{onClick:l,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:h.jsx(kN,{className:"w-6 h-6"})}),h.jsx("img",{src:F==null?void 0:F.avatarUrl,alt:F==null?void 0:F.name,className:"w-8 h-8 rounded-full object-cover"}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("h3",{className:"font-bold text-lg truncate",children:F==null?void 0:F.name}),h.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):h.jsx("div",{className:"flex items-center justify-between w-full",children:h.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),h.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:h.jsx(es,{className:"w-6 h-6"})})]}),r?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(w=>h.jsx(uD,{message:w,currentUser:i},w.id)),h.jsx("div",{ref:R})]}),h.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:h.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[h.jsx("input",{type:"text",value:p,onChange:w=>m(w.target.value),onKeyPress:I,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),h.jsx("input",{ref:T,type:"file",onChange:A,className:"hidden",accept:"image/*"}),h.jsx("button",{onClick:D,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:h.jsx(SN,{className:"w-5 h-5"})}),h.jsx("button",{onClick:C,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!p.trim(),"aria-label":"Envia el missatge",children:h.jsx(AN,{className:"w-5 h-5"})})]})})]}):h.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(w=>h.jsx(dD,{chat:w,onSelect:()=>a(w),currentUser:i,onDelete:u,isConfirmingDelete:g===w.id,onStartConfirmDelete:()=>_(w.id),onCancelConfirmDelete:()=>_(null)},w.id)):h.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[h.jsx(DT,{className:"w-16 h-16 text-gray-300 mb-4"}),h.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),h.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},Ss=({title:t,children:e})=>h.jsxs("section",{className:"mb-6",children:[h.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),h.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),hD=({onClose:t})=>h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[h.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(FT,{className:"w-8 h-8 text-primary"}),h.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",h.jsx("span",{className:"text-gray-900",children:"LA"}),h.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:h.jsx(es,{className:"w-6 h-6"})})]}),h.jsxs("div",{className:"p-6 overflow-y-auto",children:[h.jsxs("section",{className:"mb-6",children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",h.jsx("span",{className:"text-gray-900",children:"LA"}),h.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),h.jsx("div",{className:"space-y-2 text-gray-700",children:h.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),h.jsx(Ss,{title:"1. Explora els Articles",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["A la pgina principal, trobars les seccions ",h.jsx("strong",{children:"'Marxandatge del Club'"})," i ",h.jsx("strong",{children:"'Articles destacats'"}),"."]}),h.jsxs("li",{children:["Fes servir la ",h.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),h.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),h.jsx(Ss,{title:"2. Comprar un Article de Segona M",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),h.jsxs("li",{children:[h.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),h.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),h.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",h.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),h.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),h.jsxs(Ss,{title:"3. Vendre un Article",children:[h.jsxs("p",{children:["Fes clic al bot ",h.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),h.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",h.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),h.jsx(Ss,{title:"4. Gestiona els Teus Xats",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["Fes clic a la ",h.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),h.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),h.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),h.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),h.jsx(Ss,{title:"5. El Teu Perfil",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["Fes clic a la teva ",h.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),h.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),h.jsxs("li",{children:["Tamb pots ",h.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),h.jsx(Ss,{title:"6. Comprar Marxandatge Oficial",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club' sn productes oficials."}),h.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",h.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),h.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",h.jsx("strong",{children:"'Contacta amb el club'"})," per iniciar un xat directe abans de fer la comanda."]})]})}),h.jsxs(Ss,{title:"7. Eines d'Administrador",children:[h.jsx("p",{children:"Si tens el rol d'administrador, a la teva pgina de perfil trobars un panell addicional."}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["Aquest panell et permet enviar ",h.jsx("strong",{children:"missatges massius"})," a tots els usuaris o missatges directes a un usuari especfic."]}),h.jsx("li",{children:"Aquests missatges apareixeran com una nova conversa de xat per als destinataris."})]})]})]})]})}),kv=({direction:t,onClick:e})=>h.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),pD=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=V.useState(e),[i,o]=V.useState(null),a=V.useCallback(()=>{s(m=>m===0?t.length-1:m-1)},[t.length]),l=V.useCallback(()=>{s(m=>m===t.length-1?0:m+1)},[t.length]);V.useEffect(()=>{const m=g=>{g.key==="ArrowLeft"&&a(),g.key==="ArrowRight"&&l(),g.key==="Escape"&&n()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[a,l,n]);const u=m=>{o(m.touches[0].clientX)},p=m=>{if(i===null)return;const g=m.touches[0].clientX,_=i-g;_>50?(l(),o(null)):_<-50&&(a(),o(null))};return h.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[h.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),h.jsx("button",{onClick:m=>{m.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:h.jsx(es,{className:"w-6 h-6"})}),h.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&h.jsx(kv,{direction:"left",onClick:a}),h.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:u,onTouchMove:p,children:h.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&h.jsx(kv,{direction:"right",onClick:l})]}),t.length>1&&h.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},mD=()=>{};var bv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gD=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},px={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,p=i>>2,m=(i&3)<<4|a>>4;let g=(a&15)<<2|u>>6,_=u&63;l||(_=64,o||(g=64)),r.push(n[p],n[m],n[g],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(hx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||u==null||m==null)throw new yD;const g=i<<2|a>>4;if(r.push(g),u!==64){const _=a<<4&240|u>>2;if(r.push(_),m!==64){const T=u<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vD=function(t){const e=hx(t);return px.encodeByteArray(e,!0)},Wu=function(t){return vD(t).replace(/\./g,"")},mx=function(t){try{return px.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=()=>_D().__FIREBASE_DEFAULTS__,ED=()=>{if(typeof process>"u"||typeof bv>"u")return;const t=bv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},TD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&mx(t[1]);return e&&JSON.parse(e)},Uc=()=>{try{return mD()||wD()||ED()||TD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gx=t=>{var e,n;return(n=(e=Uc())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},xD=t=>{const e=gx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},yx=()=>{var t;return(t=Uc())==null?void 0:t.config},vx=t=>{var e;return(e=Uc())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _x(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Wu(JSON.stringify(n)),Wu(JSON.stringify(o)),""].join(".")}const ga={};function CD(){const t={prod:[],emulator:[]};for(const e of Object.keys(ga))ga[e]?t.emulator.push(e):t.prod.push(e);return t}function AD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Mv=!1;function wx(t,e){if(typeof window>"u"||typeof document>"u"||!ho(window.location.host)||ga[t]===e||ga[t]||Mv)return;ga[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=CD().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,_){g.setAttribute("width","24"),g.setAttribute("id",_),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Mv=!0,o()},g}function p(g,_){g.setAttribute("id",_),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=AD(r),_=n("text"),T=document.getElementById(_)||document.createElement("span"),R=n("learnmore"),x=document.getElementById(R)||document.createElement("a"),C=n("preprendIcon"),I=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const A=g.element;a(A),p(x,R);const D=u();l(I,C),A.append(I,T,x,D),document.body.appendChild(A)}i?(T.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ND(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(St())}function RD(){var e;const t=(e=Uc())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function PD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function bD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MD(){const t=St();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function DD(){return!RD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ex(){try{return typeof indexedDB=="object"}catch{return!1}}function Tx(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function LD(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="FirebaseError";class $n extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=VD,Object.setPrototypeOf(this,$n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ri.prototype.create)}}class ri{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?UD(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new $n(s,a,r)}}function UD(t,e){return t.replace(FD,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const FD=/\{\$([^}]+)}/g;function OD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ts(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Dv(i)&&Dv(o)){if(!ts(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Dv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ea(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ta(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function qD(t,e){const n=new BD(t,e);return n.subscribe.bind(n)}class BD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");jD(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Zd),s.error===void 0&&(s.error=Zd),s.complete===void 0&&(s.complete=Zd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Zd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(t){return t&&t._delegate?t._delegate:t}class Tn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ID;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($D(e))try{this.getOrInitializeService({instanceIdentifier:ks})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ks){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ks){return this.instances.has(e)}getOptions(e=ks){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:HD(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ks){return this.component?this.component.multipleInstances?e:ks:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HD(t){return t===ks?void 0:t}function $D(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new GD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const WD={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},KD=pe.INFO,JD={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},YD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=JD[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class em{constructor(e){this.name=e,this._logLevel=KD,this._logHandler=YD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}const QD=(t,e)=>e.some(n=>t instanceof n);let Lv,Vv;function XD(){return Lv||(Lv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZD(){return Vv||(Vv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xx=new WeakMap,xh=new WeakMap,Ix=new WeakMap,ef=new WeakMap,tm=new WeakMap;function eL(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(nr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&xx.set(n,t)}).catch(()=>{}),tm.set(e,t),e}function tL(t){if(xh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});xh.set(t,e)}let Ih={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ix.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return nr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nL(t){Ih=t(Ih)}function rL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(tf(this),e,...n);return Ix.set(r,e.sort?e.sort():[e]),nr(r)}:ZD().includes(t)?function(...e){return t.apply(tf(this),e),nr(xx.get(this))}:function(...e){return nr(t.apply(tf(this),e))}}function sL(t){return typeof t=="function"?rL(t):(t instanceof IDBTransaction&&tL(t),QD(t,XD())?new Proxy(t,Ih):t)}function nr(t){if(t instanceof IDBRequest)return eL(t);if(ef.has(t))return ef.get(t);const e=sL(t);return e!==t&&(ef.set(t,e),tm.set(e,t)),e}const tf=t=>tm.get(t);function Fc(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=nr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(nr(o.result),l.oldVersion,l.newVersion,nr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}function nf(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),nr(n).then(()=>{})}const iL=["get","getKey","getAll","getAllKeys","count"],oL=["put","add","delete","clear"],rf=new Map;function Uv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rf.get(e))return rf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=oL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iL.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return rf.set(e,i),i}nL(t=>({...t,get:(e,n,r)=>Uv(e,n)||t.get(e,n,r),has:(e,n)=>!!Uv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sh="@firebase/app",Fv="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cr=new em("@firebase/app"),uL="@firebase/app-compat",cL="@firebase/analytics-compat",dL="@firebase/analytics",fL="@firebase/app-check-compat",hL="@firebase/app-check",pL="@firebase/auth",mL="@firebase/auth-compat",gL="@firebase/database",yL="@firebase/data-connect",vL="@firebase/database-compat",_L="@firebase/functions",wL="@firebase/functions-compat",EL="@firebase/installations",TL="@firebase/installations-compat",xL="@firebase/messaging",IL="@firebase/messaging-compat",SL="@firebase/performance",CL="@firebase/performance-compat",AL="@firebase/remote-config",NL="@firebase/remote-config-compat",RL="@firebase/storage",PL="@firebase/storage-compat",kL="@firebase/firestore",bL="@firebase/ai",ML="@firebase/firestore-compat",DL="firebase",LL="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="[DEFAULT]",VL={[Sh]:"fire-core",[uL]:"fire-core-compat",[dL]:"fire-analytics",[cL]:"fire-analytics-compat",[hL]:"fire-app-check",[fL]:"fire-app-check-compat",[pL]:"fire-auth",[mL]:"fire-auth-compat",[gL]:"fire-rtdb",[yL]:"fire-data-connect",[vL]:"fire-rtdb-compat",[_L]:"fire-fn",[wL]:"fire-fn-compat",[EL]:"fire-iid",[TL]:"fire-iid-compat",[xL]:"fire-fcm",[IL]:"fire-fcm-compat",[SL]:"fire-perf",[CL]:"fire-perf-compat",[AL]:"fire-rc",[NL]:"fire-rc-compat",[RL]:"fire-gcs",[PL]:"fire-gcs-compat",[kL]:"fire-fst",[ML]:"fire-fst-compat",[bL]:"fire-vertex","fire-js":"fire-js",[DL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku=new Map,UL=new Map,Ah=new Map;function Ov(t,e){try{t.container.addComponent(e)}catch(n){cr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Gn(t){const e=t.name;if(Ah.has(e))return cr.debug(`There were multiple attempts to register component ${e}.`),!1;Ah.set(e,t);for(const n of Ku.values())Ov(n,t);for(const n of UL.values())Ov(n,t);return!0}function po(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jr=new ri("app","Firebase",FL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Tn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=LL;function nm(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Ch,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Jr.create("bad-app-name",{appName:String(s)});if(n||(n=yx()),!n)throw Jr.create("no-options");const i=Ku.get(s);if(i){if(ts(n,i.options)&&ts(r,i.config))return i;throw Jr.create("duplicate-app",{appName:s})}const o=new zD(s);for(const l of Ah.values())o.addComponent(l);const a=new OL(n,r,o);return Ku.set(s,a),a}function rm(t=Ch){const e=Ku.get(t);if(!e&&t===Ch&&yx())return nm();if(!e)throw Jr.create("no-app",{appName:t});return e}function ln(t,e,n){let r=VL[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),cr.warn(o.join(" "));return}Gn(new Tn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="firebase-heartbeat-database",BL=1,Oa="firebase-heartbeat-store";let sf=null;function Sx(){return sf||(sf=Fc(qL,BL,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Oa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Jr.create("idb-open",{originalErrorMessage:t.message})})),sf}async function jL(t){try{const n=(await Sx()).transaction(Oa),r=await n.objectStore(Oa).get(Cx(t));return await n.done,r}catch(e){if(e instanceof $n)cr.warn(e.message);else{const n=Jr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});cr.warn(n.message)}}}async function qv(t,e){try{const r=(await Sx()).transaction(Oa,"readwrite");await r.objectStore(Oa).put(e,Cx(t)),await r.done}catch(n){if(n instanceof $n)cr.warn(n.message);else{const r=Jr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});cr.warn(r.message)}}}function Cx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL=1024,HL=30;class $L{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new WL(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Bv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>HL){const o=KL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){cr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Bv(),{heartbeatsToSend:r,unsentEntries:s}=zL(this._heartbeatsCache.heartbeats),i=Wu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return cr.warn(n),""}}}function Bv(){return new Date().toISOString().substring(0,10)}function zL(t,e=GL){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),jv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),jv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class WL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ex()?Tx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await jL(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function jv(t){return Wu(JSON.stringify({version:2,heartbeats:t})).length}function KL(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(t){Gn(new Tn("platform-logger",e=>new aL(e),"PRIVATE")),Gn(new Tn("heartbeat",e=>new $L(e),"PRIVATE")),ln(Sh,Fv,t),ln(Sh,Fv,"esm2020"),ln("fire-js","")}JL("");var YL="firebase",QL="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ln(YL,QL,"app");function Ax(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const XL=Ax,Nx=new ri("auth","Firebase",Ax());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new em("@firebase/auth");function ZL(t,...e){Ju.logLevel<=pe.WARN&&Ju.warn(`Auth (${mo}): ${t}`,...e)}function lu(t,...e){Ju.logLevel<=pe.ERROR&&Ju.error(`Auth (${mo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t,...e){throw sm(t,...e)}function Un(t,...e){return sm(t,...e)}function Rx(t,e,n){const r={...XL(),[e]:n};return new ri("auth","Firebase",r).create(e,{appName:t.name})}function rr(t){return Rx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Nx.create(t,...e)}function ie(t,e,...n){if(!t)throw sm(e,...n)}function Zn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lu(e),new Error(e)}function dr(t,e){t||Zn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function e4(){return Gv()==="http:"||Gv()==="https:"}function Gv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e4()||kD()||"connection"in navigator)?navigator.onLine:!0}function n4(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n){this.shortDelay=e,this.longDelay=n,dr(n>e,"Short delay should be less than long delay!"),this.isMobile=ND()||bD()}get(){return t4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(t,e){dr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],i4=new rl(3e4,6e4);function vr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function _r(t,e,n,r,s={}){return kx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=nl({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...i};return PD()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&ho(t.emulatorConfig.host)&&(u.credentials="include"),Px.fetch()(await bx(t,t.config.apiHost,n,a),u)})}async function kx(t,e,n){t._canInitEmulator=!1;const r={...r4,...e};try{const s=new a4(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Bl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bl(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Bl(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Bl(t,"user-disabled",o);const p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Rx(t,p,u);xn(t,p)}}catch(s){if(s instanceof $n)throw s;xn(t,"network-request-failed",{message:String(s)})}}async function sl(t,e,n,r,s={}){const i=await _r(t,e,n,r,s);return"mfaPendingCredential"in i&&xn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function bx(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?im(t.config,s):`${t.config.apiScheme}://${s}`;return s4.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function o4(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Un(this.auth,"network-request-failed")),i4.get())})}}function Bl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Un(t,e,r);return s.customData._tokenResponse=n,s}function Hv(t){return t!==void 0&&t.enterprise!==void 0}class l4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return o4(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function u4(t,e){return _r(t,"GET","/v2/recaptchaConfig",vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c4(t,e){return _r(t,"POST","/v1/accounts:delete",e)}async function Yu(t,e){return _r(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ya(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function d4(t,e=!1){const n=Be(t),r=await n.getIdToken(e),s=om(r);ie(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ya(of(s.auth_time)),issuedAtTime:ya(of(s.iat)),expirationTime:ya(of(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function of(t){return Number(t)*1e3}function om(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return lu("JWT malformed, contained fewer than 3 sections"),null;try{const s=mx(n);return s?JSON.parse(s):(lu("Failed to decode base64 JWT payload"),null)}catch(s){return lu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function $v(t){const e=om(t);return ie(e,"internal-error"),ie(typeof e.exp<"u","internal-error"),ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof $n&&f4(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function f4({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ya(this.lastLoginAt),this.creationTime=ya(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qu(t){var m;const e=t.auth,n=await t.getIdToken(),r=await qa(t,Yu(e,{idToken:n}));ie(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?Mx(s.providerUserInfo):[],o=m4(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Rh(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,p)}async function p4(t){const e=Be(t);await Qu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function m4(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Mx(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g4(t,e){const n=await kx(t,{},async()=>{const r=nl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await bx(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&ho(t.emulatorConfig.host)&&(l.credentials="include"),Px.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function y4(t,e){return _r(t,"POST","/v2/accounts:revokeToken",vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ie(e.idToken,"internal-error"),ie(typeof e.idToken<"u","internal-error"),ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$v(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ie(e.length!==0,"internal-error");const n=$v(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await g4(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new qi;return r&&(ie(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ie(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ie(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qi,this.toJSON())}_performRefresh(){return Zn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(t,e){ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new h4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Rh(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await qa(this,this.stsTokenManager.getToken(this.auth,e));return ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return d4(this,e)}reload(){return p4(this)}_assign(e){this!==e&&(ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Qu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nn(this.auth.app))return Promise.reject(rr(this.auth));const e=await this.getIdToken();return await qa(this,c4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,p=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:_,providerData:T,stsTokenManager:R}=n;ie(m&&R,e,"internal-error");const x=qi.fromJSON(this.name,R);ie(typeof m=="string",e,"internal-error"),Nr(r,e.name),Nr(s,e.name),ie(typeof g=="boolean",e,"internal-error"),ie(typeof _=="boolean",e,"internal-error"),Nr(i,e.name),Nr(o,e.name),Nr(a,e.name),Nr(l,e.name),Nr(u,e.name),Nr(p,e.name);const C=new vn({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:x,createdAt:u,lastLoginAt:p});return T&&Array.isArray(T)&&(C.providerData=T.map(I=>({...I}))),l&&(C._redirectEventId=l),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new qi;s.updateFromServerResponse(n);const i=new vn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Qu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ie(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Mx(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new qi;a.updateFromIdToken(r);const l=new vn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Rh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv=new Map;function er(t){dr(t instanceof Function,"Expected a class definition");let e=zv.get(t);return e?(dr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Dx.type="NONE";const Wv=Dx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t,e,n){return`firebase:${t}:${e}:${n}`}class Bi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=uu(this.userKey,s.apiKey,i),this.fullPersistenceKey=uu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Yu(this.auth,{idToken:e}).catch(()=>{});return n?vn._fromGetAccountInfoResponse(this.auth,n,e):null}return vn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Bi(er(Wv),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||er(Wv);const o=uu(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const p=await u._get(o);if(p){let m;if(typeof p=="string"){const g=await Yu(e,{idToken:p}).catch(()=>{});if(!g)break;m=await vn._fromGetAccountInfoResponse(e,g,p)}else m=vn._fromJSON(e,p);u!==i&&(a=m),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Bi(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Bi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qx(e))return"Blackberry";if(Bx(e))return"Webos";if(Vx(e))return"Safari";if((e.includes("chrome/")||Ux(e))&&!e.includes("edge/"))return"Chrome";if(Ox(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Lx(t=St()){return/firefox\//i.test(t)}function Vx(t=St()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ux(t=St()){return/crios\//i.test(t)}function Fx(t=St()){return/iemobile/i.test(t)}function Ox(t=St()){return/android/i.test(t)}function qx(t=St()){return/blackberry/i.test(t)}function Bx(t=St()){return/webos/i.test(t)}function am(t=St()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function v4(t=St()){var e;return am(t)&&!!((e=window.navigator)!=null&&e.standalone)}function _4(){return MD()&&document.documentMode===10}function jx(t=St()){return am(t)||Ox(t)||Bx(t)||qx(t)||/windows phone/i.test(t)||Fx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gx(t,e=[]){let n;switch(t){case"Browser":n=Kv(St());break;case"Worker":n=`${Kv(St())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${mo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4(t,e={}){return _r(t,"GET","/v2/passwordPolicy",vr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=6;class x4{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??T4,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jv(this),this.idTokenSubscription=new Jv(this),this.beforeStateQueue=new w4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Nx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=er(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Bi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Yu(this,{idToken:e}),r=await vn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(nn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Qu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nn(this.app))return Promise.reject(rr(this));const n=e?Be(e):null;return n&&ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nn(this.app)?Promise.reject(rr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nn(this.app)?Promise.reject(rr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(er(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await E4(this),n=new x4(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ri("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await y4(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&er(e)||this._popupRedirectResolver;ie(n,this,"argument-error"),this.redirectPersistenceManager=await Bi.create(this,[er(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ie(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&ZL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function hs(t){return Be(t)}class Jv{constructor(e){this.auth=e,this.observer=null,this.addObserver=qD(n=>this.observer=n)}get next(){return ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function S4(t){Oc=t}function Hx(t){return Oc.loadJS(t)}function C4(){return Oc.recaptchaEnterpriseScript}function A4(){return Oc.gapiScript}function N4(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class R4{constructor(){this.enterprise=new P4}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class P4{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const k4="recaptcha-enterprise",$x="NO_RECAPTCHA";class b4{constructor(e){this.type=k4,this.auth=hs(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{u4(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new l4(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Hv(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o($x)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new R4().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Hv(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=C4();l.length!==0&&(l+=a),Hx(l).then(()=>{s(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Yv(t,e,n,r=!1,s=!1){const i=new b4(t);let o;if(s)o=$x;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Xu(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Yv(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Yv(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(t,e){const n=po(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ts(i,e??{}))return s;xn(s,"already-initialized")}return n.initialize({options:e})}function D4(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(er);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function L4(t,e,n){const r=hs(t);ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=zx(e),{host:o,port:a}=V4(e),l=a===null?"":`:${a}`,u={url:`${i}//${o}${l}/`},p=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ie(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ie(ts(u,r.config.emulator)&&ts(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,ho(o)?(_x(`${i}//${o}${l}`),wx("Auth",!0)):U4()}function zx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function V4(t){const e=zx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Qv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Qv(o)}}}function Qv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function U4(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Zn("not implemented")}_getIdTokenResponse(e){return Zn("not implemented")}_linkToIdToken(e,n){return Zn("not implemented")}_getReauthenticationResolver(e){return Zn("not implemented")}}async function F4(t,e){return _r(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O4(t,e){return sl(t,"POST","/v1/accounts:signInWithPassword",vr(t,e))}async function q4(t,e){return _r(t,"POST","/v1/accounts:sendOobCode",vr(t,e))}async function B4(t,e){return q4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t,e){return sl(t,"POST","/v1/accounts:signInWithEmailLink",vr(t,e))}async function G4(t,e){return sl(t,"POST","/v1/accounts:signInWithEmailLink",vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba extends lm{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ba(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ba(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xu(e,n,"signInWithPassword",O4);case"emailLink":return j4(e,{email:this._email,oobCode:this._password});default:xn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xu(e,r,"signUpPassword",F4);case"emailLink":return G4(e,{idToken:n,email:this._email,oobCode:this._password});default:xn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ji(t,e){return sl(t,"POST","/v1/accounts:signInWithIdp",vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4="http://localhost";class Ws extends lm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ws(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):xn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ws(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ji(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ji(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ji(e,n)}buildRequest(){const e={requestUri:H4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=nl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $4(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function z4(t){const e=ea(ta(t)).link,n=e?ea(ta(e)).deep_link_id:null,r=ea(ta(t)).deep_link_id;return(r?ea(ta(r)).link:null)||r||n||e||t}class um{constructor(e){const n=ea(ta(e)),r=n.apiKey??null,s=n.oobCode??null,i=$4(n.mode??null);ie(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=z4(e);try{return new um(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(){this.providerId=go.PROVIDER_ID}static credential(e,n){return Ba._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=um.parseLink(n);return ie(r,"argument-error"),Ba._fromEmailAndCode(e,r.code,r.tenantId)}}go.PROVIDER_ID="password";go.EMAIL_PASSWORD_SIGN_IN_METHOD="password";go.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il extends Wx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr extends il{constructor(){super("facebook.com")}static credential(e){return Ws._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mr.credential(e.oauthAccessToken)}catch{return null}}}Mr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends il{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ws._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Dr.credential(n,r)}catch{return null}}}Dr.GOOGLE_SIGN_IN_METHOD="google.com";Dr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr extends il{constructor(){super("github.com")}static credential(e){return Ws._fromParams({providerId:Lr.PROVIDER_ID,signInMethod:Lr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lr.credentialFromTaggedObject(e)}static credentialFromError(e){return Lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lr.credential(e.oauthAccessToken)}catch{return null}}}Lr.GITHUB_SIGN_IN_METHOD="github.com";Lr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr extends il{constructor(){super("twitter.com")}static credential(e,n){return Ws._fromParams({providerId:Vr.PROVIDER_ID,signInMethod:Vr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Vr.credentialFromTaggedObject(e)}static credentialFromError(e){return Vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Vr.credential(n,r)}catch{return null}}}Vr.TWITTER_SIGN_IN_METHOD="twitter.com";Vr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W4(t,e){return sl(t,"POST","/v1/accounts:signUp",vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await vn._fromIdTokenResponse(e,r,s),o=Xv(r);return new Ks({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Xv(r);return new Ks({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Xv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends $n{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Zu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Zu(e,n,r,s)}}function Kx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Zu._fromErrorAndOperation(t,i,e,r):i})}async function K4(t,e,n=!1){const r=await qa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ks._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(t,e,n=!1){const{auth:r}=t;if(nn(r.app))return Promise.reject(rr(r));const s="reauthenticate";try{const i=await qa(t,Kx(r,s,e,t),n);ie(i.idToken,r,"internal-error");const o=om(i.idToken);ie(o,r,"internal-error");const{sub:a}=o;return ie(t.uid===a,r,"user-mismatch"),Ks._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&xn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jx(t,e,n=!1){if(nn(t.app))return Promise.reject(rr(t));const r="signIn",s=await Kx(t,r,e),i=await Ks._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Y4(t,e){return Jx(hs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yx(t){const e=hs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Qx(t,e,n){const r=hs(t);await Xu(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",B4)}async function Xx(t,e,n){if(nn(t.app))return Promise.reject(rr(t));const r=hs(t),o=await Xu(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",W4).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Yx(t),l}),a=await Ks._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function Zx(t,e,n){return nn(t.app)?Promise.reject(rr(t)):Y4(Be(t),go.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yx(t),r})}function Q4(t,e,n,r){return Be(t).onIdTokenChanged(e,n,r)}function X4(t,e,n){return Be(t).beforeAuthStateChanged(e,n)}function eI(t,e,n,r){return Be(t).onAuthStateChanged(e,n,r)}function Gi(t){return Be(t).signOut()}const ec="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ec,"1"),this.storage.removeItem(ec),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4=1e3,e5=10;class nI extends tI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);_4()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,e5):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Z4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}nI.type="LOCAL";const t5=nI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI extends tI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}rI.type="SESSION";const sI=rI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new qc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(n.origin,i)),l=await n5(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=cm("",20);s.port1.start();const p=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(p),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return window}function s5(t){Fn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(){return typeof Fn().WorkerGlobalScope<"u"&&typeof Fn().importScripts=="function"}async function i5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function o5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function a5(){return iI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="firebaseLocalStorageDb",l5=1,tc="firebaseLocalStorage",aI="fbase_key";class ol{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Bc(t,e){return t.transaction([tc],e?"readwrite":"readonly").objectStore(tc)}function u5(){const t=indexedDB.deleteDatabase(oI);return new ol(t).toPromise()}function Ph(){const t=indexedDB.open(oI,l5);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(tc,{keyPath:aI})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(tc)?e(r):(r.close(),await u5(),e(await Ph()))})})}async function Zv(t,e,n){const r=Bc(t,!0).put({[aI]:e,value:n});return new ol(r).toPromise()}async function c5(t,e){const n=Bc(t,!1).get(e),r=await new ol(n).toPromise();return r===void 0?null:r.value}function e_(t,e){const n=Bc(t,!0).delete(e);return new ol(n).toPromise()}const d5=800,f5=3;class lI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ph(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>f5)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return iI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qc._getInstance(a5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await i5(),!this.activeServiceWorker)return;this.sender=new r5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||o5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ph();return await Zv(e,ec,"1"),await e_(e,ec),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Zv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>c5(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>e_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Bc(s,!1).getAll();return new ol(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),d5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lI.type="LOCAL";const h5=lI;new rl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t,e){return e?er(e):(ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm extends lm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ji(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ji(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ji(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function m5(t){return Jx(t.auth,new dm(t),t.bypassAuthState)}function g5(t){const{auth:e,user:n}=t;return ie(n,e,"internal-error"),J4(n,new dm(t),t.bypassAuthState)}async function y5(t){const{auth:e,user:n}=t;return ie(n,e,"internal-error"),K4(n,new dm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return m5;case"linkViaPopup":case"linkViaRedirect":return y5;case"reauthViaPopup":case"reauthViaRedirect":return g5;default:xn(this.auth,"internal-error")}}resolve(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=new rl(2e3,1e4);class Pi extends uI{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Pi.currentPopupAction&&Pi.currentPopupAction.cancel(),Pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ie(e,this.auth,"internal-error"),e}async onExecution(){dr(this.filter.length===1,"Popup operations only handle one event");const e=cm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Un(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Un(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,v5.get())};e()}}Pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5="pendingRedirect",cu=new Map;class w5 extends uI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=cu.get(this.auth._key());if(!e){try{const r=await E5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}cu.set(this.auth._key(),e)}return this.bypassAuthState||cu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function E5(t,e){const n=I5(e),r=x5(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function T5(t,e){cu.set(t._key(),e)}function x5(t){return er(t._redirectPersistence)}function I5(t){return uu(_5,t.config.apiKey,t.name)}async function S5(t,e,n=!1){if(nn(t.app))return Promise.reject(rr(t));const r=hs(t),s=p5(r,e),o=await new w5(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C5=10*60*1e3;class A5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!N5(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!cI(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Un(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C5&&this.cachedEventUids.clear(),this.cachedEventUids.has(t_(e))}saveEventToCache(e){this.cachedEventUids.add(t_(e)),this.lastProcessedEventTime=Date.now()}}function t_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function N5(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R5(t,e={}){return _r(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k5=/^https?/;async function b5(t){if(t.config.emulator)return;const{authorizedDomains:e}=await R5(t);for(const n of e)try{if(M5(n))return}catch{}xn(t,"unauthorized-domain")}function M5(t){const e=Nh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!k5.test(n))return!1;if(P5.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5=new rl(3e4,6e4);function n_(){const t=Fn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function L5(t){return new Promise((e,n)=>{var s,i,o;function r(){n_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{n_(),n(Un(t,"network-request-failed"))},timeout:D5.get()})}if((i=(s=Fn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Fn().gapi)!=null&&o.load)r();else{const a=N4("iframefcb");return Fn()[a]=()=>{gapi.load?r():n(Un(t,"network-request-failed"))},Hx(`${A4()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw du=null,e})}let du=null;function V5(t){return du=du||L5(t),du}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5=new rl(5e3,15e3),F5="__/auth/iframe",O5="emulator/auth/iframe",q5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},B5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function j5(t){const e=t.config;ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?im(e,O5):`https://${t.config.authDomain}/${F5}`,r={apiKey:e.apiKey,appName:t.name,v:mo},s=B5.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${nl(r).slice(1)}`}async function G5(t){const e=await V5(t),n=Fn().gapi;return ie(n,t,"internal-error"),e.open({where:document.body,url:j5(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:q5,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Un(t,"network-request-failed"),a=Fn().setTimeout(()=>{i(o)},U5.get());function l(){Fn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$5=500,z5=600,W5="_blank",K5="http://localhost";class r_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function J5(t,e,n,r=$5,s=z5){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...H5,width:r.toString(),height:s.toString(),top:i,left:o},u=St().toLowerCase();n&&(a=Ux(u)?W5:n),Lx(u)&&(e=e||K5,l.scrollbars="yes");const p=Object.entries(l).reduce((g,[_,T])=>`${g}${_}=${T},`,"");if(v4(u)&&a!=="_self")return Y5(e||"",a),new r_(null);const m=window.open(e||"",a,p);ie(m,t,"popup-blocked");try{m.focus()}catch{}return new r_(m)}function Y5(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5="__/auth/handler",X5="emulator/auth/handler",Z5=encodeURIComponent("fac");async function s_(t,e,n,r,s,i){ie(t.config.authDomain,t,"auth-domain-config-required"),ie(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:mo,eventId:s};if(e instanceof Wx){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",OD(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof il){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const p of Object.keys(a))a[p]===void 0&&delete a[p];const l=await t._getAppCheckToken(),u=l?`#${Z5}=${encodeURIComponent(l)}`:"";return`${eV(t)}?${nl(a).slice(1)}${u}`}function eV({config:t}){return t.emulator?im(t,X5):`https://${t.authDomain}/${Q5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af="webStorageSupport";class tV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sI,this._completeRedirectFn=S5,this._overrideRedirectResult=T5}async _openPopup(e,n,r,s){var o;dr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await s_(e,n,r,Nh(),s);return J5(e,i,cm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await s_(e,n,r,Nh(),s);return s5(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(dr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await G5(e),r=new A5(e);return n.register("authEvent",s=>(ie(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(af,{type:af},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[af];i!==void 0&&n(!!i),xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=b5(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jx()||Vx()||am()}}const nV=tV;var i_="@firebase/auth",o_="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iV(t){Gn(new Tn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ie(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gx(t)},u=new I4(r,s,i,l);return D4(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Gn(new Tn("auth-internal",e=>{const n=hs(e.getProvider("auth").getImmediate());return(r=>new rV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ln(i_,o_,sV(t)),ln(i_,o_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=5*60,aV=vx("authIdTokenMaxAge")||oV;let a_=null;const lV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>aV)return;const s=n==null?void 0:n.token;a_!==s&&(a_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function dI(t=rm()){const e=po(t,"auth");if(e.isInitialized())return e.getImmediate();const n=M4(t,{popupRedirectResolver:nV,persistence:[h5,t5,sI]}),r=vx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=lV(i.toString());X4(n,o,()=>o(n.currentUser)),Q4(n,a=>o(a))}}const s=gx("auth");return s&&L4(n,`http://${s}`),n}function uV(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}S4({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Un("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",uV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});iV("Browser");var l_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yr,fI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,E){function N(){}N.prototype=E.prototype,w.F=E.prototype,w.prototype=new N,w.prototype.constructor=w,w.D=function(b,k,M){for(var P=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)P[fe-2]=arguments[fe];return E.prototype[k].apply(b,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,E,N){N||(N=0);const b=Array(16);if(typeof E=="string")for(var k=0;k<16;++k)b[k]=E.charCodeAt(N++)|E.charCodeAt(N++)<<8|E.charCodeAt(N++)<<16|E.charCodeAt(N++)<<24;else for(k=0;k<16;++k)b[k]=E[N++]|E[N++]<<8|E[N++]<<16|E[N++]<<24;E=w.g[0],N=w.g[1],k=w.g[2];let M=w.g[3],P;P=E+(M^N&(k^M))+b[0]+3614090360&4294967295,E=N+(P<<7&4294967295|P>>>25),P=M+(k^E&(N^k))+b[1]+3905402710&4294967295,M=E+(P<<12&4294967295|P>>>20),P=k+(N^M&(E^N))+b[2]+606105819&4294967295,k=M+(P<<17&4294967295|P>>>15),P=N+(E^k&(M^E))+b[3]+3250441966&4294967295,N=k+(P<<22&4294967295|P>>>10),P=E+(M^N&(k^M))+b[4]+4118548399&4294967295,E=N+(P<<7&4294967295|P>>>25),P=M+(k^E&(N^k))+b[5]+1200080426&4294967295,M=E+(P<<12&4294967295|P>>>20),P=k+(N^M&(E^N))+b[6]+2821735955&4294967295,k=M+(P<<17&4294967295|P>>>15),P=N+(E^k&(M^E))+b[7]+4249261313&4294967295,N=k+(P<<22&4294967295|P>>>10),P=E+(M^N&(k^M))+b[8]+1770035416&4294967295,E=N+(P<<7&4294967295|P>>>25),P=M+(k^E&(N^k))+b[9]+2336552879&4294967295,M=E+(P<<12&4294967295|P>>>20),P=k+(N^M&(E^N))+b[10]+4294925233&4294967295,k=M+(P<<17&4294967295|P>>>15),P=N+(E^k&(M^E))+b[11]+2304563134&4294967295,N=k+(P<<22&4294967295|P>>>10),P=E+(M^N&(k^M))+b[12]+1804603682&4294967295,E=N+(P<<7&4294967295|P>>>25),P=M+(k^E&(N^k))+b[13]+4254626195&4294967295,M=E+(P<<12&4294967295|P>>>20),P=k+(N^M&(E^N))+b[14]+2792965006&4294967295,k=M+(P<<17&4294967295|P>>>15),P=N+(E^k&(M^E))+b[15]+1236535329&4294967295,N=k+(P<<22&4294967295|P>>>10),P=E+(k^M&(N^k))+b[1]+4129170786&4294967295,E=N+(P<<5&4294967295|P>>>27),P=M+(N^k&(E^N))+b[6]+3225465664&4294967295,M=E+(P<<9&4294967295|P>>>23),P=k+(E^N&(M^E))+b[11]+643717713&4294967295,k=M+(P<<14&4294967295|P>>>18),P=N+(M^E&(k^M))+b[0]+3921069994&4294967295,N=k+(P<<20&4294967295|P>>>12),P=E+(k^M&(N^k))+b[5]+3593408605&4294967295,E=N+(P<<5&4294967295|P>>>27),P=M+(N^k&(E^N))+b[10]+38016083&4294967295,M=E+(P<<9&4294967295|P>>>23),P=k+(E^N&(M^E))+b[15]+3634488961&4294967295,k=M+(P<<14&4294967295|P>>>18),P=N+(M^E&(k^M))+b[4]+3889429448&4294967295,N=k+(P<<20&4294967295|P>>>12),P=E+(k^M&(N^k))+b[9]+568446438&4294967295,E=N+(P<<5&4294967295|P>>>27),P=M+(N^k&(E^N))+b[14]+3275163606&4294967295,M=E+(P<<9&4294967295|P>>>23),P=k+(E^N&(M^E))+b[3]+4107603335&4294967295,k=M+(P<<14&4294967295|P>>>18),P=N+(M^E&(k^M))+b[8]+1163531501&4294967295,N=k+(P<<20&4294967295|P>>>12),P=E+(k^M&(N^k))+b[13]+2850285829&4294967295,E=N+(P<<5&4294967295|P>>>27),P=M+(N^k&(E^N))+b[2]+4243563512&4294967295,M=E+(P<<9&4294967295|P>>>23),P=k+(E^N&(M^E))+b[7]+1735328473&4294967295,k=M+(P<<14&4294967295|P>>>18),P=N+(M^E&(k^M))+b[12]+2368359562&4294967295,N=k+(P<<20&4294967295|P>>>12),P=E+(N^k^M)+b[5]+4294588738&4294967295,E=N+(P<<4&4294967295|P>>>28),P=M+(E^N^k)+b[8]+2272392833&4294967295,M=E+(P<<11&4294967295|P>>>21),P=k+(M^E^N)+b[11]+1839030562&4294967295,k=M+(P<<16&4294967295|P>>>16),P=N+(k^M^E)+b[14]+4259657740&4294967295,N=k+(P<<23&4294967295|P>>>9),P=E+(N^k^M)+b[1]+2763975236&4294967295,E=N+(P<<4&4294967295|P>>>28),P=M+(E^N^k)+b[4]+1272893353&4294967295,M=E+(P<<11&4294967295|P>>>21),P=k+(M^E^N)+b[7]+4139469664&4294967295,k=M+(P<<16&4294967295|P>>>16),P=N+(k^M^E)+b[10]+3200236656&4294967295,N=k+(P<<23&4294967295|P>>>9),P=E+(N^k^M)+b[13]+681279174&4294967295,E=N+(P<<4&4294967295|P>>>28),P=M+(E^N^k)+b[0]+3936430074&4294967295,M=E+(P<<11&4294967295|P>>>21),P=k+(M^E^N)+b[3]+3572445317&4294967295,k=M+(P<<16&4294967295|P>>>16),P=N+(k^M^E)+b[6]+76029189&4294967295,N=k+(P<<23&4294967295|P>>>9),P=E+(N^k^M)+b[9]+3654602809&4294967295,E=N+(P<<4&4294967295|P>>>28),P=M+(E^N^k)+b[12]+3873151461&4294967295,M=E+(P<<11&4294967295|P>>>21),P=k+(M^E^N)+b[15]+530742520&4294967295,k=M+(P<<16&4294967295|P>>>16),P=N+(k^M^E)+b[2]+3299628645&4294967295,N=k+(P<<23&4294967295|P>>>9),P=E+(k^(N|~M))+b[0]+4096336452&4294967295,E=N+(P<<6&4294967295|P>>>26),P=M+(N^(E|~k))+b[7]+1126891415&4294967295,M=E+(P<<10&4294967295|P>>>22),P=k+(E^(M|~N))+b[14]+2878612391&4294967295,k=M+(P<<15&4294967295|P>>>17),P=N+(M^(k|~E))+b[5]+4237533241&4294967295,N=k+(P<<21&4294967295|P>>>11),P=E+(k^(N|~M))+b[12]+1700485571&4294967295,E=N+(P<<6&4294967295|P>>>26),P=M+(N^(E|~k))+b[3]+2399980690&4294967295,M=E+(P<<10&4294967295|P>>>22),P=k+(E^(M|~N))+b[10]+4293915773&4294967295,k=M+(P<<15&4294967295|P>>>17),P=N+(M^(k|~E))+b[1]+2240044497&4294967295,N=k+(P<<21&4294967295|P>>>11),P=E+(k^(N|~M))+b[8]+1873313359&4294967295,E=N+(P<<6&4294967295|P>>>26),P=M+(N^(E|~k))+b[15]+4264355552&4294967295,M=E+(P<<10&4294967295|P>>>22),P=k+(E^(M|~N))+b[6]+2734768916&4294967295,k=M+(P<<15&4294967295|P>>>17),P=N+(M^(k|~E))+b[13]+1309151649&4294967295,N=k+(P<<21&4294967295|P>>>11),P=E+(k^(N|~M))+b[4]+4149444226&4294967295,E=N+(P<<6&4294967295|P>>>26),P=M+(N^(E|~k))+b[11]+3174756917&4294967295,M=E+(P<<10&4294967295|P>>>22),P=k+(E^(M|~N))+b[2]+718787259&4294967295,k=M+(P<<15&4294967295|P>>>17),P=N+(M^(k|~E))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+E&4294967295,w.g[1]=w.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,w.g[2]=w.g[2]+k&4294967295,w.g[3]=w.g[3]+M&4294967295}r.prototype.v=function(w,E){E===void 0&&(E=w.length);const N=E-this.blockSize,b=this.C;let k=this.h,M=0;for(;M<E;){if(k==0)for(;M<=N;)s(this,w,M),M+=this.blockSize;if(typeof w=="string"){for(;M<E;)if(b[k++]=w.charCodeAt(M++),k==this.blockSize){s(this,b),k=0;break}}else for(;M<E;)if(b[k++]=w[M++],k==this.blockSize){s(this,b),k=0;break}}this.h=k,this.o+=E},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var E=1;E<w.length-8;++E)w[E]=0;E=this.o*8;for(var N=w.length-8;N<w.length;++N)w[N]=E&255,E/=256;for(this.v(w),w=Array(16),E=0,N=0;N<4;++N)for(let b=0;b<32;b+=8)w[E++]=this.g[N]>>>b&255;return w};function i(w,E){var N=a;return Object.prototype.hasOwnProperty.call(N,w)?N[w]:N[w]=E(w)}function o(w,E){this.h=E;const N=[];let b=!0;for(let k=w.length-1;k>=0;k--){const M=w[k]|0;b&&M==E||(N[k]=M,b=!1)}this.g=N}var a={};function l(w){return-128<=w&&w<128?i(w,function(E){return new o([E|0],E<0?-1:0)}):new o([w|0],w<0?-1:0)}function u(w){if(isNaN(w)||!isFinite(w))return m;if(w<0)return x(u(-w));const E=[];let N=1;for(let b=0;w>=N;b++)E[b]=w/N|0,N*=4294967296;return new o(E,0)}function p(w,E){if(w.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(w.charAt(0)=="-")return x(p(w.substring(1),E));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=u(Math.pow(E,8));let b=m;for(let M=0;M<w.length;M+=8){var k=Math.min(8,w.length-M);const P=parseInt(w.substring(M,M+k),E);k<8?(k=u(Math.pow(E,k)),b=b.j(k).add(u(P))):(b=b.j(N),b=b.add(u(P)))}return b}var m=l(0),g=l(1),_=l(16777216);t=o.prototype,t.m=function(){if(R(this))return-x(this).m();let w=0,E=1;for(let N=0;N<this.g.length;N++){const b=this.i(N);w+=(b>=0?b:4294967296+b)*E,E*=4294967296}return w},t.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(T(this))return"0";if(R(this))return"-"+x(this).toString(w);const E=u(Math.pow(w,6));var N=this;let b="";for(;;){const k=D(N,E).g;N=C(N,k.j(E));let M=((N.g.length>0?N.g[0]:N.h)>>>0).toString(w);if(N=k,T(N))return M+b;for(;M.length<6;)M="0"+M;b=M+b}},t.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function T(w){if(w.h!=0)return!1;for(let E=0;E<w.g.length;E++)if(w.g[E]!=0)return!1;return!0}function R(w){return w.h==-1}t.l=function(w){return w=C(this,w),R(w)?-1:T(w)?0:1};function x(w){const E=w.g.length,N=[];for(let b=0;b<E;b++)N[b]=~w.g[b];return new o(N,~w.h).add(g)}t.abs=function(){return R(this)?x(this):this},t.add=function(w){const E=Math.max(this.g.length,w.g.length),N=[];let b=0;for(let k=0;k<=E;k++){let M=b+(this.i(k)&65535)+(w.i(k)&65535),P=(M>>>16)+(this.i(k)>>>16)+(w.i(k)>>>16);b=P>>>16,M&=65535,P&=65535,N[k]=P<<16|M}return new o(N,N[N.length-1]&-2147483648?-1:0)};function C(w,E){return w.add(x(E))}t.j=function(w){if(T(this)||T(w))return m;if(R(this))return R(w)?x(this).j(x(w)):x(x(this).j(w));if(R(w))return x(this.j(x(w)));if(this.l(_)<0&&w.l(_)<0)return u(this.m()*w.m());const E=this.g.length+w.g.length,N=[];for(var b=0;b<2*E;b++)N[b]=0;for(b=0;b<this.g.length;b++)for(let k=0;k<w.g.length;k++){const M=this.i(b)>>>16,P=this.i(b)&65535,fe=w.i(k)>>>16,$e=w.i(k)&65535;N[2*b+2*k]+=P*$e,I(N,2*b+2*k),N[2*b+2*k+1]+=M*$e,I(N,2*b+2*k+1),N[2*b+2*k+1]+=P*fe,I(N,2*b+2*k+1),N[2*b+2*k+2]+=M*fe,I(N,2*b+2*k+2)}for(w=0;w<E;w++)N[w]=N[2*w+1]<<16|N[2*w];for(w=E;w<2*E;w++)N[w]=0;return new o(N,0)};function I(w,E){for(;(w[E]&65535)!=w[E];)w[E+1]+=w[E]>>>16,w[E]&=65535,E++}function A(w,E){this.g=w,this.h=E}function D(w,E){if(T(E))throw Error("division by zero");if(T(w))return new A(m,m);if(R(w))return E=D(x(w),E),new A(x(E.g),x(E.h));if(R(E))return E=D(w,x(E)),new A(x(E.g),E.h);if(w.g.length>30){if(R(w)||R(E))throw Error("slowDivide_ only works with positive integers.");for(var N=g,b=E;b.l(w)<=0;)N=U(N),b=U(b);var k=F(N,1),M=F(b,1);for(b=F(b,2),N=F(N,2);!T(b);){var P=M.add(b);P.l(w)<=0&&(k=k.add(N),M=P),b=F(b,1),N=F(N,1)}return E=C(w,k.j(E)),new A(k,E)}for(k=m;w.l(E)>=0;){for(N=Math.max(1,Math.floor(w.m()/E.m())),b=Math.ceil(Math.log(N)/Math.LN2),b=b<=48?1:Math.pow(2,b-48),M=u(N),P=M.j(E);R(P)||P.l(w)>0;)N-=b,M=u(N),P=M.j(E);T(M)&&(M=g),k=k.add(M),w=C(w,P)}return new A(k,w)}t.B=function(w){return D(this,w).h},t.and=function(w){const E=Math.max(this.g.length,w.g.length),N=[];for(let b=0;b<E;b++)N[b]=this.i(b)&w.i(b);return new o(N,this.h&w.h)},t.or=function(w){const E=Math.max(this.g.length,w.g.length),N=[];for(let b=0;b<E;b++)N[b]=this.i(b)|w.i(b);return new o(N,this.h|w.h)},t.xor=function(w){const E=Math.max(this.g.length,w.g.length),N=[];for(let b=0;b<E;b++)N[b]=this.i(b)^w.i(b);return new o(N,this.h^w.h)};function U(w){const E=w.g.length+1,N=[];for(let b=0;b<E;b++)N[b]=w.i(b)<<1|w.i(b-1)>>>31;return new o(N,w.h)}function F(w,E){const N=E>>5;E%=32;const b=w.g.length-N,k=[];for(let M=0;M<b;M++)k[M]=E>0?w.i(M+N)>>>E|w.i(M+N+1)<<32-E:w.i(M+N);return new o(k,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,fI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=p,Yr=o}).apply(typeof l_<"u"?l_:typeof self<"u"?self:typeof window<"u"?window:{});var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hI,na,pI,fu,kh,mI,gI,yI;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof jl=="object"&&jl];for(var y=0;y<d.length;++y){var v=d[y];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function s(d,y){if(y)e:{var v=r;d=d.split(".");for(var S=0;S<d.length-1;S++){var L=d[S];if(!(L in v))break e;v=v[L]}d=d[d.length-1],S=v[d],y=y(S),y!=S&&y!=null&&e(v,d,{configurable:!0,writable:!0,value:y})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(y){var v=[],S;for(S in y)Object.prototype.hasOwnProperty.call(y,S)&&v.push([S,y[S]]);return v}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function l(d,y,v){return d.call.apply(d.bind,arguments)}function u(d,y,v){return u=l,u.apply(null,arguments)}function p(d,y){var v=Array.prototype.slice.call(arguments,1);return function(){var S=v.slice();return S.push.apply(S,arguments),d.apply(this,S)}}function m(d,y){function v(){}v.prototype=y.prototype,d.Z=y.prototype,d.prototype=new v,d.prototype.constructor=d,d.Ob=function(S,L,q){for(var Y=Array(arguments.length-2),de=2;de<arguments.length;de++)Y[de-2]=arguments[de];return y.prototype[L].apply(S,Y)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function _(d){const y=d.length;if(y>0){const v=Array(y);for(let S=0;S<y;S++)v[S]=d[S];return v}return[]}function T(d,y){for(let S=1;S<arguments.length;S++){const L=arguments[S];var v=typeof L;if(v=v!="object"?v:L?Array.isArray(L)?"array":v:"null",v=="array"||v=="object"&&typeof L.length=="number"){v=d.length||0;const q=L.length||0;d.length=v+q;for(let Y=0;Y<q;Y++)d[v+Y]=L[Y]}else d.push(L)}}class R{constructor(y,v){this.i=y,this.j=v,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function x(d){o.setTimeout(()=>{throw d},0)}function C(){var d=w;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class I{constructor(){this.h=this.g=null}add(y,v){const S=A.get();S.set(y,v),this.h?this.h.next=S:this.g=S,this.h=S}}var A=new R(()=>new D,d=>d.reset());class D{constructor(){this.next=this.g=this.h=null}set(y,v){this.h=y,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let U,F=!1,w=new I,E=()=>{const d=Promise.resolve(void 0);U=()=>{d.then(N)}};function N(){for(var d;d=C();){try{d.h.call(d.g)}catch(v){x(v)}var y=A;y.j(d),y.h<100&&(y.h++,d.next=y.g,y.g=d)}F=!1}function b(){this.u=this.u,this.C=this.C}b.prototype.u=!1,b.prototype.dispose=function(){this.u||(this.u=!0,this.N())},b.prototype[Symbol.dispose]=function(){this.dispose()},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const v=()=>{};o.addEventListener("test",v,y),o.removeEventListener("test",v,y)}catch{}return d}();function P(d){return/^[\s\xa0]*$/.test(d)}function fe(d,y){k.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,y)}m(fe,k),fe.prototype.init=function(d,y){const v=this.type=d.type,S=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget,y||(v=="mouseover"?y=d.fromElement:v=="mouseout"&&(y=d.toElement)),this.relatedTarget=y,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&fe.Z.h.call(this)},fe.prototype.h=function(){fe.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var $e="closure_listenable_"+(Math.random()*1e6|0),je=0;function Bt(d,y,v,S,L){this.listener=d,this.proxy=null,this.src=y,this.type=v,this.capture=!!S,this.ha=L,this.key=++je,this.da=this.fa=!1}function Q(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function se(d,y,v){for(const S in d)y.call(v,d[S],S,d)}function ue(d,y){for(const v in d)y.call(void 0,d[v],v,d)}function xe(d){const y={};for(const v in d)y[v]=d[v];return y}const Ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fn(d,y){let v,S;for(let L=1;L<arguments.length;L++){S=arguments[L];for(v in S)d[v]=S[v];for(let q=0;q<Ae.length;q++)v=Ae[q],Object.prototype.hasOwnProperty.call(S,v)&&(d[v]=S[v])}}function pt(d){this.src=d,this.g={},this.h=0}pt.prototype.add=function(d,y,v,S,L){const q=d.toString();d=this.g[q],d||(d=this.g[q]=[],this.h++);const Y=Ct(d,y,S,L);return Y>-1?(y=d[Y],v||(y.fa=!1)):(y=new Bt(y,this.src,q,!!S,L),y.fa=v,d.push(y)),y};function hn(d,y){const v=y.type;if(v in d.g){var S=d.g[v],L=Array.prototype.indexOf.call(S,y,void 0),q;(q=L>=0)&&Array.prototype.splice.call(S,L,1),q&&(Q(y),d.g[v].length==0&&(delete d.g[v],d.h--))}}function Ct(d,y,v,S){for(let L=0;L<d.length;++L){const q=d[L];if(!q.da&&q.listener==y&&q.capture==!!v&&q.ha==S)return L}return-1}var Zt="closure_lm_"+(Math.random()*1e6|0),gs={};function ai(d,y,v,S,L){if(Array.isArray(y)){for(let q=0;q<y.length;q++)ai(d,y[q],v,S,L);return null}return v=O(v),d&&d[$e]?d.J(y,v,a(S)?!!S.capture:!1,L):xo(d,y,v,!1,S,L)}function xo(d,y,v,S,L,q){if(!y)throw Error("Invalid event type");const Y=a(L)?!!L.capture:!!L;let de=vs(d);if(de||(d[Zt]=de=new pt(d)),v=de.add(y,v,S,Y,q),v.proxy)return v;if(S=Io(),v.proxy=S,S.src=d,S.listener=v,d.addEventListener)M||(L=Y),L===void 0&&(L=!1),d.addEventListener(y.toString(),S,L);else if(d.attachEvent)d.attachEvent(li(y.toString()),S);else if(d.addListener&&d.removeListener)d.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Io(){function d(v){return y.call(d.src,d.listener,v)}const y=So;return d}function wr(d,y,v,S,L){if(Array.isArray(y))for(var q=0;q<y.length;q++)wr(d,y[q],v,S,L);else S=a(S)?!!S.capture:!!S,v=O(v),d&&d[$e]?(d=d.i,q=String(y).toString(),q in d.g&&(y=d.g[q],v=Ct(y,v,S,L),v>-1&&(Q(y[v]),Array.prototype.splice.call(y,v,1),y.length==0&&(delete d.g[q],d.h--)))):d&&(d=vs(d))&&(y=d.g[y.toString()],d=-1,y&&(d=Ct(y,v,S,L)),(v=d>-1?y[d]:null)&&ys(v))}function ys(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[$e])hn(y.i,d);else{var v=d.type,S=d.proxy;y.removeEventListener?y.removeEventListener(v,S,d.capture):y.detachEvent?y.detachEvent(li(v),S):y.addListener&&y.removeListener&&y.removeListener(S),(v=vs(y))?(hn(v,d),v.h==0&&(v.src=null,y[Zt]=null)):Q(d)}}}function li(d){return d in gs?gs[d]:gs[d]="on"+d}function So(d,y){if(d.da)d=!0;else{y=new fe(y,this);const v=d.listener,S=d.ha||d.src;d.fa&&ys(d),d=v.call(S,y)}return d}function vs(d){return d=d[Zt],d instanceof pt?d:null}var _s="__closure_events_fn_"+(Math.random()*1e9>>>0);function O(d){return typeof d=="function"?d:(d[_s]||(d[_s]=function(y){return d.handleEvent(y)}),d[_s])}function H(){b.call(this),this.i=new pt(this),this.M=this,this.G=null}m(H,b),H.prototype[$e]=!0,H.prototype.removeEventListener=function(d,y,v,S){wr(this,d,y,v,S)};function B(d,y){var v,S=d.G;if(S)for(v=[];S;S=S.G)v.push(S);if(d=d.M,S=y.type||y,typeof y=="string")y=new k(y,d);else if(y instanceof k)y.target=y.target||d;else{var L=y;y=new k(S,d),fn(y,L)}L=!0;let q,Y;if(v)for(Y=v.length-1;Y>=0;Y--)q=y.g=v[Y],L=j(q,S,!0,y)&&L;if(q=y.g=d,L=j(q,S,!0,y)&&L,L=j(q,S,!1,y)&&L,v)for(Y=0;Y<v.length;Y++)q=y.g=v[Y],L=j(q,S,!1,y)&&L}H.prototype.N=function(){if(H.Z.N.call(this),this.i){var d=this.i;for(const y in d.g){const v=d.g[y];for(let S=0;S<v.length;S++)Q(v[S]);delete d.g[y],d.h--}}this.G=null},H.prototype.J=function(d,y,v,S){return this.i.add(String(d),y,!1,v,S)},H.prototype.K=function(d,y,v,S){return this.i.add(String(d),y,!0,v,S)};function j(d,y,v,S){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();let L=!0;for(let q=0;q<y.length;++q){const Y=y[q];if(Y&&!Y.da&&Y.capture==v){const de=Y.listener,Qe=Y.ha||Y.src;Y.fa&&hn(d.i,Y),L=de.call(Qe,S)!==!1&&L}}return L&&!S.defaultPrevented}function J(d,y){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=u(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:o.setTimeout(d,y||0)}function W(d){d.g=J(()=>{d.g=null,d.i&&(d.i=!1,W(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class z extends b{constructor(y,v){super(),this.m=y,this.l=v,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:W(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(d){b.call(this),this.h=d,this.g={}}m(ne,b);var ae=[];function _e(d){se(d.g,function(y,v){this.g.hasOwnProperty(v)&&ys(y)},d),d.g={}}ne.prototype.N=function(){ne.Z.N.call(this),_e(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jt=o.JSON.stringify,CC=o.JSON.parse,AC=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function ag(){}function lg(){}var Co={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function dd(){k.call(this,"d")}m(dd,k);function fd(){k.call(this,"c")}m(fd,k);var ws={},ug=null;function hl(){return ug=ug||new H}ws.Ia="serverreachability";function cg(d){k.call(this,ws.Ia,d)}m(cg,k);function Ao(d){const y=hl();B(y,new cg(y))}ws.STAT_EVENT="statevent";function dg(d,y){k.call(this,ws.STAT_EVENT,d),this.stat=y}m(dg,k);function At(d){const y=hl();B(y,new dg(y,d))}ws.Ja="timingevent";function fg(d,y){k.call(this,ws.Ja,d),this.size=y}m(fg,k);function No(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},y)}function Ro(){this.g=!0}Ro.prototype.ua=function(){this.g=!1};function NC(d,y,v,S,L,q){d.info(function(){if(d.g)if(q){var Y="",de=q.split("&");for(let Ie=0;Ie<de.length;Ie++){var Qe=de[Ie].split("=");if(Qe.length>1){const st=Qe[0];Qe=Qe[1];const An=st.split("_");Y=An.length>=2&&An[1]=="type"?Y+(st+"="+Qe+"&"):Y+(st+"=redacted&")}}}else Y=null;else Y=q;return"XMLHTTP REQ ("+S+") [attempt "+L+"]: "+y+`
`+v+`
`+Y})}function RC(d,y,v,S,L,q,Y){d.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+L+"]: "+y+`
`+v+`
`+q+" "+Y})}function ui(d,y,v,S){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+kC(d,v)+(S?" "+S:"")})}function PC(d,y){d.info(function(){return"TIMEOUT: "+y})}Ro.prototype.info=function(){};function kC(d,y){if(!d.g)return y;if(!y)return null;try{const q=JSON.parse(y);if(q){for(d=0;d<q.length;d++)if(Array.isArray(q[d])){var v=q[d];if(!(v.length<2)){var S=v[1];if(Array.isArray(S)&&!(S.length<1)){var L=S[0];if(L!="noop"&&L!="stop"&&L!="close")for(let Y=1;Y<S.length;Y++)S[Y]=""}}}}return jt(q)}catch{return y}}var pl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},hg={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},pg;function hd(){}m(hd,ag),hd.prototype.g=function(){return new XMLHttpRequest},pg=new hd;function Po(d){return encodeURIComponent(String(d))}function bC(d){var y=1;d=d.split(":");const v=[];for(;y>0&&d.length;)v.push(d.shift()),y--;return d.length&&v.push(d.join(":")),v}function Er(d,y,v,S){this.j=d,this.i=y,this.l=v,this.S=S||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new mg}function mg(){this.i=null,this.g="",this.h=!1}var gg={},pd={};function md(d,y,v){d.M=1,d.A=gl(Cn(y)),d.u=v,d.R=!0,yg(d,null)}function yg(d,y){d.F=Date.now(),ml(d),d.B=Cn(d.A);var v=d.B,S=d.S;Array.isArray(S)||(S=[String(S)]),Pg(v.i,"t",S),d.C=0,v=d.j.L,d.h=new mg,d.g=Kg(d.j,v?y:null,!d.u),d.P>0&&(d.O=new z(u(d.Y,d,d.g),d.P)),y=d.V,v=d.g,S=d.ba;var L="readystatechange";Array.isArray(L)||(L&&(ae[0]=L.toString()),L=ae);for(let q=0;q<L.length;q++){const Y=ai(v,L[q],S||y.handleEvent,!1,y.h||y);if(!Y)break;y.g[Y.key]=Y}y=d.J?xe(d.J):{},d.u?(d.v||(d.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,y)):(d.v="GET",d.g.ea(d.B,d.v,null,y)),Ao(),NC(d.i,d.v,d.B,d.l,d.S,d.u)}Er.prototype.ba=function(d){d=d.target;const y=this.O;y&&Ir(d)==3?y.j():this.Y(d)},Er.prototype.Y=function(d){try{if(d==this.g)e:{const de=Ir(this.g),Qe=this.g.ya(),Ie=this.g.ca();if(!(de<3)&&(de!=3||this.g&&(this.h.h||this.g.la()||Ug(this.g)))){this.K||de!=4||Qe==7||(Qe==8||Ie<=0?Ao(3):Ao(2)),gd(this);var y=this.g.ca();this.X=y;var v=MC(this);if(this.o=y==200,RC(this.i,this.v,this.B,this.l,this.S,de,y),this.o){if(this.U&&!this.L){t:{if(this.g){var S,L=this.g;if((S=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(S)){var q=S;break t}}q=null}if(d=q)ui(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,yd(this,d);else{this.o=!1,this.m=3,At(12),Es(this),ko(this);break e}}if(this.R){d=!0;let st;for(;!this.K&&this.C<v.length;)if(st=DC(this,v),st==pd){de==4&&(this.m=4,At(14),d=!1),ui(this.i,this.l,null,"[Incomplete Response]");break}else if(st==gg){this.m=4,At(15),ui(this.i,this.l,v,"[Invalid Chunk]"),d=!1;break}else ui(this.i,this.l,st,null),yd(this,st);if(vg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),de!=4||v.length!=0||this.h.h||(this.m=1,At(16),d=!1),this.o=this.o&&d,!d)ui(this.i,this.l,v,"[Invalid Chunked Response]"),Es(this),ko(this);else if(v.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+v.length),Sd(Y),Y.P=!0,At(11))}}else ui(this.i,this.l,v,null),yd(this,v);de==4&&Es(this),this.o&&!this.K&&(de==4?Hg(this.j,this):(this.o=!1,ml(this)))}else KC(this.g),y==400&&v.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),Es(this),ko(this)}}}catch{}finally{}};function MC(d){if(!vg(d))return d.g.la();const y=Ug(d.g);if(y==="")return"";let v="";const S=y.length,L=Ir(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Es(d),ko(d),"";d.h.i=new o.TextDecoder}for(let q=0;q<S;q++)d.h.h=!0,v+=d.h.i.decode(y[q],{stream:!(L&&q==S-1)});return y.length=0,d.h.g+=v,d.C=0,d.h.g}function vg(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function DC(d,y){var v=d.C,S=y.indexOf(`
`,v);return S==-1?pd:(v=Number(y.substring(v,S)),isNaN(v)?gg:(S+=1,S+v>y.length?pd:(y=y.slice(S,S+v),d.C=S+v,y)))}Er.prototype.cancel=function(){this.K=!0,Es(this)};function ml(d){d.T=Date.now()+d.H,_g(d,d.H)}function _g(d,y){if(d.D!=null)throw Error("WatchDog timer not null");d.D=No(u(d.aa,d),y)}function gd(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Er.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(PC(this.i,this.B),this.M!=2&&(Ao(),At(17)),Es(this),this.m=2,ko(this)):_g(this,this.T-d)};function ko(d){d.j.I==0||d.K||Hg(d.j,d)}function Es(d){gd(d);var y=d.O;y&&typeof y.dispose=="function"&&y.dispose(),d.O=null,_e(d.V),d.g&&(y=d.g,d.g=null,y.abort(),y.dispose())}function yd(d,y){try{var v=d.j;if(v.I!=0&&(v.g==d||vd(v.h,d))){if(!d.L&&vd(v.h,d)&&v.I==3){try{var S=v.Ba.g.parse(y)}catch{S=null}if(Array.isArray(S)&&S.length==3){var L=S;if(L[0]==0){e:if(!v.v){if(v.g)if(v.g.F+3e3<d.F)El(v),_l(v);else break e;Id(v),At(18)}}else v.xa=L[1],0<v.xa-v.K&&L[2]<37500&&v.F&&v.A==0&&!v.C&&(v.C=No(u(v.Va,v),6e3));Tg(v.h)<=1&&v.ta&&(v.ta=void 0)}else xs(v,11)}else if((d.L||v.g==d)&&El(v),!P(y))for(L=v.Ba.g.parse(y),y=0;y<L.length;y++){let Ie=L[y];const st=Ie[0];if(!(st<=v.K))if(v.K=st,Ie=Ie[1],v.I==2)if(Ie[0]=="c"){v.M=Ie[1],v.ba=Ie[2];const An=Ie[3];An!=null&&(v.ka=An,v.j.info("VER="+v.ka));const Is=Ie[4];Is!=null&&(v.za=Is,v.j.info("SVER="+v.za));const Sr=Ie[5];Sr!=null&&typeof Sr=="number"&&Sr>0&&(S=1.5*Sr,v.O=S,v.j.info("backChannelRequestTimeoutMs_="+S)),S=v;const Cr=d.g;if(Cr){const xl=Cr.g?Cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xl){var q=S.h;q.g||xl.indexOf("spdy")==-1&&xl.indexOf("quic")==-1&&xl.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(_d(q,q.h),q.h=null))}if(S.G){const Cd=Cr.g?Cr.g.getResponseHeader("X-HTTP-Session-Id"):null;Cd&&(S.wa=Cd,Ne(S.J,S.G,Cd))}}v.I=3,v.l&&v.l.ra(),v.aa&&(v.T=Date.now()-d.F,v.j.info("Handshake RTT: "+v.T+"ms")),S=v;var Y=d;if(S.na=Wg(S,S.L?S.ba:null,S.W),Y.L){xg(S.h,Y);var de=Y,Qe=S.O;Qe&&(de.H=Qe),de.D&&(gd(de),ml(de)),S.g=Y}else jg(S);v.i.length>0&&wl(v)}else Ie[0]!="stop"&&Ie[0]!="close"||xs(v,7);else v.I==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?xs(v,7):xd(v):Ie[0]!="noop"&&v.l&&v.l.qa(Ie),v.A=0)}}Ao(4)}catch{}}var LC=class{constructor(d,y){this.g=d,this.map=y}};function wg(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Eg(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Tg(d){return d.h?1:d.g?d.g.size:0}function vd(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function _d(d,y){d.g?d.g.add(y):d.h=y}function xg(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}wg.prototype.cancel=function(){if(this.i=Ig(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Ig(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const v of d.g.values())y=y.concat(v.G);return y}return _(d.i)}var Sg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function VC(d,y){if(d){d=d.split("&");for(let v=0;v<d.length;v++){const S=d[v].indexOf("=");let L,q=null;S>=0?(L=d[v].substring(0,S),q=d[v].substring(S+1)):L=d[v],y(L,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Tr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;d instanceof Tr?(this.l=d.l,bo(this,d.j),this.o=d.o,this.g=d.g,Mo(this,d.u),this.h=d.h,wd(this,kg(d.i)),this.m=d.m):d&&(y=String(d).match(Sg))?(this.l=!1,bo(this,y[1]||"",!0),this.o=Do(y[2]||""),this.g=Do(y[3]||"",!0),Mo(this,y[4]),this.h=Do(y[5]||"",!0),wd(this,y[6]||"",!0),this.m=Do(y[7]||"")):(this.l=!1,this.i=new Vo(null,this.l))}Tr.prototype.toString=function(){const d=[];var y=this.j;y&&d.push(Lo(y,Cg,!0),":");var v=this.g;return(v||y=="file")&&(d.push("//"),(y=this.o)&&d.push(Lo(y,Cg,!0),"@"),d.push(Po(v).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.u,v!=null&&d.push(":",String(v))),(v=this.h)&&(this.g&&v.charAt(0)!="/"&&d.push("/"),d.push(Lo(v,v.charAt(0)=="/"?OC:FC,!0))),(v=this.i.toString())&&d.push("?",v),(v=this.m)&&d.push("#",Lo(v,BC)),d.join("")},Tr.prototype.resolve=function(d){const y=Cn(this);let v=!!d.j;v?bo(y,d.j):v=!!d.o,v?y.o=d.o:v=!!d.g,v?y.g=d.g:v=d.u!=null;var S=d.h;if(v)Mo(y,d.u);else if(v=!!d.h){if(S.charAt(0)!="/")if(this.g&&!this.h)S="/"+S;else{var L=y.h.lastIndexOf("/");L!=-1&&(S=y.h.slice(0,L+1)+S)}if(L=S,L==".."||L==".")S="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){S=L.lastIndexOf("/",0)==0,L=L.split("/");const q=[];for(let Y=0;Y<L.length;){const de=L[Y++];de=="."?S&&Y==L.length&&q.push(""):de==".."?((q.length>1||q.length==1&&q[0]!="")&&q.pop(),S&&Y==L.length&&q.push("")):(q.push(de),S=!0)}S=q.join("/")}else S=L}return v?y.h=S:v=d.i.toString()!=="",v?wd(y,kg(d.i)):v=!!d.m,v&&(y.m=d.m),y};function Cn(d){return new Tr(d)}function bo(d,y,v){d.j=v?Do(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function Mo(d,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);d.u=y}else d.u=null}function wd(d,y,v){y instanceof Vo?(d.i=y,jC(d.i,d.l)):(v||(y=Lo(y,qC)),d.i=new Vo(y,d.l))}function Ne(d,y,v){d.i.set(y,v)}function gl(d){return Ne(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Do(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Lo(d,y,v){return typeof d=="string"?(d=encodeURI(d).replace(y,UC),v&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function UC(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Cg=/[#\/\?@]/g,FC=/[#\?:]/g,OC=/[#\?]/g,qC=/[#\?@]/g,BC=/#/g;function Vo(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function Ts(d){d.g||(d.g=new Map,d.h=0,d.i&&VC(d.i,function(y,v){d.add(decodeURIComponent(y.replace(/\+/g," ")),v)}))}t=Vo.prototype,t.add=function(d,y){Ts(this),this.i=null,d=ci(this,d);let v=this.g.get(d);return v||this.g.set(d,v=[]),v.push(y),this.h+=1,this};function Ag(d,y){Ts(d),y=ci(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function Ng(d,y){return Ts(d),y=ci(d,y),d.g.has(y)}t.forEach=function(d,y){Ts(this),this.g.forEach(function(v,S){v.forEach(function(L){d.call(y,L,S,this)},this)},this)};function Rg(d,y){Ts(d);let v=[];if(typeof y=="string")Ng(d,y)&&(v=v.concat(d.g.get(ci(d,y))));else for(d=Array.from(d.g.values()),y=0;y<d.length;y++)v=v.concat(d[y]);return v}t.set=function(d,y){return Ts(this),this.i=null,d=ci(this,d),Ng(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},t.get=function(d,y){return d?(d=Rg(this,d),d.length>0?String(d[0]):y):y};function Pg(d,y,v){Ag(d,y),v.length>0&&(d.i=null,d.g.set(ci(d,y),_(v)),d.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(let S=0;S<y.length;S++){var v=y[S];const L=Po(v);v=Rg(this,v);for(let q=0;q<v.length;q++){let Y=L;v[q]!==""&&(Y+="="+Po(v[q])),d.push(Y)}}return this.i=d.join("&")};function kg(d){const y=new Vo;return y.i=d.i,d.g&&(y.g=new Map(d.g),y.h=d.h),y}function ci(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function jC(d,y){y&&!d.j&&(Ts(d),d.i=null,d.g.forEach(function(v,S){const L=S.toLowerCase();S!=L&&(Ag(this,S),Pg(this,L,v))},d)),d.j=y}function GC(d,y){const v=new Ro;if(o.Image){const S=new Image;S.onload=p(xr,v,"TestLoadImage: loaded",!0,y,S),S.onerror=p(xr,v,"TestLoadImage: error",!1,y,S),S.onabort=p(xr,v,"TestLoadImage: abort",!1,y,S),S.ontimeout=p(xr,v,"TestLoadImage: timeout",!1,y,S),o.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=d}else y(!1)}function HC(d,y){const v=new Ro,S=new AbortController,L=setTimeout(()=>{S.abort(),xr(v,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:S.signal}).then(q=>{clearTimeout(L),q.ok?xr(v,"TestPingServer: ok",!0,y):xr(v,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(L),xr(v,"TestPingServer: error",!1,y)})}function xr(d,y,v,S,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),S(v)}catch{}}function $C(){this.g=new AC}function Ed(d){this.i=d.Sb||null,this.h=d.ab||!1}m(Ed,ag),Ed.prototype.g=function(){return new yl(this.i,this.h)};function yl(d,y){H.call(this),this.H=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(yl,H),t=yl.prototype,t.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=y,this.readyState=1,Fo(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(y.body=d),(this.H||o).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Uo(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Fo(this)),this.g&&(this.readyState=3,Fo(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bg(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function bg(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?Uo(this):Fo(this),this.readyState==3&&bg(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,Uo(this))},t.Na=function(d){this.g&&(this.response=d,Uo(this))},t.ga=function(){this.g&&Uo(this)};function Uo(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Fo(d)}t.setRequestHeader=function(d,y){this.A.append(d,y)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var v=y.next();!v.done;)v=v.value,d.push(v[0]+": "+v[1]),v=y.next();return d.join(`\r
`)};function Fo(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(yl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Mg(d){let y="";return se(d,function(v,S){y+=S,y+=":",y+=v,y+=`\r
`}),y}function Td(d,y,v){e:{for(S in v){var S=!1;break e}S=!0}S||(v=Mg(v),typeof d=="string"?v!=null&&Po(v):Ne(d,y,v))}function Fe(d){H.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Fe,H);var zC=/^https?$/i,WC=["POST","PUT"];t=Fe.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,y,v,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():pg.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(q){Dg(this,q);return}if(d=v||"",v=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var L in S)v.set(L,S[L]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const q of S.keys())v.set(q,S.get(q));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(v.keys()).find(q=>q.toLowerCase()=="content-type"),L=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(WC,y,void 0)>=0)||S||L||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,Y]of v)this.g.setRequestHeader(q,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(q){Dg(this,q)}};function Dg(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.o=5,Lg(d),vl(d)}function Lg(d){d.A||(d.A=!0,B(d,"complete"),B(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,B(this,"complete"),B(this,"abort"),vl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vl(this,!0)),Fe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Vg(this):this.Xa())},t.Xa=function(){Vg(this)};function Vg(d){if(d.h&&typeof i<"u"){if(d.v&&Ir(d)==4)setTimeout(d.Ca.bind(d),0);else if(B(d,"readystatechange"),Ir(d)==4){d.h=!1;try{const q=d.ca();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var v;if(!(v=y)){var S;if(S=q===0){let Y=String(d.D).match(Sg)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),S=!zC.test(Y?Y.toLowerCase():"")}v=S}if(v)B(d,"complete"),B(d,"success");else{d.o=6;try{var L=Ir(d)>2?d.g.statusText:""}catch{L=""}d.l=L+" ["+d.ca()+"]",Lg(d)}}finally{vl(d)}}}}function vl(d,y){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const v=d.g;d.g=null,y||B(d,"ready");try{v.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ir(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Ir(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),CC(y)}};function Ug(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function KC(d){const y={};d=(d.g&&Ir(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<d.length;S++){if(P(d[S]))continue;var v=bC(d[S]);const L=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const q=y[L]||[];y[L]=q,q.push(v)}ue(y,function(S){return S.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oo(d,y,v){return v&&v.internalChannelParams&&v.internalChannelParams[d]||y}function Fg(d){this.za=0,this.i=[],this.j=new Ro,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Oo("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Oo("baseRetryDelayMs",5e3,d),this.Za=Oo("retryDelaySeedMs",1e4,d),this.Ta=Oo("forwardChannelMaxRetries",2,d),this.va=Oo("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new wg(d&&d.concurrentRequestLimit),this.Ba=new $C,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Fg.prototype,t.ka=8,t.I=1,t.connect=function(d,y,v,S){At(0),this.W=d,this.H=y||{},v&&S!==void 0&&(this.H.OSID=v,this.H.OAID=S),this.F=this.X,this.J=Wg(this,null,this.W),wl(this)};function xd(d){if(Og(d),d.I==3){var y=d.V++,v=Cn(d.J);if(Ne(v,"SID",d.M),Ne(v,"RID",y),Ne(v,"TYPE","terminate"),qo(d,v),y=new Er(d,d.j,y),y.M=2,y.A=gl(Cn(v)),v=!1,o.navigator&&o.navigator.sendBeacon)try{v=o.navigator.sendBeacon(y.A.toString(),"")}catch{}!v&&o.Image&&(new Image().src=y.A,v=!0),v||(y.g=Kg(y.j,null),y.g.ea(y.A)),y.F=Date.now(),ml(y)}zg(d)}function _l(d){d.g&&(Sd(d),d.g.cancel(),d.g=null)}function Og(d){_l(d),d.v&&(o.clearTimeout(d.v),d.v=null),El(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function wl(d){if(!Eg(d.h)&&!d.m){d.m=!0;var y=d.Ea;U||E(),F||(U(),F=!0),w.add(y,d),d.D=0}}function JC(d,y){return Tg(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=y.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=No(u(d.Ea,d,y),$g(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const L=new Er(this,this.j,d);let q=this.o;if(this.U&&(q?(q=xe(q),fn(q,this.U)):q=this.U),this.u!==null||this.R||(L.J=q,q=null),this.S)e:{for(var y=0,v=0;v<this.i.length;v++){t:{var S=this.i[v];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(y+=S,y>4096){y=v;break e}if(y===4096||v===this.i.length-1){y=v+1;break e}}y=1e3}else y=1e3;y=Bg(this,L,y),v=Cn(this.J),Ne(v,"RID",d),Ne(v,"CVER",22),this.G&&Ne(v,"X-HTTP-Session-Id",this.G),qo(this,v),q&&(this.R?y="headers="+Po(Mg(q))+"&"+y:this.u&&Td(v,this.u,q)),_d(this.h,L),this.Ra&&Ne(v,"TYPE","init"),this.S?(Ne(v,"$req",y),Ne(v,"SID","null"),L.U=!0,md(L,v,null)):md(L,v,y),this.I=2}}else this.I==3&&(d?qg(this,d):this.i.length==0||Eg(this.h)||qg(this))};function qg(d,y){var v;y?v=y.l:v=d.V++;const S=Cn(d.J);Ne(S,"SID",d.M),Ne(S,"RID",v),Ne(S,"AID",d.K),qo(d,S),d.u&&d.o&&Td(S,d.u,d.o),v=new Er(d,d.j,v,d.D+1),d.u===null&&(v.J=d.o),y&&(d.i=y.G.concat(d.i)),y=Bg(d,v,1e3),v.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),_d(d.h,v),md(v,S,y)}function qo(d,y){d.H&&se(d.H,function(v,S){Ne(y,S,v)}),d.l&&se({},function(v,S){Ne(y,S,v)})}function Bg(d,y,v){v=Math.min(d.i.length,v);const S=d.l?u(d.l.Ka,d.l,d):null;e:{var L=d.i;let de=-1;for(;;){const Qe=["count="+v];de==-1?v>0?(de=L[0].g,Qe.push("ofs="+de)):de=0:Qe.push("ofs="+de);let Ie=!0;for(let st=0;st<v;st++){var q=L[st].g;const An=L[st].map;if(q-=de,q<0)de=Math.max(0,L[st].g-100),Ie=!1;else try{q="req"+q+"_"||"";try{var Y=An instanceof Map?An:Object.entries(An);for(const[Is,Sr]of Y){let Cr=Sr;a(Sr)&&(Cr=jt(Sr)),Qe.push(q+Is+"="+encodeURIComponent(Cr))}}catch(Is){throw Qe.push(q+"type="+encodeURIComponent("_badmap")),Is}}catch{S&&S(An)}}if(Ie){Y=Qe.join("&");break e}}Y=void 0}return d=d.i.splice(0,v),y.G=d,Y}function jg(d){if(!d.g&&!d.v){d.Y=1;var y=d.Da;U||E(),F||(U(),F=!0),w.add(y,d),d.A=0}}function Id(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=No(u(d.Da,d),$g(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,Gg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=No(u(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),_l(this),Gg(this))};function Sd(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function Gg(d){d.g=new Er(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var y=Cn(d.na);Ne(y,"RID","rpc"),Ne(y,"SID",d.M),Ne(y,"AID",d.K),Ne(y,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ne(y,"TO",d.ia),Ne(y,"TYPE","xmlhttp"),qo(d,y),d.u&&d.o&&Td(y,d.u,d.o),d.O&&(d.g.H=d.O);var v=d.g;d=d.ba,v.M=1,v.A=gl(Cn(y)),v.u=null,v.R=!0,yg(v,d)}t.Va=function(){this.C!=null&&(this.C=null,_l(this),Id(this),At(19))};function El(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function Hg(d,y){var v=null;if(d.g==y){El(d),Sd(d),d.g=null;var S=2}else if(vd(d.h,y))v=y.G,xg(d.h,y),S=1;else return;if(d.I!=0){if(y.o)if(S==1){v=y.u?y.u.length:0,y=Date.now()-y.F;var L=d.D;S=hl(),B(S,new fg(S,v)),wl(d)}else jg(d);else if(L=y.m,L==3||L==0&&y.X>0||!(S==1&&JC(d,y)||S==2&&Id(d)))switch(v&&v.length>0&&(y=d.h,y.i=y.i.concat(v)),L){case 1:xs(d,5);break;case 4:xs(d,10);break;case 3:xs(d,6);break;default:xs(d,2)}}}function $g(d,y){let v=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(v*=2),v*y}function xs(d,y){if(d.j.info("Error code "+y),y==2){var v=u(d.bb,d),S=d.Ua;const L=!S;S=new Tr(S||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||bo(S,"https"),gl(S),L?GC(S.toString(),v):HC(S.toString(),v)}else At(2);d.I=0,d.l&&d.l.pa(y),zg(d),Og(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function zg(d){if(d.I=0,d.ja=[],d.l){const y=Ig(d.h);(y.length!=0||d.i.length!=0)&&(T(d.ja,y),T(d.ja,d.i),d.h.i.length=0,_(d.i),d.i.length=0),d.l.oa()}}function Wg(d,y,v){var S=v instanceof Tr?Cn(v):new Tr(v);if(S.g!="")y&&(S.g=y+"."+S.g),Mo(S,S.u);else{var L=o.location;S=L.protocol,y=y?y+"."+L.hostname:L.hostname,L=+L.port;const q=new Tr(null);S&&bo(q,S),y&&(q.g=y),L&&Mo(q,L),v&&(q.h=v),S=q}return v=d.G,y=d.wa,v&&y&&Ne(S,v,y),Ne(S,"VER",d.ka),qo(d,S),S}function Kg(d,y,v){if(y&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Aa&&!d.ma?new Fe(new Ed({ab:v})):new Fe(d.ma),y.Fa(d.L),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Jg(){}t=Jg.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Tl(){}Tl.prototype.g=function(d,y){return new Gt(d,y)};function Gt(d,y){H.call(this),this.g=new Fg(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(d?d["X-WebChannel-Client-Profile"]=y.sa:d={"X-WebChannel-Client-Profile":y.sa}),this.g.U=d,(d=y&&y.Qb)&&!P(d)&&(this.g.u=d),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!P(y)&&(this.g.G=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new di(this)}m(Gt,H),Gt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gt.prototype.close=function(){xd(this.g)},Gt.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var v={};v.__data__=d,d=v}else this.v&&(v={},v.__data__=jt(d),d=v);y.i.push(new LC(y.Ya++,d)),y.I==3&&wl(y)},Gt.prototype.N=function(){this.g.l=null,delete this.j,xd(this.g),delete this.g,Gt.Z.N.call(this)};function Yg(d){dd.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const v in y){d=v;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}m(Yg,dd);function Qg(){fd.call(this),this.status=1}m(Qg,fd);function di(d){this.g=d}m(di,Jg),di.prototype.ra=function(){B(this.g,"a")},di.prototype.qa=function(d){B(this.g,new Yg(d))},di.prototype.pa=function(d){B(this.g,new Qg)},di.prototype.oa=function(){B(this.g,"b")},Tl.prototype.createWebChannel=Tl.prototype.g,Gt.prototype.send=Gt.prototype.o,Gt.prototype.open=Gt.prototype.m,Gt.prototype.close=Gt.prototype.close,yI=function(){return new Tl},gI=function(){return hl()},mI=ws,kh={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pl.NO_ERROR=0,pl.TIMEOUT=8,pl.HTTP_ERROR=6,fu=pl,hg.COMPLETE="complete",pI=hg,lg.EventType=Co,Co.OPEN="a",Co.CLOSE="b",Co.ERROR="c",Co.MESSAGE="d",H.prototype.listen=H.prototype.J,na=lg,Fe.prototype.listenOnce=Fe.prototype.K,Fe.prototype.getLastError=Fe.prototype.Ha,Fe.prototype.getLastErrorCode=Fe.prototype.ya,Fe.prototype.getStatus=Fe.prototype.ca,Fe.prototype.getResponseJson=Fe.prototype.La,Fe.prototype.getResponseText=Fe.prototype.la,Fe.prototype.send=Fe.prototype.ea,Fe.prototype.setWithCredentials=Fe.prototype.Fa,hI=Fe}).apply(typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{});const u_="@firebase/firestore",c_="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vt.UNAUTHENTICATED=new vt(null),vt.GOOGLE_CREDENTIALS=new vt("google-credentials-uid"),vt.FIRST_PARTY=new vt("first-party-uid"),vt.MOCK_USER=new vt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yo="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new em("@firebase/firestore");function hi(){return Js.logLevel}function ee(t,...e){if(Js.logLevel<=pe.DEBUG){const n=e.map(fm);Js.debug(`Firestore (${yo}): ${t}`,...n)}}function fr(t,...e){if(Js.logLevel<=pe.ERROR){const n=e.map(fm);Js.error(`Firestore (${yo}): ${t}`,...n)}}function Zi(t,...e){if(Js.logLevel<=pe.WARN){const n=e.map(fm);Js.warn(`Firestore (${yo}): ${t}`,...n)}}function fm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,vI(t,r,n)}function vI(t,e,n){let r=`FIRESTORE (${yo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw fr(r),new Error(r)}function Ee(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||vI(e,s,r)}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends $n{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(vt.UNAUTHENTICATED))}shutdown(){}}class dV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class fV{constructor(e){this.t=e,this.currentUser=vt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ee(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new sr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new sr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new sr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ee(typeof r.accessToken=="string",31837,{l:r}),new _I(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ee(e===null||typeof e=="string",2055,{h:e}),new vt(e)}}class hV{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=vt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class pV{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new hV(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(vt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class d_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mV{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,nn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ee(this.o===void 0,3512);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new d_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ee(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new d_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=gV(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function me(t,e){return t<e?-1:t>e?1:0}function bh(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return lf(s)===lf(i)?me(s,i):lf(s)?1:-1}return me(t.length,e.length)}const yV=55296,vV=57343;function lf(t){const e=t.charCodeAt(0);return e>=yV&&e<=vV}function eo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_="__name__";class Pn{constructor(e,n,r){n===void 0?n=0:n>e.length&&oe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&oe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Pn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Pn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return me(e.length,n.length)}static compareSegments(e,n){const r=Pn.isNumericId(e),s=Pn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Pn.extractNumericId(e).compare(Pn.extractNumericId(n)):bh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Yr.fromString(e.substring(4,e.length-2))}}class Se extends Pn{construct(e,n,r){return new Se(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(G.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Se(n)}static emptyPath(){return new Se([])}}const _V=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Pn{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return _V.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===f_}static keyField(){return new ct([f_])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Z(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Z(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Z(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Z(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.path=e}static fromPath(e){return new re(Se.fromString(e))}static fromName(e){return new re(Se.fromString(e).popFirst(5))}static empty(){return new re(Se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Se.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new Se(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(t,e,n){if(!n)throw new Z(G.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function wV(t,e,n,r){if(e===!0&&r===!0)throw new Z(G.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function h_(t){if(!re.isDocumentKey(t))throw new Z(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function p_(t){if(re.isDocumentKey(t))throw new Z(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function EI(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function jc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe(12329,{type:typeof t})}function qt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jc(t);throw new Z(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t,e){const n={typeString:t};return e&&(n.value=e),n}function al(t,e){if(!EI(t))throw new Z(G.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Z(G.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=-62135596800,g_=1e6;class ke{static now(){return ke.fromMillis(Date.now())}static fromDate(e){return ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*g_);return new ke(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<m_)throw new Z(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/g_}_compareTo(e){return this.seconds===e.seconds?me(this.nanoseconds,e.nanoseconds):me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ke._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(al(e,ke._jsonSchema))return new ke(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-m_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ke._jsonSchemaVersion="firestore/timestamp/1.0",ke._jsonSchema={type:Ye("string",ke._jsonSchemaVersion),seconds:Ye("number"),nanoseconds:Ye("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{static fromTimestamp(e){return new le(e)}static min(){return new le(new ke(0,0))}static max(){return new le(new ke(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=-1;function EV(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=le.fromTimestamp(r===1e9?new ke(n+1,0):new ke(n,r));return new ns(s,re.empty(),e)}function TV(t){return new ns(t.readTime,t.key,ja)}class ns{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ns(le.min(),re.empty(),ja)}static max(){return new ns(le.max(),re.empty(),ja)}}function xV(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=re.comparator(t.documentKey,e.documentKey),n!==0?n:me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class SV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(t){if(t.code!==G.FAILED_PRECONDITION||t.message!==IV)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const u=l;n(e[u]).next(p=>{o[u]=p,++a,a===i&&r(o)},p=>s(p))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function CV(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function _o(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Gc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm=-1;function Hc(t){return t==null}function nc(t){return t===0&&1/t==-1/0}function AV(t){return typeof t=="number"&&Number.isInteger(t)&&!nc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="";function NV(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=y_(e)),e=RV(t.get(n),e);return y_(e)}function RV(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case TI:n+="";break;default:n+=i}}return n}function y_(t){return t+TI+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ps(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||ut.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gl(this.root,e,this.comparator,!0)}}class Gl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ut{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ut.RED,this.left=s??ut.EMPTY,this.right=i??ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ut(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ut.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw oe(27949);return e+(this.isRed()?0:1)}}ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1;ut.EMPTY=new class{constructor(){this.size=0}get key(){throw oe(57766)}get value(){throw oe(16141)}get color(){throw oe(16727)}get left(){throw oe(29726)}get right(){throw oe(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ut(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new __(this.data.getIterator())}getIteratorFrom(e){return new __(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new rt(this.comparator);return n.data=e,n}}class __{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Kt([])}unionWith(e){let n=new rt(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Kt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return eo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new II("Invalid base64 string: "+i):i}}(e);return new ht(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ht(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const PV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rs(t){if(Ee(!!t,39018),typeof t=="string"){let e=0;const n=PV.exec(t);if(Ee(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ss(t){return typeof t=="string"?ht.fromBase64String(t):ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="server_timestamp",CI="__type__",AI="__previous_value__",NI="__local_write_time__";function mm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[CI])==null?void 0:r.stringValue)===SI}function $c(t){const e=t.mapValue.fields[AI];return mm(e)?$c(e):e}function Ga(t){const e=rs(t.mapValue.fields[NI].timestampValue);return new ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e,n,r,s,i,o,a,l,u,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=p}}const rc="(default)";class Ha{constructor(e,n){this.projectId=e,this.database=n||rc}static empty(){return new Ha("","")}get isDefaultDatabase(){return this.database===rc}isEqual(e){return e instanceof Ha&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="__type__",bV="__max__",Hl={mapValue:{}},PI="__vector__",sc="value";function is(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?mm(t)?4:DV(t)?9007199254740991:MV(t)?10:11:oe(28295,{value:t})}function Hn(t,e){if(t===e)return!0;const n=is(t);if(n!==is(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ga(t).isEqual(Ga(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=rs(s.timestampValue),a=rs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ss(s.bytesValue).isEqual(ss(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ge(s.geoPointValue.latitude)===Ge(i.geoPointValue.latitude)&&Ge(s.geoPointValue.longitude)===Ge(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ge(s.integerValue)===Ge(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ge(s.doubleValue),a=Ge(i.doubleValue);return o===a?nc(o)===nc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return eo(t.arrayValue.values||[],e.arrayValue.values||[],Hn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(v_(o)!==v_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Hn(o[l],a[l])))return!1;return!0}(t,e);default:return oe(52216,{left:t})}}function $a(t,e){return(t.values||[]).find(n=>Hn(n,e))!==void 0}function to(t,e){if(t===e)return 0;const n=is(t),r=is(e);if(n!==r)return me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return me(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ge(i.integerValue||i.doubleValue),l=Ge(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return w_(t.timestampValue,e.timestampValue);case 4:return w_(Ga(t),Ga(e));case 5:return bh(t.stringValue,e.stringValue);case 6:return function(i,o){const a=ss(i),l=ss(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const p=me(a[u],l[u]);if(p!==0)return p}return me(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=me(Ge(i.latitude),Ge(o.latitude));return a!==0?a:me(Ge(i.longitude),Ge(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return E_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,_,T,R;const a=i.fields||{},l=o.fields||{},u=(g=a[sc])==null?void 0:g.arrayValue,p=(_=l[sc])==null?void 0:_.arrayValue,m=me(((T=u==null?void 0:u.values)==null?void 0:T.length)||0,((R=p==null?void 0:p.values)==null?void 0:R.length)||0);return m!==0?m:E_(u,p)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Hl.mapValue&&o===Hl.mapValue)return 0;if(i===Hl.mapValue)return 1;if(o===Hl.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),u=o.fields||{},p=Object.keys(u);l.sort(),p.sort();for(let m=0;m<l.length&&m<p.length;++m){const g=bh(l[m],p[m]);if(g!==0)return g;const _=to(a[l[m]],u[p[m]]);if(_!==0)return _}return me(l.length,p.length)}(t.mapValue,e.mapValue);default:throw oe(23264,{he:n})}}function w_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return me(t,e);const n=rs(t),r=rs(e),s=me(n.seconds,r.seconds);return s!==0?s:me(n.nanos,r.nanos)}function E_(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=to(n[s],r[s]);if(i)return i}return me(n.length,r.length)}function no(t){return Mh(t)}function Mh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=rs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ss(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return re.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Mh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Mh(n.fields[o])}`;return s+"}"}(t.mapValue):oe(61005,{value:t})}function hu(t){switch(is(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$c(t);return e?16+hu(e):16;case 5:return 2*t.stringValue.length;case 6:return ss(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+hu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ps(r.fields,(i,o)=>{s+=i.length+hu(o)}),s}(t.mapValue);default:throw oe(13486,{value:t})}}function T_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Dh(t){return!!t&&"integerValue"in t}function gm(t){return!!t&&"arrayValue"in t}function x_(t){return!!t&&"nullValue"in t}function I_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function pu(t){return!!t&&"mapValue"in t}function MV(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[RI])==null?void 0:r.stringValue)===PI}function va(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ps(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=va(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=va(t.arrayValue.values[n]);return e}return{...t}}function DV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===bV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.value=e}static empty(){return new Lt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!pu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=va(n)}setAll(e){let n=ct.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=va(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());pu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Hn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];pu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ps(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Lt(va(this.value))}}function kI(t){const e=[];return ps(t.fields,(n,r)=>{const s=new ct([n]);if(pu(r)){const i=kI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Kt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Et(e,0,le.min(),le.min(),le.min(),Lt.empty(),0)}static newFoundDocument(e,n,r,s){return new Et(e,1,n,le.min(),r,s,0)}static newNoDocument(e,n){return new Et(e,2,n,le.min(),le.min(),Lt.empty(),0)}static newUnknownDocument(e,n){return new Et(e,3,n,le.min(),le.min(),Lt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n){this.position=e,this.inclusive=n}}function S_(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=re.comparator(re.fromName(o.referenceValue),n.key):r=to(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function C_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Hn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,n="asc"){this.field=e,this.dir=n}}function LV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{}class Je extends bI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new UV(e,n,r):n==="array-contains"?new qV(e,r):n==="in"?new BV(e,r):n==="not-in"?new jV(e,r):n==="array-contains-any"?new GV(e,r):new Je(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new FV(e,r):new OV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(to(n,this.value)):n!==null&&is(this.value)===is(n)&&this.matchesComparison(to(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends bI{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new In(e,n)}matches(e){return MI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function MI(t){return t.op==="and"}function DI(t){return VV(t)&&MI(t)}function VV(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function Lh(t){if(t instanceof Je)return t.field.canonicalString()+t.op.toString()+no(t.value);if(DI(t))return t.filters.map(e=>Lh(e)).join(",");{const e=t.filters.map(n=>Lh(n)).join(",");return`${t.op}(${e})`}}function LI(t,e){return t instanceof Je?function(r,s){return s instanceof Je&&r.op===s.op&&r.field.isEqual(s.field)&&Hn(r.value,s.value)}(t,e):t instanceof In?function(r,s){return s instanceof In&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&LI(o,s.filters[a]),!0):!1}(t,e):void oe(19439)}function VI(t){return t instanceof Je?function(n){return`${n.field.canonicalString()} ${n.op} ${no(n.value)}`}(t):t instanceof In?function(n){return n.op.toString()+" {"+n.getFilters().map(VI).join(" ,")+"}"}(t):"Filter"}class UV extends Je{constructor(e,n,r){super(e,n,r),this.key=re.fromName(r.referenceValue)}matches(e){const n=re.comparator(e.key,this.key);return this.matchesComparison(n)}}class FV extends Je{constructor(e,n){super(e,"in",n),this.keys=UI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class OV extends Je{constructor(e,n){super(e,"not-in",n),this.keys=UI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function UI(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>re.fromName(r.referenceValue))}class qV extends Je{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gm(n)&&$a(n.arrayValue,this.value)}}class BV extends Je{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&$a(this.value.arrayValue,n)}}class jV extends Je{constructor(e,n){super(e,"not-in",n)}matches(e){if($a(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!$a(this.value.arrayValue,n)}}class GV extends Je{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>$a(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function A_(t,e=null,n=[],r=[],s=null,i=null,o=null){return new HV(t,e,n,r,s,i,o)}function ym(t){const e=ce(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Lh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Hc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>no(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>no(r)).join(",")),e.Te=n}return e.Te}function vm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!LV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!LI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!C_(t.startAt,e.startAt)&&C_(t.endAt,e.endAt)}function Vh(t){return re.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function $V(t,e,n,r,s,i,o,a){return new ll(t,e,n,r,s,i,o,a)}function zc(t){return new ll(t)}function N_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function FI(t){return t.collectionGroup!==null}function _a(t){const e=ce(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new rt(ct.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new oc(i,r))}),n.has(ct.keyField().canonicalString())||e.Ie.push(new oc(ct.keyField(),r))}return e.Ie}function On(t){const e=ce(t);return e.Ee||(e.Ee=zV(e,_a(t))),e.Ee}function zV(t,e){if(t.limitType==="F")return A_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new oc(s.field,i)});const n=t.endAt?new ic(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ic(t.startAt.position,t.startAt.inclusive):null;return A_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Uh(t,e){const n=t.filters.concat([e]);return new ll(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Fh(t,e,n){return new ll(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wc(t,e){return vm(On(t),On(e))&&t.limitType===e.limitType}function OI(t){return`${ym(On(t))}|lt:${t.limitType}`}function pi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>VI(s)).join(", ")}]`),Hc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>no(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>no(s)).join(",")),`Target(${r})`}(On(t))}; limitType=${t.limitType})`}function Kc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):re.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of _a(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const u=S_(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,_a(r),s)||r.endAt&&!function(o,a,l){const u=S_(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,_a(r),s))}(t,e)}function WV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function qI(t){return(e,n)=>{let r=!1;for(const s of _a(t)){const i=KV(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function KV(t,e,n){const r=t.field.isKeyField()?re.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),u=a.data.field(i);return l!==null&&u!==null?to(l,u):oe(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return oe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ps(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return xI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JV=new Ue(re.comparator);function hr(){return JV}const BI=new Ue(re.comparator);function ra(...t){let e=BI;for(const n of t)e=e.insert(n.key,n);return e}function jI(t){let e=BI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ls(){return wa()}function GI(){return wa()}function wa(){return new si(t=>t.toString(),(t,e)=>t.isEqual(e))}const YV=new Ue(re.comparator),QV=new rt(re.comparator);function ge(...t){let e=QV;for(const n of t)e=e.add(n);return e}const XV=new rt(me);function ZV(){return XV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _m(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nc(e)?"-0":e}}function HI(t){return{integerValue:""+t}}function $I(t,e){return AV(e)?HI(e):_m(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(){this._=void 0}}function e3(t,e,n){return t instanceof za?function(s,i){const o={fields:{[CI]:{stringValue:SI},[NI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&mm(i)&&(i=$c(i)),i&&(o.fields[AI]=i),{mapValue:o}}(n,e):t instanceof ro?WI(t,e):t instanceof Wa?KI(t,e):function(s,i){const o=zI(s,i),a=R_(o)+R_(s.Ae);return Dh(o)&&Dh(s.Ae)?HI(a):_m(s.serializer,a)}(t,e)}function t3(t,e,n){return t instanceof ro?WI(t,e):t instanceof Wa?KI(t,e):n}function zI(t,e){return t instanceof Ka?function(r){return Dh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class za extends Jc{}class ro extends Jc{constructor(e){super(),this.elements=e}}function WI(t,e){const n=JI(e);for(const r of t.elements)n.some(s=>Hn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Wa extends Jc{constructor(e){super(),this.elements=e}}function KI(t,e){let n=JI(e);for(const r of t.elements)n=n.filter(s=>!Hn(s,r));return{arrayValue:{values:n}}}class Ka extends Jc{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function R_(t){return Ge(t.integerValue||t.doubleValue)}function JI(t){return gm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,n){this.field=e,this.transform=n}}function n3(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ro&&s instanceof ro||r instanceof Wa&&s instanceof Wa?eo(r.elements,s.elements,Hn):r instanceof Ka&&s instanceof Ka?Hn(r.Ae,s.Ae):r instanceof za&&s instanceof za}(t.transform,e.transform)}class r3{constructor(e,n){this.version=e,this.transformResults=n}}class un{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yc{}function YI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Em(t.key,un.none()):new ul(t.key,t.data,un.none());{const n=t.data,r=Lt.empty();let s=new rt(ct.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ms(t.key,r,new Kt(s.toArray()),un.none())}}function s3(t,e,n){t instanceof ul?function(s,i,o){const a=s.value.clone(),l=k_(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ms?function(s,i,o){if(!mu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=k_(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(QI(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ea(t,e,n,r){return t instanceof ul?function(i,o,a,l){if(!mu(i.precondition,o))return a;const u=i.value.clone(),p=b_(i.fieldTransforms,l,o);return u.setAll(p),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ms?function(i,o,a,l){if(!mu(i.precondition,o))return a;const u=b_(i.fieldTransforms,l,o),p=o.data;return p.setAll(QI(i)),p.setAll(u),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return mu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function i3(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=zI(r.transform,s||null);i!=null&&(n===null&&(n=Lt.empty()),n.set(r.field,i))}return n||null}function P_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&eo(r,s,(i,o)=>n3(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ul extends Yc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ms extends Yc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function QI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function k_(t,e,n){const r=new Map;Ee(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,t3(o,a,n[s]))}return r}function b_(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,e3(i,o,e))}return r}class Em extends Yc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o3 extends Yc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&s3(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ea(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ea(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=GI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=YI(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(le.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ge())}isEqual(e){return this.batchId===e.batchId&&eo(this.mutations,e.mutations,(n,r)=>P_(n,r))&&eo(this.baseMutations,e.baseMutations,(n,r)=>P_(n,r))}}class Tm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ee(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return YV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Tm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze,ye;function c3(t){switch(t){case G.OK:return oe(64938);case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0;default:return oe(15467,{code:t})}}function XI(t){if(t===void 0)return fr("GRPC error has no .code"),G.UNKNOWN;switch(t){case ze.OK:return G.OK;case ze.CANCELLED:return G.CANCELLED;case ze.UNKNOWN:return G.UNKNOWN;case ze.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case ze.INTERNAL:return G.INTERNAL;case ze.UNAVAILABLE:return G.UNAVAILABLE;case ze.UNAUTHENTICATED:return G.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case ze.NOT_FOUND:return G.NOT_FOUND;case ze.ALREADY_EXISTS:return G.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return G.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case ze.ABORTED:return G.ABORTED;case ze.OUT_OF_RANGE:return G.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return G.UNIMPLEMENTED;case ze.DATA_LOSS:return G.DATA_LOSS;default:return oe(39323,{code:t})}}(ye=ze||(ze={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=new Yr([4294967295,4294967295],0);function M_(t){const e=d3().encode(t),n=new fI;return n.update(e),new Uint8Array(n.digest())}function D_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Yr([n,r],0),new Yr([s,i],0)]}class xm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new sa(`Invalid padding: ${n}`);if(r<0)throw new sa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new sa(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Yr.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Yr.fromNumber(r)));return s.compare(f3)===1&&(s=new Yr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=M_(e),[r,s]=D_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new xm(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=M_(e),[r,s]=D_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class sa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,cl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qc(le.min(),s,new Ue(me),hr(),ge())}}class cl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new cl(r,n,ge(),ge(),ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class ZI{constructor(e,n){this.targetId=e,this.Ce=n}}class eS{constructor(e,n,r=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class L_{constructor(){this.ve=0,this.Fe=V_(),this.Me=ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ge(),n=ge(),r=ge();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:oe(38017,{changeType:i})}}),new cl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=V_()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ee(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class h3{constructor(e){this.Ge=e,this.ze=new Map,this.je=hr(),this.Je=$l(),this.He=$l(),this.Ye=new Ue(me)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:oe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Vh(i))if(r===0){const o=new re(i.path);this.et(n,o,Et.newNoDocument(o,le.min()))}else Ee(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=ss(r).toUint8Array()}catch(l){if(l instanceof II)return Zi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new xm(o,s,i)}catch(l){return Zi(l instanceof sa?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Vh(a.target)){const l=new re(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Et.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ge();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Qc(e,n,this.Ye,this.je,r);return this.je=hr(),this.Je=$l(),this.He=$l(),this.Ye=new Ue(me),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new L_,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new rt(me),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new rt(me),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new L_),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function $l(){return new Ue(re.comparator)}function V_(){return new Ue(re.comparator)}const p3={asc:"ASCENDING",desc:"DESCENDING"},m3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g3={and:"AND",or:"OR"};class y3{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Oh(t,e){return t.useProto3Json||Hc(e)?e:{value:e}}function ac(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function v3(t,e){return ac(t,e.toTimestamp())}function qn(t){return Ee(!!t,49232),le.fromTimestamp(function(n){const r=rs(n);return new ke(r.seconds,r.nanos)}(t))}function Im(t,e){return qh(t,e).canonicalString()}function qh(t,e){const n=function(s){return new Se(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function nS(t){const e=Se.fromString(t);return Ee(aS(e),10190,{key:e.toString()}),e}function Bh(t,e){return Im(t.databaseId,e.path)}function uf(t,e){const n=nS(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new re(sS(n))}function rS(t,e){return Im(t.databaseId,e)}function _3(t){const e=nS(t);return e.length===4?Se.emptyPath():sS(e)}function jh(t){return new Se(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sS(t){return Ee(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function U_(t,e,n){return{name:Bh(t,e),fields:n.value.mapValue.fields}}function w3(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:oe(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,p){return u.useProto3Json?(Ee(p===void 0||typeof p=="string",58123),ht.fromBase64String(p||"")):(Ee(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),ht.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const p=u.code===void 0?G.UNKNOWN:XI(u.code);return new Z(p,u.message||"")}(o);n=new eS(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=uf(t,r.document.name),i=qn(r.document.updateTime),o=r.document.createTime?qn(r.document.createTime):le.min(),a=new Lt({mapValue:{fields:r.document.fields}}),l=Et.newFoundDocument(s,i,o,a),u=r.targetIds||[],p=r.removedTargetIds||[];n=new gu(u,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=uf(t,r.document),i=r.readTime?qn(r.readTime):le.min(),o=Et.newNoDocument(s,i),a=r.removedTargetIds||[];n=new gu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=uf(t,r.document),i=r.removedTargetIds||[];n=new gu([],i,s,null)}else{if(!("filter"in e))return oe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new u3(s,i),a=r.targetId;n=new ZI(a,o)}}return n}function E3(t,e){let n;if(e instanceof ul)n={update:U_(t,e.key,e.value)};else if(e instanceof Em)n={delete:Bh(t,e.key)};else if(e instanceof ms)n={update:U_(t,e.key,e.data),updateMask:P3(e.fieldMask)};else{if(!(e instanceof o3))return oe(16599,{Vt:e.type});n={verify:Bh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof za)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ro)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Wa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ka)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw oe(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:v3(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:oe(27497)}(t,e.precondition)),n}function T3(t,e){return t&&t.length>0?(Ee(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?qn(s.updateTime):qn(i);return o.isEqual(le.min())&&(o=qn(i)),new r3(o,s.transformResults||[])}(n,e))):[]}function x3(t,e){return{documents:[rS(t,e.path)]}}function I3(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=rS(t,s);const i=function(u){if(u.length!==0)return oS(In.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(p=>function(g){return{field:mi(g.field),direction:A3(g.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Oh(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:s}}function S3(t){let e=_3(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ee(r===1,65062);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(m){const g=iS(m);return g instanceof In&&DI(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(T){return new oc(gi(T.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,Hc(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(m){const g=!!m.before,_=m.values||[];return new ic(_,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,_=m.values||[];return new ic(_,g)}(n.endAt)),$V(e,s,o,i,a,"F",l,u)}function C3(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function iS(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=gi(n.unaryFilter.field);return Je.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=gi(n.unaryFilter.field);return Je.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=gi(n.unaryFilter.field);return Je.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=gi(n.unaryFilter.field);return Je.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return oe(61313);default:return oe(60726)}}(t):t.fieldFilter!==void 0?function(n){return Je.create(gi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return oe(58110);default:return oe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return In.create(n.compositeFilter.filters.map(r=>iS(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return oe(1026)}}(n.compositeFilter.op))}(t):oe(30097,{filter:t})}function A3(t){return p3[t]}function N3(t){return m3[t]}function R3(t){return g3[t]}function mi(t){return{fieldPath:t.canonicalString()}}function gi(t){return ct.fromServerFormat(t.fieldPath)}function oS(t){return t instanceof Je?function(n){if(n.op==="=="){if(I_(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NAN"}};if(x_(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(I_(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NOT_NAN"}};if(x_(n.value))return{unaryFilter:{field:mi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mi(n.field),op:N3(n.op),value:n.value}}}(t):t instanceof In?function(n){const r=n.getFilters().map(s=>oS(s));return r.length===1?r[0]:{compositeFilter:{op:R3(n.op),filters:r}}}(t):oe(54877,{filter:t})}function P3(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function aS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,n,r,s,i=le.min(),o=le.min(),a=ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new qr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e){this.yt=e}}function b3(t){const e=S3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Fh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M3{constructor(){this.Cn=new D3}addToCollectionParentIndex(e,n){return this.Cn.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(ns.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(ns.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class D3{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new rt(Se.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new rt(Se.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lS=41943040;class bt{static withCacheSize(e){return new bt(e,bt.DEFAULT_COLLECTION_PERCENTILE,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bt.DEFAULT_COLLECTION_PERCENTILE=10,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bt.DEFAULT=new bt(lS,bt.DEFAULT_COLLECTION_PERCENTILE,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bt.DISABLED=new bt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new so(0)}static cr(){return new so(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="LruGarbageCollector",L3=1048576;function q_([t,e],[n,r]){const s=me(t,n);return s===0?me(e,r):s}class V3{constructor(e){this.Ir=e,this.buffer=new rt(q_),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();q_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class U3{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(O_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){_o(n)?ee(O_,"Ignoring IndexedDB error during garbage collection: ",n):await vo(n)}await this.Vr(3e5)})}}class F3{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(Gc.ce);const r=new V3(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(F_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),F_):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,u;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),hi()<=pe.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(u-l)+`ms
Total Duration: ${u-p}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function O3(t,e){return new F3(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(){this.changes=new si(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ea(r.mutation,s,Kt.empty(),ke.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ge()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ge()){const s=Ls();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=ra();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ls();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ge()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=hr();const o=wa(),a=function(){return wa()}();return n.forEach((l,u)=>{const p=r.get(u.key);s.has(u.key)&&(p===void 0||p.mutation instanceof ms)?i=i.insert(u.key,u):p!==void 0?(o.set(u.key,p.mutation.getFieldMask()),Ea(p.mutation,u,p.mutation.getFieldMask(),ke.now())):o.set(u.key,Kt.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,p)=>o.set(u,p)),n.forEach((u,p)=>a.set(u,new B3(p,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=wa();let s=new Ue((o,a)=>o-a),i=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let p=r.get(l)||Kt.empty();p=a.applyToLocalView(u,p),r.set(l,p);const m=(s.get(a.batchId)||ge()).add(l);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,p=l.value,m=GI();p.forEach(g=>{if(!i.has(g)){const _=YI(n.get(g),r.get(g));_!==null&&m.set(g,_),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return re.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):FI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(Ls());let a=ja,l=i;return o.next(u=>$.forEach(u,(p,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(p)?$.resolve():this.remoteDocumentCache.getEntry(e,p).next(g=>{l=l.insert(p,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,ge())).next(p=>({batchId:a,changes:jI(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new re(n)).next(r=>{let s=ra();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=ra();return this.indexManager.getCollectionParents(e,i).next(a=>$.forEach(a,l=>{const u=function(m,g){return new ll(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(p=>{p.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,u)=>{const p=u.getKey();o.get(p)===null&&(o=o.insert(p,Et.newInvalidDocument(p)))});let a=ra();return o.forEach((l,u)=>{const p=i.get(l);p!==void 0&&Ea(p.mutation,u,Kt.empty(),ke.now()),Kc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return $.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:qn(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:b3(s.bundledQuery),readTime:qn(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(){this.overlays=new Ue(re.comparator),this.qr=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ls();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=Ls(),i=n.length+1,o=new re(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((u,p)=>u-p);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let p=i.get(u.largestBatchId);p===null&&(p=Ls(),i=i.insert(u.largestBatchId,p)),p.set(u.getKey(),u)}}const a=Ls(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,p)=>a.set(u,p)),!(a.size()>=s)););return $.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new l3(n,r));let i=this.qr.get(n);i===void 0&&(i=ge(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(){this.Qr=new rt(it.$r),this.Ur=new rt(it.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new it(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new it(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new re(new Se([])),r=new it(n,e),s=new it(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new re(new Se([])),r=new it(n,e),s=new it(n,e+1);let i=ge();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new it(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class it{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return re.comparator(e.key,n.key)||me(e.Yr,n.Yr)}static Kr(e,n){return me(e.Yr,n.Yr)||re.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new rt(it.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new a3(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new it(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?pm:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new it(n,0),s=new it(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rt(me);return n.forEach(s=>{const i=new it(s,0),o=new it(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),$.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;re.isDocumentKey(i)||(i=i.child(""));const o=new it(new re(i),0);let a=new rt(me);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(l.Yr)),!0)},o),$.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ee(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return $.forEach(n.mutations,s=>{const i=new it(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new it(n,0),s=this.Zr.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e){this.ri=e,this.docs=function(){return new Ue(re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Et.newInvalidDocument(n))}getEntries(e,n){let r=hr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Et.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=hr();const o=n.path,a=new re(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:p}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||xV(TV(p),r)<=0||(s.has(p.key)||Kc(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){oe(9500)}ii(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new K3(this)}getSize(e){return $.resolve(this.size)}}class K3 extends q3{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e){this.persistence=e,this.si=new si(n=>ym(n),vm),this.lastRemoteSnapshotVersion=le.min(),this.highestTargetId=0,this.oi=0,this._i=new Sm,this.targetCount=0,this.ai=so.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),$.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new so(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Pr(n),$.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,n){this.ui={},this.overlays={},this.ci=new Gc(0),this.li=!1,this.li=!0,this.hi=new $3,this.referenceDelegate=e(this),this.Pi=new J3(this),this.indexManager=new M3,this.remoteDocumentCache=function(s){return new W3(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new k3(n),this.Ii=new G3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new H3,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new z3(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new Y3(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return $.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Y3 extends SV{constructor(e){super(),this.currentSequenceNumber=e}}class Cm{constructor(e){this.persistence=e,this.Ri=new Sm,this.Vi=null}static mi(e){return new Cm(e)}get fi(){if(this.Vi)return this.Vi;throw oe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),$.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,r=>{const s=re.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,le.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return $.or([()=>$.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class lc{constructor(e,n){this.persistence=e,this.pi=new si(r=>NV(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=O3(this,n)}static mi(e,n){return new lc(e,n)}Ei(){}di(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return $.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?$.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,le.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=hu(e.data.value)),n}br(e,n,r){return $.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return $.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ge(),s=ge();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Am(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return DD()?8:CV(St())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Q3;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(hi()<=pe.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",pi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(hi()<=pe.DEBUG&&ee("QueryEngine","Query:",pi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(hi()<=pe.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",pi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(n))):$.resolve())}ys(e,n){if(N_(n))return $.resolve(null);let r=On(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Fh(n,null,"F"),r=On(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ge(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Fh(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,s){return N_(n)||s.isEqual(le.min())?$.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?$.resolve(null):(hi()<=pe.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),pi(n)),this.vs(e,o,n,EV(s,ja)).next(a=>a))})}Ds(e,n){let r=new rt(qI(e));return n.forEach((s,i)=>{Kc(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return hi()<=pe.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",pi(n)),this.ps.getDocumentsMatchingQuery(e,n,ns.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="LocalStore",Z3=3e8;class eU{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Ue(me),this.xs=new si(i=>ym(i),vm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new j3(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function tU(t,e,n,r){return new eU(t,e,n,r)}async function cS(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=ge();for(const u of s){o.push(u.batchId);for(const p of u.mutations)l=l.add(p.key)}for(const u of i){a.push(u.batchId);for(const p of u.mutations)l=l.add(p.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function nU(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,p){const m=u.batch,g=m.keys();let _=$.resolve();return g.forEach(T=>{_=_.next(()=>p.getEntry(l,T)).next(R=>{const x=u.docVersions.get(T);Ee(x!==null,48541),R.version.compareTo(x)<0&&(m.applyToRemoteDocument(R,u),R.isValidDocument()&&(R.setReadTime(u.commitVersion),p.addEntry(R)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ge();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function dS(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function rU(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((p,m)=>{const g=s.get(m);if(!g)return;a.push(n.Pi.removeMatchingKeys(i,p.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,p.addedDocuments,m)));let _=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(ht.EMPTY_BYTE_STRING,le.min()).withLastLimboFreeSnapshotVersion(le.min()):p.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(p.resumeToken,r)),s=s.insert(m,_),function(R,x,C){return R.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=Z3?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(g,_,p)&&a.push(n.Pi.updateTargetData(i,_))});let l=hr(),u=ge();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),a.push(sU(i,o,e.documentUpdates).next(p=>{l=p.ks,u=p.qs})),!r.isEqual(le.min())){const p=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(p)}return $.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(n.Ms=s,i))}function sU(t,e,n){let r=ge(),s=ge();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=hr();return n.forEach((a,l)=>{const u=i.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(le.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee(Nm,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:s}})}function iU(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=pm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function oU(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new qr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Gh(t,e,n){const r=ce(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!_o(o))throw o;ee(Nm,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function B_(t,e,n){const r=ce(t);let s=le.min(),i=ge();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,p){const m=ce(l),g=m.xs.get(p);return g!==void 0?$.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,p)}(r,o,On(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:le.min(),n?i:ge())).next(a=>(aU(r,WV(e),a),{documents:a,Qs:i})))}function aU(t,e,n){let r=t.Os.get(e)||le.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class j_{constructor(){this.activeTargetIds=ZV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lU{constructor(){this.Mo=new j_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new j_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="ConnectivityMonitor";class H_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(G_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(G_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl=null;function Hh(){return zl===null?zl=function(){return 268435456+Math.round(2147483648*Math.random())}():zl++,"0x"+zl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="RestConnection",cU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class dU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===rc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=Hh(),a=this.zo(e,n.toUriEncodedString());ee(cf,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:u}=new URL(a),p=ho(u);return this.Jo(e,a,l,r,p).then(m=>(ee(cf,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Zi(cf,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=cU[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt="WebChannelConnection";class hU extends dU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=Hh();return new Promise((a,l)=>{const u=new hI;u.setWithCredentials(!0),u.listenOnce(pI.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case fu.NO_ERROR:const m=u.getResponseJson();ee(yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case fu.TIMEOUT:ee(yt,`RPC '${e}' ${o} timed out`),l(new Z(G.DEADLINE_EXCEEDED,"Request time out"));break;case fu.HTTP_ERROR:const g=u.getStatus();if(ee(yt,`RPC '${e}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);const T=_==null?void 0:_.error;if(T&&T.status&&T.message){const R=function(C){const I=C.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(I)>=0?I:G.UNKNOWN}(T.status);l(new Z(R,T.message))}else l(new Z(G.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Z(G.UNAVAILABLE,"Connection failed."));break;default:oe(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ee(yt,`RPC '${e}' ${o} completed.`)}});const p=JSON.stringify(s);ee(yt,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",p,r,15)})}T_(e,n,r){const s=Hh(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=yI(),a=gI(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const p=i.join("");ee(yt,`Creating RPC '${e}' stream ${s}: ${p}`,l);const m=o.createWebChannel(p,l);this.I_(m);let g=!1,_=!1;const T=new fU({Yo:x=>{_?ee(yt,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(g||(ee(yt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),ee(yt,`RPC '${e}' stream ${s} sending:`,x),m.send(x))},Zo:()=>m.close()}),R=(x,C,I)=>{x.listen(C,A=>{try{I(A)}catch(D){setTimeout(()=>{throw D},0)}})};return R(m,na.EventType.OPEN,()=>{_||(ee(yt,`RPC '${e}' stream ${s} transport opened.`),T.o_())}),R(m,na.EventType.CLOSE,()=>{_||(_=!0,ee(yt,`RPC '${e}' stream ${s} transport closed`),T.a_(),this.E_(m))}),R(m,na.EventType.ERROR,x=>{_||(_=!0,Zi(yt,`RPC '${e}' stream ${s} transport errored. Name:`,x.name,"Message:",x.message),T.a_(new Z(G.UNAVAILABLE,"The operation could not be completed")))}),R(m,na.EventType.MESSAGE,x=>{var C;if(!_){const I=x.data[0];Ee(!!I,16349);const A=I,D=(A==null?void 0:A.error)||((C=A[0])==null?void 0:C.error);if(D){ee(yt,`RPC '${e}' stream ${s} received error:`,D);const U=D.status;let F=function(N){const b=ze[N];if(b!==void 0)return XI(b)}(U),w=D.message;F===void 0&&(F=G.INTERNAL,w="Unknown error status: "+U+" with message "+D.message),_=!0,T.a_(new Z(F,w)),m.close()}else ee(yt,`RPC '${e}' stream ${s} received:`,I),T.u_(I)}}),R(a,mI.STAT_EVENT,x=>{x.stat===kh.PROXY?ee(yt,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===kh.NOPROXY&&ee(yt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function df(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xc(t){return new y3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_="PersistentStream";class hS{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new fS(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===G.RESOURCE_EXHAUSTED?(fr(n.toString()),fr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Z(G.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee($_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee($_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pU extends hS{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=w3(this.serializer,e),r=function(i){if(!("targetChange"in i))return le.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?le.min():o.readTime?qn(o.readTime):le.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=jh(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Vh(l)?{documents:x3(i,l)}:{query:I3(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=tS(i,o.resumeToken);const u=Oh(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(le.min())>0){a.readTime=ac(i,o.snapshotVersion.toTimestamp());const u=Oh(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=C3(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=jh(this.serializer),n.removeTarget=e,this.q_(n)}}class mU extends hS{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=T3(e.writeResults,e.commitTime),r=qn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=jh(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>E3(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{}class yU extends gU{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Z(G.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,qh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Z(G.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,qh(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(G.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class vU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(fr(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="RemoteStore";class _U{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ii(this)&&(ee(Ys,"Restarting streams for network reachability change."),await async function(l){const u=ce(l);u.Ea.add(4),await dl(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Zc(u)}(this))})}),this.Ra=new vU(r,s)}}async function Zc(t){if(ii(t))for(const e of t.da)await e(!0)}async function dl(t){for(const e of t.da)await e(!1)}function pS(t,e){const n=ce(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),bm(n)?km(n):wo(n).O_()&&Pm(n,e))}function Rm(t,e){const n=ce(t),r=wo(n);n.Ia.delete(e),r.O_()&&mS(n,e),n.Ia.size===0&&(r.O_()?r.L_():ii(n)&&n.Ra.set("Unknown"))}function Pm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(le.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}wo(t).Y_(e)}function mS(t,e){t.Va.Ue(e),wo(t).Z_(e)}function km(t){t.Va=new h3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),wo(t).start(),t.Ra.ua()}function bm(t){return ii(t)&&!wo(t).x_()&&t.Ia.size>0}function ii(t){return ce(t).Ea.size===0}function gS(t){t.Va=void 0}async function wU(t){t.Ra.set("Online")}async function EU(t){t.Ia.forEach((e,n)=>{Pm(t,e)})}async function TU(t,e){gS(t),bm(t)?(t.Ra.ha(e),km(t)):t.Ra.set("Unknown")}async function xU(t,e,n){if(t.Ra.set("Online"),e instanceof eS&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){ee(Ys,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await uc(t,r)}else if(e instanceof gu?t.Va.Ze(e):e instanceof ZI?t.Va.st(e):t.Va.tt(e),!n.isEqual(le.min()))try{const r=await dS(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const p=i.Ia.get(u);p&&i.Ia.set(u,p.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const p=i.Ia.get(l);if(!p)return;i.Ia.set(l,p.withResumeToken(ht.EMPTY_BYTE_STRING,p.snapshotVersion)),mS(i,l);const m=new qr(p.target,l,u,p.sequenceNumber);Pm(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(Ys,"Failed to raise snapshot:",r),await uc(t,r)}}async function uc(t,e,n){if(!_o(e))throw e;t.Ea.add(1),await dl(t),t.Ra.set("Offline"),n||(n=()=>dS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(Ys,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Zc(t)})}function yS(t,e){return e().catch(n=>uc(t,n,e))}async function ed(t){const e=ce(t),n=os(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:pm;for(;IU(e);)try{const s=await iU(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,SU(e,s)}catch(s){await uc(e,s)}vS(e)&&_S(e)}function IU(t){return ii(t)&&t.Ta.length<10}function SU(t,e){t.Ta.push(e);const n=os(t);n.O_()&&n.X_&&n.ea(e.mutations)}function vS(t){return ii(t)&&!os(t).x_()&&t.Ta.length>0}function _S(t){os(t).start()}async function CU(t){os(t).ra()}async function AU(t){const e=os(t);for(const n of t.Ta)e.ea(n.mutations)}async function NU(t,e,n){const r=t.Ta.shift(),s=Tm.from(r,e,n);await yS(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ed(t)}async function RU(t,e){e&&os(t).X_&&await async function(r,s){if(function(o){return c3(o)&&o!==G.ABORTED}(s.code)){const i=r.Ta.shift();os(r).B_(),await yS(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ed(r)}}(t,e),vS(t)&&_S(t)}async function z_(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),ee(Ys,"RemoteStore received new credentials");const r=ii(n);n.Ea.add(3),await dl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Zc(n)}async function PU(t,e){const n=ce(t);e?(n.Ea.delete(2),await Zc(n)):e||(n.Ea.add(2),await dl(n),n.Ra.set("Unknown"))}function wo(t){return t.ma||(t.ma=function(n,r,s){const i=ce(n);return i.sa(),new pU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:wU.bind(null,t),t_:EU.bind(null,t),r_:TU.bind(null,t),H_:xU.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),bm(t)?km(t):t.Ra.set("Unknown")):(await t.ma.stop(),gS(t))})),t.ma}function os(t){return t.fa||(t.fa=function(n,r,s){const i=ce(n);return i.sa(),new mU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:CU.bind(null,t),r_:RU.bind(null,t),ta:AU.bind(null,t),na:NU.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await ed(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(Ys,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new sr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Mm(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dm(t,e){if(fr("AsyncQueue",`${e}: ${t}`),_o(t))return new Z(G.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{static emptySet(e){return new Hi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||re.comparator(n.key,r.key):(n,r)=>re.comparator(n.key,r.key),this.keyedMap=ra(),this.sortedSet=new Ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Hi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Hi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(){this.ga=new Ue(re.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):oe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class io{constructor(e,n,r,s,i,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new io(e,n,Hi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class bU{constructor(){this.queries=K_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ce(n),i=s.queries;s.queries=K_(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new Z(G.ABORTED,"Firestore shutting down"))}}function K_(){return new si(t=>OI(t),Wc)}async function Lm(t,e){const n=ce(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new kU,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Dm(o,`Initialization of query '${pi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Um(n)}async function Vm(t,e){const n=ce(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function MU(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&Um(n)}function DU(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function Um(t){t.Ca.forEach(e=>{e.next()})}var $h,J_;(J_=$h||($h={})).Ma="default",J_.Cache="cache";class Fm{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new io(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=io.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==$h.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e){this.key=e}}class ES{constructor(e){this.key=e}}class LU{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ge(),this.mutatedKeys=ge(),this.eu=qI(e),this.tu=new Hi(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new W_,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,m)=>{const g=s.get(p),_=Kc(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),R=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let x=!1;g&&_?g.data.isEqual(_.data)?T!==R&&(r.track({type:3,doc:_}),x=!0):this.su(g,_)||(r.track({type:2,doc:_}),x=!0,(l&&this.eu(_,l)>0||u&&this.eu(_,u)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),x=!0):g&&!_&&(r.track({type:1,doc:g}),x=!0,(l||u)&&(a=!0)),x&&(_?(o=o.add(_),i=R?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((p,m)=>function(_,T){const R=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe(20277,{Rt:x})}};return R(_)-R(T)}(p.type,m.type)||this.eu(p.doc,m.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new io(this.query,e.tu,i,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new W_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ge(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new ES(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new wS(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ge();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return io.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Om="SyncEngine";class VU{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class UU{constructor(e){this.key=e,this.hu=!1}}class FU{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new si(a=>OI(a),Wc),this.Iu=new Map,this.Eu=new Set,this.du=new Ue(re.comparator),this.Au=new Map,this.Ru=new Sm,this.Vu={},this.mu=new Map,this.fu=so.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function OU(t,e,n=!0){const r=AS(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await TS(r,e,n,!0),s}async function qU(t,e){const n=AS(t);await TS(n,e,!0,!1)}async function TS(t,e,n,r){const s=await oU(t.localStore,On(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await BU(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&pS(t.remoteStore,s),a}async function BU(t,e,n,r,s){t.pu=(m,g,_)=>async function(R,x,C,I){let A=x.view.ru(C);A.Cs&&(A=await B_(R.localStore,x.query,!1).then(({documents:w})=>x.view.ru(w,A)));const D=I&&I.targetChanges.get(x.targetId),U=I&&I.targetMismatches.get(x.targetId)!=null,F=x.view.applyChanges(A,R.isPrimaryClient,D,U);return Q_(R,x.targetId,F.au),F.snapshot}(t,m,g,_);const i=await B_(t.localStore,e,!0),o=new LU(e,i.Qs),a=o.ru(i.documents),l=cl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(a,t.isPrimaryClient,l);Q_(t,n,u.au);const p=new VU(e,n,o);return t.Tu.set(e,p),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function jU(t,e,n){const r=ce(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Wc(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Gh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Rm(r.remoteStore,s.targetId),zh(r,s.targetId)}).catch(vo)):(zh(r,s.targetId),await Gh(r.localStore,s.targetId,!0))}async function GU(t,e){const n=ce(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Rm(n.remoteStore,r.targetId))}async function HU(t,e,n){const r=QU(t);try{const s=await function(o,a){const l=ce(o),u=ke.now(),p=a.reduce((_,T)=>_.add(T.key),ge());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let T=hr(),R=ge();return l.Ns.getEntries(_,p).next(x=>{T=x,T.forEach((C,I)=>{I.isValidDocument()||(R=R.add(C))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,T)).next(x=>{m=x;const C=[];for(const I of a){const A=i3(I,m.get(I.key).overlayedDocument);A!=null&&C.push(new ms(I.key,A,kI(A.value.mapValue),un.exists(!0)))}return l.mutationQueue.addMutationBatch(_,u,C,a)}).next(x=>{g=x;const C=x.applyToLocalDocumentSet(m,R);return l.documentOverlayCache.saveOverlays(_,x.batchId,C)})}).then(()=>({batchId:g.batchId,changes:jI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new Ue(me)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,s.batchId,n),await fl(r,s.changes),await ed(r.remoteStore)}catch(s){const i=Dm(s,"Failed to persist write");n.reject(i)}}async function xS(t,e){const n=ce(t);try{const r=await rU(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Ee(o.hu,14607):s.removedDocuments.size>0&&(Ee(o.hu,42227),o.hu=!1))}),await fl(n,r,e)}catch(r){await vo(r)}}function Y_(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ce(o);l.onlineState=a;let u=!1;l.queries.forEach((p,m)=>{for(const g of m.Sa)g.va(a)&&(u=!0)}),u&&Um(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $U(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Ue(re.comparator);o=o.insert(i,Et.newNoDocument(i,le.min()));const a=ge().add(i),l=new Qc(le.min(),new Map,new Ue(me),o,a);await xS(r,l),r.du=r.du.remove(i),r.Au.delete(e),qm(r)}else await Gh(r.localStore,e,!1).then(()=>zh(r,e,n)).catch(vo)}async function zU(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await nU(n.localStore,e);SS(n,r,null),IS(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await fl(n,s)}catch(s){await vo(s)}}async function WU(t,e,n){const r=ce(t);try{const s=await function(o,a){const l=ce(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let p;return l.mutationQueue.lookupMutationBatch(u,a).next(m=>(Ee(m!==null,37113),p=m.keys(),l.mutationQueue.removeMutationBatch(u,m))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,p,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,p)).next(()=>l.localDocuments.getDocuments(u,p))})}(r.localStore,e);SS(r,e,n),IS(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await fl(r,s)}catch(s){await vo(s)}}function IS(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function SS(t,e,n){const r=ce(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function zh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||CS(t,r)})}function CS(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Rm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),qm(t))}function Q_(t,e,n){for(const r of n)r instanceof wS?(t.Ru.addReference(r.key,e),KU(t,r)):r instanceof ES?(ee(Om,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||CS(t,r.key)):oe(19791,{wu:r})}function KU(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Om,"New document in limbo: "+n),t.Eu.add(r),qm(t))}function qm(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new re(Se.fromString(e)),r=t.fu.next();t.Au.set(r,new UU(n)),t.du=t.du.insert(n,r),pS(t.remoteStore,new qr(On(zc(n.path)),r,"TargetPurposeLimboResolution",Gc.ce))}}async function fl(t,e,n){const r=ce(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var p;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(p=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(u){s.push(u);const m=Am.As(l.targetId,u);i.push(m)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,u){const p=ce(l);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>$.forEach(u,g=>$.forEach(g.Es,_=>p.persistence.referenceDelegate.addReference(m,g.targetId,_)).next(()=>$.forEach(g.ds,_=>p.persistence.referenceDelegate.removeReference(m,g.targetId,_)))))}catch(m){if(!_o(m))throw m;ee(Nm,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const _=p.Ms.get(g),T=_.snapshotVersion,R=_.withLastLimboFreeSnapshotVersion(T);p.Ms=p.Ms.insert(g,R)}}}(r.localStore,i))}async function JU(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){ee(Om,"User change. New user:",e.toKey());const r=await cS(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new Z(G.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fl(n,r.Ls)}}function YU(t,e){const n=ce(t),r=n.Au.get(e);if(r&&r.hu)return ge().add(r.key);{let s=ge();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function AS(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$U.bind(null,e),e.Pu.H_=MU.bind(null,e.eventManager),e.Pu.yu=DU.bind(null,e.eventManager),e}function QU(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WU.bind(null,e),e}class cc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return tU(this.persistence,new X3,e.initialUser,this.serializer)}Cu(e){return new uS(Cm.mi,this.serializer)}Du(e){return new lU}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cc.provider={build:()=>new cc};class XU extends cc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ee(this.persistence.referenceDelegate instanceof lc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new U3(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?bt.withCacheSize(this.cacheSizeBytes):bt.DEFAULT;return new uS(r=>lc.mi(r,n),this.serializer)}}class Wh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Y_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=JU.bind(null,this.syncEngine),await PU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new bU}()}createDatastore(e){const n=Xc(e.databaseInfo.databaseId),r=function(i){return new hU(i)}(e.databaseInfo);return function(i,o,a,l){return new yU(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new _U(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Y_(this.syncEngine,n,0),function(){return H_.v()?new H_:new uU}())}createSyncEngine(e,n){return function(s,i,o,a,l,u,p){const m=new FU(s,i,o,a,l,u);return p&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ce(s);ee(Ys,"RemoteStore shutting down."),i.Ea.add(5),await dl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Wh.provider={build:()=>new Wh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):fr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const as="FirestoreClient";class ZU{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=vt.UNAUTHENTICATED,this.clientId=hm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ee(as,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(as,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Dm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ff(t,e){t.asyncQueue.verifyOperationInProgress(),ee(as,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await cS(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function X_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await e6(t);ee(as,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>z_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>z_(e.remoteStore,s)),t._onlineComponents=e}async function e6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(as,"Using user provided OfflineComponentProvider");try{await ff(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===G.FAILED_PRECONDITION||s.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Zi("Error using user provided cache. Falling back to memory cache: "+n),await ff(t,new cc)}}else ee(as,"Using default OfflineComponentProvider"),await ff(t,new XU(void 0));return t._offlineComponents}async function NS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(as,"Using user provided OnlineComponentProvider"),await X_(t,t._uninitializedComponentsProvider._online)):(ee(as,"Using default OnlineComponentProvider"),await X_(t,new Wh))),t._onlineComponents}function t6(t){return NS(t).then(e=>e.syncEngine)}async function dc(t){const e=await NS(t),n=e.eventManager;return n.onListen=OU.bind(null,e.syncEngine),n.onUnlisten=jU.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=qU.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=GU.bind(null,e.syncEngine),n}function n6(t,e,n={}){const r=new sr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const p=new Bm({next:g=>{p.Nu(),o.enqueueAndForget(()=>Vm(i,m));const _=g.docs.has(a);!_&&g.fromCache?u.reject(new Z(G.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&l&&l.source==="server"?u.reject(new Z(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new Fm(zc(a.path),p,{includeMetadataChanges:!0,qa:!0});return Lm(i,m)}(await dc(t),t.asyncQueue,e,n,r)),r.promise}function r6(t,e,n={}){const r=new sr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const p=new Bm({next:g=>{p.Nu(),o.enqueueAndForget(()=>Vm(i,m)),g.fromCache&&l.source==="server"?u.reject(new Z(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new Fm(a,p,{includeMetadataChanges:!0,qa:!0});return Lm(i,m)}(await dc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="firestore.googleapis.com",ew=!0;class tw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Z(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=PS,this.ssl=ew}else this.host=e.host,this.ssl=e.ssl??ew;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<L3)throw new Z(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RS(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class td{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new cV;switch(r.type){case"firstParty":return new pV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Z_.get(n);r&&(ee("ComponentProvider","Removing Datastore"),Z_.delete(n),r.terminate())}(this),Promise.resolve()}}function s6(t,e,n,r={}){var u;t=qt(t,td);const s=ho(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(_x(`https://${a}`),wx("Firestore",!0)),i.host!==PS&&i.host!==a&&Zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!ts(l,o)&&(t._setSettings(l),r.mockUserToken)){let p,m;if(typeof r.mockUserToken=="string")p=r.mockUserToken,m=vt.MOCK_USER;else{p=SD(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Z(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new vt(g)}t._authCredentials=new dV(new _I(p,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oi(this.firestore,e,this._query)}}class qe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qe(this.firestore,e,this._key)}toJSON(){return{type:qe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(al(n,qe._jsonSchema))return new qe(e,r||null,new re(Se.fromString(n.referencePath)))}}qe._jsonSchemaVersion="firestore/documentReference/1.0",qe._jsonSchema={type:Ye("string",qe._jsonSchemaVersion),referencePath:Ye("string")};class Qr extends oi{constructor(e,n,r){super(e,n,zc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new re(e))}withConverter(e){return new Qr(this.firestore,e,this._path)}}function We(t,e,...n){if(t=Be(t),wI("collection","path",e),t instanceof td){const r=Se.fromString(e,...n);return p_(r),new Qr(t,null,r)}{if(!(t instanceof qe||t instanceof Qr))throw new Z(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Se.fromString(e,...n));return p_(r),new Qr(t.firestore,null,r)}}function et(t,e,...n){if(t=Be(t),arguments.length===1&&(e=hm.newId()),wI("doc","path",e),t instanceof td){const r=Se.fromString(e,...n);return h_(r),new qe(t,null,new re(r))}{if(!(t instanceof qe||t instanceof Qr))throw new Z(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Se.fromString(e,...n));return h_(r),new qe(t.firestore,t instanceof Qr?t.converter:null,new re(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw="AsyncQueue";class rw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new fS(this,"async_queue_retry"),this._c=()=>{const r=df();r&&ee(nw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=df();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=df();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new sr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_o(e))throw e;ee(nw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,fr("INTERNAL UNHANDLED ERROR: ",sw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Mm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&oe(47125,{Pc:sw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function sw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class pr extends td{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new rw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rw(e),this._firestoreClient=void 0,await e}}}function kS(t,e){const n=typeof t=="object"?t:rm(),r=typeof t=="string"?t:rc,s=po(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=xD("firestore");i&&s6(s,...i)}return s}function nd(t){if(t._terminated)throw new Z(G.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||i6(t),t._firestoreClient}function i6(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,u,p){return new kV(a,l,u,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,RS(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ZU(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rn(ht.fromBase64String(e))}catch(n){throw new Z(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new rn(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:rn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(al(e,rn._jsonSchema))return rn.fromBase64String(e.bytes)}}rn._jsonSchemaVersion="firestore/bytes/1.0",rn._jsonSchema={type:Ye("string",rn._jsonSchemaVersion),bytes:Ye("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Z(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return me(this._lat,e._lat)||me(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bn._jsonSchemaVersion}}static fromJSON(e){if(al(e,Bn._jsonSchema))return new Bn(e.latitude,e.longitude)}}Bn._jsonSchemaVersion="firestore/geoPoint/1.0",Bn._jsonSchema={type:Ye("string",Bn._jsonSchemaVersion),latitude:Ye("number"),longitude:Ye("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(al(e,jn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new jn(e.vectorValues);throw new Z(G.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jn._jsonSchemaVersion="firestore/vectorValue/1.0",jn._jsonSchema={type:Ye("string",jn._jsonSchemaVersion),vectorValues:Ye("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6=/^__.*__$/;class a6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ms(e,this.data,this.fieldMask,n,this.fieldTransforms):new ul(e,this.data,n,this.fieldTransforms)}}class bS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ms(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function MS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe(40011,{Ac:t})}}class sd{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new sd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(MS(this.Ac)&&o6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class l6{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Xc(e)}Cc(e,n,r,s=!1){return new sd({Ac:e,methodName:n,Dc:r,path:ct.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function id(t){const e=t._freezeSettings(),n=Xc(t._databaseId);return new l6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function DS(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);$m("Data must be an object, but it was:",o,r);const a=LS(r,o);let l,u;if(i.merge)l=new Kt(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const g=Kh(e,m,n);if(!o.contains(g))throw new Z(G.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);US(p,g)||p.push(g)}l=new Kt(p),u=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,u=o.fieldTransforms;return new a6(new Lt(a),l,u)}class od extends Eo{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof od}}function u6(t,e,n){return new sd({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class jm extends Eo{_toFieldTransform(e){return new wm(e.path,new za)}isEqual(e){return e instanceof jm}}class Gm extends Eo{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=u6(this,e,!0),r=this.vc.map(i=>To(i,n)),s=new ro(r);return new wm(e.path,s)}isEqual(e){return e instanceof Gm&&ts(this.vc,e.vc)}}class Hm extends Eo{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Ka(e.serializer,$I(e.serializer,this.Fc));return new wm(e.path,n)}isEqual(e){return e instanceof Hm&&this.Fc===e.Fc}}function c6(t,e,n,r){const s=t.Cc(1,e,n);$m("Data must be an object, but it was:",s,r);const i=[],o=Lt.empty();ps(r,(l,u)=>{const p=zm(e,l,n);u=Be(u);const m=s.yc(p);if(u instanceof od)i.push(p);else{const g=To(u,m);g!=null&&(i.push(p),o.set(p,g))}});const a=new Kt(i);return new bS(o,a,s.fieldTransforms)}function d6(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[Kh(e,r,n)],l=[s];if(i.length%2!=0)throw new Z(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(Kh(e,i[g])),l.push(i[g+1]);const u=[],p=Lt.empty();for(let g=a.length-1;g>=0;--g)if(!US(u,a[g])){const _=a[g];let T=l[g];T=Be(T);const R=o.yc(_);if(T instanceof od)u.push(_);else{const x=To(T,R);x!=null&&(u.push(_),p.set(_,x))}}const m=new Kt(u);return new bS(p,m,o.fieldTransforms)}function f6(t,e,n,r=!1){return To(n,t.Cc(r?4:3,e))}function To(t,e){if(VS(t=Be(t)))return $m("Unsupported field value:",e,t),LS(t,e);if(t instanceof Eo)return function(r,s){if(!MS(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=To(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Be(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return $I(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ke.fromDate(r);return{timestampValue:ac(s.serializer,i)}}if(r instanceof ke){const i=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ac(s.serializer,i)}}if(r instanceof Bn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof rn)return{bytesValue:tS(s.serializer,r._byteString)};if(r instanceof qe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Im(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof jn)return function(o,a){return{mapValue:{fields:{[RI]:{stringValue:PI},[sc]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return _m(a.serializer,u)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${jc(r)}`)}(t,e)}function LS(t,e){const n={};return xI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ps(t,(r,s)=>{const i=To(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function VS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ke||t instanceof Bn||t instanceof rn||t instanceof qe||t instanceof Eo||t instanceof jn)}function $m(t,e,n){if(!VS(n)||!EI(n)){const r=jc(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Kh(t,e,n){if((e=Be(e))instanceof rd)return e._internalPath;if(typeof e=="string")return zm(t,e);throw fc("Field path arguments must be of type string or ",t,!1,void 0,n)}const h6=new RegExp("[~\\*/\\[\\]]");function zm(t,e,n){if(e.search(h6)>=0)throw fc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rd(...e.split("."))._internalPath}catch{throw fc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new Z(G.INVALID_ARGUMENT,a+t+l)}function US(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new p6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Wm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class p6 extends FS{data(){return super.data()}}function Wm(t,e){return typeof e=="string"?zm(t,e):e instanceof rd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Z(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Km{}class m6 extends Km{}function bn(t,e,...n){let r=[];e instanceof Km&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Jm).length,a=i.filter(l=>l instanceof ad).length;if(o>1||o>0&&a>0)throw new Z(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class ad extends m6{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ad(e,n,r)}_apply(e){const n=this._parse(e);return qS(e._query,n),new oi(e.firestore,e.converter,Uh(e._query,n))}_parse(e){const n=id(e.firestore);return function(i,o,a,l,u,p,m){let g;if(u.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Z(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){aw(m,p);const T=[];for(const R of m)T.push(ow(l,i,R));g={arrayValue:{values:T}}}else g=ow(l,i,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||aw(m,p),g=f6(a,o,m,p==="in"||p==="not-in");return Je.create(u,p,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $i(t,e,n){const r=e,s=Wm("where",t);return ad._create(s,r,n)}class Jm extends Km{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Jm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:In.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)qS(o,l),o=Uh(o,l)}(e._query,n),new oi(e.firestore,e.converter,Uh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function ow(t,e,n){if(typeof(n=Be(n))=="string"){if(n==="")throw new Z(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FI(e)&&n.indexOf("/")!==-1)throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Se.fromString(n));if(!re.isDocumentKey(r))throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return T_(t,new re(r))}if(n instanceof qe)return T_(t,n._key);throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jc(n)}.`)}function aw(t,e){if(!Array.isArray(t)||t.length===0)throw new Z(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qS(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Z(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class g6{convertValue(e,n="none"){switch(is(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw oe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ps(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[sc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Ge(o.doubleValue));return new jn(n)}convertGeoPoint(e){return new Bn(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=$c(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ga(e));default:return null}}convertTimestamp(e){const n=rs(e);return new ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Se.fromString(e);Ee(aS(r),9688,{name:e});const s=new Ha(r.get(1),r.get(3)),i=new re(r.popFirst(5));return s.isEqual(n)||fr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class ia{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Os extends FS{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Wm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(G.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Os._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Os._jsonSchemaVersion="firestore/documentSnapshot/1.0",Os._jsonSchema={type:Ye("string",Os._jsonSchemaVersion),bundleSource:Ye("string","DocumentSnapshot"),bundleName:Ye("string"),bundle:Ye("string")};class yu extends Os{data(e={}){return super.data(e)}}class qs{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ia(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yu(this._firestore,this._userDataWriter,r.key,r,new ia(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new yu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ia(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new yu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ia(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,p=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),p=o.indexOf(a.doc.key)),{type:y6(a.type),doc:l,oldIndex:u,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(G.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=qs._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function y6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t){t=qt(t,qe);const e=qt(t.firestore,pr);return n6(nd(e),t._key).then(n=>$S(e,t,n))}qs._jsonSchemaVersion="firestore/querySnapshot/1.0",qs._jsonSchema={type:Ye("string",qs._jsonSchemaVersion),bundleSource:Ye("string","QuerySnapshot"),bundleName:Ye("string"),bundle:Ye("string")};class Ym extends g6{constructor(e){super(),this.firestore=e}convertBytes(e){return new rn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,n)}}function jS(t){t=qt(t,oi);const e=qt(t.firestore,pr),n=nd(e),r=new Ym(e);return OS(t._query),r6(n,t._query).then(s=>new qs(e,r,t,s))}function GS(t,e,n){t=qt(t,qe);const r=qt(t.firestore,pr),s=BS(t.converter,e);return ld(r,[DS(id(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,un.none())])}function Mt(t,e,n,...r){t=qt(t,qe);const s=qt(t.firestore,pr),i=id(s);let o;return o=typeof(e=Be(e))=="string"||e instanceof rd?d6(i,"updateDoc",t._key,e,n,r):c6(i,"updateDoc",t._key,e),ld(s,[o.toMutation(t._key,un.exists(!0))])}function HS(t){return ld(qt(t.firestore,pr),[new Em(t._key,un.none())])}function Mn(t,e){const n=qt(t.firestore,pr),r=et(t),s=BS(t.converter,e);return ld(n,[DS(id(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,un.exists(!1))]).then(()=>r)}function Dn(t,...e){var l,u,p;t=Be(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||iw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(iw(e[r])){const m=e[r];e[r]=(l=m.next)==null?void 0:l.bind(m),e[r+1]=(u=m.error)==null?void 0:u.bind(m),e[r+2]=(p=m.complete)==null?void 0:p.bind(m)}let i,o,a;if(t instanceof qe)o=qt(t.firestore,pr),a=zc(t._key.path),i={next:m=>{e[r]&&e[r]($S(o,t,m))},error:e[r+1],complete:e[r+2]};else{const m=qt(t,oi);o=qt(m.firestore,pr),a=m._query;const g=new Ym(o);i={next:_=>{e[r]&&e[r](new qs(o,g,m,_))},error:e[r+1],complete:e[r+2]},OS(t._query)}return function(g,_,T,R){const x=new Bm(R),C=new Fm(_,x,T);return g.asyncQueue.enqueueAndForget(async()=>Lm(await dc(g),C)),()=>{x.Nu(),g.asyncQueue.enqueueAndForget(async()=>Vm(await dc(g),C))}}(nd(o),a,s,i)}function ld(t,e){return function(r,s){const i=new sr;return r.asyncQueue.enqueueAndForget(async()=>HU(await t6(r),s,i)),i.promise}(nd(t),e)}function $S(t,e,n){const r=n.docs.get(e._key),s=new Ym(t);return new Os(t,s,e._key,r,new ia(n.hasPendingWrites,n.fromCache),e.converter)}function _t(){return new jm("serverTimestamp")}function pc(...t){return new Gm("arrayUnion",t)}function mc(t){return new Hm("increment",t)}(function(e,n=!0){(function(s){yo=s})(mo),Gn(new Tn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new pr(new fV(r.getProvider("auth-internal")),new mV(o,r.getProvider("app-check-internal")),function(u,p){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Z(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ha(u.options.projectId,p)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),ln(u_,c_,e),ln(u_,c_,"esm2020")})();const zS="@firebase/installations",Qm="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS=1e4,KS=`w:${Qm}`,JS="FIS_v2",v6="https://firebaseinstallations.googleapis.com/v1",_6=60*60*1e3,w6="installations",E6="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Qs=new ri(w6,E6,T6);function YS(t){return t instanceof $n&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS({projectId:t}){return`${v6}/projects/${t}/installations`}function XS(t){return{token:t.token,requestStatus:2,expiresIn:I6(t.expiresIn),creationTime:Date.now()}}async function ZS(t,e){const r=(await e.json()).error;return Qs.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function eC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function x6(t,{refreshToken:e}){const n=eC(t);return n.append("Authorization",S6(e)),n}async function tC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function I6(t){return Number(t.replace("s","000"))}function S6(t){return`${JS} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C6({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=QS(t),s=eC(t),i=e.getImmediate({optional:!0});if(i){const u=await i.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const o={fid:n,authVersion:JS,appId:t.appId,sdkVersion:KS},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await tC(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:XS(u.authToken)}}else throw await ZS("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A6(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N6=/^[cdef][\w-]{21}$/,Jh="";function R6(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=P6(t);return N6.test(n)?n:Jh}catch{return Jh}}function P6(t){return A6(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new Map;function sC(t,e){const n=ud(t);iC(n,e),k6(n,e)}function iC(t,e){const n=rC.get(t);if(n)for(const r of n)r(e)}function k6(t,e){const n=b6();n&&n.postMessage({key:t,fid:e}),M6()}let Vs=null;function b6(){return!Vs&&"BroadcastChannel"in self&&(Vs=new BroadcastChannel("[Firebase] FID Change"),Vs.onmessage=t=>{iC(t.data.key,t.data.fid)}),Vs}function M6(){rC.size===0&&Vs&&(Vs.close(),Vs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6="firebase-installations-database",L6=1,Xs="firebase-installations-store";let hf=null;function Xm(){return hf||(hf=Fc(D6,L6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Xs)}}})),hf}async function gc(t,e){const n=ud(t),s=(await Xm()).transaction(Xs,"readwrite"),i=s.objectStore(Xs),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&sC(t,e.fid),e}async function oC(t){const e=ud(t),r=(await Xm()).transaction(Xs,"readwrite");await r.objectStore(Xs).delete(e),await r.done}async function cd(t,e){const n=ud(t),s=(await Xm()).transaction(Xs,"readwrite"),i=s.objectStore(Xs),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&sC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zm(t){let e;const n=await cd(t.appConfig,r=>{const s=V6(r),i=U6(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Jh?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function V6(t){const e=t||{fid:R6(),registrationStatus:0};return aC(e)}function U6(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Qs.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=F6(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:O6(t)}:{installationEntry:e}}async function F6(t,e){try{const n=await C6(t,e);return gc(t.appConfig,n)}catch(n){throw YS(n)&&n.customData.serverCode===409?await oC(t.appConfig):await gc(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function O6(t){let e=await lw(t.appConfig);for(;e.registrationStatus===1;)await nC(100),e=await lw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Zm(t);return r||n}return e}function lw(t){return cd(t,e=>{if(!e)throw Qs.create("installation-not-found");return aC(e)})}function aC(t){return q6(t)?{fid:t.fid,registrationStatus:0}:t}function q6(t){return t.registrationStatus===1&&t.registrationTime+WS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B6({appConfig:t,heartbeatServiceProvider:e},n){const r=j6(t,n),s=x6(t,n),i=e.getImmediate({optional:!0});if(i){const u=await i.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const o={installation:{sdkVersion:KS,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await tC(()=>fetch(r,a));if(l.ok){const u=await l.json();return XS(u)}else throw await ZS("Generate Auth Token",l)}function j6(t,{fid:e}){return`${QS(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eg(t,e=!1){let n;const r=await cd(t.appConfig,i=>{if(!lC(i))throw Qs.create("not-registered");const o=i.authToken;if(!e&&$6(o))return i;if(o.requestStatus===1)return n=G6(t,e),i;{if(!navigator.onLine)throw Qs.create("app-offline");const a=W6(i);return n=H6(t,a),a}});return n?await n:r.authToken}async function G6(t,e){let n=await uw(t.appConfig);for(;n.authToken.requestStatus===1;)await nC(100),n=await uw(t.appConfig);const r=n.authToken;return r.requestStatus===0?eg(t,e):r}function uw(t){return cd(t,e=>{if(!lC(e))throw Qs.create("not-registered");const n=e.authToken;return K6(n)?{...e,authToken:{requestStatus:0}}:e})}async function H6(t,e){try{const n=await B6(t,e),r={...e,authToken:n};return await gc(t.appConfig,r),n}catch(n){if(YS(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await oC(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await gc(t.appConfig,r)}throw n}}function lC(t){return t!==void 0&&t.registrationStatus===2}function $6(t){return t.requestStatus===2&&!z6(t)}function z6(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+_6}function W6(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function K6(t){return t.requestStatus===1&&t.requestTime+WS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J6(t){const e=t,{installationEntry:n,registrationPromise:r}=await Zm(e);return r?r.catch(console.error):eg(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y6(t,e=!1){const n=t;return await Q6(n),(await eg(n,e)).token}async function Q6(t){const{registrationPromise:e}=await Zm(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X6(t){if(!t||!t.options)throw pf("App Configuration");if(!t.name)throw pf("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw pf(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function pf(t){return Qs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="installations",Z6="installations-internal",eF=t=>{const e=t.getProvider("app").getImmediate(),n=X6(e),r=po(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},tF=t=>{const e=t.getProvider("app").getImmediate(),n=po(e,uC).getImmediate();return{getId:()=>J6(n),getToken:s=>Y6(n,s)}};function nF(){Gn(new Tn(uC,eF,"PUBLIC")),Gn(new Tn(Z6,tF,"PRIVATE"))}nF();ln(zS,Qm);ln(zS,Qm,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF="/firebase-messaging-sw.js",sF="/firebase-cloud-messaging-push-scope",cC="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",iF="https://fcmregistrations.googleapis.com/v1",dC="google.c.a.c_id",oF="google.c.a.c_l",aF="google.c.a.ts",lF="google.c.a.e",cw=1e4;var dw;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(dw||(dw={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Ja;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Ja||(Ja={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function uF(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="fcm_token_details_db",cF=5,fw="fcm_token_object_Store";async function dF(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(mf))return null;let e=null;return(await Fc(mf,cF,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(fw))return;const a=o.objectStore(fw),l=await a.index("fcmSenderId").get(t);if(await a.clear(),!!l){if(s===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:u.createTime??Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Jn(u.vapidKey)}}}else if(s===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Jn(u.auth),p256dh:Jn(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Jn(u.vapidKey)}}}else if(s===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Jn(u.auth),p256dh:Jn(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Jn(u.vapidKey)}}}}}})).close(),await nf(mf),await nf("fcm_vapid_details_db"),await nf("undefined"),fF(e)?e:null}function fF(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF="firebase-messaging-database",pF=1,Ya="firebase-messaging-store";let gf=null;function fC(){return gf||(gf=Fc(hF,pF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ya)}}})),gf}async function mF(t){const e=hC(t),r=await(await fC()).transaction(Ya).objectStore(Ya).get(e);if(r)return r;{const s=await dF(t.appConfig.senderId);if(s)return await tg(t,s),s}}async function tg(t,e){const n=hC(t),s=(await fC()).transaction(Ya,"readwrite");return await s.objectStore(Ya).put(e,n),await s.done,e}function hC({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},xt=new ri("messaging","Messaging",gF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(t,e){const n=await rg(t),r=pC(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(ng(t.appConfig),s)).json()}catch(o){throw xt.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw xt.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw xt.create("token-subscribe-no-token");return i.token}async function vF(t,e){const n=await rg(t),r=pC(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${ng(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw xt.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw xt.create("token-update-failed",{errorInfo:o})}if(!i.token)throw xt.create("token-update-no-token");return i.token}async function _F(t,e){const r={method:"DELETE",headers:await rg(t)};try{const i=await(await fetch(`${ng(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw xt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw xt.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function ng({projectId:t}){return`${iF}/projects/${t}/registrations`}async function rg({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function pC({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==cC&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=7*24*60*60*1e3;async function EF(t){const e=await xF(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Jn(e.getKey("auth")),p256dh:Jn(e.getKey("p256dh"))},r=await mF(t.firebaseDependencies);if(r){if(IF(r.subscriptionOptions,n))return Date.now()>=r.createTime+wF?TF(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await _F(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return hw(t.firebaseDependencies,n)}else return hw(t.firebaseDependencies,n)}async function TF(t,e){try{const n=await vF(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await tg(t.firebaseDependencies,r),n}catch(n){throw n}}async function hw(t,e){const r={token:await yF(t,e),createTime:Date.now(),subscriptionOptions:e};return await tg(t,r),r.token}async function xF(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:uF(e)})}function IF(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return SF(e,t),CF(e,t),AF(e,t),e}function SF(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function CF(t,e){e.data&&(t.data=e.data)}function AF(t,e){var s,i,o,a;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(a=e.fcmOptions)==null?void 0:a.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(t){return typeof t=="object"&&!!t&&dC in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RF(t){if(!t||!t.options)throw yf("App Configuration Object");if(!t.name)throw yf("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw yf(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function yf(t){return xt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PF{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=RF(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kF(t){try{t.swRegistration=await navigator.serviceWorker.register(rF,{scope:sF}),t.swRegistration.update().catch(()=>{}),await bF(t.swRegistration)}catch(e){throw xt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function bF(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${cw} ms`)),cw),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MF(t,e){if(!e&&!t.swRegistration&&await kF(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw xt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DF(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=cC)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(t,e){if(!navigator)throw xt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw xt.create("permission-blocked");return await DF(t,e==null?void 0:e.vapidKey),await MF(t,e==null?void 0:e.serviceWorkerRegistration),EF(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LF(t,e,n){const r=VF(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[dC],message_name:n[oF],message_time:n[aF],message_device_time:Math.floor(Date.now()/1e3)})}function VF(t){switch(t){case Ja.NOTIFICATION_CLICKED:return"notification_open";case Ja.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UF(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Ja.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(pw(n)):t.onMessageHandler.next(pw(n)));const r=n.data;NF(r)&&r[lF]==="1"&&await LF(t,n.messageType,r)}const mw="@firebase/messaging",gw="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=t=>{const e=new PF(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>UF(e,n)),e},OF=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>mC(e,r)}};function qF(){Gn(new Tn("messaging",FF,"PUBLIC")),Gn(new Tn("messaging-internal",OF,"PRIVATE")),ln(mw,gw),ln(mw,gw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BF(){try{await Tx()}catch{return!1}return typeof window<"u"&&Ex()&&LD()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(t,e){if(!navigator)throw xt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t=rm()){return BF().then(e=>{if(!e)throw xt.create("unsupported-browser")},e=>{throw xt.create("indexed-db-unsupported")}),po(Be(t),"messaging").getImmediate()}async function yC(t,e){return t=Be(t),mC(t,e)}function vC(t,e){return t=Be(t),jF(t,e)}qF();const GF={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},sg=nm(GF),Cs=dI(sg),Xe=kS(sg),Wl=typeof window<"u"?gC(sg):null,HF="dfmkfeqzt",$F="BOTIGAHANDBOL",vf=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",$F);const n=await fetch(`https://api.cloudinary.com/v1_1/${HF}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},Ht=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],yw=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Ht[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Ht[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Ht[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Ht[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Ht[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Ht[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Ht[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Ht[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Ht[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Ht[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Ht[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Ht[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Ht[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],zF=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[a,l]=V.useState(0),[u,p]=V.useState(!1),[m,g]=V.useState(!1),_=V.useRef(null);V.useEffect(()=>()=>{_.current&&clearTimeout(_.current)},[]),V.useEffect(()=>{const A=D=>{D.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[n]);const T=async()=>{u||(m?(_.current&&(clearTimeout(_.current),_.current=null),p(!0),await i(t.id)||(p(!1),g(!1))):(g(!0),_.current=window.setTimeout(()=>{g(!1),_.current=null},4e3)))},R=(e==null?void 0:e.role)==="admin",x=(e==null?void 0:e.id)===t.seller.id,C=t.imageUrls&&t.imageUrls.length>0,I=A=>typeof A!="number"||isNaN(A)?"N/A":A.toFixed(2);return h.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[h.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:A=>A.stopPropagation(),children:[h.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:h.jsx(es,{className:"w-6 h-6"})}),h.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[h.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:C&&h.jsx("img",{src:t.imageUrls[a],alt:`${t.title} - imatge ${a+1}`,className:"w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer",onClick:()=>o(t.imageUrls,a)})}),C&&t.imageUrls.length>1&&h.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((A,D)=>h.jsx("button",{onClick:()=>l(D),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${a===D?"border-primary":"border-transparent hover:border-gray-400"}`,children:h.jsx("img",{src:A,alt:`miniatura ${D+1}`,className:"w-full h-full object-cover"})},D))})]}),h.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[h.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),h.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[I(t.price)," "]}),h.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[h.jsxs("div",{className:"border-t pt-4",children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),h.jsx("div",{children:h.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),h.jsxs("div",{className:"border-t pt-4",children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),h.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),h.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&h.jsxs("a",{href:"https://forms.gle/wc7nmx2MubiMix8h8",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[h.jsx(CN,{className:"w-5 h-5"}),h.jsx("span",{children:"Realitzar comanda"})]}),!x&&e&&h.jsxs("button",{onClick:()=>s(t),className:`w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors ${t.isMerchandise?"bg-gray-600 text-white hover:bg-gray-700":"bg-primary text-white hover:bg-primary-700"}`,children:[h.jsx(DT,{className:"w-5 h-5"}),h.jsx("span",{children:t.isMerchandise?"Contacta amb el club":"Contacta amb el venedor"})]}),(R||x)&&h.jsxs("div",{className:"flex gap-3",children:[h.jsxs("button",{onClick:()=>r(t),disabled:u||m,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[h.jsx(xN,{className:"w-5 h-5"})," Edita"]}),h.jsx("button",{onClick:T,disabled:u,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${m?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:u?h.jsxs(h.Fragment,{children:[h.jsx(zs,{className:"w-5 h-5"}),h.jsx("span",{children:"Eliminant..."})]}):m?"Confirmar eliminaci":h.jsxs(h.Fragment,{children:[h.jsx(LT,{className:"w-5 h-5"}),h.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},WF=()=>{const[t,e]=V.useState("home"),[n,r]=V.useState([]),[s,i]=V.useState([]),[o,a]=V.useState(null),[l,u]=V.useState(null),[p,m]=V.useState(null),[g,_]=V.useState(null),[T,R]=V.useState(null),[x,C]=V.useState(null),[I,A]=V.useState([]),[D,U]=V.useState(!1),[F,w]=V.useState([]),[E,N]=V.useState(null),[b,k]=V.useState([]),[M,P]=V.useState(0),fe=V.useRef(new Set),[$e,je]=V.useState(!1);V.useEffect(()=>{if(x&&Wl){(async()=>{var B;if(Wl)try{if(await window.Notification.requestPermission()==="granted"){const W=await yC(Wl,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(W){const z=et(Xe,"users",x.id);(((B=(await hc(z)).data())==null?void 0:B.fcmTokens)||[]).includes(W)||await Mt(z,{fcmTokens:pc(W)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(j){console.error("Ha ocorregut un error en configurar les notificacions:",j)}})();const H=vC(Wl,B=>{var j,J;console.log("Missatge rebut en primer pla: ",B),a({message:`${(j=B.notification)==null?void 0:j.title}: ${(J=B.notification)==null?void 0:J.body}`,type:"success"})});return()=>H()}},[x]),V.useEffect(()=>{let O=null;const H=eI(Cs,B=>{if(O&&(O(),O=null),B){const j=et(Xe,"users",B.uid);O=Dn(j,J=>{J.exists()?C({id:B.uid,...J.data()}):(Gi(Cs),C(null))},J=>{console.error("Error en escoltar el document d'usuari:",J),Gi(Cs),C(null)})}else C(null)});return()=>{H(),O&&O()}},[]),V.useEffect(()=>{if((x==null?void 0:x.role)==="admin"){const O=bn(We(Xe,"users")),H=Dn(O,B=>{const j=B.docs.map(J=>({id:J.id,...J.data()}));A(j.filter(J=>J.id!==x.id))});return()=>H()}else A([])},[x]),V.useEffect(()=>{const O=bn(We(Xe,"products")),H=Dn(O,B=>{const j=B.docs.map(z=>{var _e;const ne=z.data(),ae=(_e=ne.createdAt)!=null&&_e.toDate?ne.createdAt.toDate():new Date;return{id:z.id,...ne,createdAt:ae}}),J=j.filter(z=>z.isMerchandise),W=j.filter(z=>!z.isMerchandise);J.sort((z,ne)=>ne.createdAt.getTime()-z.createdAt.getTime()),W.sort((z,ne)=>ne.createdAt.getTime()-z.createdAt.getTime()),i(J),r(W),_(null)},B=>{console.error("Error en el listener de Firestore (products):",B),_(B),a({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const j=yw.filter(W=>W.isMerchandise).map(W=>({...W,createdAt:new Date(W.createdAt)})),J=yw.filter(W=>!W.isMerchandise).map(W=>({...W,createdAt:new Date(W.createdAt)}));j.sort((W,z)=>z.createdAt.getTime()-W.createdAt.getTime()),J.sort((W,z)=>z.createdAt.getTime()-W.createdAt.getTime()),i(j),r(J)});return()=>H()},[]),V.useEffect(()=>{if(!x){w([]);return}const O=bn(We(Xe,"chats"),$i("participantIds","array-contains",x.id)),H=Dn(O,B=>{let j=B.docs.map(W=>({id:W.id,...W.data()}));j=j.filter(W=>{var z;return!((z=W.hiddenFor)!=null&&z.includes(x.id))&&!fe.current.has(W.id)}),j.sort((W,z)=>{var _e,jt;const ne=((_e=W.updatedAt)==null?void 0:_e.toMillis())||0;return(((jt=z.updatedAt)==null?void 0:jt.toMillis())||0)-ne});const J=j.reduce((W,z)=>W+(z.unreadCount[x.id]||0),0);P(J),w(j),_(null)},B=>{console.error("Error fetching chats:",B),_(B)});return()=>H()},[x]),V.useEffect(()=>{if(!E){k([]);return}const O=bn(We(Xe,"chats",E.id,"messages")),H=Dn(O,B=>{const j=B.docs.map(J=>({id:J.id,...J.data()}));j.sort((J,W)=>{var ae,_e;const z=((ae=J.timestamp)==null?void 0:ae.toMillis())||0,ne=((_e=W.timestamp)==null?void 0:_e.toMillis())||0;return z-ne}),k(j)});return()=>H()},[E]),V.useEffect(()=>{if(o){const O=setTimeout(()=>a(null),8e3);return()=>clearTimeout(O)}},[o]),V.useEffect(()=>{const O="LABOTIGA";M>0?document.title=`(${M}) ${O}`:document.title=O},[M]),V.useEffect(()=>(l||D||!x||$e||T?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[l,D,x,$e,T]);const Bt=async(O,H)=>{await Zx(Cs,O,H),a({message:"Benvingut/da de nou!",type:"success"})},Q=(O,H)=>{const J=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(W=>{let z=0;for(let ae=0;ae<W.length;ae++)z=W.charCodeAt(ae)+((z<<5)-z);let ne="#";for(let ae=0;ae<3;ae++){const _e=z>>ae*8&255;ne+=("00"+_e.toString(16)).substr(-2)}return ne})(H)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${O}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(J)}`},se=async(O,H,B,j)=>{let J="",W=j;if(!W){const _e=O.split(" ").map(jt=>jt[0]).slice(0,2).join("").toUpperCase();W=Q(_e,O)}try{J=await vf(W)}catch(_e){throw console.error("La pujada de la imatge ha fallat:",_e),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!J)throw new Error("Cloudinary no ha retornat una URL vlida.");const ne=(await Xx(Cs,H,B)).user,ae={name:O,email:H,avatarUrl:J,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await GS(et(Xe,"users",ne.uid),ae),C({id:ne.uid,...ae}),a({message:`Benvingut/da, ${O}! El teu compte ha estat creat.`,type:"success"})},ue=async O=>{try{await Qx(Cs,O),a({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(H){throw console.error("Error en restablir la contrasenya:",H),H}},xe=async()=>{e("home"),await Gi(Cs),a({message:"Sessi tancada correctament.",type:"success"})},Ae=()=>{e("home"),m(null)},fn=()=>{m(null),e("listing")},pt=()=>{x&&e("profile")},hn=async(O,H,B)=>{if(!x||x.id!==O)throw a({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(H===x.name&&!B){a({message:"No s'han detectat canvis.",type:"success"});return}try{const j={name:H};B&&(j.avatarUrl=await vf(B));const J=et(Xe,"users",O);await Mt(J,j),a({message:"Perfil actualitzat correctament!",type:"success"})}catch(j){throw console.error("Error actualitzant l'usuari:",j),a({message:`Error en actualitzar: ${j.message||"Error desconegut."}`,type:"error"}),j}},Ct=async(O,H)=>{var W;if(!x){a({message:"Has d'iniciar la sessi per desar un producte.",type:"error"});return}const B=O.imageUrls.map(z=>z.startsWith("data:image")?vf(z):Promise.resolve(z)),j=await Promise.all(B),J={...O,imageUrls:j};if(H){const z=et(Xe,"products",H),ne=(W=(await hc(z)).data())==null?void 0:W.seller;await Mt(z,{...J,seller:ne}),a({message:"Anunci actualitzat correctament!",type:"success"})}else{const z={...J,seller:{id:x.id,name:x.name,avatarUrl:x.avatarUrl},createdAt:new Date};await Mn(We(Xe,"products"),z),a({message:"Anunci publicat amb xit!",type:"success"})}e("home"),m(null)},Zt=O=>{m(O),u(null),e("listing")},gs=async O=>{try{return await HS(et(Xe,"products",O)),a({message:"Anunci eliminat correctament.",type:"success"}),u(null),!0}catch(H){console.error("Error en eliminar el producte: ",H);const B=`Error en eliminar: ${H.code||H.message||"Error desconegut."}`;return a({message:B,type:"error"}),!1}},ai=O=>{u(O)},xo=()=>{u(null)},Io=async O=>{if(!x)return;const H=O.seller.id,B=x.id,j=We(Xe,"chats"),J=bn(j,$i("productId","==",O.id),$i("participantIds","array-contains",B)),W=await jS(J);let z=null;if(W.forEach(ne=>{const ae={id:ne.id,...ne.data()};ae.participantIds.includes(H)&&(z=ae)}),z)await wr(z);else{const ne={participantIds:[B,H],participants:{[B]:{name:x.name,avatarUrl:x.avatarUrl},[H]:{name:O.seller.name,avatarUrl:O.seller.avatarUrl}},productId:O.id,productTitle:O.title,productImageUrl:O.imageUrls[0]||"",lastMessage:null,createdAt:_t(),updatedAt:_t(),unreadCount:{[B]:0,[H]:0},hiddenFor:[]},ae=await Mn(We(Xe,"chats"),ne);N({id:ae.id,...ne})}u(null),U(!0)},wr=async O=>{if(N(O),x&&(O.unreadCount[x.id]||0)>0){const H=et(Xe,"chats",O.id);await Mt(H,{[`unreadCount.${x.id}`]:0})}},ys=async(O,H)=>{if(!x||!E)return;const B=x.id,j=E.participantIds.find(z=>z!==B);if(!j)return;const J={senderId:B,text:O,timestamp:_t(),...H&&{imageUrl:H}};await Mn(We(Xe,"chats",E.id,"messages"),J);const W=et(Xe,"chats",E.id);await Mt(W,{lastMessage:{...J,timestamp:new Date},updatedAt:_t(),[`unreadCount.${j}`]:mc(1)})},li=()=>{N(null)},So=()=>{U(!1),N(null)},vs=async O=>{if(!x)return;fe.current.add(O),w(B=>B.filter(j=>j.id!==O)),(E==null?void 0:E.id)===O&&N(null);const H=et(Xe,"chats",O);try{await Mt(H,{hiddenFor:pc(x.id)}),fe.current.delete(O)}catch(B){console.error("Error en eliminar el xat:",B),a({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),fe.current.delete(O)}},_s=async(O,H)=>{if(!x||x.role!=="admin"){a({message:"No autoritzat.",type:"error"});return}const B=O==="all"?I:I.filter(j=>j.id===O);if(B.length===0){a({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const j of B){const J=`admin-message-${x.id}-${j.id}-${Date.now()}`,W={participantIds:[x.id,j.id],participants:{[x.id]:{name:x.name,avatarUrl:x.avatarUrl},[j.id]:{name:j.name,avatarUrl:j.avatarUrl}},productId:J,productTitle:"Missatge de l'administrador",productImageUrl:x.avatarUrl,lastMessage:null,createdAt:_t(),updatedAt:_t(),unreadCount:{[x.id]:0,[j.id]:0},hiddenFor:[]},z=await Mn(We(Xe,"chats"),W),ne={senderId:x.id,text:H,timestamp:_t()};await Mn(We(Xe,"chats",z.id,"messages"),ne),await Mt(z,{lastMessage:{...ne,timestamp:new Date},updatedAt:_t(),[`unreadCount.${j.id}`]:mc(1)})}a({message:`Missatge enviat a ${B.length} usuari(s).`,type:"success"})}catch(j){throw console.error("Error en enviar el missatge d'administrador:",j),a({message:"No s'ha pogut enviar el missatge.",type:"error"}),j}};return x?h.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[h.jsx(DN,{user:x,onNavigateHome:Ae,onNavigateToListing:fn,onNavigateToProfile:pt,onOpenTutorial:()=>je(!0)}),h.jsx(nD,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>a(null)}),t==="home"&&h.jsx(LN,{userProducts:n,merchProducts:s,onProductSelect:ai,firebaseError:g,currentUser:x}),t==="listing"&&h.jsx(tD,{onSave:Ct,productToEdit:p,currentUser:x}),t==="profile"&&h.jsx(aD,{user:x,onUpdateUser:hn,onBack:()=>e("home"),onLogout:xe,allUsers:I,onSendAdminMessage:_s}),l&&h.jsx(zF,{product:l,currentUser:x,onClose:xo,onEdit:Zt,onContactSeller:Io,onDelete:gs,onOpenImageViewer:(O,H)=>R({images:O,startIndex:H})}),$e&&h.jsx(hD,{onClose:()=>je(!1)}),T&&h.jsx(pD,{images:T.images,startIndex:T.startIndex,onClose:()=>R(null)}),h.jsx(lD,{isOpen:D,onClick:()=>U(!D),unreadCount:M}),h.jsx(fD,{isOpen:D,onClose:So,chats:F,activeChat:E,messages:b,currentUser:x,onSendMessage:ys,onSelectChat:wr,onBackToList:li,onDeleteChat:vs})]}):h.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),h.jsx("div",{className:"relative z-10",children:h.jsx(sD,{onLogin:Bt,onRegister:se,onPasswordReset:ue,isDismissable:!1})})]})},_C=document.getElementById("root");if(!_C)throw new Error("Could not find root element to mount to");const KF=vu.createRoot(_C);KF.render(h.jsx(kw.StrictMode,{children:h.jsx(WF,{})}));const ig=t=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),wC=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),ls=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),EC=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),JF=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),TC=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),Zs=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:h.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),YF=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),QF=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),xC=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),XF=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),ZF=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),e9=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),t9=t=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),Yh=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),n9=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),r9=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),s9=t=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),i9=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),IC=t=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),o9=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>h.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:h.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[h.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),h.jsxs("span",{className:"text-2xl font-bold",children:[h.jsx("span",{className:"text-gray-900",children:"LA"}),h.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),h.jsx("div",{className:"flex items-center gap-4",children:t&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:h.jsx(IC,{className:"w-7 h-7"})}),h.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[h.jsx(Yh,{className:"h-5 w-5"}),h.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),h.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[h.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),h.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),vw=({product:t,onSelect:e})=>{const n=t.imageUrls&&t.imageUrls.length>0,r=s=>typeof s!="number"||isNaN(s)?"N/A":s.toFixed(2);return h.jsxs("button",{onClick:e,className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden group text-left w-full hover:shadow-lg transition-shadow",children:[h.jsx("div",{className:"w-full aspect-square bg-gray-100 overflow-hidden",children:n&&h.jsx("img",{src:t.imageUrls[0],alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),h.jsxs("div",{className:"p-3",children:[h.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[r(t.price)," "]}),h.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),h.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[h.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),h.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})},a9=({userProducts:t,merchProducts:e,onProductSelect:n,firebaseError:r,currentUser:s})=>{const[i,o]=V.useState(t),[a,l]=V.useState("");V.useEffect(()=>{const p=a.toLowerCase();if(p==="")o(t);else{const m=t.filter(g=>g.title.toLowerCase().includes(p)||g.description.toLowerCase().includes(p));o(m)}},[a,t]);const u=p=>{l(p.target.value)};return h.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Descobreix i estalvia"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"Busca entre els articles de segona m a prop teu."}),h.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:h.jsxs("div",{className:"relative flex-grow",children:[h.jsx(xC,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:a,onChange:u,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&h.jsx("section",{className:"mb-12",children:h.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[h.jsx("div",{className:"flex justify-between items-center mb-6",children:h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club"})}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:e.map(p=>h.jsx(vw,{product:p,onSelect:()=>n(p)},p.id))})]})}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles destacats"}),i.length>0?h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:i.map(p=>h.jsx(vw,{product:p,onSelect:()=>n(p)},p.id))}):h.jsx("div",{className:"text-center py-16",children:h.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},Wn=5,l9=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.85))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),u9=({images:t,setImages:e})=>{const[n,r]=V.useState(!1),[s,i]=V.useState(null),[o,a]=V.useState(!1),l=V.useRef(null),u=V.useRef(null),p=async T=>{const R=T.target.files;if(!R)return;const x=Array.from(R).slice(0,Wn-t.length);if(R.length>x.length?i(`Noms pots pujar un mxim de ${Wn} imatges.`):i(null),x.length!==0){r(!0);try{const C=x.map(A=>l9(A)),I=await Promise.all(C);e([...t,...I])}catch(C){i("No s'ha pogut carregar una o ms imatges."),console.error(C)}finally{r(!1)}T.target.value=""}},m=T=>{e(t.filter((R,x)=>x!==T))},g=()=>{var T;a(!1),(T=l.current)==null||T.click()},_=()=>{var T;a(!1),(T=u.current)==null||T.click()};return h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:h.jsx(Yh,{className:"h-6 w-6 text-primary"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),h.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",Wn]})]}),h.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((T,R)=>h.jsxs("div",{className:"relative aspect-square group",children:[h.jsx("img",{src:T,alt:`Product image ${R+1}`,className:"w-full h-full object-cover rounded-lg border"}),h.jsx("button",{onClick:()=>m(R),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:h.jsx(ls,{className:"w-4 h-4"})})]},R)),n&&h.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:h.jsx(Zs,{className:"w-8 h-8 text-primary"})}),t.length<Wn&&!n&&h.jsxs("button",{onClick:()=>a(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${Wn-t.length} imatges ms`,children:[h.jsx(Yh,{className:"mx-auto h-8 w-8 text-gray-400"}),h.jsx("p",{className:"mt-1 text-xs text-gray-600",children:h.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),h.jsx("input",{ref:l,type:"file",onChange:p,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=Wn}),h.jsx("input",{ref:u,type:"file",onChange:p,className:"hidden",accept:"image/*",capture:"environment",disabled:t.length>=Wn}),s&&h.jsx("p",{className:"text-red-500 text-sm mt-4",children:s}),o&&h.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>a(!1),"aria-modal":"true",role:"dialog",children:[h.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),h.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:T=>T.stopPropagation(),children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),h.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:h.jsx(ls,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("button",{onClick:_,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Wn,children:[h.jsx(ig,{className:"w-6 h-6 text-primary"}),h.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),h.jsxs("button",{onClick:g,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Wn,children:[h.jsx(TC,{className:"w-6 h-6 text-primary"}),h.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]})]})},c9=({title:t,setTitle:e,description:n,setDescription:r})=>h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:h.jsx(e9,{className:"h-6 w-6 text-primary"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),h.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),h.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),d9=({images:t,title:e,description:n,price:r,onPublish:s,isEditing:i})=>{const o=t.length>0&&e&&r;return h.jsx("div",{className:"sticky top-28",children:h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),h.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?h.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):h.jsx(TC,{className:"w-16 h-16 text-gray-300"})}),h.jsxs("div",{className:"space-y-3",children:[h.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),h.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),h.jsx("div",{className:"border-t pt-3",children:h.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),h.jsx("button",{onClick:s,disabled:!o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:i?"Desa els canvis":"Publica l'anunci"})]})]})})};throw new Error("API_KEY environment variable is not set.");const f9=new fx({apiKey:void 0}),h9=async t=>{var e,n,r;try{const s=`Basant-te en anuncis en lnia, suggereix un preu de venda raonable en euros per a aquest article: "${t}". Respon noms amb una frase curta, per exemple: "Un preu just seria al voltant de XX ."`,i=await f9.models.generateContent({model:"gemini-2.5-flash",contents:s,config:{tools:[{googleSearch:{}}]}}),o=i.text,a=((r=(n=(e=i.candidates)==null?void 0:e[0])==null?void 0:n.groundingMetadata)==null?void 0:r.groundingChunks)||[];if(!o)throw new Error("No price suggestion found in the response.");return{suggestion:o,sources:a}}catch(s){throw console.error("Error suggesting price:",s),s}},p9=({title:t,description:e,price:n,setPrice:r})=>{const[s,i]=V.useState(!1),[o,a]=V.useState(null),[l,u]=V.useState([]),[p,m]=V.useState(null),g=async()=>{const _=`${t} ${e}`;if(!_.trim()){m("Si us plau, proporciona primer un ttol o una descripci.");return}i(!0),m(null),a(null),u([]);try{const T=await h9(_),R=T.suggestion.match(/(\d+([.,]\d{1,2})?)\s*?/),x=R?R[1].replace(",","."):"";a(T.suggestion),r(x),u(T.sources||[])}catch(T){m("No s'ha pogut suggerir un preu. Si us plau, torna-ho a provar."),console.error(T)}finally{i(!1)}};return h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:h.jsx(t9,{className:"h-6 w-6 text-primary"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),h.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Obtn un suggeriment de preu basat en anuncis en lnia o introdueix-lo manualment."}),h.jsxs("button",{onClick:g,disabled:s||!t,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-gray-400 disabled:cursor-not-allowed",children:[s?h.jsx(Zs,{className:"w-5 h-5"}):h.jsx(xC,{className:"w-5 h-5"}),h.jsx("span",{className:"ml-2",children:"Suggereix un preu"})]}),p&&h.jsx("p",{className:"text-red-500 text-sm mt-2",children:p}),o&&h.jsx("div",{className:"mt-4 p-4 bg-primary-50 border border-primary-200 rounded-lg",children:h.jsx("p",{className:"text-gray-800 font-medium",children:o})}),l.length>0&&h.jsxs("div",{className:"mt-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Fonts:"}),h.jsx("ul",{className:"mt-2 space-y-1 text-sm list-disc list-inside",children:l.map((_,T)=>_.web?h.jsx("li",{children:h.jsx("a",{href:_.web.uri,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:_.web.title})},T):null)})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),h.jsx("input",{id:"product-price",type:"number",value:n,onChange:_=>r(_.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]})},m9=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=V.useState([]),[i,o]=V.useState(""),[a,l]=V.useState(""),[u,p]=V.useState(""),[m,g]=V.useState(!1),_=!!e;V.useEffect(()=>{var x;_&&e?(o(e.title),l(e.description),p(((x=e.price)==null?void 0:x.toString())||""),s(e.imageUrls||[]),g(e.isMerchandise||!1)):T()},[e,_]);const T=()=>{s([]),o(""),l(""),p(""),g(!1)},R=()=>{if(r.length>0&&i&&u){const x={title:i,description:a,price:parseFloat(u),imageUrls:r,isMerchandise:m};t(x,e==null?void 0:e.id),_||T()}};return h.jsx("main",{className:"container mx-auto p-4 md:p-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:_?"Edita el teu anunci":"Crea el teu anunci"}),h.jsx("p",{className:"text-gray-600 mb-8",children:_?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[h.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[h.jsx(u9,{images:r,setImages:s}),h.jsx(c9,{title:i,setTitle:o,description:a,setDescription:l}),(n==null?void 0:n.role)==="admin"&&h.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),h.jsx("div",{className:"mt-4",children:h.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:m,onChange:x=>g(x.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),h.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]})})]}),h.jsx(p9,{title:i,description:a,price:u,setPrice:p})]}),h.jsx("div",{className:"lg:col-span-2",children:h.jsx(d9,{images:r,title:i,description:a,price:u,onPublish:R,isEditing:_})})]})]})})},g9=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return h.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[h.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),h.jsxs("div",{className:`${r} ${s[e]}`,children:[h.jsx("span",{children:t}),h.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:h.jsx(ls,{className:"w-4 h-4"})})]})]})},y9=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.9))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),v9=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=V.useState("login"),[a,l]=V.useState(""),[u,p]=V.useState(""),[m,g]=V.useState(""),[_,T]=V.useState(!1),[R,x]=V.useState(null),C=V.useRef(null),[I,A]=V.useState(!1),[D,U]=V.useState(null),[F,w]=V.useState(null),E=async k=>{var P;const M=(P=k.target.files)==null?void 0:P[0];if(M)try{const fe=await y9(M);x(fe)}catch(fe){console.error("Error en llegir el fitxer:",fe),U("No s'ha pogut processar la imatge.")}},N=async k=>{k.preventDefault(),A(!0),U(null),w(null);try{i==="login"?await e(u,m):await n(a,u,m,R)}catch(M){let P="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(M.code)switch(M.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":P="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":P="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":P="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":P="El format del correu electrnic no s vlid.";break}else M.message&&(M.message.includes("Cloudinary")?P="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":P=M.message);U(P),console.error(M)}finally{A(!1)}},b=async k=>{k.preventDefault(),A(!0),U(null),w(null);try{await r(u),w("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(M){let P="Hi ha hagut un error en enviar el correu.";(M.code==="auth/user-not-found"||M.code==="auth/invalid-email")&&(P="No s'ha trobat cap usuari amb aquest correu electrnic."),U(P)}finally{A(!1)}};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:k=>k.stopPropagation(),children:[s&&h.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:h.jsx(ls,{className:"w-6 h-6"})}),h.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),h.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),h.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),h.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),h.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:u,onChange:k=>p(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),D&&h.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),F&&h.jsx("p",{className:"text-green-600 text-sm text-center",children:F}),h.jsx("div",{children:h.jsx("button",{type:"submit",disabled:I,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:I?h.jsx(Zs,{className:"w-5 h-5"}):"Envia l'enlla"})}),h.jsx("div",{children:h.jsx("button",{type:"button",onClick:()=>{o("login"),U(null),w(null),T(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),h.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?h.jsxs(h.Fragment,{children:["Benvingut/da a LA",h.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),h.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),h.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[h.jsx("button",{onClick:()=>{o("login"),U(null),w(null),T(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),h.jsx("button",{onClick:()=>{o("register"),U(null),w(null),T(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),h.jsxs("form",{onSubmit:N,className:"space-y-4",children:[i==="register"&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-center",children:[h.jsx("input",{type:"file",ref:C,onChange:E,className:"hidden",accept:"image/*"}),h.jsxs("button",{type:"button",onClick:()=>{var k;return(k=C.current)==null?void 0:k.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[R?h.jsx("img",{src:R,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):h.jsx(ig,{className:"w-10 h-10"}),h.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),h.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:a,onChange:k=>l(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),h.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:u,onChange:k=>p(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&h.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),U(null),w(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),h.jsxs("div",{className:"relative mt-1",children:[h.jsx("input",{id:"password",name:"password",type:_?"text":"password",autoComplete:"current-password",required:!0,value:m,onChange:k=>g(k.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),h.jsx("button",{type:"button",onClick:()=>T(!_),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":_?"Oculta la contrasenya":"Mostra la contrasenya",children:_?h.jsx(i9,{className:"w-5 h-5"}):h.jsx(s9,{className:"w-5 h-5"})})]})]}),D&&h.jsx("p",{className:"text-red-500 text-sm text-center",children:D}),F&&h.jsx("p",{className:"text-green-600 text-sm text-center",children:F}),h.jsx("div",{children:h.jsx("button",{type:"submit",disabled:I,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:I?h.jsx(Zs,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},_9=(t,e=512,n=512)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.9))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),w9=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=V.useState("all"),[s,i]=V.useState(""),[o,a]=V.useState(!1),l=async u=>{if(u.preventDefault(),!!s.trim()){a(!0);try{await e(n,s),i(""),r("all")}catch{}finally{a(!1)}}};return h.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[h.jsx(YF,{className:"h-10 w-10 text-primary"}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),h.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),h.jsxs("form",{onSubmit:l,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),h.jsxs("select",{id:"recipient",value:n,onChange:u=>r(u.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[h.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(u=>h.jsxs("option",{value:u.id,children:[u.name," (",u.email,")"]},u.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),h.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:u=>i(u.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),h.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?h.jsx(Zs,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},E9=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i})=>{const[o,a]=V.useState(t.name),[l,u]=V.useState(null),p=V.useRef(null),[m,g]=V.useState(!1);V.useEffect(()=>{a(t.name)},[t]);const _=async R=>{var C;const x=(C=R.target.files)==null?void 0:C[0];if(x)try{const I=await _9(x);u(I)}catch(I){console.error("Error en llegir el fitxer:",I)}},T=async R=>{R.preventDefault(),g(!0);try{await e(t.id,o,l),u(null)}catch(x){console.error(x)}finally{g(!1)}};return h.jsx("main",{className:"container mx-auto p-4 md:p-8",children:h.jsxs("div",{className:"max-w-2xl mx-auto",children:[h.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[h.jsx(n9,{className:"h-10 w-10 text-primary"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),h.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),h.jsxs("form",{onSubmit:T,className:"space-y-4 sm:space-y-6",children:[h.jsxs("div",{className:"flex flex-col items-center gap-4",children:[h.jsx("input",{type:"file",ref:p,onChange:_,className:"hidden",accept:"image/*"}),h.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),h.jsxs("button",{type:"button",onClick:()=>{var R;return(R=p.current)==null?void 0:R.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[h.jsx("img",{src:l||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:h.jsx(ig,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),h.jsx("input",{id:"name",type:"text",required:!0,value:o,onChange:R=>a(R.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),h.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),h.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),h.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[h.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),h.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:m?h.jsx(Zs,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),h.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:h.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&h.jsx(w9,{allUsers:s,onSendAdminMessage:i})]})})},T9=({onClick:t,unreadCount:e,isOpen:n})=>n?null:h.jsxs(h.Fragment,{children:[h.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),h.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&h.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),h.jsx("div",{className:"w-9 h-9",children:h.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),x9=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return h.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:h.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&h.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&h.jsx("div",{className:"mt-2",children:h.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),h.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},I9=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var l;if(!((l=o.target)!=null&&l.result))return s(new Error("No s'ha pogut llegir el fitxer."));const a=new Image;a.src=o.target.result,a.onload=()=>{const u=document.createElement("canvas");let{width:p,height:m}=a;p>m?p>e&&(m=Math.round(m*(e/p)),p=e):m>n&&(p=Math.round(p*(n/m)),m=n),u.width=p,u.height=m;const g=u.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(a,0,0,p,m),r(u.toDataURL("image/jpeg",.85))},a.onerror=u=>s(new Error(`Error en carregar la imatge: ${u}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),S9=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,_,T,R,x;const a=t.participantIds.find(C=>C!==n.id);if(!a)return null;const l=t.participants[a],u=t.unreadCount[n.id]||0,p=((T=(_=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:_.toDate())==null?void 0:T.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",m=()=>{r(t.id),o()};return h.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[h.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[h.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),h.jsx("button",{onClick:m,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),h.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[h.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[h.jsxs("div",{className:"relative flex-shrink-0",children:[h.jsx("img",{src:l.avatarUrl,alt:l.name,className:"w-12 h-12 rounded-full object-cover"}),h.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),h.jsxs("div",{className:"flex-1 overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("p",{className:"font-bold text-gray-800 truncate",children:l.name}),h.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:p})]}),h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((R=t.lastMessage)==null?void 0:R.text)||((x=t.lastMessage)!=null&&x.imageUrl?"Imatge":"Cap missatge encara")}),u>0&&h.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:u})]})]})]}),h.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${l.name}`,children:h.jsx(EC,{className:"w-5 h-5"})})]})]})},C9=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:a,onBackToList:l,onDeleteChat:u})=>{const[p,m]=V.useState(""),[g,_]=V.useState(null),T=V.useRef(null),R=V.useRef(null),x=()=>{var w;(w=R.current)==null||w.scrollIntoView({behavior:"smooth"})};V.useEffect(()=>{t&&r&&x()},[s,t,r]),V.useEffect(()=>{(!t||!r)&&_(null)},[t,r]);const C=()=>{p.trim()&&(o(p),m(""))},I=w=>{w.key==="Enter"&&(w.preventDefault(),C())},A=async w=>{var N;const E=(N=w.target.files)==null?void 0:N[0];if(E)try{const b=await I9(E);o("",b)}catch(b){console.error("No s'ha pogut llegir el fitxer",b)}w.target&&(w.target.value="")},D=()=>{var w;(w=T.current)==null||w.click()};if(!t||!i)return null;const U=r==null?void 0:r.participantIds.find(w=>w!==i.id),F=U?r==null?void 0:r.participants[U]:null;return h.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[h.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),h.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?h.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[h.jsx("button",{onClick:l,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:h.jsx(r9,{className:"w-6 h-6"})}),h.jsx("img",{src:F==null?void 0:F.avatarUrl,alt:F==null?void 0:F.name,className:"w-8 h-8 rounded-full object-cover"}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("h3",{className:"font-bold text-lg truncate",children:F==null?void 0:F.name}),h.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):h.jsx("div",{className:"flex items-center justify-between w-full",children:h.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),h.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:h.jsx(ls,{className:"w-6 h-6"})})]}),r?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(w=>h.jsx(x9,{message:w,currentUser:i},w.id)),h.jsx("div",{ref:R})]}),h.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:h.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[h.jsx("input",{type:"text",value:p,onChange:w=>m(w.target.value),onKeyPress:I,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),h.jsx("input",{ref:T,type:"file",onChange:A,className:"hidden",accept:"image/*"}),h.jsx("button",{onClick:D,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:h.jsx(QF,{className:"w-5 h-5"})}),h.jsx("button",{onClick:C,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!p.trim(),"aria-label":"Envia el missatge",children:h.jsx(ZF,{className:"w-5 h-5"})})]})})]}):h.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(w=>h.jsx(S9,{chat:w,onSelect:()=>a(w),currentUser:i,onDelete:u,isConfirmingDelete:g===w.id,onStartConfirmDelete:()=>_(w.id),onCancelConfirmDelete:()=>_(null)},w.id)):h.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[h.jsx(wC,{className:"w-16 h-16 text-gray-300 mb-4"}),h.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),h.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},As=({title:t,children:e})=>h.jsxs("section",{className:"mb-6",children:[h.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),h.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),A9=({onClose:t})=>h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[h.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(IC,{className:"w-8 h-8 text-primary"}),h.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",h.jsx("span",{className:"text-gray-900",children:"LA"}),h.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),h.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:h.jsx(ls,{className:"w-6 h-6"})})]}),h.jsxs("div",{className:"p-6 overflow-y-auto",children:[h.jsxs("section",{className:"mb-6",children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",h.jsx("span",{className:"text-gray-900",children:"LA"}),h.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),h.jsx("div",{className:"space-y-2 text-gray-700",children:h.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),h.jsx(As,{title:"1. Explora els Articles",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["A la pgina principal, trobars les seccions ",h.jsx("strong",{children:"'Marxandatge del Club'"})," i ",h.jsx("strong",{children:"'Articles destacats'"}),"."]}),h.jsxs("li",{children:["Fes servir la ",h.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),h.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),h.jsx(As,{title:"2. Comprar un Article de Segona M",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),h.jsxs("li",{children:[h.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),h.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),h.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",h.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),h.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),h.jsxs(As,{title:"3. Vendre un Article",children:[h.jsxs("p",{children:["Fes clic al bot ",h.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),h.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",h.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),h.jsx(As,{title:"4. Gestiona els Teus Xats",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["Fes clic a la ",h.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),h.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),h.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),h.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),h.jsx(As,{title:"5. El Teu Perfil",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["Fes clic a la teva ",h.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),h.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),h.jsxs("li",{children:["Tamb pots ",h.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),h.jsx(As,{title:"6. Comprar Marxandatge Oficial",children:h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club' sn productes oficials."}),h.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",h.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),h.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",h.jsx("strong",{children:"'Contacta amb el club'"})," per iniciar un xat directe abans de fer la comanda."]})]})}),h.jsxs(As,{title:"7. Eines d'Administrador",children:[h.jsx("p",{children:"Si tens el rol d'administrador, a la teva pgina de perfil trobars un panell addicional."}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["Aquest panell et permet enviar ",h.jsx("strong",{children:"missatges massius"})," a tots els usuaris o missatges directes a un usuari especfic."]}),h.jsx("li",{children:"Aquests missatges apareixeran com una nova conversa de xat per als destinataris."})]})]})]})]})}),_w=({direction:t,onClick:e})=>h.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),N9=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=V.useState(e),[i,o]=V.useState(null),a=V.useCallback(()=>{s(m=>m===0?t.length-1:m-1)},[t.length]),l=V.useCallback(()=>{s(m=>m===t.length-1?0:m+1)},[t.length]);V.useEffect(()=>{const m=g=>{g.key==="ArrowLeft"&&a(),g.key==="ArrowRight"&&l(),g.key==="Escape"&&n()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[a,l,n]);const u=m=>{o(m.touches[0].clientX)},p=m=>{if(i===null)return;const g=m.touches[0].clientX,_=i-g;_>50?(l(),o(null)):_<-50&&(a(),o(null))};return h.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[h.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),h.jsx("button",{onClick:m=>{m.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:h.jsx(ls,{className:"w-6 h-6"})}),h.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&h.jsx(_w,{direction:"left",onClick:a}),h.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:u,onTouchMove:p,children:h.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&h.jsx(_w,{direction:"right",onClick:l})]}),t.length>1&&h.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},R9={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},og=nm(R9),Ns=dI(og),Ze=kS(og),_f=typeof window<"u"?gC(og):null,P9="dfmkfeqzt",k9="BOTIGAHANDBOL",wf=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",k9);const n=await fetch(`https://api.cloudinary.com/v1_1/${P9}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},$t=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],ww=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:$t[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:$t[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:$t[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:$t[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:$t[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:$t[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:$t[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:$t[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:$t[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:$t[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:$t[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:$t[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:$t[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],b9=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[a,l]=V.useState(0),[u,p]=V.useState(!1),[m,g]=V.useState(!1),_=V.useRef(null);V.useEffect(()=>()=>{_.current&&clearTimeout(_.current)},[]),V.useEffect(()=>{const A=D=>{D.key==="Escape"&&n()};return window.addEventListener("keydown",A),()=>{window.removeEventListener("keydown",A)}},[n]);const T=async()=>{u||(m?(_.current&&(clearTimeout(_.current),_.current=null),p(!0),await i(t.id)||(p(!1),g(!1))):(g(!0),_.current=window.setTimeout(()=>{g(!1),_.current=null},4e3)))},R=(e==null?void 0:e.role)==="admin",x=(e==null?void 0:e.id)===t.seller.id,C=t.imageUrls&&t.imageUrls.length>0,I=A=>typeof A!="number"||isNaN(A)?"N/A":A.toFixed(2);return h.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[h.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),h.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:A=>A.stopPropagation(),children:[h.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:h.jsx(ls,{className:"w-6 h-6"})}),h.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[h.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:C&&h.jsx("img",{src:t.imageUrls[a],alt:`${t.title} - imatge ${a+1}`,className:"w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer",onClick:()=>o(t.imageUrls,a)})}),C&&t.imageUrls.length>1&&h.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((A,D)=>h.jsx("button",{onClick:()=>l(D),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${a===D?"border-primary":"border-transparent hover:border-gray-400"}`,children:h.jsx("img",{src:A,alt:`miniatura ${D+1}`,className:"w-full h-full object-cover"})},D))})]}),h.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[h.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),h.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[I(t.price)," "]}),h.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[h.jsxs("div",{className:"border-t pt-4",children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),h.jsx("div",{children:h.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),h.jsxs("div",{className:"border-t pt-4",children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),h.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),h.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&h.jsxs("a",{href:"https://forms.gle/wc7nmx2MubiMix8h8",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[h.jsx(XF,{className:"w-5 h-5"}),h.jsx("span",{children:"Realitzar comanda"})]}),!x&&e&&h.jsxs("button",{onClick:()=>s(t),className:`w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors ${t.isMerchandise?"bg-gray-600 text-white hover:bg-gray-700":"bg-primary text-white hover:bg-primary-700"}`,children:[h.jsx(wC,{className:"w-5 h-5"}),h.jsx("span",{children:t.isMerchandise?"Contacta amb el club":"Contacta amb el venedor"})]}),(R||x)&&h.jsxs("div",{className:"flex gap-3",children:[h.jsxs("button",{onClick:()=>r(t),disabled:u||m,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[h.jsx(JF,{className:"w-5 h-5"})," Edita"]}),h.jsx("button",{onClick:T,disabled:u,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${m?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:u?h.jsxs(h.Fragment,{children:[h.jsx(Zs,{className:"w-5 h-5"}),h.jsx("span",{children:"Eliminant..."})]}):m?"Confirmar eliminaci":h.jsxs(h.Fragment,{children:[h.jsx(EC,{className:"w-5 h-5"}),h.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},M9=()=>{const[t,e]=V.useState("home"),[n,r]=V.useState([]),[s,i]=V.useState([]),[o,a]=V.useState(null),[l,u]=V.useState(null),[p,m]=V.useState(null),[g,_]=V.useState(null),[T,R]=V.useState(null),[x,C]=V.useState(null),[I,A]=V.useState([]),[D,U]=V.useState(!1),[F,w]=V.useState([]),[E,N]=V.useState(null),[b,k]=V.useState([]),[M,P]=V.useState(0),fe=V.useRef(new Set),[$e,je]=V.useState(!1);V.useEffect(()=>{if(x&&_f){(async()=>{var B;try{if(await window.Notification.requestPermission()==="granted"){const W=await yC(_f,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(W){const z=et(Ze,"users",x.id);(((B=(await hc(z)).data())==null?void 0:B.fcmTokens)||[]).includes(W)||await Mt(z,{fcmTokens:pc(W)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(j){console.error("Ha ocorregut un error en configurar les notificacions:",j)}})();const H=vC(_f,B=>{var j,J;console.log("Missatge rebut en primer pla: ",B),a({message:`${(j=B.notification)==null?void 0:j.title}: ${(J=B.notification)==null?void 0:J.body}`,type:"success"})});return()=>H()}},[x]),V.useEffect(()=>{let O=null;const H=eI(Ns,B=>{if(O&&(O(),O=null),B){const j=et(Ze,"users",B.uid);O=Dn(j,J=>{J.exists()?C({id:B.uid,...J.data()}):(Gi(Ns),C(null))},J=>{console.error("Error en escoltar el document d'usuari:",J),Gi(Ns),C(null)})}else C(null)});return()=>{H(),O&&O()}},[]),V.useEffect(()=>{if((x==null?void 0:x.role)==="admin"){const O=bn(We(Ze,"users")),H=Dn(O,B=>{const j=B.docs.map(J=>({id:J.id,...J.data()}));A(j.filter(J=>J.id!==x.id))});return()=>H()}else A([])},[x]),V.useEffect(()=>{const O=bn(We(Ze,"products")),H=Dn(O,B=>{const j=B.docs.map(z=>{var _e;const ne=z.data(),ae=(_e=ne.createdAt)!=null&&_e.toDate?ne.createdAt.toDate():new Date;return{id:z.id,...ne,createdAt:ae}}),J=j.filter(z=>z.isMerchandise),W=j.filter(z=>!z.isMerchandise);J.sort((z,ne)=>ne.createdAt.getTime()-z.createdAt.getTime()),W.sort((z,ne)=>ne.createdAt.getTime()-z.createdAt.getTime()),i(J),r(W),_(null)},B=>{console.error("Error en el listener de Firestore (products):",B),_(B),a({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const j=ww.filter(W=>W.isMerchandise).map(W=>({...W,createdAt:new Date(W.createdAt)})),J=ww.filter(W=>!W.isMerchandise).map(W=>({...W,createdAt:new Date(W.createdAt)}));j.sort((W,z)=>z.createdAt.getTime()-W.createdAt.getTime()),J.sort((W,z)=>z.createdAt.getTime()-W.createdAt.getTime()),i(j),r(J)});return()=>H()},[]),V.useEffect(()=>{if(!x){w([]);return}const O=bn(We(Ze,"chats"),$i("participantIds","array-contains",x.id)),H=Dn(O,B=>{let j=B.docs.map(W=>({id:W.id,...W.data()}));j=j.filter(W=>{var z;return!((z=W.hiddenFor)!=null&&z.includes(x.id))&&!fe.current.has(W.id)}),j.sort((W,z)=>{var _e,jt;const ne=((_e=W.updatedAt)==null?void 0:_e.toMillis())||0;return(((jt=z.updatedAt)==null?void 0:jt.toMillis())||0)-ne});const J=j.reduce((W,z)=>W+(z.unreadCount[x.id]||0),0);P(J),w(j),_(null)},B=>{console.error("Error fetching chats:",B),_(B)});return()=>H()},[x]),V.useEffect(()=>{if(!E){k([]);return}const O=bn(We(Ze,"chats",E.id,"messages")),H=Dn(O,B=>{const j=B.docs.map(J=>({id:J.id,...J.data()}));j.sort((J,W)=>{var ae,_e;const z=((ae=J.timestamp)==null?void 0:ae.toMillis())||0,ne=((_e=W.timestamp)==null?void 0:_e.toMillis())||0;return z-ne}),k(j)});return()=>H()},[E]),V.useEffect(()=>{if(o){const O=setTimeout(()=>a(null),8e3);return()=>clearTimeout(O)}},[o]),V.useEffect(()=>{const O="LABOTIGA";M>0?document.title=`(${M}) ${O}`:document.title=O},[M]),V.useEffect(()=>(l||D||!x||$e||T?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[l,D,x,$e,T]);const Bt=async(O,H)=>{await Zx(Ns,O,H),a({message:"Benvingut/da de nou!",type:"success"})},Q=(O,H)=>{const J=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(W=>{let z=0;for(let ae=0;ae<W.length;ae++)z=W.charCodeAt(ae)+((z<<5)-z);let ne="#";for(let ae=0;ae<3;ae++){const _e=z>>ae*8&255;ne+=("00"+_e.toString(16)).substr(-2)}return ne})(H)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${O}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(J)}`},se=async(O,H,B,j)=>{let J="",W=j;if(!W){const _e=O.split(" ").map(jt=>jt[0]).slice(0,2).join("").toUpperCase();W=Q(_e,O)}try{J=await wf(W)}catch(_e){throw console.error("La pujada de la imatge ha fallat:",_e),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!J)throw new Error("Cloudinary no ha retornat una URL vlida.");const ne=(await Xx(Ns,H,B)).user,ae={name:O,email:H,avatarUrl:J,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await GS(et(Ze,"users",ne.uid),ae),C({id:ne.uid,...ae}),a({message:`Benvingut/da, ${O}! El teu compte ha estat creat.`,type:"success"})},ue=async O=>{try{await Qx(Ns,O),a({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(H){throw console.error("Error en restablir la contrasenya:",H),H}},xe=async()=>{e("home"),await Gi(Ns),a({message:"Sessi tancada correctament.",type:"success"})},Ae=()=>{e("home"),m(null)},fn=()=>{m(null),e("listing")},pt=()=>{x&&e("profile")},hn=async(O,H,B)=>{if(!x||x.id!==O)throw a({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(H===x.name&&!B){a({message:"No s'han detectat canvis.",type:"success"});return}try{const j={name:H};B&&(j.avatarUrl=await wf(B));const J=et(Ze,"users",O);await Mt(J,j),a({message:"Perfil actualitzat correctament!",type:"success"})}catch(j){throw console.error("Error actualitzant l'usuari:",j),a({message:`Error en actualitzar: ${j.message||"Error desconegut."}`,type:"error"}),j}},Ct=async(O,H)=>{var W;if(!x){a({message:"Has d'iniciar la sessi per desar un producte.",type:"error"});return}const B=O.imageUrls.map(z=>z.startsWith("data:image")?wf(z):Promise.resolve(z)),j=await Promise.all(B),J={...O,imageUrls:j};if(H){const z=et(Ze,"products",H),ne=(W=(await hc(z)).data())==null?void 0:W.seller;await Mt(z,{...J,seller:ne}),a({message:"Anunci actualitzat correctament!",type:"success"})}else{const z={...J,seller:{id:x.id,name:x.name,avatarUrl:x.avatarUrl},createdAt:new Date};await Mn(We(Ze,"products"),z),a({message:"Anunci publicat amb xit!",type:"success"})}e("home"),m(null)},Zt=O=>{m(O),u(null),e("listing")},gs=async O=>{try{return await HS(et(Ze,"products",O)),a({message:"Anunci eliminat correctament.",type:"success"}),u(null),!0}catch(H){console.error("Error en eliminar el producte: ",H);const B=`Error en eliminar: ${H.code||H.message||"Error desconegut."}`;return a({message:B,type:"error"}),!1}},ai=O=>{u(O)},xo=()=>{u(null)},Io=async O=>{if(!x)return;const H=O.seller.id,B=x.id,j=We(Ze,"chats"),J=bn(j,$i("productId","==",O.id),$i("participantIds","array-contains",B)),W=await jS(J);let z=null;if(W.forEach(ne=>{const ae={id:ne.id,...ne.data()};ae.participantIds.includes(H)&&(z=ae)}),z)await wr(z);else{const ne={participantIds:[B,H],participants:{[B]:{name:x.name,avatarUrl:x.avatarUrl},[H]:{name:O.seller.name,avatarUrl:O.seller.avatarUrl}},productId:O.id,productTitle:O.title,productImageUrl:O.imageUrls[0]||"",lastMessage:null,createdAt:_t(),updatedAt:_t(),unreadCount:{[B]:0,[H]:0},hiddenFor:[]},ae=await Mn(We(Ze,"chats"),ne);N({id:ae.id,...ne})}u(null),U(!0)},wr=async O=>{if(N(O),x&&(O.unreadCount[x.id]||0)>0){const H=et(Ze,"chats",O.id);await Mt(H,{[`unreadCount.${x.id}`]:0})}},ys=async(O,H)=>{if(!x||!E)return;const B=x.id,j=E.participantIds.find(z=>z!==B);if(!j)return;const J={senderId:B,text:O,timestamp:_t(),...H&&{imageUrl:H}};await Mn(We(Ze,"chats",E.id,"messages"),J);const W=et(Ze,"chats",E.id);await Mt(W,{lastMessage:{...J,timestamp:new Date},updatedAt:_t(),[`unreadCount.${j}`]:mc(1)})},li=()=>{N(null)},So=()=>{U(!1),N(null)},vs=async O=>{if(!x)return;fe.current.add(O),w(B=>B.filter(j=>j.id!==O)),(E==null?void 0:E.id)===O&&N(null);const H=et(Ze,"chats",O);try{await Mt(H,{hiddenFor:pc(x.id)}),fe.current.delete(O)}catch(B){console.error("Error en eliminar el xat:",B),a({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),fe.current.delete(O)}},_s=async(O,H)=>{if(!x||x.role!=="admin"){a({message:"No autoritzat.",type:"error"});return}const B=O==="all"?I:I.filter(j=>j.id===O);if(B.length===0){a({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const j of B){const J=`admin-message-${x.id}-${j.id}-${Date.now()}`,W={participantIds:[x.id,j.id],participants:{[x.id]:{name:x.name,avatarUrl:x.avatarUrl},[j.id]:{name:j.name,avatarUrl:j.avatarUrl}},productId:J,productTitle:"Missatge de l'administrador",productImageUrl:x.avatarUrl,lastMessage:null,createdAt:_t(),updatedAt:_t(),unreadCount:{[x.id]:0,[j.id]:0},hiddenFor:[]},z=await Mn(We(Ze,"chats"),W),ne={senderId:x.id,text:H,timestamp:_t()};await Mn(We(Ze,"chats",z.id,"messages"),ne),await Mt(z,{lastMessage:{...ne,timestamp:new Date},updatedAt:_t(),[`unreadCount.${j.id}`]:mc(1)})}a({message:`Missatge enviat a ${B.length} usuari(s).`,type:"success"})}catch(j){throw console.error("Error en enviar el missatge d'administrador:",j),a({message:"No s'ha pogut enviar el missatge.",type:"error"}),j}};return x?h.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[h.jsx(o9,{user:x,onNavigateHome:Ae,onNavigateToListing:fn,onNavigateToProfile:pt,onOpenTutorial:()=>je(!0)}),h.jsx(g9,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>a(null)}),t==="home"&&h.jsx(a9,{userProducts:n,merchProducts:s,onProductSelect:ai,firebaseError:g,currentUser:x}),t==="listing"&&h.jsx(m9,{onSave:Ct,productToEdit:p,currentUser:x}),t==="profile"&&h.jsx(E9,{user:x,onUpdateUser:hn,onBack:()=>e("home"),onLogout:xe,allUsers:I,onSendAdminMessage:_s}),l&&h.jsx(b9,{product:l,currentUser:x,onClose:xo,onEdit:Zt,onContactSeller:Io,onDelete:gs,onOpenImageViewer:(O,H)=>R({images:O,startIndex:H})}),$e&&h.jsx(A9,{onClose:()=>je(!1)}),T&&h.jsx(N9,{images:T.images,startIndex:T.startIndex,onClose:()=>R(null)}),h.jsx(T9,{isOpen:D,onClick:()=>U(!D),unreadCount:M}),h.jsx(C9,{isOpen:D,onClose:So,chats:F,activeChat:E,messages:b,currentUser:x,onSendMessage:ys,onSelectChat:wr,onBackToList:li,onDeleteChat:vs})]}):h.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),h.jsx("div",{className:"relative z-10",children:h.jsx(v9,{onLogin:Bt,onRegister:se,onPasswordReset:ue,isDismissable:!1})})]})},SC=document.getElementById("root");if(!SC)throw new Error("Could not find root element to mount to");const D9=vu.createRoot(SC);D9.render(h.jsx(kw.StrictMode,{children:h.jsx(M9,{})}));
