(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function yE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _v={exports:{}},nu={},Ev={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Va=Symbol.for("react.element"),vE=Symbol.for("react.portal"),wE=Symbol.for("react.fragment"),xE=Symbol.for("react.strict_mode"),_E=Symbol.for("react.profiler"),EE=Symbol.for("react.provider"),bE=Symbol.for("react.context"),TE=Symbol.for("react.forward_ref"),IE=Symbol.for("react.suspense"),SE=Symbol.for("react.memo"),NE=Symbol.for("react.lazy"),wg=Symbol.iterator;function AE(t){return t===null||typeof t!="object"?null:(t=wg&&t[wg]||t["@@iterator"],typeof t=="function"?t:null)}var bv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Tv=Object.assign,Iv={};function Xi(t,e,n){this.props=t,this.context=e,this.refs=Iv,this.updater=n||bv}Xi.prototype.isReactComponent={};Xi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Xi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Sv(){}Sv.prototype=Xi.prototype;function Ef(t,e,n){this.props=t,this.context=e,this.refs=Iv,this.updater=n||bv}var bf=Ef.prototype=new Sv;bf.constructor=Ef;Tv(bf,Xi.prototype);bf.isPureReactComponent=!0;var xg=Array.isArray,Nv=Object.prototype.hasOwnProperty,Tf={current:null},Av={key:!0,ref:!0,__self:!0,__source:!0};function kv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Nv.call(e,r)&&!Av.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Va,type:t,key:i,ref:o,props:s,_owner:Tf.current}}function kE(t,e){return{$$typeof:Va,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function If(t){return typeof t=="object"&&t!==null&&t.$$typeof===Va}function CE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var _g=/\/+/g;function ld(t,e){return typeof t=="object"&&t!==null&&t.key!=null?CE(""+t.key):e.toString(36)}function Ml(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Va:case vE:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+ld(o,0):r,xg(s)?(n="",t!=null&&(n=t.replace(_g,"$&/")+"/"),Ml(s,e,n,"",function(d){return d})):s!=null&&(If(s)&&(s=kE(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(_g,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",xg(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+ld(i,c);o+=Ml(i,e,n,u,s)}else if(u=AE(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+ld(i,c++),o+=Ml(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function dl(t,e,n){if(t==null)return t;var r=[],s=0;return Ml(t,r,"","",function(i){return e.call(n,i,s++)}),r}function jE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kt={current:null},Ol={transition:null},PE={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:Ol,ReactCurrentOwner:Tf};function Cv(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:dl,forEach:function(t,e,n){dl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return dl(t,function(){e++}),e},toArray:function(t){return dl(t,function(e){return e})||[]},only:function(t){if(!If(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=Xi;me.Fragment=wE;me.Profiler=_E;me.PureComponent=Ef;me.StrictMode=xE;me.Suspense=IE;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PE;me.act=Cv;me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Tv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Tf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Nv.call(e,u)&&!Av.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Va,type:t.type,key:s,ref:i,props:r,_owner:o}};me.createContext=function(t){return t={$$typeof:bE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:EE,_context:t},t.Consumer=t};me.createElement=kv;me.createFactory=function(t){var e=kv.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:TE,render:t}};me.isValidElement=If;me.lazy=function(t){return{$$typeof:NE,_payload:{_status:-1,_result:t},_init:jE}};me.memo=function(t,e){return{$$typeof:SE,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=Ol.transition;Ol.transition={};try{t()}finally{Ol.transition=e}};me.unstable_act=Cv;me.useCallback=function(t,e){return kt.current.useCallback(t,e)};me.useContext=function(t){return kt.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return kt.current.useDeferredValue(t)};me.useEffect=function(t,e){return kt.current.useEffect(t,e)};me.useId=function(){return kt.current.useId()};me.useImperativeHandle=function(t,e,n){return kt.current.useImperativeHandle(t,e,n)};me.useInsertionEffect=function(t,e){return kt.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return kt.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return kt.current.useMemo(t,e)};me.useReducer=function(t,e,n){return kt.current.useReducer(t,e,n)};me.useRef=function(t){return kt.current.useRef(t)};me.useState=function(t){return kt.current.useState(t)};me.useSyncExternalStore=function(t,e,n){return kt.current.useSyncExternalStore(t,e,n)};me.useTransition=function(){return kt.current.useTransition()};me.version="18.3.1";Ev.exports=me;var P=Ev.exports;const jv=yE(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RE=P,DE=Symbol.for("react.element"),LE=Symbol.for("react.fragment"),ME=Object.prototype.hasOwnProperty,OE=RE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VE={key:!0,ref:!0,__self:!0,__source:!0};function Pv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ME.call(e,r)&&!VE.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:DE,type:t,key:i,ref:o,props:s,_owner:OE.current}}nu.Fragment=LE;nu.jsx=Pv;nu.jsxs=Pv;_v.exports=nu;var a=_v.exports,oc={},Rv={exports:{}},Gt={},Dv={exports:{}},Lv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,se){var ce=q.length;q.push(se);e:for(;0<ce;){var Ee=ce-1>>>1,Se=q[Ee];if(0<s(Se,se))q[Ee]=se,q[ce]=Se,ce=Ee;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var se=q[0],ce=q.pop();if(ce!==se){q[0]=ce;e:for(var Ee=0,Se=q.length,an=Se>>>1;Ee<an;){var ft=2*(Ee+1)-1,ln=q[ft],It=ft+1,Qt=q[It];if(0>s(ln,ce))It<Se&&0>s(Qt,ln)?(q[Ee]=Qt,q[It]=ce,Ee=It):(q[Ee]=ln,q[ft]=ce,Ee=ft);else if(It<Se&&0>s(Qt,ce))q[Ee]=Qt,q[It]=ce,Ee=It;else break e}}return se}function s(q,se){var ce=q.sortIndex-se.sortIndex;return ce!==0?ce:q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],m=1,f=null,g=3,x=!1,k=!1,j=!1,E=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(q){for(var se=n(d);se!==null;){if(se.callback===null)r(d);else if(se.startTime<=q)r(d),se.sortIndex=se.expirationTime,e(u,se);else break;se=n(d)}}function R(q){if(j=!1,S(q),!k)if(n(u)!==null)k=!0,Z(F);else{var se=n(d);se!==null&&te(R,se.startTime-q)}}function F(q,se){k=!1,j&&(j=!1,b(v),v=-1),x=!0;var ce=g;try{for(S(se),f=n(u);f!==null&&(!(f.expirationTime>se)||q&&!N());){var Ee=f.callback;if(typeof Ee=="function"){f.callback=null,g=f.priorityLevel;var Se=Ee(f.expirationTime<=se);se=t.unstable_now(),typeof Se=="function"?f.callback=Se:f===n(u)&&r(u),S(se)}else r(u);f=n(u)}if(f!==null)var an=!0;else{var ft=n(d);ft!==null&&te(R,ft.startTime-se),an=!1}return an}finally{f=null,g=ce,x=!1}}var B=!1,y=null,v=-1,T=5,A=-1;function N(){return!(t.unstable_now()-A<T)}function C(){if(y!==null){var q=t.unstable_now();A=q;var se=!0;try{se=y(!0,q)}finally{se?I():(B=!1,y=null)}}else B=!1}var I;if(typeof _=="function")I=function(){_(C)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,fe=W.port2;W.port1.onmessage=C,I=function(){fe.postMessage(null)}}else I=function(){E(C,0)};function Z(q){y=q,B||(B=!0,I())}function te(q,se){v=E(function(){q(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){k||x||(k=!0,Z(F))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(q){switch(g){case 1:case 2:case 3:var se=3;break;default:se=g}var ce=g;g=se;try{return q()}finally{g=ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,se){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ce=g;g=q;try{return se()}finally{g=ce}},t.unstable_scheduleCallback=function(q,se,ce){var Ee=t.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ee+ce:Ee):ce=Ee,q){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ce+Se,q={id:m++,callback:se,priorityLevel:q,startTime:ce,expirationTime:Se,sortIndex:-1},ce>Ee?(q.sortIndex=ce,e(d,q),n(u)===null&&q===n(d)&&(j?(b(v),v=-1):j=!0,te(R,ce-Ee))):(q.sortIndex=Se,e(u,q),k||x||(k=!0,Z(F))),q},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(q){var se=g;return function(){var ce=g;g=se;try{return q.apply(this,arguments)}finally{g=ce}}}})(Lv);Dv.exports=Lv;var FE=Dv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UE=P,Wt=FE;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mv=new Set,ca={};function Qs(t,e){Oi(t,e),Oi(t+"Capture",e)}function Oi(t,e){for(ca[t]=e,t=0;t<e.length;t++)Mv.add(e[t])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jd=Object.prototype.hasOwnProperty,BE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Eg={},bg={};function zE(t){return Jd.call(bg,t)?!0:Jd.call(Eg,t)?!1:BE.test(t)?bg[t]=!0:(Eg[t]=!0,!1)}function $E(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function qE(t,e,n,r){if(e===null||typeof e>"u"||$E(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ct(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dt[t]=new Ct(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dt[e]=new Ct(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dt[t]=new Ct(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dt[t]=new Ct(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dt[t]=new Ct(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dt[t]=new Ct(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dt[t]=new Ct(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dt[t]=new Ct(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dt[t]=new Ct(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sf=/[\-:]([a-z])/g;function Nf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sf,Nf);dt[e]=new Ct(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sf,Nf);dt[e]=new Ct(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sf,Nf);dt[e]=new Ct(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dt[t]=new Ct(t,1,!1,t.toLowerCase(),null,!1,!1)});dt.xlinkHref=new Ct("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dt[t]=new Ct(t,1,!1,t.toLowerCase(),null,!0,!0)});function Af(t,e,n,r){var s=dt.hasOwnProperty(e)?dt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qE(e,n,s,r)&&(n=null),r||s===null?zE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var hr=UE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hl=Symbol.for("react.element"),hi=Symbol.for("react.portal"),fi=Symbol.for("react.fragment"),kf=Symbol.for("react.strict_mode"),Zd=Symbol.for("react.profiler"),Ov=Symbol.for("react.provider"),Vv=Symbol.for("react.context"),Cf=Symbol.for("react.forward_ref"),eh=Symbol.for("react.suspense"),th=Symbol.for("react.suspense_list"),jf=Symbol.for("react.memo"),kr=Symbol.for("react.lazy"),Fv=Symbol.for("react.offscreen"),Tg=Symbol.iterator;function Co(t){return t===null||typeof t!="object"?null:(t=Tg&&t[Tg]||t["@@iterator"],typeof t=="function"?t:null)}var Le=Object.assign,cd;function Vo(t){if(cd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cd=e&&e[1]||""}return`
`+cd+t}var ud=!1;function dd(t,e){if(!t||ud)return"";ud=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{ud=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vo(t):""}function HE(t){switch(t.tag){case 5:return Vo(t.type);case 16:return Vo("Lazy");case 13:return Vo("Suspense");case 19:return Vo("SuspenseList");case 0:case 2:case 15:return t=dd(t.type,!1),t;case 11:return t=dd(t.type.render,!1),t;case 1:return t=dd(t.type,!0),t;default:return""}}function nh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fi:return"Fragment";case hi:return"Portal";case Zd:return"Profiler";case kf:return"StrictMode";case eh:return"Suspense";case th:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vv:return(t.displayName||"Context")+".Consumer";case Ov:return(t._context.displayName||"Context")+".Provider";case Cf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jf:return e=t.displayName||null,e!==null?e:nh(t.type)||"Memo";case kr:e=t._payload,t=t._init;try{return nh(t(e))}catch{}}return null}function WE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nh(e);case 8:return e===kf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Uv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function GE(t){var e=Uv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fl(t){t._valueTracker||(t._valueTracker=GE(t))}function Bv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Uv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ac(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function rh(t,e){var n=e.checked;return Le({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ig(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function zv(t,e){e=e.checked,e!=null&&Af(t,"checked",e,!1)}function sh(t,e){zv(t,e);var n=Xr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ih(t,e.type,n):e.hasOwnProperty("defaultValue")&&ih(t,e.type,Xr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ih(t,e,n){(e!=="number"||ac(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fo=Array.isArray;function Ii(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function oh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Le({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ng(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Q(92));if(Fo(n)){if(1<n.length)throw Error(Q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xr(n)}}function $v(t,e){var n=Xr(e.value),r=Xr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ag(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function qv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ah(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?qv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ml,Hv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ml=ml||document.createElement("div"),ml.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ml.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ua(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ko={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},KE=["Webkit","ms","Moz","O"];Object.keys(Ko).forEach(function(t){KE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ko[e]=Ko[t]})});function Wv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ko.hasOwnProperty(t)&&Ko[t]?(""+e).trim():e+"px"}function Gv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Wv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var QE=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lh(t,e){if(e){if(QE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function ch(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uh=null;function Pf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var dh=null,Si=null,Ni=null;function kg(t){if(t=Ba(t)){if(typeof dh!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=au(e),dh(t.stateNode,t.type,e))}}function Kv(t){Si?Ni?Ni.push(t):Ni=[t]:Si=t}function Qv(){if(Si){var t=Si,e=Ni;if(Ni=Si=null,kg(t),e)for(t=0;t<e.length;t++)kg(e[t])}}function Yv(t,e){return t(e)}function Xv(){}var hd=!1;function Jv(t,e,n){if(hd)return t(e,n);hd=!0;try{return Yv(t,e,n)}finally{hd=!1,(Si!==null||Ni!==null)&&(Xv(),Qv())}}function da(t,e){var n=t.stateNode;if(n===null)return null;var r=au(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Q(231,e,typeof n));return n}var hh=!1;if(tr)try{var jo={};Object.defineProperty(jo,"passive",{get:function(){hh=!0}}),window.addEventListener("test",jo,jo),window.removeEventListener("test",jo,jo)}catch{hh=!1}function YE(t,e,n,r,s,i,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(m){this.onError(m)}}var Qo=!1,lc=null,cc=!1,fh=null,XE={onError:function(t){Qo=!0,lc=t}};function JE(t,e,n,r,s,i,o,c,u){Qo=!1,lc=null,YE.apply(XE,arguments)}function ZE(t,e,n,r,s,i,o,c,u){if(JE.apply(this,arguments),Qo){if(Qo){var d=lc;Qo=!1,lc=null}else throw Error(Q(198));cc||(cc=!0,fh=d)}}function Ys(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Zv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Cg(t){if(Ys(t)!==t)throw Error(Q(188))}function eb(t){var e=t.alternate;if(!e){if(e=Ys(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Cg(s),t;if(i===r)return Cg(s),e;i=i.sibling}throw Error(Q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?t:e}function ew(t){return t=eb(t),t!==null?tw(t):null}function tw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=tw(t);if(e!==null)return e;t=t.sibling}return null}var nw=Wt.unstable_scheduleCallback,jg=Wt.unstable_cancelCallback,tb=Wt.unstable_shouldYield,nb=Wt.unstable_requestPaint,qe=Wt.unstable_now,rb=Wt.unstable_getCurrentPriorityLevel,Rf=Wt.unstable_ImmediatePriority,rw=Wt.unstable_UserBlockingPriority,uc=Wt.unstable_NormalPriority,sb=Wt.unstable_LowPriority,sw=Wt.unstable_IdlePriority,ru=null,kn=null;function ib(t){if(kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(ru,t,void 0,(t.current.flags&128)===128)}catch{}}var mn=Math.clz32?Math.clz32:lb,ob=Math.log,ab=Math.LN2;function lb(t){return t>>>=0,t===0?32:31-(ob(t)/ab|0)|0}var pl=64,gl=4194304;function Uo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=Uo(c):(i&=o,i!==0&&(r=Uo(i)))}else o=n&~s,o!==0?r=Uo(o):i!==0&&(r=Uo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-mn(e),s=1<<n,r|=t[n],e&=~s;return r}function cb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ub(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-mn(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=cb(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function mh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function iw(){var t=pl;return pl<<=1,!(pl&4194240)&&(pl=64),t}function fd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mn(e),t[e]=n}function db(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-mn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Df(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-mn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var _e=0;function ow(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var aw,Lf,lw,cw,uw,ph=!1,yl=[],Ur=null,Br=null,zr=null,ha=new Map,fa=new Map,jr=[],hb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pg(t,e){switch(t){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":zr=null;break;case"pointerover":case"pointerout":ha.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fa.delete(e.pointerId)}}function Po(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ba(e),e!==null&&Lf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function fb(t,e,n,r,s){switch(e){case"focusin":return Ur=Po(Ur,t,e,n,r,s),!0;case"dragenter":return Br=Po(Br,t,e,n,r,s),!0;case"mouseover":return zr=Po(zr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ha.set(i,Po(ha.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,fa.set(i,Po(fa.get(i)||null,t,e,n,r,s)),!0}return!1}function dw(t){var e=ks(t.target);if(e!==null){var n=Ys(e);if(n!==null){if(e=n.tag,e===13){if(e=Zv(n),e!==null){t.blockedOn=e,uw(t.priority,function(){lw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Vl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=gh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);uh=r,n.target.dispatchEvent(r),uh=null}else return e=Ba(n),e!==null&&Lf(e),t.blockedOn=n,!1;e.shift()}return!0}function Rg(t,e,n){Vl(t)&&n.delete(e)}function mb(){ph=!1,Ur!==null&&Vl(Ur)&&(Ur=null),Br!==null&&Vl(Br)&&(Br=null),zr!==null&&Vl(zr)&&(zr=null),ha.forEach(Rg),fa.forEach(Rg)}function Ro(t,e){t.blockedOn===e&&(t.blockedOn=null,ph||(ph=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,mb)))}function ma(t){function e(s){return Ro(s,t)}if(0<yl.length){Ro(yl[0],t);for(var n=1;n<yl.length;n++){var r=yl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ur!==null&&Ro(Ur,t),Br!==null&&Ro(Br,t),zr!==null&&Ro(zr,t),ha.forEach(e),fa.forEach(e),n=0;n<jr.length;n++)r=jr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<jr.length&&(n=jr[0],n.blockedOn===null);)dw(n),n.blockedOn===null&&jr.shift()}var Ai=hr.ReactCurrentBatchConfig,hc=!0;function pb(t,e,n,r){var s=_e,i=Ai.transition;Ai.transition=null;try{_e=1,Mf(t,e,n,r)}finally{_e=s,Ai.transition=i}}function gb(t,e,n,r){var s=_e,i=Ai.transition;Ai.transition=null;try{_e=4,Mf(t,e,n,r)}finally{_e=s,Ai.transition=i}}function Mf(t,e,n,r){if(hc){var s=gh(t,e,n,r);if(s===null)bd(t,e,r,fc,n),Pg(t,r);else if(fb(s,t,e,n,r))r.stopPropagation();else if(Pg(t,r),e&4&&-1<hb.indexOf(t)){for(;s!==null;){var i=Ba(s);if(i!==null&&aw(i),i=gh(t,e,n,r),i===null&&bd(t,e,r,fc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else bd(t,e,r,null,n)}}var fc=null;function gh(t,e,n,r){if(fc=null,t=Pf(r),t=ks(t),t!==null)if(e=Ys(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Zv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fc=t,null}function hw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rb()){case Rf:return 1;case rw:return 4;case uc:case sb:return 16;case sw:return 536870912;default:return 16}default:return 16}}var Or=null,Of=null,Fl=null;function fw(){if(Fl)return Fl;var t,e=Of,n=e.length,r,s="value"in Or?Or.value:Or.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Fl=s.slice(t,1<r?1-r:void 0)}function Ul(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vl(){return!0}function Dg(){return!1}function Kt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?vl:Dg,this.isPropagationStopped=Dg,this}return Le(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vl)},persist:function(){},isPersistent:vl}),e}var Ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vf=Kt(Ji),Ua=Le({},Ji,{view:0,detail:0}),yb=Kt(Ua),md,pd,Do,su=Le({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ff,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Do&&(Do&&t.type==="mousemove"?(md=t.screenX-Do.screenX,pd=t.screenY-Do.screenY):pd=md=0,Do=t),md)},movementY:function(t){return"movementY"in t?t.movementY:pd}}),Lg=Kt(su),vb=Le({},su,{dataTransfer:0}),wb=Kt(vb),xb=Le({},Ua,{relatedTarget:0}),gd=Kt(xb),_b=Le({},Ji,{animationName:0,elapsedTime:0,pseudoElement:0}),Eb=Kt(_b),bb=Le({},Ji,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Tb=Kt(bb),Ib=Le({},Ji,{data:0}),Mg=Kt(Ib),Sb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ab={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ab[t])?!!e[t]:!1}function Ff(){return kb}var Cb=Le({},Ua,{key:function(t){if(t.key){var e=Sb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ul(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Nb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ff,charCode:function(t){return t.type==="keypress"?Ul(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ul(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jb=Kt(Cb),Pb=Le({},su,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Og=Kt(Pb),Rb=Le({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ff}),Db=Kt(Rb),Lb=Le({},Ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mb=Kt(Lb),Ob=Le({},su,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Vb=Kt(Ob),Fb=[9,13,27,32],Uf=tr&&"CompositionEvent"in window,Yo=null;tr&&"documentMode"in document&&(Yo=document.documentMode);var Ub=tr&&"TextEvent"in window&&!Yo,mw=tr&&(!Uf||Yo&&8<Yo&&11>=Yo),Vg=" ",Fg=!1;function pw(t,e){switch(t){case"keyup":return Fb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mi=!1;function Bb(t,e){switch(t){case"compositionend":return gw(e);case"keypress":return e.which!==32?null:(Fg=!0,Vg);case"textInput":return t=e.data,t===Vg&&Fg?null:t;default:return null}}function zb(t,e){if(mi)return t==="compositionend"||!Uf&&pw(t,e)?(t=fw(),Fl=Of=Or=null,mi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mw&&e.locale!=="ko"?null:e.data;default:return null}}var $b={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ug(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$b[t.type]:e==="textarea"}function yw(t,e,n,r){Kv(r),e=mc(e,"onChange"),0<e.length&&(n=new Vf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xo=null,pa=null;function qb(t){Aw(t,0)}function iu(t){var e=yi(t);if(Bv(e))return t}function Hb(t,e){if(t==="change")return e}var vw=!1;if(tr){var yd;if(tr){var vd="oninput"in document;if(!vd){var Bg=document.createElement("div");Bg.setAttribute("oninput","return;"),vd=typeof Bg.oninput=="function"}yd=vd}else yd=!1;vw=yd&&(!document.documentMode||9<document.documentMode)}function zg(){Xo&&(Xo.detachEvent("onpropertychange",ww),pa=Xo=null)}function ww(t){if(t.propertyName==="value"&&iu(pa)){var e=[];yw(e,pa,t,Pf(t)),Jv(qb,e)}}function Wb(t,e,n){t==="focusin"?(zg(),Xo=e,pa=n,Xo.attachEvent("onpropertychange",ww)):t==="focusout"&&zg()}function Gb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return iu(pa)}function Kb(t,e){if(t==="click")return iu(e)}function Qb(t,e){if(t==="input"||t==="change")return iu(e)}function Yb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gn=typeof Object.is=="function"?Object.is:Yb;function ga(t,e){if(gn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Jd.call(e,s)||!gn(t[s],e[s]))return!1}return!0}function $g(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qg(t,e){var n=$g(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=$g(n)}}function xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function _w(){for(var t=window,e=ac();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ac(t.document)}return e}function Bf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Xb(t){var e=_w(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&xw(n.ownerDocument.documentElement,n)){if(r!==null&&Bf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=qg(n,i);var o=qg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Jb=tr&&"documentMode"in document&&11>=document.documentMode,pi=null,yh=null,Jo=null,vh=!1;function Hg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;vh||pi==null||pi!==ac(r)||(r=pi,"selectionStart"in r&&Bf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jo&&ga(Jo,r)||(Jo=r,r=mc(yh,"onSelect"),0<r.length&&(e=new Vf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=pi)))}function wl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var gi={animationend:wl("Animation","AnimationEnd"),animationiteration:wl("Animation","AnimationIteration"),animationstart:wl("Animation","AnimationStart"),transitionend:wl("Transition","TransitionEnd")},wd={},Ew={};tr&&(Ew=document.createElement("div").style,"AnimationEvent"in window||(delete gi.animationend.animation,delete gi.animationiteration.animation,delete gi.animationstart.animation),"TransitionEvent"in window||delete gi.transitionend.transition);function ou(t){if(wd[t])return wd[t];if(!gi[t])return t;var e=gi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ew)return wd[t]=e[n];return t}var bw=ou("animationend"),Tw=ou("animationiteration"),Iw=ou("animationstart"),Sw=ou("transitionend"),Nw=new Map,Wg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(t,e){Nw.set(t,e),Qs(e,[t])}for(var xd=0;xd<Wg.length;xd++){var _d=Wg[xd],Zb=_d.toLowerCase(),eT=_d[0].toUpperCase()+_d.slice(1);cs(Zb,"on"+eT)}cs(bw,"onAnimationEnd");cs(Tw,"onAnimationIteration");cs(Iw,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(Sw,"onTransitionEnd");Oi("onMouseEnter",["mouseout","mouseover"]);Oi("onMouseLeave",["mouseout","mouseover"]);Oi("onPointerEnter",["pointerout","pointerover"]);Oi("onPointerLeave",["pointerout","pointerover"]);Qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bo));function Gg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ZE(r,e,void 0,t),t.currentTarget=null}function Aw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Gg(s,c,d),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Gg(s,c,d),i=u}}}if(cc)throw t=fh,cc=!1,fh=null,t}function Ae(t,e){var n=e[bh];n===void 0&&(n=e[bh]=new Set);var r=t+"__bubble";n.has(r)||(kw(e,t,2,!1),n.add(r))}function Ed(t,e,n){var r=0;e&&(r|=4),kw(n,t,r,e)}var xl="_reactListening"+Math.random().toString(36).slice(2);function ya(t){if(!t[xl]){t[xl]=!0,Mv.forEach(function(n){n!=="selectionchange"&&(tT.has(n)||Ed(n,!1,t),Ed(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xl]||(e[xl]=!0,Ed("selectionchange",!1,e))}}function kw(t,e,n,r){switch(hw(e)){case 1:var s=pb;break;case 4:s=gb;break;default:s=Mf}n=s.bind(null,e,n,t),s=void 0,!hh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function bd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=ks(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}Jv(function(){var d=i,m=Pf(n),f=[];e:{var g=Nw.get(t);if(g!==void 0){var x=Vf,k=t;switch(t){case"keypress":if(Ul(n)===0)break e;case"keydown":case"keyup":x=jb;break;case"focusin":k="focus",x=gd;break;case"focusout":k="blur",x=gd;break;case"beforeblur":case"afterblur":x=gd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Lg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=wb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Db;break;case bw:case Tw:case Iw:x=Eb;break;case Sw:x=Mb;break;case"scroll":x=yb;break;case"wheel":x=Vb;break;case"copy":case"cut":case"paste":x=Tb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Og}var j=(e&4)!==0,E=!j&&t==="scroll",b=j?g!==null?g+"Capture":null:g;j=[];for(var _=d,S;_!==null;){S=_;var R=S.stateNode;if(S.tag===5&&R!==null&&(S=R,b!==null&&(R=da(_,b),R!=null&&j.push(va(_,R,S)))),E)break;_=_.return}0<j.length&&(g=new x(g,k,null,n,m),f.push({event:g,listeners:j}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==uh&&(k=n.relatedTarget||n.fromElement)&&(ks(k)||k[nr]))break e;if((x||g)&&(g=m.window===m?m:(g=m.ownerDocument)?g.defaultView||g.parentWindow:window,x?(k=n.relatedTarget||n.toElement,x=d,k=k?ks(k):null,k!==null&&(E=Ys(k),k!==E||k.tag!==5&&k.tag!==6)&&(k=null)):(x=null,k=d),x!==k)){if(j=Lg,R="onMouseLeave",b="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(j=Og,R="onPointerLeave",b="onPointerEnter",_="pointer"),E=x==null?g:yi(x),S=k==null?g:yi(k),g=new j(R,_+"leave",x,n,m),g.target=E,g.relatedTarget=S,R=null,ks(m)===d&&(j=new j(b,_+"enter",k,n,m),j.target=S,j.relatedTarget=E,R=j),E=R,x&&k)t:{for(j=x,b=k,_=0,S=j;S;S=ai(S))_++;for(S=0,R=b;R;R=ai(R))S++;for(;0<_-S;)j=ai(j),_--;for(;0<S-_;)b=ai(b),S--;for(;_--;){if(j===b||b!==null&&j===b.alternate)break t;j=ai(j),b=ai(b)}j=null}else j=null;x!==null&&Kg(f,g,x,j,!1),k!==null&&E!==null&&Kg(f,E,k,j,!0)}}e:{if(g=d?yi(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var F=Hb;else if(Ug(g))if(vw)F=Qb;else{F=Gb;var B=Wb}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=Kb);if(F&&(F=F(t,d))){yw(f,F,n,m);break e}B&&B(t,g,d),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&ih(g,"number",g.value)}switch(B=d?yi(d):window,t){case"focusin":(Ug(B)||B.contentEditable==="true")&&(pi=B,yh=d,Jo=null);break;case"focusout":Jo=yh=pi=null;break;case"mousedown":vh=!0;break;case"contextmenu":case"mouseup":case"dragend":vh=!1,Hg(f,n,m);break;case"selectionchange":if(Jb)break;case"keydown":case"keyup":Hg(f,n,m)}var y;if(Uf)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else mi?pw(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(mw&&n.locale!=="ko"&&(mi||v!=="onCompositionStart"?v==="onCompositionEnd"&&mi&&(y=fw()):(Or=m,Of="value"in Or?Or.value:Or.textContent,mi=!0)),B=mc(d,v),0<B.length&&(v=new Mg(v,t,null,n,m),f.push({event:v,listeners:B}),y?v.data=y:(y=gw(n),y!==null&&(v.data=y)))),(y=Ub?Bb(t,n):zb(t,n))&&(d=mc(d,"onBeforeInput"),0<d.length&&(m=new Mg("onBeforeInput","beforeinput",null,n,m),f.push({event:m,listeners:d}),m.data=y))}Aw(f,e)})}function va(t,e,n){return{instance:t,listener:e,currentTarget:n}}function mc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=da(t,n),i!=null&&r.unshift(va(t,i,s)),i=da(t,e),i!=null&&r.push(va(t,i,s))),t=t.return}return r}function ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Kg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=da(n,i),u!=null&&o.unshift(va(n,u,c))):s||(u=da(n,i),u!=null&&o.push(va(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var nT=/\r\n?/g,rT=/\u0000|\uFFFD/g;function Qg(t){return(typeof t=="string"?t:""+t).replace(nT,`
`).replace(rT,"")}function _l(t,e,n){if(e=Qg(e),Qg(t)!==e&&n)throw Error(Q(425))}function pc(){}var wh=null,xh=null;function _h(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Eh=typeof setTimeout=="function"?setTimeout:void 0,sT=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,iT=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(t){return Yg.resolve(null).then(t).catch(oT)}:Eh;function oT(t){setTimeout(function(){throw t})}function Td(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ma(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ma(e)}function $r(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Xg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Zi=Math.random().toString(36).slice(2),In="__reactFiber$"+Zi,wa="__reactProps$"+Zi,nr="__reactContainer$"+Zi,bh="__reactEvents$"+Zi,aT="__reactListeners$"+Zi,lT="__reactHandles$"+Zi;function ks(t){var e=t[In];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nr]||n[In]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Xg(t);t!==null;){if(n=t[In])return n;t=Xg(t)}return e}t=n,n=t.parentNode}return null}function Ba(t){return t=t[In]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function yi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function au(t){return t[wa]||null}var Th=[],vi=-1;function us(t){return{current:t}}function je(t){0>vi||(t.current=Th[vi],Th[vi]=null,vi--)}function Ie(t,e){vi++,Th[vi]=t.current,t.current=e}var Jr={},bt=us(Jr),Lt=us(!1),Vs=Jr;function Vi(t,e){var n=t.type.contextTypes;if(!n)return Jr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Mt(t){return t=t.childContextTypes,t!=null}function gc(){je(Lt),je(bt)}function Jg(t,e,n){if(bt.current!==Jr)throw Error(Q(168));Ie(bt,e),Ie(Lt,n)}function Cw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Q(108,WE(t)||"Unknown",s));return Le({},n,r)}function yc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Jr,Vs=bt.current,Ie(bt,t),Ie(Lt,Lt.current),!0}function Zg(t,e,n){var r=t.stateNode;if(!r)throw Error(Q(169));n?(t=Cw(t,e,Vs),r.__reactInternalMemoizedMergedChildContext=t,je(Lt),je(bt),Ie(bt,t)):je(Lt),Ie(Lt,n)}var zn=null,lu=!1,Id=!1;function jw(t){zn===null?zn=[t]:zn.push(t)}function cT(t){lu=!0,jw(t)}function ds(){if(!Id&&zn!==null){Id=!0;var t=0,e=_e;try{var n=zn;for(_e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}zn=null,lu=!1}catch(s){throw zn!==null&&(zn=zn.slice(t+1)),nw(Rf,ds),s}finally{_e=e,Id=!1}}return null}var wi=[],xi=0,vc=null,wc=0,Yt=[],Xt=0,Fs=null,$n=1,qn="";function Ss(t,e){wi[xi++]=wc,wi[xi++]=vc,vc=t,wc=e}function Pw(t,e,n){Yt[Xt++]=$n,Yt[Xt++]=qn,Yt[Xt++]=Fs,Fs=t;var r=$n;t=qn;var s=32-mn(r)-1;r&=~(1<<s),n+=1;var i=32-mn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,$n=1<<32-mn(e)+s|n<<s|r,qn=i+t}else $n=1<<i|n<<s|r,qn=t}function zf(t){t.return!==null&&(Ss(t,1),Pw(t,1,0))}function $f(t){for(;t===vc;)vc=wi[--xi],wi[xi]=null,wc=wi[--xi],wi[xi]=null;for(;t===Fs;)Fs=Yt[--Xt],Yt[Xt]=null,qn=Yt[--Xt],Yt[Xt]=null,$n=Yt[--Xt],Yt[Xt]=null}var Ht=null,$t=null,Pe=!1,hn=null;function Rw(t,e){var n=en(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ey(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ht=t,$t=$r(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ht=t,$t=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Fs!==null?{id:$n,overflow:qn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=en(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ht=t,$t=null,!0):!1;default:return!1}}function Ih(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Sh(t){if(Pe){var e=$t;if(e){var n=e;if(!ey(t,e)){if(Ih(t))throw Error(Q(418));e=$r(n.nextSibling);var r=Ht;e&&ey(t,e)?Rw(r,n):(t.flags=t.flags&-4097|2,Pe=!1,Ht=t)}}else{if(Ih(t))throw Error(Q(418));t.flags=t.flags&-4097|2,Pe=!1,Ht=t}}}function ty(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ht=t}function El(t){if(t!==Ht)return!1;if(!Pe)return ty(t),Pe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_h(t.type,t.memoizedProps)),e&&(e=$t)){if(Ih(t))throw Dw(),Error(Q(418));for(;e;)Rw(t,e),e=$r(e.nextSibling)}if(ty(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$t=$r(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$t=null}}else $t=Ht?$r(t.stateNode.nextSibling):null;return!0}function Dw(){for(var t=$t;t;)t=$r(t.nextSibling)}function Fi(){$t=Ht=null,Pe=!1}function qf(t){hn===null?hn=[t]:hn.push(t)}var uT=hr.ReactCurrentBatchConfig;function Lo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,t))}return t}function bl(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ny(t){var e=t._init;return e(t._payload)}function Lw(t){function e(b,_){if(t){var S=b.deletions;S===null?(b.deletions=[_],b.flags|=16):S.push(_)}}function n(b,_){if(!t)return null;for(;_!==null;)e(b,_),_=_.sibling;return null}function r(b,_){for(b=new Map;_!==null;)_.key!==null?b.set(_.key,_):b.set(_.index,_),_=_.sibling;return b}function s(b,_){return b=Gr(b,_),b.index=0,b.sibling=null,b}function i(b,_,S){return b.index=S,t?(S=b.alternate,S!==null?(S=S.index,S<_?(b.flags|=2,_):S):(b.flags|=2,_)):(b.flags|=1048576,_)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function c(b,_,S,R){return _===null||_.tag!==6?(_=Pd(S,b.mode,R),_.return=b,_):(_=s(_,S),_.return=b,_)}function u(b,_,S,R){var F=S.type;return F===fi?m(b,_,S.props.children,R,S.key):_!==null&&(_.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===kr&&ny(F)===_.type)?(R=s(_,S.props),R.ref=Lo(b,_,S),R.return=b,R):(R=Gl(S.type,S.key,S.props,null,b.mode,R),R.ref=Lo(b,_,S),R.return=b,R)}function d(b,_,S,R){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=Rd(S,b.mode,R),_.return=b,_):(_=s(_,S.children||[]),_.return=b,_)}function m(b,_,S,R,F){return _===null||_.tag!==7?(_=Ls(S,b.mode,R,F),_.return=b,_):(_=s(_,S),_.return=b,_)}function f(b,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Pd(""+_,b.mode,S),_.return=b,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case hl:return S=Gl(_.type,_.key,_.props,null,b.mode,S),S.ref=Lo(b,null,_),S.return=b,S;case hi:return _=Rd(_,b.mode,S),_.return=b,_;case kr:var R=_._init;return f(b,R(_._payload),S)}if(Fo(_)||Co(_))return _=Ls(_,b.mode,S,null),_.return=b,_;bl(b,_)}return null}function g(b,_,S,R){var F=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return F!==null?null:c(b,_,""+S,R);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hl:return S.key===F?u(b,_,S,R):null;case hi:return S.key===F?d(b,_,S,R):null;case kr:return F=S._init,g(b,_,F(S._payload),R)}if(Fo(S)||Co(S))return F!==null?null:m(b,_,S,R,null);bl(b,S)}return null}function x(b,_,S,R,F){if(typeof R=="string"&&R!==""||typeof R=="number")return b=b.get(S)||null,c(_,b,""+R,F);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case hl:return b=b.get(R.key===null?S:R.key)||null,u(_,b,R,F);case hi:return b=b.get(R.key===null?S:R.key)||null,d(_,b,R,F);case kr:var B=R._init;return x(b,_,S,B(R._payload),F)}if(Fo(R)||Co(R))return b=b.get(S)||null,m(_,b,R,F,null);bl(_,R)}return null}function k(b,_,S,R){for(var F=null,B=null,y=_,v=_=0,T=null;y!==null&&v<S.length;v++){y.index>v?(T=y,y=null):T=y.sibling;var A=g(b,y,S[v],R);if(A===null){y===null&&(y=T);break}t&&y&&A.alternate===null&&e(b,y),_=i(A,_,v),B===null?F=A:B.sibling=A,B=A,y=T}if(v===S.length)return n(b,y),Pe&&Ss(b,v),F;if(y===null){for(;v<S.length;v++)y=f(b,S[v],R),y!==null&&(_=i(y,_,v),B===null?F=y:B.sibling=y,B=y);return Pe&&Ss(b,v),F}for(y=r(b,y);v<S.length;v++)T=x(y,b,v,S[v],R),T!==null&&(t&&T.alternate!==null&&y.delete(T.key===null?v:T.key),_=i(T,_,v),B===null?F=T:B.sibling=T,B=T);return t&&y.forEach(function(N){return e(b,N)}),Pe&&Ss(b,v),F}function j(b,_,S,R){var F=Co(S);if(typeof F!="function")throw Error(Q(150));if(S=F.call(S),S==null)throw Error(Q(151));for(var B=F=null,y=_,v=_=0,T=null,A=S.next();y!==null&&!A.done;v++,A=S.next()){y.index>v?(T=y,y=null):T=y.sibling;var N=g(b,y,A.value,R);if(N===null){y===null&&(y=T);break}t&&y&&N.alternate===null&&e(b,y),_=i(N,_,v),B===null?F=N:B.sibling=N,B=N,y=T}if(A.done)return n(b,y),Pe&&Ss(b,v),F;if(y===null){for(;!A.done;v++,A=S.next())A=f(b,A.value,R),A!==null&&(_=i(A,_,v),B===null?F=A:B.sibling=A,B=A);return Pe&&Ss(b,v),F}for(y=r(b,y);!A.done;v++,A=S.next())A=x(y,b,v,A.value,R),A!==null&&(t&&A.alternate!==null&&y.delete(A.key===null?v:A.key),_=i(A,_,v),B===null?F=A:B.sibling=A,B=A);return t&&y.forEach(function(C){return e(b,C)}),Pe&&Ss(b,v),F}function E(b,_,S,R){if(typeof S=="object"&&S!==null&&S.type===fi&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case hl:e:{for(var F=S.key,B=_;B!==null;){if(B.key===F){if(F=S.type,F===fi){if(B.tag===7){n(b,B.sibling),_=s(B,S.props.children),_.return=b,b=_;break e}}else if(B.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===kr&&ny(F)===B.type){n(b,B.sibling),_=s(B,S.props),_.ref=Lo(b,B,S),_.return=b,b=_;break e}n(b,B);break}else e(b,B);B=B.sibling}S.type===fi?(_=Ls(S.props.children,b.mode,R,S.key),_.return=b,b=_):(R=Gl(S.type,S.key,S.props,null,b.mode,R),R.ref=Lo(b,_,S),R.return=b,b=R)}return o(b);case hi:e:{for(B=S.key;_!==null;){if(_.key===B)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(b,_.sibling),_=s(_,S.children||[]),_.return=b,b=_;break e}else{n(b,_);break}else e(b,_);_=_.sibling}_=Rd(S,b.mode,R),_.return=b,b=_}return o(b);case kr:return B=S._init,E(b,_,B(S._payload),R)}if(Fo(S))return k(b,_,S,R);if(Co(S))return j(b,_,S,R);bl(b,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(b,_.sibling),_=s(_,S),_.return=b,b=_):(n(b,_),_=Pd(S,b.mode,R),_.return=b,b=_),o(b)):n(b,_)}return E}var Ui=Lw(!0),Mw=Lw(!1),xc=us(null),_c=null,_i=null,Hf=null;function Wf(){Hf=_i=_c=null}function Gf(t){var e=xc.current;je(xc),t._currentValue=e}function Nh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ki(t,e){_c=t,Hf=_i=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Dt=!0),t.firstContext=null)}function sn(t){var e=t._currentValue;if(Hf!==t)if(t={context:t,memoizedValue:e,next:null},_i===null){if(_c===null)throw Error(Q(308));_i=t,_c.dependencies={lanes:0,firstContext:t}}else _i=_i.next=t;return e}var Cs=null;function Kf(t){Cs===null?Cs=[t]:Cs.push(t)}function Ow(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Kf(e)):(n.next=s.next,s.next=n),e.interleaved=n,rr(t,r)}function rr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Cr=!1;function Qf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,rr(t,n)}return s=r.interleaved,s===null?(e.next=e,Kf(r)):(e.next=s.next,s.next=e),r.interleaved=e,rr(t,n)}function Bl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Df(t,n)}}function ry(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ec(t,e,n,r){var s=t.updateQueue;Cr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=u))}if(i!==null){var f=s.baseState;o=0,m=d=u=null,c=i;do{var g=c.lane,x=c.eventTime;if((r&g)===g){m!==null&&(m=m.next={eventTime:x,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var k=t,j=c;switch(g=e,x=n,j.tag){case 1:if(k=j.payload,typeof k=="function"){f=k.call(x,f,g);break e}f=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=j.payload,g=typeof k=="function"?k.call(x,f,g):k,g==null)break e;f=Le({},f,g);break e;case 2:Cr=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[c]:g.push(c))}else x={eventTime:x,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(d=m=x,u=f):m=m.next=x,o|=g;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;g=c,c=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(m===null&&(u=f),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Bs|=o,t.lanes=o,t.memoizedState=f}}function sy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Q(191,s));s.call(r)}}}var za={},Cn=us(za),xa=us(za),_a=us(za);function js(t){if(t===za)throw Error(Q(174));return t}function Yf(t,e){switch(Ie(_a,e),Ie(xa,t),Ie(Cn,za),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ah(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ah(e,t)}je(Cn),Ie(Cn,e)}function Bi(){je(Cn),je(xa),je(_a)}function Fw(t){js(_a.current);var e=js(Cn.current),n=ah(e,t.type);e!==n&&(Ie(xa,t),Ie(Cn,n))}function Xf(t){xa.current===t&&(je(Cn),je(xa))}var Re=us(0);function bc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Sd=[];function Jf(){for(var t=0;t<Sd.length;t++)Sd[t]._workInProgressVersionPrimary=null;Sd.length=0}var zl=hr.ReactCurrentDispatcher,Nd=hr.ReactCurrentBatchConfig,Us=0,De=null,Ze=null,it=null,Tc=!1,Zo=!1,Ea=0,dT=0;function pt(){throw Error(Q(321))}function Zf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gn(t[n],e[n]))return!1;return!0}function em(t,e,n,r,s,i){if(Us=i,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zl.current=t===null||t.memoizedState===null?pT:gT,t=n(r,s),Zo){i=0;do{if(Zo=!1,Ea=0,25<=i)throw Error(Q(301));i+=1,it=Ze=null,e.updateQueue=null,zl.current=yT,t=n(r,s)}while(Zo)}if(zl.current=Ic,e=Ze!==null&&Ze.next!==null,Us=0,it=Ze=De=null,Tc=!1,e)throw Error(Q(300));return t}function tm(){var t=Ea!==0;return Ea=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?De.memoizedState=it=t:it=it.next=t,it}function on(){if(Ze===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=Ze.next;var e=it===null?De.memoizedState:it.next;if(e!==null)it=e,Ze=t;else{if(t===null)throw Error(Q(310));Ze=t,t={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},it===null?De.memoizedState=it=t:it=it.next=t}return it}function ba(t,e){return typeof e=="function"?e(t):e}function Ad(t){var e=on(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=Ze,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,d=i;do{var m=d.lane;if((Us&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=f,o=r):u=u.next=f,De.lanes|=m,Bs|=m}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=c,gn(r,e.memoizedState)||(Dt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,De.lanes|=i,Bs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function kd(t){var e=on(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);gn(i,e.memoizedState)||(Dt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Uw(){}function Bw(t,e){var n=De,r=on(),s=e(),i=!gn(r.memoizedState,s);if(i&&(r.memoizedState=s,Dt=!0),r=r.queue,nm(qw.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||it!==null&&it.memoizedState.tag&1){if(n.flags|=2048,Ta(9,$w.bind(null,n,r,s,e),void 0,null),ot===null)throw Error(Q(349));Us&30||zw(n,e,s)}return s}function zw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function $w(t,e,n,r){e.value=n,e.getSnapshot=r,Hw(e)&&Ww(t)}function qw(t,e,n){return n(function(){Hw(e)&&Ww(t)})}function Hw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gn(t,n)}catch{return!0}}function Ww(t){var e=rr(t,1);e!==null&&pn(e,t,1,-1)}function iy(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:t},e.queue=t,t=t.dispatch=mT.bind(null,De,t),[e.memoizedState,t]}function Ta(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Gw(){return on().memoizedState}function $l(t,e,n,r){var s=bn();De.flags|=t,s.memoizedState=Ta(1|e,n,void 0,r===void 0?null:r)}function cu(t,e,n,r){var s=on();r=r===void 0?null:r;var i=void 0;if(Ze!==null){var o=Ze.memoizedState;if(i=o.destroy,r!==null&&Zf(r,o.deps)){s.memoizedState=Ta(e,n,i,r);return}}De.flags|=t,s.memoizedState=Ta(1|e,n,i,r)}function oy(t,e){return $l(8390656,8,t,e)}function nm(t,e){return cu(2048,8,t,e)}function Kw(t,e){return cu(4,2,t,e)}function Qw(t,e){return cu(4,4,t,e)}function Yw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Xw(t,e,n){return n=n!=null?n.concat([t]):null,cu(4,4,Yw.bind(null,e,t),n)}function rm(){}function Jw(t,e){var n=on();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Zw(t,e){var n=on();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ex(t,e,n){return Us&21?(gn(n,e)||(n=iw(),De.lanes|=n,Bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Dt=!0),t.memoizedState=n)}function hT(t,e){var n=_e;_e=n!==0&&4>n?n:4,t(!0);var r=Nd.transition;Nd.transition={};try{t(!1),e()}finally{_e=n,Nd.transition=r}}function tx(){return on().memoizedState}function fT(t,e,n){var r=Wr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nx(t))rx(e,n);else if(n=Ow(t,e,n,r),n!==null){var s=At();pn(n,t,r,s),sx(n,e,r)}}function mT(t,e,n){var r=Wr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nx(t))rx(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,gn(c,o)){var u=e.interleaved;u===null?(s.next=s,Kf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Ow(t,e,s,r),n!==null&&(s=At(),pn(n,t,r,s),sx(n,e,r))}}function nx(t){var e=t.alternate;return t===De||e!==null&&e===De}function rx(t,e){Zo=Tc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function sx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Df(t,n)}}var Ic={readContext:sn,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},pT={readContext:sn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:sn,useEffect:oy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,$l(4194308,4,Yw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return $l(4194308,4,t,e)},useInsertionEffect:function(t,e){return $l(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=fT.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:iy,useDebugValue:rm,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=iy(!1),e=t[0];return t=hT.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,s=bn();if(Pe){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=e(),ot===null)throw Error(Q(349));Us&30||zw(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,oy(qw.bind(null,r,i,t),[t]),r.flags|=2048,Ta(9,$w.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=ot.identifierPrefix;if(Pe){var n=qn,r=$n;n=(r&~(1<<32-mn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ea++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=dT++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gT={readContext:sn,useCallback:Jw,useContext:sn,useEffect:nm,useImperativeHandle:Xw,useInsertionEffect:Kw,useLayoutEffect:Qw,useMemo:Zw,useReducer:Ad,useRef:Gw,useState:function(){return Ad(ba)},useDebugValue:rm,useDeferredValue:function(t){var e=on();return ex(e,Ze.memoizedState,t)},useTransition:function(){var t=Ad(ba)[0],e=on().memoizedState;return[t,e]},useMutableSource:Uw,useSyncExternalStore:Bw,useId:tx,unstable_isNewReconciler:!1},yT={readContext:sn,useCallback:Jw,useContext:sn,useEffect:nm,useImperativeHandle:Xw,useInsertionEffect:Kw,useLayoutEffect:Qw,useMemo:Zw,useReducer:kd,useRef:Gw,useState:function(){return kd(ba)},useDebugValue:rm,useDeferredValue:function(t){var e=on();return Ze===null?e.memoizedState=t:ex(e,Ze.memoizedState,t)},useTransition:function(){var t=kd(ba)[0],e=on().memoizedState;return[t,e]},useMutableSource:Uw,useSyncExternalStore:Bw,useId:tx,unstable_isNewReconciler:!1};function un(t,e){if(t&&t.defaultProps){e=Le({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ah(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Le({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var uu={isMounted:function(t){return(t=t._reactInternals)?Ys(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=At(),s=Wr(t),i=Qn(r,s);i.payload=e,n!=null&&(i.callback=n),e=qr(t,i,s),e!==null&&(pn(e,t,s,r),Bl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=At(),s=Wr(t),i=Qn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=qr(t,i,s),e!==null&&(pn(e,t,s,r),Bl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=At(),r=Wr(t),s=Qn(n,r);s.tag=2,e!=null&&(s.callback=e),e=qr(t,s,r),e!==null&&(pn(e,t,r,n),Bl(e,t,r))}};function ay(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!ga(n,r)||!ga(s,i):!0}function ix(t,e,n){var r=!1,s=Jr,i=e.contextType;return typeof i=="object"&&i!==null?i=sn(i):(s=Mt(e)?Vs:bt.current,r=e.contextTypes,i=(r=r!=null)?Vi(t,s):Jr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=uu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function ly(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&uu.enqueueReplaceState(e,e.state,null)}function kh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Qf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=sn(i):(i=Mt(e)?Vs:bt.current,s.context=Vi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ah(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&uu.enqueueReplaceState(s,s.state,null),Ec(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function zi(t,e){try{var n="",r=e;do n+=HE(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Cd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ch(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var vT=typeof WeakMap=="function"?WeakMap:Map;function ox(t,e,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Nc||(Nc=!0,Uh=r),Ch(t,e)},n}function ax(t,e,n){n=Qn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Ch(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ch(t,e),typeof r!="function"&&(Hr===null?Hr=new Set([this]):Hr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function cy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new vT;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=PT.bind(null,t,e,n),e.then(t,t))}function uy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function dy(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qn(-1,1),e.tag=2,qr(n,e,1))),n.lanes|=1),t)}var wT=hr.ReactCurrentOwner,Dt=!1;function Nt(t,e,n,r){e.child=t===null?Mw(e,null,n,r):Ui(e,t.child,n,r)}function hy(t,e,n,r,s){n=n.render;var i=e.ref;return ki(e,s),r=em(t,e,n,r,i,s),n=tm(),t!==null&&!Dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Pe&&n&&zf(e),e.flags|=1,Nt(t,e,r,s),e.child)}function fy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!dm(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,lx(t,e,i,r,s)):(t=Gl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ga,n(o,r)&&t.ref===e.ref)return sr(t,e,s)}return e.flags|=1,t=Gr(i,r),t.ref=e.ref,t.return=e,e.child=t}function lx(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(ga(i,r)&&t.ref===e.ref)if(Dt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Dt=!0);else return e.lanes=t.lanes,sr(t,e,s)}return jh(t,e,n,r,s)}function cx(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(bi,zt),zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ie(bi,zt),zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ie(bi,zt),zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ie(bi,zt),zt|=r;return Nt(t,e,s,n),e.child}function ux(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function jh(t,e,n,r,s){var i=Mt(n)?Vs:bt.current;return i=Vi(e,i),ki(e,s),n=em(t,e,n,r,i,s),r=tm(),t!==null&&!Dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Pe&&r&&zf(e),e.flags|=1,Nt(t,e,n,s),e.child)}function my(t,e,n,r,s){if(Mt(n)){var i=!0;yc(e)}else i=!1;if(ki(e,s),e.stateNode===null)ql(t,e),ix(e,n,r),kh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=sn(d):(d=Mt(n)?Vs:bt.current,d=Vi(e,d));var m=n.getDerivedStateFromProps,f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&ly(e,o,r,d),Cr=!1;var g=e.memoizedState;o.state=g,Ec(e,r,o,s),u=e.memoizedState,c!==r||g!==u||Lt.current||Cr?(typeof m=="function"&&(Ah(e,n,m,r),u=e.memoizedState),(c=Cr||ay(e,n,c,r,g,u,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Vw(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:un(e.type,c),o.props=d,f=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=sn(u):(u=Mt(n)?Vs:bt.current,u=Vi(e,u));var x=n.getDerivedStateFromProps;(m=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==f||g!==u)&&ly(e,o,r,u),Cr=!1,g=e.memoizedState,o.state=g,Ec(e,r,o,s);var k=e.memoizedState;c!==f||g!==k||Lt.current||Cr?(typeof x=="function"&&(Ah(e,n,x,r),k=e.memoizedState),(d=Cr||ay(e,n,d,r,g,k,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,k,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,k,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),o.props=r,o.state=k,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Ph(t,e,n,r,i,s)}function Ph(t,e,n,r,s,i){ux(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Zg(e,n,!1),sr(t,e,i);r=e.stateNode,wT.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ui(e,t.child,null,i),e.child=Ui(e,null,c,i)):Nt(t,e,c,i),e.memoizedState=r.state,s&&Zg(e,n,!0),e.child}function dx(t){var e=t.stateNode;e.pendingContext?Jg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Jg(t,e.context,!1),Yf(t,e.containerInfo)}function py(t,e,n,r,s){return Fi(),qf(s),e.flags|=256,Nt(t,e,n,r),e.child}var Rh={dehydrated:null,treeContext:null,retryLane:0};function Dh(t){return{baseLanes:t,cachePool:null,transitions:null}}function hx(t,e,n){var r=e.pendingProps,s=Re.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ie(Re,s&1),t===null)return Sh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=fu(o,r,0,null),t=Ls(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Dh(n),e.memoizedState=Rh,t):sm(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return xT(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Gr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Gr(c,i):(i=Ls(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Dh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Rh,r}return i=t.child,t=i.sibling,r=Gr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function sm(t,e){return e=fu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Tl(t,e,n,r){return r!==null&&qf(r),Ui(e,t.child,null,n),t=sm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function xT(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Cd(Error(Q(422))),Tl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=fu({mode:"visible",children:r.children},s,0,null),i=Ls(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ui(e,t.child,null,o),e.child.memoizedState=Dh(o),e.memoizedState=Rh,i);if(!(e.mode&1))return Tl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(Q(419)),r=Cd(i,r,void 0),Tl(t,e,o,r)}if(c=(o&t.childLanes)!==0,Dt||c){if(r=ot,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,rr(t,s),pn(r,t,s,-1))}return um(),r=Cd(Error(Q(421))),Tl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=RT.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,$t=$r(s.nextSibling),Ht=e,Pe=!0,hn=null,t!==null&&(Yt[Xt++]=$n,Yt[Xt++]=qn,Yt[Xt++]=Fs,$n=t.id,qn=t.overflow,Fs=e),e=sm(e,r.children),e.flags|=4096,e)}function gy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Nh(t.return,e,n)}function jd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function fx(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=Re.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gy(t,n,e);else if(t.tag===19)gy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ie(Re,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&bc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),jd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&bc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}jd(e,!0,n,null,i);break;case"together":jd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ql(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,n=Gr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _T(t,e,n){switch(e.tag){case 3:dx(e),Fi();break;case 5:Fw(e);break;case 1:Mt(e.type)&&yc(e);break;case 4:Yf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ie(xc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ie(Re,Re.current&1),e.flags|=128,null):n&e.child.childLanes?hx(t,e,n):(Ie(Re,Re.current&1),t=sr(t,e,n),t!==null?t.sibling:null);Ie(Re,Re.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return fx(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ie(Re,Re.current),r)break;return null;case 22:case 23:return e.lanes=0,cx(t,e,n)}return sr(t,e,n)}var mx,Lh,px,gx;mx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lh=function(){};px=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,js(Cn.current);var i=null;switch(n){case"input":s=rh(t,s),r=rh(t,r),i=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),i=[];break;case"textarea":s=oh(t,s),r=oh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=pc)}lh(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ca.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ca.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ae("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};gx=function(t,e,n,r){n!==r&&(e.flags|=4)};function Mo(t,e){if(!Pe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function gt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ET(t,e,n){var r=e.pendingProps;switch($f(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(e),null;case 1:return Mt(e.type)&&gc(),gt(e),null;case 3:return r=e.stateNode,Bi(),je(Lt),je(bt),Jf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(El(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hn!==null&&($h(hn),hn=null))),Lh(t,e),gt(e),null;case 5:Xf(e);var s=js(_a.current);if(n=e.type,t!==null&&e.stateNode!=null)px(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Q(166));return gt(e),null}if(t=js(Cn.current),El(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[In]=e,r[wa]=i,t=(e.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<Bo.length;s++)Ae(Bo[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":Ig(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":Ng(r,i),Ae("invalid",r)}lh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&_l(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&_l(r.textContent,c,t),s=["children",""+c]):ca.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Ae("scroll",r)}switch(n){case"input":fl(r),Sg(r,i,!0);break;case"textarea":fl(r),Ag(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=pc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=qv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[In]=e,t[wa]=r,mx(t,e,!1,!1),e.stateNode=t;e:{switch(o=ch(n,r),n){case"dialog":Ae("cancel",t),Ae("close",t),s=r;break;case"iframe":case"object":case"embed":Ae("load",t),s=r;break;case"video":case"audio":for(s=0;s<Bo.length;s++)Ae(Bo[s],t);s=r;break;case"source":Ae("error",t),s=r;break;case"img":case"image":case"link":Ae("error",t),Ae("load",t),s=r;break;case"details":Ae("toggle",t),s=r;break;case"input":Ig(t,r),s=rh(t,r),Ae("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),Ae("invalid",t);break;case"textarea":Ng(t,r),s=oh(t,r),Ae("invalid",t);break;default:s=r}lh(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?Gv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Hv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ua(t,u):typeof u=="number"&&ua(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ca.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ae("scroll",t):u!=null&&Af(t,i,u,o))}switch(n){case"input":fl(t),Sg(t,r,!1);break;case"textarea":fl(t),Ag(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ii(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ii(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=pc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gt(e),null;case 6:if(t&&e.stateNode!=null)gx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Q(166));if(n=js(_a.current),js(Cn.current),El(e)){if(r=e.stateNode,n=e.memoizedProps,r[In]=e,(i=r.nodeValue!==n)&&(t=Ht,t!==null))switch(t.tag){case 3:_l(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_l(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[In]=e,e.stateNode=r}return gt(e),null;case 13:if(je(Re),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pe&&$t!==null&&e.mode&1&&!(e.flags&128))Dw(),Fi(),e.flags|=98560,i=!1;else if(i=El(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Q(317));i[In]=e}else Fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gt(e),i=!1}else hn!==null&&($h(hn),hn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Re.current&1?et===0&&(et=3):um())),e.updateQueue!==null&&(e.flags|=4),gt(e),null);case 4:return Bi(),Lh(t,e),t===null&&ya(e.stateNode.containerInfo),gt(e),null;case 10:return Gf(e.type._context),gt(e),null;case 17:return Mt(e.type)&&gc(),gt(e),null;case 19:if(je(Re),i=e.memoizedState,i===null)return gt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Mo(i,!1);else{if(et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=bc(t),o!==null){for(e.flags|=128,Mo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ie(Re,Re.current&1|2),e.child}t=t.sibling}i.tail!==null&&qe()>$i&&(e.flags|=128,r=!0,Mo(i,!1),e.lanes=4194304)}else{if(!r)if(t=bc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Mo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Pe)return gt(e),null}else 2*qe()-i.renderingStartTime>$i&&n!==1073741824&&(e.flags|=128,r=!0,Mo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=qe(),e.sibling=null,n=Re.current,Ie(Re,r?n&1|2:n&1),e):(gt(e),null);case 22:case 23:return cm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zt&1073741824&&(gt(e),e.subtreeFlags&6&&(e.flags|=8192)):gt(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function bT(t,e){switch($f(e),e.tag){case 1:return Mt(e.type)&&gc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Bi(),je(Lt),je(bt),Jf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Xf(e),null;case 13:if(je(Re),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));Fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(Re),null;case 4:return Bi(),null;case 10:return Gf(e.type._context),null;case 22:case 23:return cm(),null;case 24:return null;default:return null}}var Il=!1,xt=!1,TT=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Ei(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(t,e,r)}else n.current=null}function Mh(t,e,n){try{n()}catch(r){Ue(t,e,r)}}var yy=!1;function IT(t,e){if(wh=hc,t=_w(),Bf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,m=0,f=t,g=null;t:for(;;){for(var x;f!==n||s!==0&&f.nodeType!==3||(c=o+s),f!==i||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(x=f.firstChild)!==null;)g=f,f=x;for(;;){if(f===t)break t;if(g===n&&++d===s&&(c=o),g===i&&++m===r&&(u=o),(x=f.nextSibling)!==null)break;f=g,g=f.parentNode}f=x}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(xh={focusedElem:t,selectionRange:n},hc=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var j=k.memoizedProps,E=k.memoizedState,b=e.stateNode,_=b.getSnapshotBeforeUpdate(e.elementType===e.type?j:un(e.type,j),E);b.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(R){Ue(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return k=yy,yy=!1,k}function ea(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Mh(e,n,i)}s=s.next}while(s!==r)}}function du(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Oh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function yx(t){var e=t.alternate;e!==null&&(t.alternate=null,yx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[In],delete e[wa],delete e[bh],delete e[aT],delete e[lT])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vx(t){return t.tag===5||t.tag===3||t.tag===4}function vy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=pc));else if(r!==4&&(t=t.child,t!==null))for(Vh(t,e,n),t=t.sibling;t!==null;)Vh(t,e,n),t=t.sibling}function Fh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Fh(t,e,n),t=t.sibling;t!==null;)Fh(t,e,n),t=t.sibling}var at=null,dn=!1;function br(t,e,n){for(n=n.child;n!==null;)wx(t,e,n),n=n.sibling}function wx(t,e,n){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(ru,n)}catch{}switch(n.tag){case 5:xt||Ei(n,e);case 6:var r=at,s=dn;at=null,br(t,e,n),at=r,dn=s,at!==null&&(dn?(t=at,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):at.removeChild(n.stateNode));break;case 18:at!==null&&(dn?(t=at,n=n.stateNode,t.nodeType===8?Td(t.parentNode,n):t.nodeType===1&&Td(t,n),ma(t)):Td(at,n.stateNode));break;case 4:r=at,s=dn,at=n.stateNode.containerInfo,dn=!0,br(t,e,n),at=r,dn=s;break;case 0:case 11:case 14:case 15:if(!xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Mh(n,e,o),s=s.next}while(s!==r)}br(t,e,n);break;case 1:if(!xt&&(Ei(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Ue(n,e,c)}br(t,e,n);break;case 21:br(t,e,n);break;case 22:n.mode&1?(xt=(r=xt)||n.memoizedState!==null,br(t,e,n),xt=r):br(t,e,n);break;default:br(t,e,n)}}function wy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new TT),e.forEach(function(r){var s=DT.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function cn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:at=c.stateNode,dn=!1;break e;case 3:at=c.stateNode.containerInfo,dn=!0;break e;case 4:at=c.stateNode.containerInfo,dn=!0;break e}c=c.return}if(at===null)throw Error(Q(160));wx(i,o,s),at=null,dn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ue(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xx(e,t),e=e.sibling}function xx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(cn(e,t),En(t),r&4){try{ea(3,t,t.return),du(3,t)}catch(j){Ue(t,t.return,j)}try{ea(5,t,t.return)}catch(j){Ue(t,t.return,j)}}break;case 1:cn(e,t),En(t),r&512&&n!==null&&Ei(n,n.return);break;case 5:if(cn(e,t),En(t),r&512&&n!==null&&Ei(n,n.return),t.flags&32){var s=t.stateNode;try{ua(s,"")}catch(j){Ue(t,t.return,j)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&zv(s,i),ch(c,o);var d=ch(c,i);for(o=0;o<u.length;o+=2){var m=u[o],f=u[o+1];m==="style"?Gv(s,f):m==="dangerouslySetInnerHTML"?Hv(s,f):m==="children"?ua(s,f):Af(s,m,f,d)}switch(c){case"input":sh(s,i);break;case"textarea":$v(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Ii(s,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?Ii(s,!!i.multiple,i.defaultValue,!0):Ii(s,!!i.multiple,i.multiple?[]:"",!1))}s[wa]=i}catch(j){Ue(t,t.return,j)}}break;case 6:if(cn(e,t),En(t),r&4){if(t.stateNode===null)throw Error(Q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(j){Ue(t,t.return,j)}}break;case 3:if(cn(e,t),En(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ma(e.containerInfo)}catch(j){Ue(t,t.return,j)}break;case 4:cn(e,t),En(t);break;case 13:cn(e,t),En(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(am=qe())),r&4&&wy(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(xt=(d=xt)||m,cn(e,t),xt=d):cn(e,t),En(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(ne=t,m=t.child;m!==null;){for(f=ne=m;ne!==null;){switch(g=ne,x=g.child,g.tag){case 0:case 11:case 14:case 15:ea(4,g,g.return);break;case 1:Ei(g,g.return);var k=g.stateNode;if(typeof k.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(j){Ue(r,n,j)}}break;case 5:Ei(g,g.return);break;case 22:if(g.memoizedState!==null){_y(f);continue}}x!==null?(x.return=g,ne=x):_y(f)}m=m.sibling}e:for(m=null,f=t;;){if(f.tag===5){if(m===null){m=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Wv("display",o))}catch(j){Ue(t,t.return,j)}}}else if(f.tag===6){if(m===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(j){Ue(t,t.return,j)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:cn(e,t),En(t),r&4&&wy(t);break;case 21:break;default:cn(e,t),En(t)}}function En(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(vx(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ua(s,""),r.flags&=-33);var i=vy(t);Fh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=vy(t);Vh(t,c,o);break;default:throw Error(Q(161))}}catch(u){Ue(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ST(t,e,n){ne=t,_x(t)}function _x(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Il;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||xt;c=Il;var d=xt;if(Il=o,(xt=u)&&!d)for(ne=s;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?Ey(s):u!==null?(u.return=o,ne=u):Ey(s);for(;i!==null;)ne=i,_x(i),i=i.sibling;ne=s,Il=c,xt=d}xy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):xy(t)}}function xy(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:xt||du(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!xt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:un(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&sy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}sy(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var f=m.dehydrated;f!==null&&ma(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}xt||e.flags&512&&Oh(e)}catch(g){Ue(e,e.return,g)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function _y(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function Ey(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{du(4,e)}catch(u){Ue(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ue(e,s,u)}}var i=e.return;try{Oh(e)}catch(u){Ue(e,i,u)}break;case 5:var o=e.return;try{Oh(e)}catch(u){Ue(e,o,u)}}}catch(u){Ue(e,e.return,u)}if(e===t){ne=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ne=c;break}ne=e.return}}var NT=Math.ceil,Sc=hr.ReactCurrentDispatcher,im=hr.ReactCurrentOwner,tn=hr.ReactCurrentBatchConfig,we=0,ot=null,Ke=null,ut=0,zt=0,bi=us(0),et=0,Ia=null,Bs=0,hu=0,om=0,ta=null,Pt=null,am=0,$i=1/0,Un=null,Nc=!1,Uh=null,Hr=null,Sl=!1,Vr=null,Ac=0,na=0,Bh=null,Hl=-1,Wl=0;function At(){return we&6?qe():Hl!==-1?Hl:Hl=qe()}function Wr(t){return t.mode&1?we&2&&ut!==0?ut&-ut:uT.transition!==null?(Wl===0&&(Wl=iw()),Wl):(t=_e,t!==0||(t=window.event,t=t===void 0?16:hw(t.type)),t):1}function pn(t,e,n,r){if(50<na)throw na=0,Bh=null,Error(Q(185));Fa(t,n,r),(!(we&2)||t!==ot)&&(t===ot&&(!(we&2)&&(hu|=n),et===4&&Pr(t,ut)),Ot(t,r),n===1&&we===0&&!(e.mode&1)&&($i=qe()+500,lu&&ds()))}function Ot(t,e){var n=t.callbackNode;ub(t,e);var r=dc(t,t===ot?ut:0);if(r===0)n!==null&&jg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jg(n),e===1)t.tag===0?cT(by.bind(null,t)):jw(by.bind(null,t)),iT(function(){!(we&6)&&ds()}),n=null;else{switch(ow(r)){case 1:n=Rf;break;case 4:n=rw;break;case 16:n=uc;break;case 536870912:n=sw;break;default:n=uc}n=kx(n,Ex.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ex(t,e){if(Hl=-1,Wl=0,we&6)throw Error(Q(327));var n=t.callbackNode;if(Ci()&&t.callbackNode!==n)return null;var r=dc(t,t===ot?ut:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=kc(t,r);else{e=r;var s=we;we|=2;var i=Tx();(ot!==t||ut!==e)&&(Un=null,$i=qe()+500,Ds(t,e));do try{CT();break}catch(c){bx(t,c)}while(!0);Wf(),Sc.current=i,we=s,Ke!==null?e=0:(ot=null,ut=0,e=et)}if(e!==0){if(e===2&&(s=mh(t),s!==0&&(r=s,e=zh(t,s))),e===1)throw n=Ia,Ds(t,0),Pr(t,r),Ot(t,qe()),n;if(e===6)Pr(t,r);else{if(s=t.current.alternate,!(r&30)&&!AT(s)&&(e=kc(t,r),e===2&&(i=mh(t),i!==0&&(r=i,e=zh(t,i))),e===1))throw n=Ia,Ds(t,0),Pr(t,r),Ot(t,qe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Q(345));case 2:Ns(t,Pt,Un);break;case 3:if(Pr(t,r),(r&130023424)===r&&(e=am+500-qe(),10<e)){if(dc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){At(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Eh(Ns.bind(null,t,Pt,Un),e);break}Ns(t,Pt,Un);break;case 4:if(Pr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-mn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*NT(r/1960))-r,10<r){t.timeoutHandle=Eh(Ns.bind(null,t,Pt,Un),r);break}Ns(t,Pt,Un);break;case 5:Ns(t,Pt,Un);break;default:throw Error(Q(329))}}}return Ot(t,qe()),t.callbackNode===n?Ex.bind(null,t):null}function zh(t,e){var n=ta;return t.current.memoizedState.isDehydrated&&(Ds(t,e).flags|=256),t=kc(t,e),t!==2&&(e=Pt,Pt=n,e!==null&&$h(e)),t}function $h(t){Pt===null?Pt=t:Pt.push.apply(Pt,t)}function AT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!gn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pr(t,e){for(e&=~om,e&=~hu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mn(e),r=1<<n;t[n]=-1,e&=~r}}function by(t){if(we&6)throw Error(Q(327));Ci();var e=dc(t,0);if(!(e&1))return Ot(t,qe()),null;var n=kc(t,e);if(t.tag!==0&&n===2){var r=mh(t);r!==0&&(e=r,n=zh(t,r))}if(n===1)throw n=Ia,Ds(t,0),Pr(t,e),Ot(t,qe()),n;if(n===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ns(t,Pt,Un),Ot(t,qe()),null}function lm(t,e){var n=we;we|=1;try{return t(e)}finally{we=n,we===0&&($i=qe()+500,lu&&ds())}}function zs(t){Vr!==null&&Vr.tag===0&&!(we&6)&&Ci();var e=we;we|=1;var n=tn.transition,r=_e;try{if(tn.transition=null,_e=1,t)return t()}finally{_e=r,tn.transition=n,we=e,!(we&6)&&ds()}}function cm(){zt=bi.current,je(bi)}function Ds(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,sT(n)),Ke!==null)for(n=Ke.return;n!==null;){var r=n;switch($f(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&gc();break;case 3:Bi(),je(Lt),je(bt),Jf();break;case 5:Xf(r);break;case 4:Bi();break;case 13:je(Re);break;case 19:je(Re);break;case 10:Gf(r.type._context);break;case 22:case 23:cm()}n=n.return}if(ot=t,Ke=t=Gr(t.current,null),ut=zt=e,et=0,Ia=null,om=hu=Bs=0,Pt=ta=null,Cs!==null){for(e=0;e<Cs.length;e++)if(n=Cs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Cs=null}return t}function bx(t,e){do{var n=Ke;try{if(Wf(),zl.current=Ic,Tc){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Tc=!1}if(Us=0,it=Ze=De=null,Zo=!1,Ea=0,im.current=null,n===null||n.return===null){et=1,Ia=e,Ke=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=ut,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=c,f=m.tag;if(!(m.mode&1)&&(f===0||f===11||f===15)){var g=m.alternate;g?(m.updateQueue=g.updateQueue,m.memoizedState=g.memoizedState,m.lanes=g.lanes):(m.updateQueue=null,m.memoizedState=null)}var x=uy(o);if(x!==null){x.flags&=-257,dy(x,o,c,i,e),x.mode&1&&cy(i,d,e),e=x,u=d;var k=e.updateQueue;if(k===null){var j=new Set;j.add(u),e.updateQueue=j}else k.add(u);break e}else{if(!(e&1)){cy(i,d,e),um();break e}u=Error(Q(426))}}else if(Pe&&c.mode&1){var E=uy(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),dy(E,o,c,i,e),qf(zi(u,c));break e}}i=u=zi(u,c),et!==4&&(et=2),ta===null?ta=[i]:ta.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=ox(i,u,e);ry(i,b);break e;case 1:c=u;var _=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Hr===null||!Hr.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=ax(i,c,e);ry(i,R);break e}}i=i.return}while(i!==null)}Sx(n)}catch(F){e=F,Ke===n&&n!==null&&(Ke=n=n.return);continue}break}while(!0)}function Tx(){var t=Sc.current;return Sc.current=Ic,t===null?Ic:t}function um(){(et===0||et===3||et===2)&&(et=4),ot===null||!(Bs&268435455)&&!(hu&268435455)||Pr(ot,ut)}function kc(t,e){var n=we;we|=2;var r=Tx();(ot!==t||ut!==e)&&(Un=null,Ds(t,e));do try{kT();break}catch(s){bx(t,s)}while(!0);if(Wf(),we=n,Sc.current=r,Ke!==null)throw Error(Q(261));return ot=null,ut=0,et}function kT(){for(;Ke!==null;)Ix(Ke)}function CT(){for(;Ke!==null&&!tb();)Ix(Ke)}function Ix(t){var e=Ax(t.alternate,t,zt);t.memoizedProps=t.pendingProps,e===null?Sx(t):Ke=e,im.current=null}function Sx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=bT(n,e),n!==null){n.flags&=32767,Ke=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{et=6,Ke=null;return}}else if(n=ET(n,e,zt),n!==null){Ke=n;return}if(e=e.sibling,e!==null){Ke=e;return}Ke=e=t}while(e!==null);et===0&&(et=5)}function Ns(t,e,n){var r=_e,s=tn.transition;try{tn.transition=null,_e=1,jT(t,e,n,r)}finally{tn.transition=s,_e=r}return null}function jT(t,e,n,r){do Ci();while(Vr!==null);if(we&6)throw Error(Q(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(db(t,i),t===ot&&(Ke=ot=null,ut=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sl||(Sl=!0,kx(uc,function(){return Ci(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=tn.transition,tn.transition=null;var o=_e;_e=1;var c=we;we|=4,im.current=null,IT(t,n),xx(n,t),Xb(xh),hc=!!wh,xh=wh=null,t.current=n,ST(n),nb(),we=c,_e=o,tn.transition=i}else t.current=n;if(Sl&&(Sl=!1,Vr=t,Ac=s),i=t.pendingLanes,i===0&&(Hr=null),ib(n.stateNode),Ot(t,qe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Nc)throw Nc=!1,t=Uh,Uh=null,t;return Ac&1&&t.tag!==0&&Ci(),i=t.pendingLanes,i&1?t===Bh?na++:(na=0,Bh=t):na=0,ds(),null}function Ci(){if(Vr!==null){var t=ow(Ac),e=tn.transition,n=_e;try{if(tn.transition=null,_e=16>t?16:t,Vr===null)var r=!1;else{if(t=Vr,Vr=null,Ac=0,we&6)throw Error(Q(331));var s=we;for(we|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(ne=d;ne!==null;){var m=ne;switch(m.tag){case 0:case 11:case 15:ea(8,m,i)}var f=m.child;if(f!==null)f.return=m,ne=f;else for(;ne!==null;){m=ne;var g=m.sibling,x=m.return;if(yx(m),m===d){ne=null;break}if(g!==null){g.return=x,ne=g;break}ne=x}}}var k=i.alternate;if(k!==null){var j=k.child;if(j!==null){k.child=null;do{var E=j.sibling;j.sibling=null,j=E}while(j!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ea(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,ne=b;break e}ne=i.return}}var _=t.current;for(ne=_;ne!==null;){o=ne;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,ne=S;else e:for(o=_;ne!==null;){if(c=ne,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:du(9,c)}}catch(F){Ue(c,c.return,F)}if(c===o){ne=null;break e}var R=c.sibling;if(R!==null){R.return=c.return,ne=R;break e}ne=c.return}}if(we=s,ds(),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(ru,t)}catch{}r=!0}return r}finally{_e=n,tn.transition=e}}return!1}function Ty(t,e,n){e=zi(n,e),e=ox(t,e,1),t=qr(t,e,1),e=At(),t!==null&&(Fa(t,1,e),Ot(t,e))}function Ue(t,e,n){if(t.tag===3)Ty(t,t,n);else for(;e!==null;){if(e.tag===3){Ty(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hr===null||!Hr.has(r))){t=zi(n,t),t=ax(e,t,1),e=qr(e,t,1),t=At(),e!==null&&(Fa(e,1,t),Ot(e,t));break}}e=e.return}}function PT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=At(),t.pingedLanes|=t.suspendedLanes&n,ot===t&&(ut&n)===n&&(et===4||et===3&&(ut&130023424)===ut&&500>qe()-am?Ds(t,0):om|=n),Ot(t,e)}function Nx(t,e){e===0&&(t.mode&1?(e=gl,gl<<=1,!(gl&130023424)&&(gl=4194304)):e=1);var n=At();t=rr(t,e),t!==null&&(Fa(t,e,n),Ot(t,n))}function RT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Nx(t,n)}function DT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(e),Nx(t,n)}var Ax;Ax=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Lt.current)Dt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Dt=!1,_T(t,e,n);Dt=!!(t.flags&131072)}else Dt=!1,Pe&&e.flags&1048576&&Pw(e,wc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ql(t,e),t=e.pendingProps;var s=Vi(e,bt.current);ki(e,n),s=em(null,e,r,t,s,n);var i=tm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Mt(r)?(i=!0,yc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Qf(e),s.updater=uu,e.stateNode=s,s._reactInternals=e,kh(e,r,t,n),e=Ph(null,e,r,!0,i,n)):(e.tag=0,Pe&&i&&zf(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ql(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=MT(r),t=un(r,t),s){case 0:e=jh(null,e,r,t,n);break e;case 1:e=my(null,e,r,t,n);break e;case 11:e=hy(null,e,r,t,n);break e;case 14:e=fy(null,e,r,un(r.type,t),n);break e}throw Error(Q(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),jh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),my(t,e,r,s,n);case 3:e:{if(dx(e),t===null)throw Error(Q(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Vw(t,e),Ec(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=zi(Error(Q(423)),e),e=py(t,e,r,n,s);break e}else if(r!==s){s=zi(Error(Q(424)),e),e=py(t,e,r,n,s);break e}else for($t=$r(e.stateNode.containerInfo.firstChild),Ht=e,Pe=!0,hn=null,n=Mw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fi(),r===s){e=sr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return Fw(e),t===null&&Sh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,_h(r,s)?o=null:i!==null&&_h(r,i)&&(e.flags|=32),ux(t,e),Nt(t,e,o,n),e.child;case 6:return t===null&&Sh(e),null;case 13:return hx(t,e,n);case 4:return Yf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ui(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),hy(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ie(xc,r._currentValue),r._currentValue=o,i!==null)if(gn(i.value,o)){if(i.children===s.children&&!Lt.current){e=sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Qn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Nh(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Q(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Nh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ki(e,n),s=sn(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=un(r,e.pendingProps),s=un(r.type,s),fy(t,e,r,s,n);case 15:return lx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:un(r,s),ql(t,e),e.tag=1,Mt(r)?(t=!0,yc(e)):t=!1,ki(e,n),ix(e,r,s),kh(e,r,s,n),Ph(null,e,r,!0,t,n);case 19:return fx(t,e,n);case 22:return cx(t,e,n)}throw Error(Q(156,e.tag))};function kx(t,e){return nw(t,e)}function LT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(t,e,n,r){return new LT(t,e,n,r)}function dm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MT(t){if(typeof t=="function")return dm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Cf)return 11;if(t===jf)return 14}return 2}function Gr(t,e){var n=t.alternate;return n===null?(n=en(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Gl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")dm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case fi:return Ls(n.children,s,i,e);case kf:o=8,s|=8;break;case Zd:return t=en(12,n,e,s|2),t.elementType=Zd,t.lanes=i,t;case eh:return t=en(13,n,e,s),t.elementType=eh,t.lanes=i,t;case th:return t=en(19,n,e,s),t.elementType=th,t.lanes=i,t;case Fv:return fu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ov:o=10;break e;case Vv:o=9;break e;case Cf:o=11;break e;case jf:o=14;break e;case kr:o=16,r=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=en(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ls(t,e,n,r){return t=en(7,t,r,e),t.lanes=n,t}function fu(t,e,n,r){return t=en(22,t,r,e),t.elementType=Fv,t.lanes=n,t.stateNode={isHidden:!1},t}function Pd(t,e,n){return t=en(6,t,null,e),t.lanes=n,t}function Rd(t,e,n){return e=en(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function OT(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fd(0),this.expirationTimes=fd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function hm(t,e,n,r,s,i,o,c,u){return t=new OT(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=en(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qf(i),t}function VT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Cx(t){if(!t)return Jr;t=t._reactInternals;e:{if(Ys(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Mt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var n=t.type;if(Mt(n))return Cw(t,n,e)}return e}function jx(t,e,n,r,s,i,o,c,u){return t=hm(n,r,!0,t,s,i,o,c,u),t.context=Cx(null),n=t.current,r=At(),s=Wr(n),i=Qn(r,s),i.callback=e??null,qr(n,i,s),t.current.lanes=s,Fa(t,s,r),Ot(t,r),t}function mu(t,e,n,r){var s=e.current,i=At(),o=Wr(s);return n=Cx(n),e.context===null?e.context=n:e.pendingContext=n,e=Qn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=qr(s,e,o),t!==null&&(pn(t,s,o,i),Bl(t,s,o)),o}function Cc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Iy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function fm(t,e){Iy(t,e),(t=t.alternate)&&Iy(t,e)}function FT(){return null}var Px=typeof reportError=="function"?reportError:function(t){console.error(t)};function mm(t){this._internalRoot=t}pu.prototype.render=mm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));mu(t,e,null,null)};pu.prototype.unmount=mm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zs(function(){mu(null,t,null,null)}),e[nr]=null}};function pu(t){this._internalRoot=t}pu.prototype.unstable_scheduleHydration=function(t){if(t){var e=cw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<jr.length&&e!==0&&e<jr[n].priority;n++);jr.splice(n,0,t),n===0&&dw(t)}};function pm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sy(){}function UT(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Cc(o);i.call(d)}}var o=jx(e,r,t,0,null,!1,!1,"",Sy);return t._reactRootContainer=o,t[nr]=o.current,ya(t.nodeType===8?t.parentNode:t),zs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=Cc(u);c.call(d)}}var u=hm(t,0,!1,null,null,!1,!1,"",Sy);return t._reactRootContainer=u,t[nr]=u.current,ya(t.nodeType===8?t.parentNode:t),zs(function(){mu(e,u,n,r)}),u}function yu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=Cc(o);c.call(u)}}mu(e,o,t,s)}else o=UT(n,e,t,s,r);return Cc(o)}aw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Uo(e.pendingLanes);n!==0&&(Df(e,n|1),Ot(e,qe()),!(we&6)&&($i=qe()+500,ds()))}break;case 13:zs(function(){var r=rr(t,1);if(r!==null){var s=At();pn(r,t,1,s)}}),fm(t,1)}};Lf=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var n=At();pn(e,t,134217728,n)}fm(t,134217728)}};lw=function(t){if(t.tag===13){var e=Wr(t),n=rr(t,e);if(n!==null){var r=At();pn(n,t,e,r)}fm(t,e)}};cw=function(){return _e};uw=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}};dh=function(t,e,n){switch(e){case"input":if(sh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=au(r);if(!s)throw Error(Q(90));Bv(r),sh(r,s)}}}break;case"textarea":$v(t,n);break;case"select":e=n.value,e!=null&&Ii(t,!!n.multiple,e,!1)}};Yv=lm;Xv=zs;var BT={usingClientEntryPoint:!1,Events:[Ba,yi,au,Kv,Qv,lm]},Oo={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zT={bundleType:Oo.bundleType,version:Oo.version,rendererPackageName:Oo.rendererPackageName,rendererConfig:Oo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ew(t),t===null?null:t.stateNode},findFiberByHostInstance:Oo.findFiberByHostInstance||FT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nl.isDisabled&&Nl.supportsFiber)try{ru=Nl.inject(zT),kn=Nl}catch{}}Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BT;Gt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pm(e))throw Error(Q(200));return VT(t,e,null,n)};Gt.createRoot=function(t,e){if(!pm(t))throw Error(Q(299));var n=!1,r="",s=Px;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=hm(t,1,!1,null,null,n,!1,r,s),t[nr]=e.current,ya(t.nodeType===8?t.parentNode:t),new mm(e)};Gt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=ew(e),t=t===null?null:t.stateNode,t};Gt.flushSync=function(t){return zs(t)};Gt.hydrate=function(t,e,n){if(!gu(e))throw Error(Q(200));return yu(null,t,e,!0,n)};Gt.hydrateRoot=function(t,e,n){if(!pm(t))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Px;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=jx(e,null,t,1,n??null,s,!1,i,o),t[nr]=e.current,ya(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new pu(e)};Gt.render=function(t,e,n){if(!gu(e))throw Error(Q(200));return yu(null,t,e,!1,n)};Gt.unmountComponentAtNode=function(t){if(!gu(t))throw Error(Q(40));return t._reactRootContainer?(zs(function(){yu(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};Gt.unstable_batchedUpdates=lm;Gt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!gu(n))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return yu(t,e,n,!1,r)};Gt.version="18.3.1-next-f1338f8080-20240426";function Rx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rx)}catch(t){console.error(t)}}Rx(),Rv.exports=Gt;var $T=Rv.exports,Ny=$T;oc.createRoot=Ny.createRoot,oc.hydrateRoot=Ny.hydrateRoot;const gm=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),qh=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),ir=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),ym=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),Dx=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),Lx=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),Yn=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:a.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),qT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),HT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),WT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),Mx=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),GT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),KT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),Ay=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),Hh=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),QT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),YT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.962a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5zM3.75 18.75a3 3 0 013-3h1.5a3 3 0 013 3v.5a.75.75 0 01-.75.75h-5.5a.75.75 0 01-.75-.75v-.5z"})}),XT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),JT=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),ZT=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),Ox=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),eI=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>a.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:a.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[a.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),a.jsxs("span",{className:"text-2xl font-bold",children:[a.jsx("span",{className:"text-gray-900",children:"LA"}),a.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),a.jsx("div",{className:"flex items-center gap-4",children:t&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:a.jsx(Ox,{className:"w-7 h-7"})}),a.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[a.jsx(Hh,{className:"h-5 w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),a.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[a.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),a.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),Hn={novedad:{label:"Novetat",emoji:"",className:"bg-blue-500 text-white"},ultimas_unidades:{label:"ltimes Unitats",emoji:"",className:"bg-yellow-500 text-black"},reservado:{label:"Reservat",emoji:"",className:"bg-orange-500 text-white"},vendido:{label:"Tracte Fet",emoji:"",className:"bg-gray-700 text-white"}},ky=({product:t,onSelect:e,isAdmin:n,onMove:r})=>{const s=t.imageUrls&&t.imageUrls.length>0,i=g=>typeof g!="number"||isNaN(g)?"N/A":g.toFixed(2),o=t.tag?Hn[t.tag]:null,c=n&&t.isMerchandise,u=g=>{c&&(g.dataTransfer.setData("text/plain",t.id),g.dataTransfer.effectAllowed="move",g.currentTarget.style.opacity="0.5")},d=g=>{g.currentTarget.style.opacity="1"},m=g=>{c&&(g.preventDefault(),g.dataTransfer.dropEffect="move")},f=g=>{if(!c)return;g.preventDefault();const x=g.dataTransfer.getData("text/plain");r&&x&&x!==t.id&&r(x,t.id)};return a.jsx("div",{className:"relative group",draggable:c,onDragStart:u,onDragEnd:d,onDragOver:m,onDrop:f,style:{cursor:c?"move":"pointer"},children:a.jsxs("button",{onClick:e,className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden text-left w-full hover:shadow-lg transition-shadow duration-200 ${t.tag==="vendido"?"opacity-70":""}`,children:[a.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",children:[s&&a.jsx("img",{src:t.imageUrls[0],alt:t.title,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 ${t.tag==="vendido"?"grayscale":""}`}),o&&a.jsxs("div",{className:`absolute top-2 left-2 text-xs font-bold px-2 py-1 rounded-full shadow-md ${o.className}`,children:[o.emoji," ",o.label]})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[i(t.price)," "]}),a.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),a.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[a.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})})},tI=({userProducts:t,merchProducts:e,onProductSelect:n,firebaseError:r,currentUser:s,onMoveProduct:i})=>{const[o,c]=P.useState(t),[u,d]=P.useState("");P.useEffect(()=>{const f=u.toLowerCase();if(f==="")c(t);else{const g=t.filter(x=>x.title.toLowerCase().includes(f)||x.description.toLowerCase().includes(f));c(g)}},[u,t]);const m=f=>{d(f.target.value)};return a.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[r&&a.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-8 rounded-r-lg",role:"alert",children:[a.jsx("p",{className:"font-bold",children:"Avs de connexi"}),a.jsx("p",{children:"No s'ha pogut connectar a la base de dades. S'estan mostrant dades d'exemple."})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[a.jsx("h1",{className:"text-xl md:text-3xl font-bold text-gray-800 mb-2",children:s?`Hola, ${s.name.split(" ")[0]}! Benvingut al nostre espai de Marxandatge i intercanvi de roba del Club.`:"Benvingut al nostre espai de Marxandatge i intercanvi de roba del Club."}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Busca al nostre club els articles de segona m que et calguin."}),a.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(WT,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:u,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&a.jsx("section",{className:"mb-12",children:a.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club."})}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6 mb-8",children:e.map(f=>a.jsx(ky,{product:f,onSelect:()=>n(f),isAdmin:(s==null?void 0:s.role)==="admin",onMove:i},f.id))}),a.jsx("div",{className:"flex justify-center",children:a.jsxs("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLSfux48JDT3BFqAlhNqPfM5BirPosepNYO_88zz1fwWk-Gmwwg/viewform",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-primary text-white font-bold py-3 px-8 rounded-full hover:bg-primary-700 transition-all transform hover:scale-105 shadow-md",children:[a.jsx(Mx,{className:"w-5 h-5"}),a.jsx("span",{children:"Realitzar comanda"})]})})]})}),a.jsxs("section",{className:"mb-12",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4 text-center",children:"Accedeix a les nostres equipacions oficials."}),a.jsx("a",{href:"https://tcequipacions.cat/ca/search?controller=search&s=handbol+molins",target:"_blank",rel:"noopener noreferrer",className:"block w-full max-w-xs mx-auto rounded-2xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 transform hover:scale-[1.01]",children:a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/tc%20equipacions%20esportives.png",alt:"TC Equipacions Esportives - Handbol Molins",className:"w-full h-auto object-cover"})})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles que et poden interessar."}),o.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:o.map(f=>a.jsx(ky,{product:f,onSelect:()=>n(f)},f.id))}):a.jsx("div",{className:"text-center py-16",children:a.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},Zr=(t,e=1024,n=1024,r=.75)=>new Promise((s,i)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=c=>{var d;if(!((d=c.target)!=null&&d.result))return i(new Error("No s'ha pogut llegir el fitxer."));const u=new Image;u.src=c.target.result,u.onload=()=>{const m=document.createElement("canvas");let{width:f,height:g}=u;f>g?f>e&&(g=Math.round(g*(e/f)),f=e):g>n&&(f=Math.round(f*(n/g)),g=n),m.width=f,m.height=g;const x=m.getContext("2d");if(!x)return i(new Error("No s'ha pogut obtenir el context del canvas"));x.drawImage(u,0,0,f,g),m.toBlob(k=>{k?s(k):i(new Error("La creaci del Blob des del canvas ha fallat."))},"image/jpeg",r)},u.onerror=m=>i(new Error(`Error en carregar la imatge: ${typeof m=="string"?m:"Event d'error"}`))},o.onerror=()=>i(o.error??new Error("Error desconegut en llegir el fitxer"))}),eo=t=>new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}),nI=({onClose:t,onCapture:e})=>{const n=P.useRef(null),r=P.useRef(null),s=P.useRef(null),[i,o]=P.useState(null);P.useEffect(()=>((async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("La cmera no s compatible amb aquest navegador.");const d=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});s.current=d,n.current&&(n.current.srcObject=d)}catch(d){console.error("Error en accedir a la cmera:",d),o("No s'ha pogut accedir a la cmera. Assegura't que has donat perms al navegador.")}})(),()=>{s.current&&s.current.getTracks().forEach(d=>d.stop())}),[]);const c=()=>{if(n.current&&r.current){const u=n.current,d=r.current;d.width=u.videoWidth,d.height=u.videoHeight;const m=d.getContext("2d");m&&(m.drawImage(u,0,0,u.videoWidth,u.videoHeight),d.toBlob(f=>{f&&e(f)},"image/jpeg",.9))}};return a.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col justify-center items-center","aria-modal":"true",role:"dialog",children:[a.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),a.jsx("canvas",{ref:r,className:"hidden"}),i&&a.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white p-4 rounded-lg text-center",children:[a.jsx("p",{children:i}),a.jsx("button",{onClick:t,className:"mt-2 px-4 py-2 bg-white text-red-500 font-bold rounded",children:"Tancar"})]}),a.jsx("button",{onClick:t,className:"absolute top-4 left-4 text-white bg-black bg-opacity-50 rounded-full p-3","aria-label":"Tancar la cmera",children:a.jsx(ir,{className:"w-6 h-6"})}),a.jsx("div",{className:"absolute bottom-8 flex justify-center w-full",children:a.jsx("button",{onClick:c,className:"w-20 h-20 bg-white rounded-full border-4 border-black border-opacity-25 flex items-center justify-center","aria-label":"Fes una foto",children:a.jsx("div",{className:"w-16 h-16 bg-white rounded-full border-2 border-black"})})})]})},Tr=5,rI=({imagePreviews:t,onImagesAdded:e,onDeleteImage:n})=>{const[r,s]=P.useState(!1),[i,o]=P.useState(null),[c,u]=P.useState(!1),[d,m]=P.useState(!1),f=P.useRef(null),g=async E=>{const b=E.target.files;if(!b)return;const _=Array.from(b).slice(0,Tr-t.length);if(b.length>_.length?o(`Noms pots pujar un mxim de ${Tr} imatges.`):o(null),_.length!==0){s(!0);try{const S=_.map(F=>Zr(F)),R=await Promise.all(S);e(R)}catch(S){const R=S instanceof Error?S.message:String(S);o(`No s'ha pogut carregar una o ms imatges: ${R}`),console.error(S)}finally{s(!1)}E.target.value=""}},x=()=>{var E;u(!1),(E=f.current)==null||E.click()},k=()=>{u(!1),m(!0)},j=async E=>{m(!1),s(!0);try{const b=await Zr(E);e([b])}catch(b){const _=b instanceof Error?b.message:String(b);o(`No s'ha pogut processar la foto capturada: ${_}`),console.error(b)}finally{s(!1)}};return a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(Hh,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),a.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",Tr]})]}),a.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((E,b)=>a.jsxs("div",{className:"relative aspect-square group",children:[a.jsx("img",{src:E,alt:`Product image ${b+1}`,className:"w-full h-full object-cover rounded-lg border"}),a.jsx("button",{onClick:()=>n(b),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:a.jsx(ir,{className:"w-4 h-4"})})]},b)),r&&a.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:a.jsx(Yn,{className:"w-8 h-8 text-primary"})}),t.length<Tr&&!r&&a.jsxs("button",{onClick:()=>u(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${Tr-t.length} imatges ms`,children:[a.jsx(Hh,{className:"mx-auto h-8 w-8 text-gray-400"}),a.jsx("p",{className:"mt-1 text-xs text-gray-600",children:a.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),a.jsx("input",{ref:f,type:"file",onChange:g,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=Tr}),i&&a.jsx("p",{className:"text-red-500 text-sm mt-4",children:i}),c&&a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>u(!1),"aria-modal":"true",role:"dialog",children:[a.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),a.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ir,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:k,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Tr,children:[a.jsx(gm,{className:"w-6 h-6 text-primary"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),a.jsxs("button",{onClick:x,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Tr,children:[a.jsx(Lx,{className:"w-6 h-6 text-primary"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]}),d&&a.jsx(nI,{onCapture:j,onClose:()=>m(!1)})]})},sI=({title:t,setTitle:e,description:n,setDescription:r})=>a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(KT,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),a.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),a.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),iI=({imagePreviews:t,title:e,description:n,price:r,onPublish:s,isEditing:i,isPublishing:o})=>{const c=t.length>0&&e&&r;return a.jsx("div",{className:"sticky top-28",children:a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),a.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?a.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):a.jsx(Lx,{className:"w-16 h-16 text-gray-300"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),a.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),a.jsx("div",{className:"border-t pt-3",children:a.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),a.jsx("button",{onClick:s,disabled:!c||o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?a.jsxs(a.Fragment,{children:[a.jsx(Yn,{className:"w-5 h-5"}),a.jsx("span",{children:i?"Desant...":"Publicant..."})]}):i?"Desa els canvis":"Publica l'anunci"})]})]})})},oI="dfmkfeqzt",aI="BOTIGAHANDBOL",Kl=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",aI);const n=await fetch(`https://api.cloudinary.com/v1_1/${oI}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},lI="ListingDraftDB",cI=1,es="listingDrafts",vm="currentListingDraft",wm=()=>new Promise((t,e)=>{const n=indexedDB.open(lI,cI);n.onerror=()=>e("Error en obrir la base de dades IndexedDB."),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(es)||s.createObjectStore(es)}}),uI=async t=>{const n=(await wm()).transaction(es,"readwrite");return n.objectStore(es).put(t,vm),new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i("Error en desar l'esborrany a IndexedDB.")})},dI=async()=>{const r=(await wm()).transaction(es,"readonly").objectStore(es).get(vm);return new Promise((s,i)=>{r.onsuccess=()=>{s(r.result||null)},r.onerror=()=>i("Error en llegir l'esborrany.")})},hI=async()=>{(await wm()).transaction(es,"readwrite").objectStore(es).delete(vm)},fI=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=P.useState([]),[i,o]=P.useState([]),[c,u]=P.useState(""),[d,m]=P.useState(""),[f,g]=P.useState(""),[x,k]=P.useState(!1),[j,E]=P.useState(""),[b,_]=P.useState(!1),[S,R]=P.useState(!1),[F,B]=P.useState(!0),[y,v]=P.useState(!1),T=!!e,A=P.useRef(null);P.useEffect(()=>{const Z=r.map(te=>typeof te=="string"?te:URL.createObjectURL(te));return o(Z),()=>{Z.forEach(te=>{te.startsWith("blob:")&&URL.revokeObjectURL(te)})}},[r]),P.useEffect(()=>{(async()=>{var te;if(T&&e)u(e.title),m(e.description),g(((te=e.price)==null?void 0:te.toString())||""),s(e.imageUrls||[]),k(e.isMerchandise||!1),E(e.tag||""),_(e.hideOrderButton||!1),R(e.hideContactButton||!1);else if(!T)try{const q=await dI();q&&(s(q.imagesData||[]),u(q.title||""),m(q.description||""),g(q.price||""),k(q.isMerchandise||!1),E(q.tag||""),_(q.hideOrderButton||!1),R(q.hideContactButton||!1))}catch(q){console.error("Error en restaurar l'esborrany:",q)}B(!1)})()},[e,T]),P.useEffect(()=>{if(!(F||T))return A.current&&clearTimeout(A.current),A.current=window.setTimeout(()=>{uI({imagesData:r,title:c,description:d,price:f,isMerchandise:x,tag:j,hideOrderButton:b,hideContactButton:S}).catch(te=>console.error("Error en desar l'esborrany:",te))},500),()=>{A.current&&clearTimeout(A.current)}},[r,c,d,f,x,j,b,S,F,T]);const N=async()=>{s([]),u(""),m(""),g(""),k(!1),E(""),_(!1),R(!1),await hI()},C=async()=>{if(i.length>0&&c&&f){v(!0);try{const Z=r.map(se=>typeof se=="string"?Promise.resolve(se):eo(se).then(ce=>Kl(ce))),te=await Promise.all(Z),q={title:c,description:d,price:parseFloat(f),imageUrls:te,isMerchandise:x,tag:j||"",hideOrderButton:b,hideContactButton:S};await t(q,e==null?void 0:e.id),await N()}catch{console.error("La publicaci ha fallat. L'usuari ja ha estat notificat.")}finally{v(!1)}}},I={novedad:Hn.novedad,ultimas_unidades:Hn.ultimas_unidades},W={reservado:Hn.reservado,vendido:Hn.vendido},fe=(n==null?void 0:n.role)==="admin"&&x?I:W;return F&&!T?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("p",{className:"text-gray-600",children:"Recuperant l'esborrany..."})}):a.jsx("main",{className:"container mx-auto p-4 md:p-8",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:T?"Edita el teu anunci":"Crea el teu anunci"}),a.jsx("p",{className:"text-gray-600 mb-8",children:T?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[a.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[a.jsx(rI,{imagePreviews:i,onImagesAdded:Z=>s(te=>[...te,...Z]),onDeleteImage:Z=>s(te=>te.filter((q,se)=>se!==Z))}),a.jsx(sI,{title:c,setTitle:u,description:d,setDescription:m}),a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(Ay,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Introdueix el preu de venda del teu article."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),a.jsx("input",{id:"product-price",type:"number",value:f,onChange:Z=>g(Z.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(Ay,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"4. Etiqueta (Opcional)"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecciona un estat per al teu article."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[a.jsx("input",{type:"radio",name:"tag",value:"",checked:j==="",onChange:Z=>E(Z.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Cap etiqueta"})]}),Object.entries(fe).map(([Z,te])=>a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[a.jsx("input",{type:"radio",name:"tag",value:Z,checked:j===Z,onChange:q=>E(q.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),a.jsxs("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${te.className}`,children:[te.emoji," ",te.label]})]},Z))]})]}),(n==null?void 0:n.role)==="admin"&&a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),a.jsxs("div",{className:"mt-4 space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:x,onChange:Z=>k(Z.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]}),a.jsxs("div",{className:`pl-8 space-y-3 border-l-2 border-gray-100 transition-opacity duration-200 ${x?"opacity-100":"opacity-50"}`,children:[a.jsxs("label",{className:`flex items-center gap-3 cursor-pointer ${x?"":"cursor-not-allowed"}`,children:[a.jsx("input",{type:"checkbox",checked:b,onChange:Z=>_(Z.target.checked),disabled:!x,className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary disabled:cursor-not-allowed"}),a.jsx("span",{className:"text-gray-600 text-sm",children:'Oculta el bot "Realitzar comanda"'})]}),a.jsxs("label",{className:`flex items-center gap-3 cursor-pointer ${x?"":"cursor-not-allowed"}`,children:[a.jsx("input",{type:"checkbox",checked:S,onChange:Z=>R(Z.target.checked),disabled:!x,className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary disabled:cursor-not-allowed"}),a.jsx("span",{className:"text-gray-600 text-sm",children:'Oculta el bot "Contacta amb el club"'})]})]})]})]})]}),a.jsx("div",{className:"lg:col-span-2",children:a.jsx(iI,{imagePreviews:i,title:c,description:d,price:f,onPublish:C,isEditing:T,isPublishing:y})})]})]})})},mI=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return a.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[a.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),a.jsxs("div",{className:`${r} ${s[e]}`,children:[a.jsx("span",{children:t}),a.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:a.jsx(ir,{className:"w-4 h-4"})})]})]})},pI=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=P.useState("login"),[c,u]=P.useState(""),[d,m]=P.useState(""),[f,g]=P.useState(""),[x,k]=P.useState(!1),[j,E]=P.useState(null),b=P.useRef(null),[_,S]=P.useState(!1),[R,F]=P.useState(null),[B,y]=P.useState(null),v=async N=>{var I;const C=(I=N.target.files)==null?void 0:I[0];if(C)try{const W=await Zr(C,512,512,.9),fe=await eo(W);E(fe)}catch(W){console.error("Error en llegir el fitxer:",W),F("No s'ha pogut processar la imatge.")}},T=async N=>{N.preventDefault(),S(!0),F(null),y(null);try{i==="login"?await e(d,f):await n(c,d,f,j)}catch(C){let I="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(C.code)switch(C.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":I="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":I="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":I="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":I="El format del correu electrnic no s vlid.";break}else C.message&&(C.message.includes("Cloudinary")?I="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":I=C.message);F(I),console.error(C)}finally{S(!1)}},A=async N=>{N.preventDefault(),S(!0),F(null),y(null);try{await r(d),y("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(C){let I="Hi ha hagut un error en enviar el correu.";(C.code==="auth/user-not-found"||C.code==="auth/invalid-email")&&(I="No s'ha trobat cap usuari amb aquest correu electrnic."),F(I)}finally{S(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:N=>N.stopPropagation(),children:[s&&a.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:a.jsx(ir,{className:"w-6 h-6"})}),a.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),a.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),a.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:N=>m(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),R&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:R}),B&&a.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:_,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:_?a.jsx(Yn,{className:"w-5 h-5"}):"Envia l'enlla"})}),a.jsx("div",{children:a.jsx("button",{type:"button",onClick:()=>{o("login"),F(null),y(null),k(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),a.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?a.jsxs(a.Fragment,{children:["Benvingut/da a LA",a.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),a.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),a.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[a.jsx("button",{onClick:()=>{o("login"),F(null),y(null),k(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),a.jsx("button",{onClick:()=>{o("register"),F(null),y(null),k(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),a.jsxs("form",{onSubmit:T,className:"space-y-4",children:[i==="register"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-center",children:[a.jsx("input",{type:"file",ref:b,onChange:v,className:"hidden",accept:"image/*"}),a.jsxs("button",{type:"button",onClick:()=>{var N;return(N=b.current)==null?void 0:N.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[j?a.jsx("img",{src:j,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):a.jsx(gm,{className:"w-10 h-10"}),a.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),a.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:c,onChange:N=>u(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),a.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:N=>m(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&a.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),F(null),y(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx("input",{id:"password",name:"password",type:x?"text":"password",autoComplete:"current-password",required:!0,value:f,onChange:N=>g(N.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),a.jsx("button",{type:"button",onClick:()=>k(!x),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":x?"Oculta la contrasenya":"Mostra la contrasenya",children:x?a.jsx(ZT,{className:"w-5 h-5"}):a.jsx(JT,{className:"w-5 h-5"})})]})]}),R&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:R}),B&&a.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:_,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:_?a.jsx(Yn,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},gI=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=P.useState("all"),[s,i]=P.useState(""),[o,c]=P.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{await e(n,s),i(""),r("all")}catch{}finally{c(!1)}}};return a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[a.jsx(qT,{className:"h-10 w-10 text-primary"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),a.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),a.jsxs("select",{id:"recipient",value:n,onChange:d=>r(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[a.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(d=>a.jsxs("option",{value:d.id,children:[d.name," (",d.email,")"]},d.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),a.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:d=>i(d.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),a.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?a.jsx(Yn,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},yI=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i,onUpdateUserRole:o,onDeleteUserByAdmin:c})=>{const[u,d]=P.useState(t.name),[m,f]=P.useState(null),g=P.useRef(null),[x,k]=P.useState(!1),[j,E]=P.useState(null),[b,_]=P.useState(!1),[S,R]=P.useState(!1),[F,B]=P.useState("user");P.useEffect(()=>{d(t.name)},[t]);const y=async W=>{var Z;const fe=(Z=W.target.files)==null?void 0:Z[0];if(fe)try{const te=await Zr(fe,512,512,.9),q=await eo(te);f(q)}catch(te){console.error("Error en llegir el fitxer:",te)}},v=async W=>{W.preventDefault(),k(!0);try{await e(t.id,u,m),f(null)}catch(fe){console.error(fe)}finally{k(!1)}},T=W=>{E(W),B(W.role),_(!0)},A=W=>{E(W),R(!0)},N=()=>{E(null),_(!1),R(!1)},C=async W=>{if(W.preventDefault(),!!j){k(!0);try{await o(j.id,F),N()}catch{}finally{k(!1)}}},I=async()=>{if(j){k(!0);try{await c(j.id)&&N()}catch(W){console.error("Error durant la confirmaci de l'eliminaci:",W)}finally{k(!1)}}};return a.jsxs(a.Fragment,{children:[a.jsx("main",{className:"container mx-auto p-4 md:p-8",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[a.jsx(QT,{className:"h-10 w-10 text-primary"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),a.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("input",{type:"file",ref:g,onChange:y,className:"hidden",accept:"image/*"}),a.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),a.jsxs("button",{type:"button",onClick:()=>{var W;return(W=g.current)==null?void 0:W.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[a.jsx("img",{src:m||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:a.jsx(gm,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),a.jsx("input",{id:"name",type:"text",required:!0,value:u,onChange:W=>d(W.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),a.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),a.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),a.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),a.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:x?a.jsx(Yn,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:a.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&a.jsxs(a.Fragment,{children:[a.jsx(gI,{allUsers:s,onSendAdminMessage:i}),a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx(YT,{className:"h-10 w-10 text-primary"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gesti d'Usuaris"}),a.jsx("p",{className:"text-gray-600",children:"Edita rols o elimina usuaris de la plataforma."})]})]}),a.jsx("div",{className:"space-y-3",children:s.length>0?s.map(W=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[a.jsx("img",{src:W.avatarUrl,alt:W.name,className:"w-10 h-10 rounded-full"}),a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("p",{className:"font-semibold text-gray-800 truncate",children:W.name}),a.jsx("p",{className:"text-sm text-gray-500 truncate",children:W.email})]})]}),a.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>T(W),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-100 rounded-md transition-colors","aria-label":`Edita ${W.name}`,children:a.jsx(Dx,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>A(W),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-100 rounded-md transition-colors","aria-label":`Elimina ${W.name}`,children:a.jsx(ym,{className:"w-5 h-5"})})]})]},W.id)):a.jsx("p",{className:"text-center text-gray-500 py-4",children:"No hi ha altres usuaris per gestionar."})})]})]})]})}),b&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:N,children:a.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md",onClick:W=>W.stopPropagation(),children:a.jsxs("form",{onSubmit:C,className:"p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Edita l'Usuari"}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[a.jsx("strong",{children:"Nom:"})," ",j.name]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[a.jsx("strong",{children:"Email:"})," ",j.email]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Rol"}),a.jsxs("select",{id:"role",value:F,onChange:W=>B(W.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[a.jsx("option",{value:"user",children:"Usuari"}),a.jsx("option",{value:"admin",children:"Administrador"})]})]}),a.jsxs("div",{className:"mt-6 flex gap-3",children:[a.jsx("button",{type:"button",onClick:N,className:"w-full text-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancella"}),a.jsx("button",{type:"submit",disabled:x,className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 disabled:bg-primary-300",children:x?a.jsx(Yn,{className:"w-5 h-5 mx-auto"}):"Desa els canvis"})]})]})})}),S&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:N,children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",onClick:W=>W.stopPropagation(),children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Confirmar Eliminaci"}),a.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Ests segur que vols eliminar l'usuari ",a.jsx("strong",{children:j.name}),"? Aquesta acci no es pot desfer. L'usuari perdr l'accs a l'aplicaci."]}),a.jsxs("div",{className:"mt-6 flex gap-3",children:[a.jsx("button",{type:"button",onClick:N,className:"w-full text-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancella"}),a.jsx("button",{onClick:I,disabled:x,className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 disabled:bg-red-300",children:x?a.jsx(Yn,{className:"w-5 h-5 mx-auto"}):"S, elimina'l"})]})]})})]})},vI=({onClick:t,unreadCount:e,isOpen:n})=>n?null:a.jsxs(a.Fragment,{children:[a.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),a.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&a.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),a.jsx("div",{className:"w-9 h-9",children:a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),wI=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return a.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&a.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&a.jsx("div",{className:"mt-2",children:a.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),a.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},xI=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:m,height:f}=c;m>f?m>e&&(f=Math.round(f*(e/m)),m=e):f>n&&(m=Math.round(m*(n/f)),f=n),d.width=m,d.height=f;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,m,f),r(d.toDataURL("image/jpeg",.85))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),_I=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,x,k,j,E;const c=t.participantIds.find(b=>b!==n.id);if(!c)return null;const u=t.participants[c],d=t.unreadCount[n.id]||0,m=((k=(x=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:x.toDate())==null?void 0:k.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",f=()=>{r(t.id),o()};return a.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[a.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[a.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),a.jsx("button",{onClick:f,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),a.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[a.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[a.jsxs("div",{className:"relative flex-shrink-0",children:[a.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-12 h-12 rounded-full object-cover"}),a.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("p",{className:"font-bold text-gray-800 truncate",children:u.name}),a.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:m})]}),a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((j=t.lastMessage)==null?void 0:j.text)||((E=t.lastMessage)!=null&&E.imageUrl?"Imatge":"Cap missatge encara")}),d>0&&a.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:d})]})]})]}),a.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${u.name}`,children:a.jsx(ym,{className:"w-5 h-5"})})]})]})},EI=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:c,onBackToList:u,onDeleteChat:d})=>{const[m,f]=P.useState(""),[g,x]=P.useState(null),k=P.useRef(null),j=P.useRef(null),E=()=>{var y;(y=j.current)==null||y.scrollIntoView({behavior:"smooth"})};P.useEffect(()=>{t&&r&&E()},[s,t,r]),P.useEffect(()=>{(!t||!r)&&x(null)},[t,r]);const b=()=>{m.trim()&&(o(m),f(""))},_=y=>{y.key==="Enter"&&(y.preventDefault(),b())},S=async y=>{var T;const v=(T=y.target.files)==null?void 0:T[0];if(v)try{const A=await xI(v);o("",A)}catch(A){console.error("No s'ha pogut llegir el fitxer",A)}y.target&&(y.target.value="")},R=()=>{var y;(y=k.current)==null||y.click()};if(!t||!i)return null;const F=r==null?void 0:r.participantIds.find(y=>y!==i.id),B=F?r==null?void 0:r.participants[F]:null;return a.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[a.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),a.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?a.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[a.jsx("button",{onClick:u,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:a.jsx(XT,{className:"w-6 h-6"})}),a.jsx("img",{src:B==null?void 0:B.avatarUrl,alt:B==null?void 0:B.name,className:"w-8 h-8 rounded-full object-cover"}),a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("h3",{className:"font-bold text-lg truncate",children:B==null?void 0:B.name}),a.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):a.jsx("div",{className:"flex items-center justify-between w-full",children:a.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),a.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:a.jsx(ir,{className:"w-6 h-6"})})]}),r?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(y=>a.jsx(wI,{message:y,currentUser:i},y.id)),a.jsx("div",{ref:j})]}),a.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:a.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[a.jsx("input",{type:"text",value:m,onChange:y=>f(y.target.value),onKeyPress:_,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),a.jsx("input",{ref:k,type:"file",onChange:S,className:"hidden",accept:"image/*"}),a.jsx("button",{onClick:R,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:a.jsx(HT,{className:"w-5 h-5"})}),a.jsx("button",{onClick:b,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!m.trim(),"aria-label":"Envia el missatge",children:a.jsx(GT,{className:"w-5 h-5"})})]})})]}):a.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(y=>a.jsx(_I,{chat:y,onSelect:()=>c(y),currentUser:i,onDelete:d,isConfirmingDelete:g===y.id,onStartConfirmDelete:()=>x(y.id),onCancelConfirmDelete:()=>x(null)},y.id)):a.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[a.jsx(qh,{className:"w-16 h-16 text-gray-300 mb-4"}),a.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),a.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},Ir=({title:t,children:e})=>a.jsxs("section",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),a.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),bI=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[a.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ox,{className:"w-8 h-8 text-primary"}),a.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",a.jsx("span",{className:"text-gray-900",children:"LA"}),a.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:a.jsx(ir,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto",children:[a.jsxs("section",{className:"mb-6",children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",a.jsx("span",{className:"text-gray-900",children:"LA"}),a.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),a.jsx("div",{className:"space-y-2 text-gray-700",children:a.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),a.jsx(Ir,{title:"1. Explora els Articles",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["A la pgina principal, trobars les seccions ",a.jsx("strong",{children:"'Marxandatge del Club.'"})," i ",a.jsx("strong",{children:"'Articles que et poden interessar.'"}),"."]}),a.jsxs("li",{children:["Fes servir la ",a.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),a.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),a.jsx(Ir,{title:"2. Comprar un Article de Segona M",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),a.jsxs("li",{children:[a.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),a.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),a.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",a.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),a.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),a.jsxs(Ir,{title:"3. Vendre un Article",children:[a.jsxs("p",{children:["Fes clic al bot ",a.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),a.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",a.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),a.jsx(Ir,{title:"4. Gestiona els Teus Xats",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Fes clic a la ",a.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),a.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),a.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),a.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),a.jsx(Ir,{title:"5. El Teu Perfil",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Fes clic a la teva ",a.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),a.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),a.jsxs("li",{children:["Tamb pots ",a.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),a.jsx(Ir,{title:"6. Comprar Marxandatge Oficial",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club.' sn productes oficials."}),a.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",a.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),a.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",a.jsx("strong",{children:"'Contacta amb el club'"})," per enviar un correu electrnic amb la teva consulta."]})]})}),a.jsx(Ir,{title:"7. Equipacions Oficials",children:a.jsxs("p",{children:["Tamb pots accedir directament a la botiga del nostre provedor ",a.jsx("strong",{children:"TC Equipacions"})," fent clic al banner corresponent a la pgina principal per comprar les equipacions oficials de joc."]})}),a.jsxs(Ir,{title:"8. Eines d'Administrador",children:[a.jsx("p",{children:"Si tens el rol d'administrador, tens accs a funcionalitats extra:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Panell de Comunicats:"})," A la teva pgina de perfil, pots enviar missatges a tots els usuaris o a un en concret."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Ordenaci de Productes:"})," Pots canviar l'ordre dels productes de 'Marxandatge del Club.' simplement ",a.jsx("strong",{children:"arrossegant-los i deixant-los anar"})," (Drag & Drop) a la nova posici."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Configuraci de Marxandatge:"}),' En crear o editar un producte oficial, pots marcar opcions per ocultar els botons de "Realitzar comanda" o "Contacta amb el club" si s necessari.']})]})]})]})]})}),Cy=({direction:t,onClick:e})=>a.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),TI=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=P.useState(e),[i,o]=P.useState(null),c=P.useCallback(()=>{s(f=>f===0?t.length-1:f-1)},[t.length]),u=P.useCallback(()=>{s(f=>f===t.length-1?0:f+1)},[t.length]);P.useEffect(()=>{const f=g=>{g.key==="ArrowLeft"&&c(),g.key==="ArrowRight"&&u(),g.key==="Escape"&&n()};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[c,u,n]);const d=f=>{o(f.touches[0].clientX)},m=f=>{if(i===null)return;const g=f.touches[0].clientX,x=i-g;x>50?(u(),o(null)):x<-50&&(c(),o(null))};return a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[a.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),a.jsx("button",{onClick:f=>{f.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:a.jsx(ir,{className:"w-6 h-6"})}),a.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&a.jsx(Cy,{direction:"left",onClick:c}),a.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:d,onTouchMove:m,children:a.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&a.jsx(Cy,{direction:"right",onClick:u})]}),t.length>1&&a.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},II=()=>{};var jy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},SI=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Fx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,m=i>>2,f=(i&3)<<4|c>>4;let g=(c&15)<<2|d>>6,x=d&63;u||(x=64,o||(g=64)),r.push(n[m],n[f],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Vx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||f==null)throw new NI;const g=i<<2|c>>4;if(r.push(g),d!==64){const x=c<<4&240|d>>2;if(r.push(x),f!==64){const k=d<<6&192|f;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class NI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AI=function(t){const e=Vx(t);return Fx.encodeByteArray(e,!0)},jc=function(t){return AI(t).replace(/\./g,"")},Ux=function(t){try{return Fx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=()=>kI().__FIREBASE_DEFAULTS__,jI=()=>{if(typeof process>"u"||typeof jy>"u")return;const t=jy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},PI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ux(t[1]);return e&&JSON.parse(e)},vu=()=>{try{return II()||CI()||jI()||PI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Bx=t=>{var e,n;return(n=(e=vu())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},RI=t=>{const e=Bx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},zx=()=>{var t;return(t=vu())==null?void 0:t.config},$x=t=>{var e;return(e=vu())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[jc(JSON.stringify(n)),jc(JSON.stringify(o)),""].join(".")}const ra={};function MI(){const t={prod:[],emulator:[]};for(const e of Object.keys(ra))ra[e]?t.emulator.push(e):t.prod.push(e);return t}function OI(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Py=!1;function Hx(t,e){if(typeof window>"u"||typeof document>"u"||!to(window.location.host)||ra[t]===e||ra[t]||Py)return;ra[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=MI().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,x){g.setAttribute("width","24"),g.setAttribute("id",x),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Py=!0,o()},g}function m(g,x){g.setAttribute("id",x),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){const g=OI(r),x=n("text"),k=document.getElementById(x)||document.createElement("span"),j=n("learnmore"),E=document.getElementById(j)||document.createElement("a"),b=n("preprendIcon"),_=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const S=g.element;c(S),m(E,j);const R=d();u(_,b),S.append(_,k,E,R),document.body.appendChild(S)}i?(k.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function VI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tt())}function FI(){var e;const t=(e=vu())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function UI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function zI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $I(){const t=Tt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function qI(){return!FI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Wx(){try{return typeof indexedDB=="object"}catch{return!1}}function Gx(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function HI(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="FirebaseError";class Fn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=WI,Object.setPrototypeOf(this,Fn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xs.prototype.create)}}class Xs{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?GI(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Fn(s,c,r)}}function GI(t,e){return t.replace(KI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const KI=/\{\$([^}]+)}/g;function QI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ts(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Ry(i)&&Ry(o)){if(!ts(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ry(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function zo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function $o(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function YI(t,e){const n=new XI(t,e);return n.subscribe.bind(n)}class XI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");JI(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Dd),s.error===void 0&&(s.error=Dd),s.complete===void 0&&(s.complete=Dd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Dd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(t){return t&&t._delegate?t._delegate:t}class yn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new DI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tS(e))try{this.getOrInitializeService({instanceIdentifier:As})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=As){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=As){return this.instances.has(e)}getOptions(e=As){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:eS(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=As){return this.component?this.component.multipleInstances?e:As:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eS(t){return t===As?void 0:t}function tS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ZI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const rS={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},sS=pe.INFO,iS={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},oS=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=iS[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xm{constructor(e){this.name=e,this._logLevel=sS,this._logHandler=oS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}const aS=(t,e)=>e.some(n=>t instanceof n);let Dy,Ly;function lS(){return Dy||(Dy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cS(){return Ly||(Ly=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Kx=new WeakMap,Wh=new WeakMap,Qx=new WeakMap,Ld=new WeakMap,_m=new WeakMap;function uS(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Xn(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Kx.set(n,t)}).catch(()=>{}),_m.set(e,t),e}function dS(t){if(Wh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Wh.set(t,e)}let Gh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Wh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Qx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hS(t){Gh=t(Gh)}function fS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Md(this),e,...n);return Qx.set(r,e.sort?e.sort():[e]),Xn(r)}:cS().includes(t)?function(...e){return t.apply(Md(this),e),Xn(Kx.get(this))}:function(...e){return Xn(t.apply(Md(this),e))}}function mS(t){return typeof t=="function"?fS(t):(t instanceof IDBTransaction&&dS(t),aS(t,lS())?new Proxy(t,Gh):t)}function Xn(t){if(t instanceof IDBRequest)return uS(t);if(Ld.has(t))return Ld.get(t);const e=mS(t);return e!==t&&(Ld.set(t,e),_m.set(e,t)),e}const Md=t=>_m.get(t);function wu(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Xn(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Xn(o.result),u.oldVersion,u.newVersion,Xn(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}function Od(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Xn(n).then(()=>{})}const pS=["get","getKey","getAll","getAllKeys","count"],gS=["put","add","delete","clear"],Vd=new Map;function My(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vd.get(e))return Vd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=gS.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pS.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return Vd.set(e,i),i}hS(t=>({...t,get:(e,n,r)=>My(e,n)||t.get(e,n,r),has:(e,n)=>!!My(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(vS(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function vS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kh="@firebase/app",Oy="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const or=new xm("@firebase/app"),wS="@firebase/app-compat",xS="@firebase/analytics-compat",_S="@firebase/analytics",ES="@firebase/app-check-compat",bS="@firebase/app-check",TS="@firebase/auth",IS="@firebase/auth-compat",SS="@firebase/database",NS="@firebase/data-connect",AS="@firebase/database-compat",kS="@firebase/functions",CS="@firebase/functions-compat",jS="@firebase/installations",PS="@firebase/installations-compat",RS="@firebase/messaging",DS="@firebase/messaging-compat",LS="@firebase/performance",MS="@firebase/performance-compat",OS="@firebase/remote-config",VS="@firebase/remote-config-compat",FS="@firebase/storage",US="@firebase/storage-compat",BS="@firebase/firestore",zS="@firebase/ai",$S="@firebase/firestore-compat",qS="firebase",HS="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="[DEFAULT]",WS={[Kh]:"fire-core",[wS]:"fire-core-compat",[_S]:"fire-analytics",[xS]:"fire-analytics-compat",[bS]:"fire-app-check",[ES]:"fire-app-check-compat",[TS]:"fire-auth",[IS]:"fire-auth-compat",[SS]:"fire-rtdb",[NS]:"fire-data-connect",[AS]:"fire-rtdb-compat",[kS]:"fire-fn",[CS]:"fire-fn-compat",[jS]:"fire-iid",[PS]:"fire-iid-compat",[RS]:"fire-fcm",[DS]:"fire-fcm-compat",[LS]:"fire-perf",[MS]:"fire-perf-compat",[OS]:"fire-rc",[VS]:"fire-rc-compat",[FS]:"fire-gcs",[US]:"fire-gcs-compat",[BS]:"fire-fst",[$S]:"fire-fst-compat",[zS]:"fire-vertex","fire-js":"fire-js",[qS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc=new Map,GS=new Map,Yh=new Map;function Vy(t,e){try{t.container.addComponent(e)}catch(n){or.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function On(t){const e=t.name;if(Yh.has(e))return or.debug(`There were multiple attempts to register component ${e}.`),!1;Yh.set(e,t);for(const n of Pc.values())Vy(n,t);for(const n of GS.values())Vy(n,t);return!0}function no(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Jt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kr=new Xs("app","Firebase",KS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=HS;function Em(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Qh,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Kr.create("bad-app-name",{appName:String(s)});if(n||(n=zx()),!n)throw Kr.create("no-options");const i=Pc.get(s);if(i){if(ts(n,i.options)&&ts(r,i.config))return i;throw Kr.create("duplicate-app",{appName:s})}const o=new nS(s);for(const u of Yh.values())o.addComponent(u);const c=new QS(n,r,o);return Pc.set(s,c),c}function bm(t=Qh){const e=Pc.get(t);if(!e&&t===Qh&&zx())return Em();if(!e)throw Kr.create("no-app",{appName:t});return e}function nn(t,e,n){let r=WS[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),or.warn(o.join(" "));return}On(new yn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="firebase-heartbeat-database",XS=1,Sa="firebase-heartbeat-store";let Fd=null;function Yx(){return Fd||(Fd=wu(YS,XS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Kr.create("idb-open",{originalErrorMessage:t.message})})),Fd}async function JS(t){try{const n=(await Yx()).transaction(Sa),r=await n.objectStore(Sa).get(Xx(t));return await n.done,r}catch(e){if(e instanceof Fn)or.warn(e.message);else{const n=Kr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});or.warn(n.message)}}}async function Fy(t,e){try{const r=(await Yx()).transaction(Sa,"readwrite");await r.objectStore(Sa).put(e,Xx(t)),await r.done}catch(n){if(n instanceof Fn)or.warn(n.message);else{const r=Kr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});or.warn(r.message)}}}function Xx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS=1024,eN=30;class tN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Uy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>eN){const o=sN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Uy(),{heartbeatsToSend:r,unsentEntries:s}=nN(this._heartbeatsCache.heartbeats),i=jc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return or.warn(n),""}}}function Uy(){return new Date().toISOString().substring(0,10)}function nN(t,e=ZS){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),By(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),By(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class rN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wx()?Gx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await JS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Fy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Fy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function By(t){return jc(JSON.stringify({version:2,heartbeats:t})).length}function sN(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(t){On(new yn("platform-logger",e=>new yS(e),"PRIVATE")),On(new yn("heartbeat",e=>new tN(e),"PRIVATE")),nn(Kh,Oy,t),nn(Kh,Oy,"esm2020"),nn("fire-js","")}iN("");var oN="firebase",aN="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn(oN,aN,"app");function Jx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lN=Jx,Zx=new Xs("auth","Firebase",Jx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rc=new xm("@firebase/auth");function cN(t,...e){Rc.logLevel<=pe.WARN&&Rc.warn(`Auth (${ro}): ${t}`,...e)}function Ql(t,...e){Rc.logLevel<=pe.ERROR&&Rc.error(`Auth (${ro}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t,...e){throw Tm(t,...e)}function jn(t,...e){return Tm(t,...e)}function e_(t,e,n){const r={...lN(),[e]:n};return new Xs("auth","Firebase",r).create(e,{appName:t.name})}function Jn(t){return e_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Tm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Zx.create(t,...e)}function ae(t,e,...n){if(!t)throw Tm(e,...n)}function Wn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ql(e),new Error(e)}function ar(t,e){t||Wn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function uN(){return zy()==="http:"||zy()==="https:"}function zy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uN()||BI()||"connection"in navigator)?navigator.onLine:!0}function hN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n){this.shortDelay=e,this.longDelay=n,ar(n>e,"Short delay should be less than long delay!"),this.isMobile=VI()||zI()}get(){return dN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(t,e){ar(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pN=new qa(3e4,6e4);function fr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function mr(t,e,n,r,s={}){return n_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=$a({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return UI()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&to(t.emulatorConfig.host)&&(d.credentials="include"),t_.fetch()(await r_(t,t.config.apiHost,n,c),d)})}async function n_(t,e,n){t._canInitEmulator=!1;const r={...fN,...e};try{const s=new yN(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Al(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Al(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Al(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Al(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw e_(t,m,d);vn(t,m)}}catch(s){if(s instanceof Fn)throw s;vn(t,"network-request-failed",{message:String(s)})}}async function Ha(t,e,n,r,s={}){const i=await mr(t,e,n,r,s);return"mfaPendingCredential"in i&&vn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function r_(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Im(t.config,s):`${t.config.apiScheme}://${s}`;return mN.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function gN(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class yN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(jn(this.auth,"network-request-failed")),pN.get())})}}function Al(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=jn(t,e,r);return s.customData._tokenResponse=n,s}function $y(t){return t!==void 0&&t.enterprise!==void 0}class vN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return gN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wN(t,e){return mr(t,"GET","/v2/recaptchaConfig",fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xN(t,e){return mr(t,"POST","/v1/accounts:delete",e)}async function Dc(t,e){return mr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _N(t,e=!1){const n=ze(t),r=await n.getIdToken(e),s=Sm(r);ae(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:sa(Ud(s.auth_time)),issuedAtTime:sa(Ud(s.iat)),expirationTime:sa(Ud(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ud(t){return Number(t)*1e3}function Sm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ql("JWT malformed, contained fewer than 3 sections"),null;try{const s=Ux(n);return s?JSON.parse(s):(Ql("Failed to decode base64 JWT payload"),null)}catch(s){return Ql("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function qy(t){const e=Sm(t);return ae(e,"internal-error"),ae(typeof e.exp<"u","internal-error"),ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Na(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Fn&&EN(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function EN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sa(this.lastLoginAt),this.creationTime=sa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lc(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Na(t,Dc(e,{idToken:n}));ae(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(f=s.providerUserInfo)!=null&&f.length?s_(s.providerUserInfo):[],o=IN(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Jh(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function TN(t){const e=ze(t);await Lc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IN(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function s_(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SN(t,e){const n=await n_(t,{},async()=>{const r=$a({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await r_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&to(t.emulatorConfig.host)&&(u.credentials="include"),t_.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function NN(t,e){return mr(t,"POST","/v2/accounts:revokeToken",fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ae(e.idToken,"internal-error"),ae(typeof e.idToken<"u","internal-error"),ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ae(e.length!==0,"internal-error");const n=qy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await SN(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ji;return r&&(ae(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ae(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ae(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ji,this.toJSON())}_performRefresh(){return Wn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t,e){ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new bN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Jh(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Na(this,this.stsTokenManager.getToken(this.auth,e));return ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return _N(this,e)}reload(){return TN(this)}_assign(e){this!==e&&(ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Lc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Jt(this.auth.app))return Promise.reject(Jn(this.auth));const e=await this.getIdToken();return await Na(this,xN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,m=n.lastLoginAt??void 0,{uid:f,emailVerified:g,isAnonymous:x,providerData:k,stsTokenManager:j}=n;ae(f&&j,e,"internal-error");const E=ji.fromJSON(this.name,j);ae(typeof f=="string",e,"internal-error"),Sr(r,e.name),Sr(s,e.name),ae(typeof g=="boolean",e,"internal-error"),ae(typeof x=="boolean",e,"internal-error"),Sr(i,e.name),Sr(o,e.name),Sr(c,e.name),Sr(u,e.name),Sr(d,e.name),Sr(m,e.name);const b=new fn({uid:f,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:E,createdAt:d,lastLoginAt:m});return k&&Array.isArray(k)&&(b.providerData=k.map(_=>({..._}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,n,r=!1){const s=new ji;s.updateFromServerResponse(n);const i=new fn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Lc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ae(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?s_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new ji;c.updateFromIdToken(r);const u=new fn({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Jh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=new Map;function Gn(t){ar(t instanceof Function,"Expected a class definition");let e=Hy.get(t);return e?(ar(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}i_.type="NONE";const Wy=i_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(t,e,n){return`firebase:${t}:${e}:${n}`}class Pi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Yl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Yl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Dc(this.auth,{idToken:e}).catch(()=>{});return n?fn._fromGetAccountInfoResponse(this.auth,n,e):null}return fn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Pi(Gn(Wy),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Gn(Wy);const o=Yl(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const m=await d._get(o);if(m){let f;if(typeof m=="string"){const g=await Dc(e,{idToken:m}).catch(()=>{});if(!g)break;f=await fn._fromGetAccountInfoResponse(e,g,m)}else f=fn._fromJSON(e,m);d!==i&&(c=f),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Pi(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Pi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(c_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(o_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(d_(e))return"Blackberry";if(h_(e))return"Webos";if(a_(e))return"Safari";if((e.includes("chrome/")||l_(e))&&!e.includes("edge/"))return"Chrome";if(u_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function o_(t=Tt()){return/firefox\//i.test(t)}function a_(t=Tt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function l_(t=Tt()){return/crios\//i.test(t)}function c_(t=Tt()){return/iemobile/i.test(t)}function u_(t=Tt()){return/android/i.test(t)}function d_(t=Tt()){return/blackberry/i.test(t)}function h_(t=Tt()){return/webos/i.test(t)}function Nm(t=Tt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function AN(t=Tt()){var e;return Nm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function kN(){return $I()&&document.documentMode===10}function f_(t=Tt()){return Nm(t)||u_(t)||h_(t)||d_(t)||/windows phone/i.test(t)||c_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(t,e=[]){let n;switch(t){case"Browser":n=Gy(Tt());break;case"Worker":n=`${Gy(Tt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ro}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jN(t,e={}){return mr(t,"GET","/v2/passwordPolicy",fr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=6;class RN{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??PN,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ky(this),this.idTokenSubscription=new Ky(this),this.beforeStateQueue=new CN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Zx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Gn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Pi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Dc(this,{idToken:e}),r=await fn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Jt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Lc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Jt(this.app))return Promise.reject(Jn(this));const n=e?ze(e):null;return n&&ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Jt(this.app)?Promise.reject(Jn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Jt(this.app)?Promise.reject(Jn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jN(this),n=new RN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Xs("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await NN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Gn(e)||this._popupRedirectResolver;ae(n,this,"argument-error"),this.redirectPersistenceManager=await Pi.create(this,[Gn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ae(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=m_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Jt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&cN(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function hs(t){return ze(t)}class Ky{constructor(e){this.auth=e,this.observer=null,this.addObserver=YI(n=>this.observer=n)}get next(){return ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function LN(t){xu=t}function p_(t){return xu.loadJS(t)}function MN(){return xu.recaptchaEnterpriseScript}function ON(){return xu.gapiScript}function VN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class FN{constructor(){this.enterprise=new UN}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class UN{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const BN="recaptcha-enterprise",g_="NO_RECAPTCHA";class zN{constructor(e){this.type=BN,this.auth=hs(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{wN(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new vN(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;$y(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(g_)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new FN().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(c=>{if(!n&&$y(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=MN();u.length!==0&&(u+=c),p_(u).then(()=>{s(c,i,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function Qy(t,e,n,r=!1,s=!1){const i=new zN(t);let o;if(s)o=g_;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Mc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Qy(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Qy(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $N(t,e){const n=no(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ts(i,e??{}))return s;vn(s,"already-initialized")}return n.initialize({options:e})}function qN(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Gn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function HN(t,e,n){const r=hs(t);ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=y_(e),{host:o,port:c}=WN(e),u=c===null?"":`:${c}`,d={url:`${i}//${o}${u}/`},m=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ae(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ae(ts(d,r.config.emulator)&&ts(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,to(o)?(qx(`${i}//${o}${u}`),Hx("Auth",!0)):GN()}function y_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function WN(t){const e=y_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Yy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Yy(o)}}}function Yy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Wn("not implemented")}_getIdTokenResponse(e){return Wn("not implemented")}_linkToIdToken(e,n){return Wn("not implemented")}_getReauthenticationResolver(e){return Wn("not implemented")}}async function KN(t,e){return mr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QN(t,e){return Ha(t,"POST","/v1/accounts:signInWithPassword",fr(t,e))}async function YN(t,e){return mr(t,"POST","/v1/accounts:sendOobCode",fr(t,e))}async function XN(t,e){return YN(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JN(t,e){return Ha(t,"POST","/v1/accounts:signInWithEmailLink",fr(t,e))}async function ZN(t,e){return Ha(t,"POST","/v1/accounts:signInWithEmailLink",fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends Am{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Aa(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Aa(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Mc(e,n,"signInWithPassword",QN);case"emailLink":return JN(e,{email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Mc(e,r,"signUpPassword",KN);case"emailLink":return ZN(e,{idToken:n,email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ri(t,e){return Ha(t,"POST","/v1/accounts:signInWithIdp",fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="http://localhost";class $s extends Am{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $s(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):vn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new $s(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ri(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ri(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ri(e,n)}buildRequest(){const e={requestUri:eA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=$a(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nA(t){const e=zo($o(t)).link,n=e?zo($o(e)).deep_link_id:null,r=zo($o(t)).deep_link_id;return(r?zo($o(r)).link:null)||r||n||e||t}class km{constructor(e){const n=zo($o(e)),r=n.apiKey??null,s=n.oobCode??null,i=tA(n.mode??null);ae(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=nA(e);try{return new km(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(){this.providerId=so.PROVIDER_ID}static credential(e,n){return Aa._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=km.parseLink(n);return ae(r,"argument-error"),Aa._fromEmailAndCode(e,r.code,r.tenantId)}}so.PROVIDER_ID="password";so.EMAIL_PASSWORD_SIGN_IN_METHOD="password";so.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa extends v_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Wa{constructor(){super("facebook.com")}static credential(e){return $s._fromParams({providerId:Rr.PROVIDER_ID,signInMethod:Rr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rr.credentialFromTaggedObject(e)}static credentialFromError(e){return Rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rr.credential(e.oauthAccessToken)}catch{return null}}}Rr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends Wa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $s._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Dr.credential(n,r)}catch{return null}}}Dr.GOOGLE_SIGN_IN_METHOD="google.com";Dr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr extends Wa{constructor(){super("github.com")}static credential(e){return $s._fromParams({providerId:Lr.PROVIDER_ID,signInMethod:Lr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lr.credentialFromTaggedObject(e)}static credentialFromError(e){return Lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lr.credential(e.oauthAccessToken)}catch{return null}}}Lr.GITHUB_SIGN_IN_METHOD="github.com";Lr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr extends Wa{constructor(){super("twitter.com")}static credential(e,n){return $s._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Mr.credential(n,r)}catch{return null}}}Mr.TWITTER_SIGN_IN_METHOD="twitter.com";Mr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rA(t,e){return Ha(t,"POST","/v1/accounts:signUp",fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await fn._fromIdTokenResponse(e,r,s),o=Xy(r);return new qs({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Xy(r);return new qs({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Xy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc extends Fn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Oc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Oc(e,n,r,s)}}function w_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Oc._fromErrorAndOperation(t,i,e,r):i})}async function sA(t,e,n=!1){const r=await Na(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return qs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iA(t,e,n=!1){const{auth:r}=t;if(Jt(r.app))return Promise.reject(Jn(r));const s="reauthenticate";try{const i=await Na(t,w_(r,s,e,t),n);ae(i.idToken,r,"internal-error");const o=Sm(i.idToken);ae(o,r,"internal-error");const{sub:c}=o;return ae(t.uid===c,r,"user-mismatch"),qs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&vn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x_(t,e,n=!1){if(Jt(t.app))return Promise.reject(Jn(t));const r="signIn",s=await w_(t,r,e),i=await qs._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function oA(t,e){return x_(hs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __(t){const e=hs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function E_(t,e,n){const r=hs(t);await Mc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",XN)}async function b_(t,e,n){if(Jt(t.app))return Promise.reject(Jn(t));const r=hs(t),o=await Mc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rA).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&__(t),u}),c=await qs._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function T_(t,e,n){return Jt(t.app)?Promise.reject(Jn(t)):oA(ze(t),so.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&__(t),r})}function aA(t,e,n,r){return ze(t).onIdTokenChanged(e,n,r)}function lA(t,e,n){return ze(t).beforeAuthStateChanged(e,n)}function I_(t,e,n,r){return ze(t).onAuthStateChanged(e,n,r)}function Di(t){return ze(t).signOut()}const Vc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Vc,"1"),this.storage.removeItem(Vc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=1e3,uA=10;class N_ extends S_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=f_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);kN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,uA):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},cA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}N_.type="LOCAL";const dA=N_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_ extends S_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}A_.type="SESSION";const k_=A_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new _u(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async d=>d(n.origin,i)),u=await hA(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_u.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const d=Cm("",20);s.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(m),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(){return window}function mA(t){Pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(){return typeof Pn().WorkerGlobalScope<"u"&&typeof Pn().importScripts=="function"}async function pA(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gA(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function yA(){return C_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_="firebaseLocalStorageDb",vA=1,Fc="firebaseLocalStorage",P_="fbase_key";class Ga{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Eu(t,e){return t.transaction([Fc],e?"readwrite":"readonly").objectStore(Fc)}function wA(){const t=indexedDB.deleteDatabase(j_);return new Ga(t).toPromise()}function Zh(){const t=indexedDB.open(j_,vA);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Fc,{keyPath:P_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Fc)?e(r):(r.close(),await wA(),e(await Zh()))})})}async function Jy(t,e,n){const r=Eu(t,!0).put({[P_]:e,value:n});return new Ga(r).toPromise()}async function xA(t,e){const n=Eu(t,!1).get(e),r=await new Ga(n).toPromise();return r===void 0?null:r.value}function Zy(t,e){const n=Eu(t,!0).delete(e);return new Ga(n).toPromise()}const _A=800,EA=3;class R_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Zh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>EA)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return C_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_u._getInstance(yA()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await pA(),!this.activeServiceWorker)return;this.sender=new fA(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Zh();return await Jy(e,Vc,"1"),await Zy(e,Vc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jy(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>xA(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Zy(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Eu(s,!1).getAll();return new Ga(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_A)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}R_.type="LOCAL";const bA=R_;new qa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(t,e){return e?Gn(e):(ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm extends Am{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ri(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ri(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ri(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function IA(t){return x_(t.auth,new jm(t),t.bypassAuthState)}function SA(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),iA(n,new jm(t),t.bypassAuthState)}async function NA(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),sA(n,new jm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return IA;case"linkViaPopup":case"linkViaRedirect":return NA;case"reauthViaPopup":case"reauthViaRedirect":return SA;default:vn(this.auth,"internal-error")}}resolve(e){ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=new qa(2e3,1e4);class Ti extends D_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ti.currentPopupAction&&Ti.currentPopupAction.cancel(),Ti.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ae(e,this.auth,"internal-error"),e}async onExecution(){ar(this.filter.length===1,"Popup operations only handle one event");const e=Cm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(jn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(jn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ti.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(jn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AA.get())};e()}}Ti.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA="pendingRedirect",Xl=new Map;class CA extends D_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Xl.get(this.auth._key());if(!e){try{const r=await jA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Xl.set(this.auth._key(),e)}return this.bypassAuthState||Xl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jA(t,e){const n=DA(e),r=RA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function PA(t,e){Xl.set(t._key(),e)}function RA(t){return Gn(t._redirectPersistence)}function DA(t){return Yl(kA,t.config.apiKey,t.name)}async function LA(t,e,n=!1){if(Jt(t.app))return Promise.reject(Jn(t));const r=hs(t),s=TA(r,e),o=await new CA(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA=10*60*1e3;class OA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!L_(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(jn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MA&&this.cachedEventUids.clear(),this.cachedEventUids.has(e0(e))}saveEventToCache(e){this.cachedEventUids.add(e0(e)),this.lastProcessedEventTime=Date.now()}}function e0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function L_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function VA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return L_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FA(t,e={}){return mr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BA=/^https?/;async function zA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await FA(t);for(const n of e)try{if($A(n))return}catch{}vn(t,"unauthorized-domain")}function $A(t){const e=Xh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!BA.test(n))return!1;if(UA.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA=new qa(3e4,6e4);function t0(){const t=Pn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function HA(t){return new Promise((e,n)=>{var s,i,o;function r(){t0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{t0(),n(jn(t,"network-request-failed"))},timeout:qA.get()})}if((i=(s=Pn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Pn().gapi)!=null&&o.load)r();else{const c=VN("iframefcb");return Pn()[c]=()=>{gapi.load?r():n(jn(t,"network-request-failed"))},p_(`${ON()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Jl=null,e})}let Jl=null;function WA(t){return Jl=Jl||HA(t),Jl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=new qa(5e3,15e3),KA="__/auth/iframe",QA="emulator/auth/iframe",YA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JA(t){const e=t.config;ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Im(e,QA):`https://${t.config.authDomain}/${KA}`,r={apiKey:e.apiKey,appName:t.name,v:ro},s=XA.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${$a(r).slice(1)}`}async function ZA(t){const e=await WA(t),n=Pn().gapi;return ae(n,t,"internal-error"),e.open({where:document.body,url:JA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=jn(t,"network-request-failed"),c=Pn().setTimeout(()=>{i(o)},GA.get());function u(){Pn().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tk=500,nk=600,rk="_blank",sk="http://localhost";class n0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ik(t,e,n,r=tk,s=nk){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...ek,width:r.toString(),height:s.toString(),top:i,left:o},d=Tt().toLowerCase();n&&(c=l_(d)?rk:n),o_(d)&&(e=e||sk,u.scrollbars="yes");const m=Object.entries(u).reduce((g,[x,k])=>`${g}${x}=${k},`,"");if(AN(d)&&c!=="_self")return ok(e||"",c),new n0(null);const f=window.open(e||"",c,m);ae(f,t,"popup-blocked");try{f.focus()}catch{}return new n0(f)}function ok(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak="__/auth/handler",lk="emulator/auth/handler",ck=encodeURIComponent("fac");async function r0(t,e,n,r,s,i){ae(t.config.authDomain,t,"auth-domain-config-required"),ae(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ro,eventId:s};if(e instanceof v_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",QI(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,f]of Object.entries({}))o[m]=f}if(e instanceof Wa){const m=e.getScopes().filter(f=>f!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const u=await t._getAppCheckToken(),d=u?`#${ck}=${encodeURIComponent(u)}`:"";return`${uk(t)}?${$a(c).slice(1)}${d}`}function uk({config:t}){return t.emulator?Im(t,lk):`https://${t.authDomain}/${ak}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd="webStorageSupport";class dk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=k_,this._completeRedirectFn=LA,this._overrideRedirectResult=PA}async _openPopup(e,n,r,s){var o;ar((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await r0(e,n,r,Xh(),s);return ik(e,i,Cm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await r0(e,n,r,Xh(),s);return mA(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ar(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await ZA(e),r=new OA(e);return n.register("authEvent",s=>(ae(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Bd,{type:Bd},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Bd];i!==void 0&&n(!!i),vn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=zA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return f_()||a_()||Nm()}}const hk=dk;var s0="@firebase/auth",i0="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mk(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pk(t){On(new yn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;ae(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:m_(t)},d=new DN(r,s,i,u);return qN(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),On(new yn("auth-internal",e=>{const n=hs(e.getProvider("auth").getImmediate());return(r=>new fk(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),nn(s0,i0,mk(t)),nn(s0,i0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=5*60,yk=$x("authIdTokenMaxAge")||gk;let o0=null;const vk=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>yk)return;const s=n==null?void 0:n.token;o0!==s&&(o0=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function M_(t=bm()){const e=no(t,"auth");if(e.isInitialized())return e.getImmediate();const n=$N(t,{popupRedirectResolver:hk,persistence:[bA,dA,k_]}),r=$x("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=vk(i.toString());lA(n,o,()=>o(n.currentUser)),aA(n,c=>o(c))}}const s=Bx("auth");return s&&HN(n,`http://${s}`),n}function wk(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}LN({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=jn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",wk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pk("Browser");var a0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qr,O_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,v){function T(){}T.prototype=v.prototype,y.F=v.prototype,y.prototype=new T,y.prototype.constructor=y,y.D=function(A,N,C){for(var I=Array(arguments.length-2),W=2;W<arguments.length;W++)I[W-2]=arguments[W];return v.prototype[N].apply(A,I)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(y,v,T){T||(T=0);const A=Array(16);if(typeof v=="string")for(var N=0;N<16;++N)A[N]=v.charCodeAt(T++)|v.charCodeAt(T++)<<8|v.charCodeAt(T++)<<16|v.charCodeAt(T++)<<24;else for(N=0;N<16;++N)A[N]=v[T++]|v[T++]<<8|v[T++]<<16|v[T++]<<24;v=y.g[0],T=y.g[1],N=y.g[2];let C=y.g[3],I;I=v+(C^T&(N^C))+A[0]+3614090360&4294967295,v=T+(I<<7&4294967295|I>>>25),I=C+(N^v&(T^N))+A[1]+3905402710&4294967295,C=v+(I<<12&4294967295|I>>>20),I=N+(T^C&(v^T))+A[2]+606105819&4294967295,N=C+(I<<17&4294967295|I>>>15),I=T+(v^N&(C^v))+A[3]+3250441966&4294967295,T=N+(I<<22&4294967295|I>>>10),I=v+(C^T&(N^C))+A[4]+4118548399&4294967295,v=T+(I<<7&4294967295|I>>>25),I=C+(N^v&(T^N))+A[5]+1200080426&4294967295,C=v+(I<<12&4294967295|I>>>20),I=N+(T^C&(v^T))+A[6]+2821735955&4294967295,N=C+(I<<17&4294967295|I>>>15),I=T+(v^N&(C^v))+A[7]+4249261313&4294967295,T=N+(I<<22&4294967295|I>>>10),I=v+(C^T&(N^C))+A[8]+1770035416&4294967295,v=T+(I<<7&4294967295|I>>>25),I=C+(N^v&(T^N))+A[9]+2336552879&4294967295,C=v+(I<<12&4294967295|I>>>20),I=N+(T^C&(v^T))+A[10]+4294925233&4294967295,N=C+(I<<17&4294967295|I>>>15),I=T+(v^N&(C^v))+A[11]+2304563134&4294967295,T=N+(I<<22&4294967295|I>>>10),I=v+(C^T&(N^C))+A[12]+1804603682&4294967295,v=T+(I<<7&4294967295|I>>>25),I=C+(N^v&(T^N))+A[13]+4254626195&4294967295,C=v+(I<<12&4294967295|I>>>20),I=N+(T^C&(v^T))+A[14]+2792965006&4294967295,N=C+(I<<17&4294967295|I>>>15),I=T+(v^N&(C^v))+A[15]+1236535329&4294967295,T=N+(I<<22&4294967295|I>>>10),I=v+(N^C&(T^N))+A[1]+4129170786&4294967295,v=T+(I<<5&4294967295|I>>>27),I=C+(T^N&(v^T))+A[6]+3225465664&4294967295,C=v+(I<<9&4294967295|I>>>23),I=N+(v^T&(C^v))+A[11]+643717713&4294967295,N=C+(I<<14&4294967295|I>>>18),I=T+(C^v&(N^C))+A[0]+3921069994&4294967295,T=N+(I<<20&4294967295|I>>>12),I=v+(N^C&(T^N))+A[5]+3593408605&4294967295,v=T+(I<<5&4294967295|I>>>27),I=C+(T^N&(v^T))+A[10]+38016083&4294967295,C=v+(I<<9&4294967295|I>>>23),I=N+(v^T&(C^v))+A[15]+3634488961&4294967295,N=C+(I<<14&4294967295|I>>>18),I=T+(C^v&(N^C))+A[4]+3889429448&4294967295,T=N+(I<<20&4294967295|I>>>12),I=v+(N^C&(T^N))+A[9]+568446438&4294967295,v=T+(I<<5&4294967295|I>>>27),I=C+(T^N&(v^T))+A[14]+3275163606&4294967295,C=v+(I<<9&4294967295|I>>>23),I=N+(v^T&(C^v))+A[3]+4107603335&4294967295,N=C+(I<<14&4294967295|I>>>18),I=T+(C^v&(N^C))+A[8]+1163531501&4294967295,T=N+(I<<20&4294967295|I>>>12),I=v+(N^C&(T^N))+A[13]+2850285829&4294967295,v=T+(I<<5&4294967295|I>>>27),I=C+(T^N&(v^T))+A[2]+4243563512&4294967295,C=v+(I<<9&4294967295|I>>>23),I=N+(v^T&(C^v))+A[7]+1735328473&4294967295,N=C+(I<<14&4294967295|I>>>18),I=T+(C^v&(N^C))+A[12]+2368359562&4294967295,T=N+(I<<20&4294967295|I>>>12),I=v+(T^N^C)+A[5]+4294588738&4294967295,v=T+(I<<4&4294967295|I>>>28),I=C+(v^T^N)+A[8]+2272392833&4294967295,C=v+(I<<11&4294967295|I>>>21),I=N+(C^v^T)+A[11]+1839030562&4294967295,N=C+(I<<16&4294967295|I>>>16),I=T+(N^C^v)+A[14]+4259657740&4294967295,T=N+(I<<23&4294967295|I>>>9),I=v+(T^N^C)+A[1]+2763975236&4294967295,v=T+(I<<4&4294967295|I>>>28),I=C+(v^T^N)+A[4]+1272893353&4294967295,C=v+(I<<11&4294967295|I>>>21),I=N+(C^v^T)+A[7]+4139469664&4294967295,N=C+(I<<16&4294967295|I>>>16),I=T+(N^C^v)+A[10]+3200236656&4294967295,T=N+(I<<23&4294967295|I>>>9),I=v+(T^N^C)+A[13]+681279174&4294967295,v=T+(I<<4&4294967295|I>>>28),I=C+(v^T^N)+A[0]+3936430074&4294967295,C=v+(I<<11&4294967295|I>>>21),I=N+(C^v^T)+A[3]+3572445317&4294967295,N=C+(I<<16&4294967295|I>>>16),I=T+(N^C^v)+A[6]+76029189&4294967295,T=N+(I<<23&4294967295|I>>>9),I=v+(T^N^C)+A[9]+3654602809&4294967295,v=T+(I<<4&4294967295|I>>>28),I=C+(v^T^N)+A[12]+3873151461&4294967295,C=v+(I<<11&4294967295|I>>>21),I=N+(C^v^T)+A[15]+530742520&4294967295,N=C+(I<<16&4294967295|I>>>16),I=T+(N^C^v)+A[2]+3299628645&4294967295,T=N+(I<<23&4294967295|I>>>9),I=v+(N^(T|~C))+A[0]+4096336452&4294967295,v=T+(I<<6&4294967295|I>>>26),I=C+(T^(v|~N))+A[7]+1126891415&4294967295,C=v+(I<<10&4294967295|I>>>22),I=N+(v^(C|~T))+A[14]+2878612391&4294967295,N=C+(I<<15&4294967295|I>>>17),I=T+(C^(N|~v))+A[5]+4237533241&4294967295,T=N+(I<<21&4294967295|I>>>11),I=v+(N^(T|~C))+A[12]+1700485571&4294967295,v=T+(I<<6&4294967295|I>>>26),I=C+(T^(v|~N))+A[3]+2399980690&4294967295,C=v+(I<<10&4294967295|I>>>22),I=N+(v^(C|~T))+A[10]+4293915773&4294967295,N=C+(I<<15&4294967295|I>>>17),I=T+(C^(N|~v))+A[1]+2240044497&4294967295,T=N+(I<<21&4294967295|I>>>11),I=v+(N^(T|~C))+A[8]+1873313359&4294967295,v=T+(I<<6&4294967295|I>>>26),I=C+(T^(v|~N))+A[15]+4264355552&4294967295,C=v+(I<<10&4294967295|I>>>22),I=N+(v^(C|~T))+A[6]+2734768916&4294967295,N=C+(I<<15&4294967295|I>>>17),I=T+(C^(N|~v))+A[13]+1309151649&4294967295,T=N+(I<<21&4294967295|I>>>11),I=v+(N^(T|~C))+A[4]+4149444226&4294967295,v=T+(I<<6&4294967295|I>>>26),I=C+(T^(v|~N))+A[11]+3174756917&4294967295,C=v+(I<<10&4294967295|I>>>22),I=N+(v^(C|~T))+A[2]+718787259&4294967295,N=C+(I<<15&4294967295|I>>>17),I=T+(C^(N|~v))+A[9]+3951481745&4294967295,y.g[0]=y.g[0]+v&4294967295,y.g[1]=y.g[1]+(N+(I<<21&4294967295|I>>>11))&4294967295,y.g[2]=y.g[2]+N&4294967295,y.g[3]=y.g[3]+C&4294967295}r.prototype.v=function(y,v){v===void 0&&(v=y.length);const T=v-this.blockSize,A=this.C;let N=this.h,C=0;for(;C<v;){if(N==0)for(;C<=T;)s(this,y,C),C+=this.blockSize;if(typeof y=="string"){for(;C<v;)if(A[N++]=y.charCodeAt(C++),N==this.blockSize){s(this,A),N=0;break}}else for(;C<v;)if(A[N++]=y[C++],N==this.blockSize){s(this,A),N=0;break}}this.h=N,this.o+=v},r.prototype.A=function(){var y=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);y[0]=128;for(var v=1;v<y.length-8;++v)y[v]=0;v=this.o*8;for(var T=y.length-8;T<y.length;++T)y[T]=v&255,v/=256;for(this.v(y),y=Array(16),v=0,T=0;T<4;++T)for(let A=0;A<32;A+=8)y[v++]=this.g[T]>>>A&255;return y};function i(y,v){var T=c;return Object.prototype.hasOwnProperty.call(T,y)?T[y]:T[y]=v(y)}function o(y,v){this.h=v;const T=[];let A=!0;for(let N=y.length-1;N>=0;N--){const C=y[N]|0;A&&C==v||(T[N]=C,A=!1)}this.g=T}var c={};function u(y){return-128<=y&&y<128?i(y,function(v){return new o([v|0],v<0?-1:0)}):new o([y|0],y<0?-1:0)}function d(y){if(isNaN(y)||!isFinite(y))return f;if(y<0)return E(d(-y));const v=[];let T=1;for(let A=0;y>=T;A++)v[A]=y/T|0,T*=4294967296;return new o(v,0)}function m(y,v){if(y.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(y.charAt(0)=="-")return E(m(y.substring(1),v));if(y.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=d(Math.pow(v,8));let A=f;for(let C=0;C<y.length;C+=8){var N=Math.min(8,y.length-C);const I=parseInt(y.substring(C,C+N),v);N<8?(N=d(Math.pow(v,N)),A=A.j(N).add(d(I))):(A=A.j(T),A=A.add(d(I)))}return A}var f=u(0),g=u(1),x=u(16777216);t=o.prototype,t.m=function(){if(j(this))return-E(this).m();let y=0,v=1;for(let T=0;T<this.g.length;T++){const A=this.i(T);y+=(A>=0?A:4294967296+A)*v,v*=4294967296}return y},t.toString=function(y){if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(k(this))return"0";if(j(this))return"-"+E(this).toString(y);const v=d(Math.pow(y,6));var T=this;let A="";for(;;){const N=R(T,v).g;T=b(T,N.j(v));let C=((T.g.length>0?T.g[0]:T.h)>>>0).toString(y);if(T=N,k(T))return C+A;for(;C.length<6;)C="0"+C;A=C+A}},t.i=function(y){return y<0?0:y<this.g.length?this.g[y]:this.h};function k(y){if(y.h!=0)return!1;for(let v=0;v<y.g.length;v++)if(y.g[v]!=0)return!1;return!0}function j(y){return y.h==-1}t.l=function(y){return y=b(this,y),j(y)?-1:k(y)?0:1};function E(y){const v=y.g.length,T=[];for(let A=0;A<v;A++)T[A]=~y.g[A];return new o(T,~y.h).add(g)}t.abs=function(){return j(this)?E(this):this},t.add=function(y){const v=Math.max(this.g.length,y.g.length),T=[];let A=0;for(let N=0;N<=v;N++){let C=A+(this.i(N)&65535)+(y.i(N)&65535),I=(C>>>16)+(this.i(N)>>>16)+(y.i(N)>>>16);A=I>>>16,C&=65535,I&=65535,T[N]=I<<16|C}return new o(T,T[T.length-1]&-2147483648?-1:0)};function b(y,v){return y.add(E(v))}t.j=function(y){if(k(this)||k(y))return f;if(j(this))return j(y)?E(this).j(E(y)):E(E(this).j(y));if(j(y))return E(this.j(E(y)));if(this.l(x)<0&&y.l(x)<0)return d(this.m()*y.m());const v=this.g.length+y.g.length,T=[];for(var A=0;A<2*v;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(let N=0;N<y.g.length;N++){const C=this.i(A)>>>16,I=this.i(A)&65535,W=y.i(N)>>>16,fe=y.i(N)&65535;T[2*A+2*N]+=I*fe,_(T,2*A+2*N),T[2*A+2*N+1]+=C*fe,_(T,2*A+2*N+1),T[2*A+2*N+1]+=I*W,_(T,2*A+2*N+1),T[2*A+2*N+2]+=C*W,_(T,2*A+2*N+2)}for(y=0;y<v;y++)T[y]=T[2*y+1]<<16|T[2*y];for(y=v;y<2*v;y++)T[y]=0;return new o(T,0)};function _(y,v){for(;(y[v]&65535)!=y[v];)y[v+1]+=y[v]>>>16,y[v]&=65535,v++}function S(y,v){this.g=y,this.h=v}function R(y,v){if(k(v))throw Error("division by zero");if(k(y))return new S(f,f);if(j(y))return v=R(E(y),v),new S(E(v.g),E(v.h));if(j(v))return v=R(y,E(v)),new S(E(v.g),v.h);if(y.g.length>30){if(j(y)||j(v))throw Error("slowDivide_ only works with positive integers.");for(var T=g,A=v;A.l(y)<=0;)T=F(T),A=F(A);var N=B(T,1),C=B(A,1);for(A=B(A,2),T=B(T,2);!k(A);){var I=C.add(A);I.l(y)<=0&&(N=N.add(T),C=I),A=B(A,1),T=B(T,1)}return v=b(y,N.j(v)),new S(N,v)}for(N=f;y.l(v)>=0;){for(T=Math.max(1,Math.floor(y.m()/v.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),C=d(T),I=C.j(v);j(I)||I.l(y)>0;)T-=A,C=d(T),I=C.j(v);k(C)&&(C=g),N=N.add(C),y=b(y,I)}return new S(N,y)}t.B=function(y){return R(this,y).h},t.and=function(y){const v=Math.max(this.g.length,y.g.length),T=[];for(let A=0;A<v;A++)T[A]=this.i(A)&y.i(A);return new o(T,this.h&y.h)},t.or=function(y){const v=Math.max(this.g.length,y.g.length),T=[];for(let A=0;A<v;A++)T[A]=this.i(A)|y.i(A);return new o(T,this.h|y.h)},t.xor=function(y){const v=Math.max(this.g.length,y.g.length),T=[];for(let A=0;A<v;A++)T[A]=this.i(A)^y.i(A);return new o(T,this.h^y.h)};function F(y){const v=y.g.length+1,T=[];for(let A=0;A<v;A++)T[A]=y.i(A)<<1|y.i(A-1)>>>31;return new o(T,y.h)}function B(y,v){const T=v>>5;v%=32;const A=y.g.length-T,N=[];for(let C=0;C<A;C++)N[C]=v>0?y.i(C+T)>>>v|y.i(C+T+1)<<32-v:y.i(C+T);return new o(N,y.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,O_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=m,Qr=o}).apply(typeof a0<"u"?a0:typeof self<"u"?self:typeof window<"u"?window:{});var kl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V_,qo,F_,Zl,ef,U_,B_,z_;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof kl=="object"&&kl];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var p=r;l=l.split(".");for(var w=0;w<l.length-1;w++){var L=l[w];if(!(L in p))break e;p=p[L]}l=l[l.length-1],w=p[l],h=h(w),h!=w&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(h){var p=[],w;for(w in h)Object.prototype.hasOwnProperty.call(h,w)&&p.push([w,h[w]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function u(l,h,p){return l.call.apply(l.bind,arguments)}function d(l,h,p){return d=u,d.apply(null,arguments)}function m(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var w=p.slice();return w.push.apply(w,arguments),l.apply(this,w)}}function f(l,h){function p(){}p.prototype=h.prototype,l.Z=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(w,L,M){for(var Y=Array(arguments.length-2),he=2;he<arguments.length;he++)Y[he-2]=arguments[he];return h.prototype[L].apply(w,Y)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function x(l){const h=l.length;if(h>0){const p=Array(h);for(let w=0;w<h;w++)p[w]=l[w];return p}return[]}function k(l,h){for(let w=1;w<arguments.length;w++){const L=arguments[w];var p=typeof L;if(p=p!="object"?p:L?Array.isArray(L)?"array":p:"null",p=="array"||p=="object"&&typeof L.length=="number"){p=l.length||0;const M=L.length||0;l.length=p+M;for(let Y=0;Y<M;Y++)l[p+Y]=L[Y]}else l.push(L)}}class j{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function E(l){o.setTimeout(()=>{throw l},0)}function b(){var l=y;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class _{constructor(){this.h=this.g=null}add(h,p){const w=S.get();w.set(h,p),this.h?this.h.next=w:this.g=w,this.h=w}}var S=new j(()=>new R,l=>l.reset());class R{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let F,B=!1,y=new _,v=()=>{const l=Promise.resolve(void 0);F=()=>{l.then(T)}};function T(){for(var l;l=b();){try{l.h.call(l.g)}catch(p){E(p)}var h=S;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}B=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var C=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,h),o.removeEventListener("test",p,h)}catch{}return l}();function I(l){return/^[\s\xa0]*$/.test(l)}function W(l,h){N.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}f(W,N),W.prototype.init=function(l,h){const p=this.type=l.type,w=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&W.Z.h.call(this)},W.prototype.h=function(){W.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var fe="closure_listenable_"+(Math.random()*1e6|0),Z=0;function te(l,h,p,w,L){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!w,this.ha=L,this.key=++Z,this.da=this.fa=!1}function q(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function se(l,h,p){for(const w in l)h.call(p,l[w],w,l)}function ce(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function Ee(l){const h={};for(const p in l)h[p]=l[p];return h}const Se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function an(l,h){let p,w;for(let L=1;L<arguments.length;L++){w=arguments[L];for(p in w)l[p]=w[p];for(let M=0;M<Se.length;M++)p=Se[M],Object.prototype.hasOwnProperty.call(w,p)&&(l[p]=w[p])}}function ft(l){this.src=l,this.g={},this.h=0}ft.prototype.add=function(l,h,p,w,L){const M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);const Y=It(l,h,w,L);return Y>-1?(h=l[Y],p||(h.fa=!1)):(h=new te(h,this.src,M,!!w,L),h.fa=p,l.push(h)),h};function ln(l,h){const p=h.type;if(p in l.g){var w=l.g[p],L=Array.prototype.indexOf.call(w,h,void 0),M;(M=L>=0)&&Array.prototype.splice.call(w,L,1),M&&(q(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function It(l,h,p,w){for(let L=0;L<l.length;++L){const M=l[L];if(!M.da&&M.listener==h&&M.capture==!!p&&M.ha==w)return L}return-1}var Qt="closure_lm_"+(Math.random()*1e6|0),ps={};function ti(l,h,p,w,L){if(Array.isArray(h)){for(let M=0;M<h.length;M++)ti(l,h[M],p,w,L);return null}return p=ri(p),l&&l[fe]?l.J(h,p,c(w)?!!w.capture:!1,L):ho(l,h,p,!1,w,L)}function ho(l,h,p,w,L,M){if(!h)throw Error("Invalid event type");const Y=c(L)?!!L.capture:!!L;let he=ys(l);if(he||(l[Qt]=he=new ft(l)),p=he.add(h,p,w,Y,M),p.proxy)return p;if(w=fo(),p.proxy=w,w.src=l,w.listener=p,l.addEventListener)C||(L=Y),L===void 0&&(L=!1),l.addEventListener(h.toString(),w,L);else if(l.attachEvent)l.attachEvent(pr(h.toString()),w);else if(l.addListener&&l.removeListener)l.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return p}function fo(){function l(p){return h.call(l.src,l.listener,p)}const h=mo;return l}function ni(l,h,p,w,L){if(Array.isArray(h))for(var M=0;M<h.length;M++)ni(l,h[M],p,w,L);else w=c(w)?!!w.capture:!!w,p=ri(p),l&&l[fe]?(l=l.i,M=String(h).toString(),M in l.g&&(h=l.g[M],p=It(h,p,w,L),p>-1&&(q(h[p]),Array.prototype.splice.call(h,p,1),h.length==0&&(delete l.g[M],l.h--)))):l&&(l=ys(l))&&(h=l.g[h.toString()],l=-1,h&&(l=It(h,p,w,L)),(p=l>-1?h[l]:null)&&gs(p))}function gs(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[fe])ln(h.i,l);else{var p=l.type,w=l.proxy;h.removeEventListener?h.removeEventListener(p,w,l.capture):h.detachEvent?h.detachEvent(pr(p),w):h.addListener&&h.removeListener&&h.removeListener(w),(p=ys(h))?(ln(p,l),p.h==0&&(p.src=null,h[Qt]=null)):q(l)}}}function pr(l){return l in ps?ps[l]:ps[l]="on"+l}function mo(l,h){if(l.da)l=!0;else{h=new W(h,this);const p=l.listener,w=l.ha||l.src;l.fa&&gs(l),l=p.call(w,h)}return l}function ys(l){return l=l[Qt],l instanceof ft?l:null}var vs="__closure_events_fn_"+(Math.random()*1e9>>>0);function ri(l){return typeof l=="function"?l:(l[vs]||(l[vs]=function(h){return l.handleEvent(h)}),l[vs])}function He(){A.call(this),this.i=new ft(this),this.M=this,this.G=null}f(He,A),He.prototype[fe]=!0,He.prototype.removeEventListener=function(l,h,p,w){ni(this,l,h,p,w)};function Xe(l,h){var p,w=l.G;if(w)for(p=[];w;w=w.G)p.push(w);if(l=l.M,w=h.type||h,typeof h=="string")h=new N(h,l);else if(h instanceof N)h.target=h.target||l;else{var L=h;h=new N(w,l),an(h,L)}L=!0;let M,Y;if(p)for(Y=p.length-1;Y>=0;Y--)M=h.g=p[Y],L=gr(M,w,!0,h)&&L;if(M=h.g=l,L=gr(M,w,!0,h)&&L,L=gr(M,w,!1,h)&&L,p)for(Y=0;Y<p.length;Y++)M=h.g=p[Y],L=gr(M,w,!1,h)&&L}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var l=this.i;for(const h in l.g){const p=l.g[h];for(let w=0;w<p.length;w++)q(p[w]);delete l.g[h],l.h--}}this.G=null},He.prototype.J=function(l,h,p,w){return this.i.add(String(l),h,!1,p,w)},He.prototype.K=function(l,h,p,w){return this.i.add(String(l),h,!0,p,w)};function gr(l,h,p,w){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let L=!0;for(let M=0;M<h.length;++M){const Y=h[M];if(Y&&!Y.da&&Y.capture==p){const he=Y.listener,Je=Y.ha||Y.src;Y.fa&&ln(l.i,Y),L=he.call(Je,w)!==!1&&L}}return L&&!w.defaultPrevented}function D(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(l,h||0)}function z(l){l.g=D(()=>{l.g=null,l.i&&(l.i=!1,z(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class O extends A{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:z(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function V(l){A.call(this),this.h=l,this.g={}}f(V,A);var G=[];function K(l){se(l.g,function(h,p){this.g.hasOwnProperty(p)&&gs(h)},l),l.g={}}V.prototype.N=function(){V.Z.N.call(this),K(this)},V.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var U=o.JSON.stringify,X=o.JSON.parse,re=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function oe(){}function mt(){}var po={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Wu(){N.call(this,"d")}f(Wu,N);function Gu(){N.call(this,"c")}f(Gu,N);var ws={},Cp=null;function el(){return Cp=Cp||new He}ws.Ia="serverreachability";function jp(l){N.call(this,ws.Ia,l)}f(jp,N);function go(l){const h=el();Xe(h,new jp(h))}ws.STAT_EVENT="statevent";function Pp(l,h){N.call(this,ws.STAT_EVENT,l),this.stat=h}f(Pp,N);function St(l){const h=el();Xe(h,new Pp(h,l))}ws.Ja="timingevent";function Rp(l,h){N.call(this,ws.Ja,l),this.size=h}f(Rp,N);function yo(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},h)}function vo(){this.g=!0}vo.prototype.ua=function(){this.g=!1};function Q2(l,h,p,w,L,M){l.info(function(){if(l.g)if(M){var Y="",he=M.split("&");for(let be=0;be<he.length;be++){var Je=he[be].split("=");if(Je.length>1){const nt=Je[0];Je=Je[1];const _n=nt.split("_");Y=_n.length>=2&&_n[1]=="type"?Y+(nt+"="+Je+"&"):Y+(nt+"=redacted&")}}}else Y=null;else Y=M;return"XMLHTTP REQ ("+w+") [attempt "+L+"]: "+h+`
`+p+`
`+Y})}function Y2(l,h,p,w,L,M,Y){l.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+L+"]: "+h+`
`+p+`
`+M+" "+Y})}function si(l,h,p,w){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+J2(l,p)+(w?" "+w:"")})}function X2(l,h){l.info(function(){return"TIMEOUT: "+h})}vo.prototype.info=function(){};function J2(l,h){if(!l.g)return h;if(!h)return null;try{const M=JSON.parse(h);if(M){for(l=0;l<M.length;l++)if(Array.isArray(M[l])){var p=M[l];if(!(p.length<2)){var w=p[1];if(Array.isArray(w)&&!(w.length<1)){var L=w[0];if(L!="noop"&&L!="stop"&&L!="close")for(let Y=1;Y<w.length;Y++)w[Y]=""}}}}return U(M)}catch{return h}}var tl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Dp={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Lp;function Ku(){}f(Ku,oe),Ku.prototype.g=function(){return new XMLHttpRequest},Lp=new Ku;function wo(l){return encodeURIComponent(String(l))}function Z2(l){var h=1;l=l.split(":");const p=[];for(;h>0&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function yr(l,h,p,w){this.j=l,this.i=h,this.l=p,this.S=w||1,this.V=new V(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Mp}function Mp(){this.i=null,this.g="",this.h=!1}var Op={},Qu={};function Yu(l,h,p){l.M=1,l.A=rl(xn(h)),l.u=p,l.R=!0,Vp(l,null)}function Vp(l,h){l.F=Date.now(),nl(l),l.B=xn(l.A);var p=l.B,w=l.S;Array.isArray(w)||(w=[String(w)]),Xp(p.i,"t",w),l.C=0,p=l.j.L,l.h=new Mp,l.g=pg(l.j,p?h:null,!l.u),l.P>0&&(l.O=new O(d(l.Y,l,l.g),l.P)),h=l.V,p=l.g,w=l.ba;var L="readystatechange";Array.isArray(L)||(L&&(G[0]=L.toString()),L=G);for(let M=0;M<L.length;M++){const Y=ti(p,L[M],w||h.handleEvent,!1,h.h||h);if(!Y)break;h.g[Y.key]=Y}h=l.J?Ee(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),go(),Q2(l.i,l.v,l.B,l.l,l.S,l.u)}yr.prototype.ba=function(l){l=l.target;const h=this.O;h&&xr(l)==3?h.j():this.Y(l)},yr.prototype.Y=function(l){try{if(l==this.g)e:{const he=xr(this.g),Je=this.g.ya(),be=this.g.ca();if(!(he<3)&&(he!=3||this.g&&(this.h.h||this.g.la()||sg(this.g)))){this.K||he!=4||Je==7||(Je==8||be<=0?go(3):go(2)),Xu(this);var h=this.g.ca();this.X=h;var p=eE(this);if(this.o=h==200,Y2(this.i,this.v,this.B,this.l,this.S,he,h),this.o){if(this.U&&!this.L){t:{if(this.g){var w,L=this.g;if((w=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(w)){var M=w;break t}}M=null}if(l=M)si(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ju(this,l);else{this.o=!1,this.m=3,St(12),xs(this),xo(this);break e}}if(this.R){l=!0;let nt;for(;!this.K&&this.C<p.length;)if(nt=tE(this,p),nt==Qu){he==4&&(this.m=4,St(14),l=!1),si(this.i,this.l,null,"[Incomplete Response]");break}else if(nt==Op){this.m=4,St(15),si(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else si(this.i,this.l,nt,null),Ju(this,nt);if(Fp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),he!=4||p.length!=0||this.h.h||(this.m=1,St(16),l=!1),this.o=this.o&&l,!l)si(this.i,this.l,p,"[Invalid Chunked Response]"),xs(this),xo(this);else if(p.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),od(Y),Y.P=!0,St(11))}}else si(this.i,this.l,p,null),Ju(this,p);he==4&&xs(this),this.o&&!this.K&&(he==4?dg(this.j,this):(this.o=!1,nl(this)))}else pE(this.g),h==400&&p.indexOf("Unknown SID")>0?(this.m=3,St(12)):(this.m=0,St(13)),xs(this),xo(this)}}}catch{}finally{}};function eE(l){if(!Fp(l))return l.g.la();const h=sg(l.g);if(h==="")return"";let p="";const w=h.length,L=xr(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return xs(l),xo(l),"";l.h.i=new o.TextDecoder}for(let M=0;M<w;M++)l.h.h=!0,p+=l.h.i.decode(h[M],{stream:!(L&&M==w-1)});return h.length=0,l.h.g+=p,l.C=0,l.h.g}function Fp(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function tE(l,h){var p=l.C,w=h.indexOf(`
`,p);return w==-1?Qu:(p=Number(h.substring(p,w)),isNaN(p)?Op:(w+=1,w+p>h.length?Qu:(h=h.slice(w,w+p),l.C=w+p,h)))}yr.prototype.cancel=function(){this.K=!0,xs(this)};function nl(l){l.T=Date.now()+l.H,Up(l,l.H)}function Up(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=yo(d(l.aa,l),h)}function Xu(l){l.D&&(o.clearTimeout(l.D),l.D=null)}yr.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(X2(this.i,this.B),this.M!=2&&(go(),St(17)),xs(this),this.m=2,xo(this)):Up(this,this.T-l)};function xo(l){l.j.I==0||l.K||dg(l.j,l)}function xs(l){Xu(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,K(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function Ju(l,h){try{var p=l.j;if(p.I!=0&&(p.g==l||Zu(p.h,l))){if(!l.L&&Zu(p.h,l)&&p.I==3){try{var w=p.Ba.g.parse(h)}catch{w=null}if(Array.isArray(w)&&w.length==3){var L=w;if(L[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)ll(p),ol(p);else break e;id(p),St(18)}}else p.xa=L[1],0<p.xa-p.K&&L[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=yo(d(p.Va,p),6e3));$p(p.h)<=1&&p.ta&&(p.ta=void 0)}else Es(p,11)}else if((l.L||p.g==l)&&ll(p),!I(h))for(L=p.Ba.g.parse(h),h=0;h<L.length;h++){let be=L[h];const nt=be[0];if(!(nt<=p.K))if(p.K=nt,be=be[1],p.I==2)if(be[0]=="c"){p.M=be[1],p.ba=be[2];const _n=be[3];_n!=null&&(p.ka=_n,p.j.info("VER="+p.ka));const bs=be[4];bs!=null&&(p.za=bs,p.j.info("SVER="+p.za));const _r=be[5];_r!=null&&typeof _r=="number"&&_r>0&&(w=1.5*_r,p.O=w,p.j.info("backChannelRequestTimeoutMs_="+w)),w=p;const Er=l.g;if(Er){const ul=Er.g?Er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ul){var M=w.h;M.g||ul.indexOf("spdy")==-1&&ul.indexOf("quic")==-1&&ul.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(ed(M,M.h),M.h=null))}if(w.G){const ad=Er.g?Er.g.getResponseHeader("X-HTTP-Session-Id"):null;ad&&(w.wa=ad,Ne(w.J,w.G,ad))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),w=p;var Y=l;if(w.na=mg(w,w.L?w.ba:null,w.W),Y.L){qp(w.h,Y);var he=Y,Je=w.O;Je&&(he.H=Je),he.D&&(Xu(he),nl(he)),w.g=Y}else cg(w);p.i.length>0&&al(p)}else be[0]!="stop"&&be[0]!="close"||Es(p,7);else p.I==3&&(be[0]=="stop"||be[0]=="close"?be[0]=="stop"?Es(p,7):sd(p):be[0]!="noop"&&p.l&&p.l.qa(be),p.A=0)}}go(4)}catch{}}var nE=class{constructor(l,h){this.g=l,this.map=h}};function Bp(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zp(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function $p(l){return l.h?1:l.g?l.g.size:0}function Zu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function ed(l,h){l.g?l.g.add(h):l.h=h}function qp(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Bp.prototype.cancel=function(){if(this.i=Hp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Hp(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.G);return h}return x(l.i)}var Wp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rE(l,h){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const w=l[p].indexOf("=");let L,M=null;w>=0?(L=l[p].substring(0,w),M=l[p].substring(w+1)):L=l[p],h(L,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function vr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof vr?(this.l=l.l,_o(this,l.j),this.o=l.o,this.g=l.g,Eo(this,l.u),this.h=l.h,td(this,Jp(l.i)),this.m=l.m):l&&(h=String(l).match(Wp))?(this.l=!1,_o(this,h[1]||"",!0),this.o=bo(h[2]||""),this.g=bo(h[3]||"",!0),Eo(this,h[4]),this.h=bo(h[5]||"",!0),td(this,h[6]||"",!0),this.m=bo(h[7]||"")):(this.l=!1,this.i=new Io(null,this.l))}vr.prototype.toString=function(){const l=[];var h=this.j;h&&l.push(To(h,Gp,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(To(h,Gp,!0),"@"),l.push(wo(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(To(p,p.charAt(0)=="/"?oE:iE,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",To(p,lE)),l.join("")},vr.prototype.resolve=function(l){const h=xn(this);let p=!!l.j;p?_o(h,l.j):p=!!l.o,p?h.o=l.o:p=!!l.g,p?h.g=l.g:p=l.u!=null;var w=l.h;if(p)Eo(h,l.u);else if(p=!!l.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var L=h.h.lastIndexOf("/");L!=-1&&(w=h.h.slice(0,L+1)+w)}if(L=w,L==".."||L==".")w="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){w=L.lastIndexOf("/",0)==0,L=L.split("/");const M=[];for(let Y=0;Y<L.length;){const he=L[Y++];he=="."?w&&Y==L.length&&M.push(""):he==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),w&&Y==L.length&&M.push("")):(M.push(he),w=!0)}w=M.join("/")}else w=L}return p?h.h=w:p=l.i.toString()!=="",p?td(h,Jp(l.i)):p=!!l.m,p&&(h.m=l.m),h};function xn(l){return new vr(l)}function _o(l,h,p){l.j=p?bo(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Eo(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function td(l,h,p){h instanceof Io?(l.i=h,cE(l.i,l.l)):(p||(h=To(h,aE)),l.i=new Io(h,l.l))}function Ne(l,h,p){l.i.set(h,p)}function rl(l){return Ne(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function bo(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function To(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,sE),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function sE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Gp=/[#\/\?@]/g,iE=/[#\?:]/g,oE=/[#\?]/g,aE=/[#\?@]/g,lE=/#/g;function Io(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function _s(l){l.g||(l.g=new Map,l.h=0,l.i&&rE(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=Io.prototype,t.add=function(l,h){_s(this),this.i=null,l=ii(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Kp(l,h){_s(l),h=ii(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Qp(l,h){return _s(l),h=ii(l,h),l.g.has(h)}t.forEach=function(l,h){_s(this),this.g.forEach(function(p,w){p.forEach(function(L){l.call(h,L,w,this)},this)},this)};function Yp(l,h){_s(l);let p=[];if(typeof h=="string")Qp(l,h)&&(p=p.concat(l.g.get(ii(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)p=p.concat(l[h]);return p}t.set=function(l,h){return _s(this),this.i=null,l=ii(this,l),Qp(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=Yp(this,l),l.length>0?String(l[0]):h):h};function Xp(l,h,p){Kp(l,h),p.length>0&&(l.i=null,l.g.set(ii(l,h),x(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(let w=0;w<h.length;w++){var p=h[w];const L=wo(p);p=Yp(this,p);for(let M=0;M<p.length;M++){let Y=L;p[M]!==""&&(Y+="="+wo(p[M])),l.push(Y)}}return this.i=l.join("&")};function Jp(l){const h=new Io;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function ii(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function cE(l,h){h&&!l.j&&(_s(l),l.i=null,l.g.forEach(function(p,w){const L=w.toLowerCase();w!=L&&(Kp(this,w),Xp(this,L,p))},l)),l.j=h}function uE(l,h){const p=new vo;if(o.Image){const w=new Image;w.onload=m(wr,p,"TestLoadImage: loaded",!0,h,w),w.onerror=m(wr,p,"TestLoadImage: error",!1,h,w),w.onabort=m(wr,p,"TestLoadImage: abort",!1,h,w),w.ontimeout=m(wr,p,"TestLoadImage: timeout",!1,h,w),o.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=l}else h(!1)}function dE(l,h){const p=new vo,w=new AbortController,L=setTimeout(()=>{w.abort(),wr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:w.signal}).then(M=>{clearTimeout(L),M.ok?wr(p,"TestPingServer: ok",!0,h):wr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(L),wr(p,"TestPingServer: error",!1,h)})}function wr(l,h,p,w,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),w(p)}catch{}}function hE(){this.g=new re}function nd(l){this.i=l.Sb||null,this.h=l.ab||!1}f(nd,oe),nd.prototype.g=function(){return new sl(this.i,this.h)};function sl(l,h){He.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(sl,He),t=sl.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,No(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,So(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,No(this)),this.g&&(this.readyState=3,No(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Zp(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Zp(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?So(this):No(this),this.readyState==3&&Zp(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,So(this))},t.Na=function(l){this.g&&(this.response=l,So(this))},t.ga=function(){this.g&&So(this)};function So(l){l.readyState=4,l.l=null,l.j=null,l.B=null,No(l)}t.setRequestHeader=function(l,h){this.A.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function No(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(sl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function eg(l){let h="";return se(l,function(p,w){h+=w,h+=":",h+=p,h+=`\r
`}),h}function rd(l,h,p){e:{for(w in p){var w=!1;break e}w=!0}w||(p=eg(p),typeof l=="string"?p!=null&&wo(p):Ne(l,h,p))}function Oe(l){He.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Oe,He);var fE=/^https?$/i,mE=["POST","PUT"];t=Oe.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,h,p,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Lp.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(M){tg(this,M);return}if(l=p||"",p=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var L in w)p.set(L,w[L]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const M of w.keys())p.set(M,w.get(M));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),L=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(mE,h,void 0)>=0)||w||L||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,Y]of p)this.g.setRequestHeader(M,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(M){tg(this,M)}};function tg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,ng(l),il(l)}function ng(l){l.A||(l.A=!0,Xe(l,"complete"),Xe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,Xe(this,"complete"),Xe(this,"abort"),il(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),il(this,!0)),Oe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?rg(this):this.Xa())},t.Xa=function(){rg(this)};function rg(l){if(l.h&&typeof i<"u"){if(l.v&&xr(l)==4)setTimeout(l.Ca.bind(l),0);else if(Xe(l,"readystatechange"),xr(l)==4){l.h=!1;try{const M=l.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var w;if(w=M===0){let Y=String(l.D).match(Wp)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),w=!fE.test(Y?Y.toLowerCase():"")}p=w}if(p)Xe(l,"complete"),Xe(l,"success");else{l.o=6;try{var L=xr(l)>2?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.ca()+"]",ng(l)}}finally{il(l)}}}}function il(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,h||Xe(l,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function xr(l){return l.g?l.g.readyState:0}t.ca=function(){try{return xr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),X(h)}};function sg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function pE(l){const h={};l=(l.g&&xr(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<l.length;w++){if(I(l[w]))continue;var p=Z2(l[w]);const L=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const M=h[L]||[];h[L]=M,M.push(p)}ce(h,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ao(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function ig(l){this.za=0,this.i=[],this.j=new vo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ao("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ao("baseRetryDelayMs",5e3,l),this.Za=Ao("retryDelaySeedMs",1e4,l),this.Ta=Ao("forwardChannelMaxRetries",2,l),this.va=Ao("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Bp(l&&l.concurrentRequestLimit),this.Ba=new hE,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ig.prototype,t.ka=8,t.I=1,t.connect=function(l,h,p,w){St(0),this.W=l,this.H=h||{},p&&w!==void 0&&(this.H.OSID=p,this.H.OAID=w),this.F=this.X,this.J=mg(this,null,this.W),al(this)};function sd(l){if(og(l),l.I==3){var h=l.V++,p=xn(l.J);if(Ne(p,"SID",l.M),Ne(p,"RID",h),Ne(p,"TYPE","terminate"),ko(l,p),h=new yr(l,l.j,h),h.M=2,h.A=rl(xn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=h.A,p=!0),p||(h.g=pg(h.j,null),h.g.ea(h.A)),h.F=Date.now(),nl(h)}fg(l)}function ol(l){l.g&&(od(l),l.g.cancel(),l.g=null)}function og(l){ol(l),l.v&&(o.clearTimeout(l.v),l.v=null),ll(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function al(l){if(!zp(l.h)&&!l.m){l.m=!0;var h=l.Ea;F||v(),B||(F(),B=!0),y.add(h,l),l.D=0}}function gE(l,h){return $p(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=yo(d(l.Ea,l,h),hg(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const L=new yr(this,this.j,l);let M=this.o;if(this.U&&(M?(M=Ee(M),an(M,this.U)):M=this.U),this.u!==null||this.R||(L.J=M,M=null),this.S)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var w=this.i[p];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(h+=w,h>4096){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=lg(this,L,h),p=xn(this.J),Ne(p,"RID",l),Ne(p,"CVER",22),this.G&&Ne(p,"X-HTTP-Session-Id",this.G),ko(this,p),M&&(this.R?h="headers="+wo(eg(M))+"&"+h:this.u&&rd(p,this.u,M)),ed(this.h,L),this.Ra&&Ne(p,"TYPE","init"),this.S?(Ne(p,"$req",h),Ne(p,"SID","null"),L.U=!0,Yu(L,p,null)):Yu(L,p,h),this.I=2}}else this.I==3&&(l?ag(this,l):this.i.length==0||zp(this.h)||ag(this))};function ag(l,h){var p;h?p=h.l:p=l.V++;const w=xn(l.J);Ne(w,"SID",l.M),Ne(w,"RID",p),Ne(w,"AID",l.K),ko(l,w),l.u&&l.o&&rd(w,l.u,l.o),p=new yr(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),h&&(l.i=h.G.concat(l.i)),h=lg(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),ed(l.h,p),Yu(p,w,h)}function ko(l,h){l.H&&se(l.H,function(p,w){Ne(h,w,p)}),l.l&&se({},function(p,w){Ne(h,w,p)})}function lg(l,h,p){p=Math.min(l.i.length,p);const w=l.l?d(l.l.Ka,l.l,l):null;e:{var L=l.i;let he=-1;for(;;){const Je=["count="+p];he==-1?p>0?(he=L[0].g,Je.push("ofs="+he)):he=0:Je.push("ofs="+he);let be=!0;for(let nt=0;nt<p;nt++){var M=L[nt].g;const _n=L[nt].map;if(M-=he,M<0)he=Math.max(0,L[nt].g-100),be=!1;else try{M="req"+M+"_"||"";try{var Y=_n instanceof Map?_n:Object.entries(_n);for(const[bs,_r]of Y){let Er=_r;c(_r)&&(Er=U(_r)),Je.push(M+bs+"="+encodeURIComponent(Er))}}catch(bs){throw Je.push(M+"type="+encodeURIComponent("_badmap")),bs}}catch{w&&w(_n)}}if(be){Y=Je.join("&");break e}}Y=void 0}return l=l.i.splice(0,p),h.G=l,Y}function cg(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;F||v(),B||(F(),B=!0),y.add(h,l),l.A=0}}function id(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=yo(d(l.Da,l),hg(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,ug(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=yo(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,St(10),ol(this),ug(this))};function od(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function ug(l){l.g=new yr(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=xn(l.na);Ne(h,"RID","rpc"),Ne(h,"SID",l.M),Ne(h,"AID",l.K),Ne(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&Ne(h,"TO",l.ia),Ne(h,"TYPE","xmlhttp"),ko(l,h),l.u&&l.o&&rd(h,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=rl(xn(h)),p.u=null,p.R=!0,Vp(p,l)}t.Va=function(){this.C!=null&&(this.C=null,ol(this),id(this),St(19))};function ll(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function dg(l,h){var p=null;if(l.g==h){ll(l),od(l),l.g=null;var w=2}else if(Zu(l.h,h))p=h.G,qp(l.h,h),w=1;else return;if(l.I!=0){if(h.o)if(w==1){p=h.u?h.u.length:0,h=Date.now()-h.F;var L=l.D;w=el(),Xe(w,new Rp(w,p)),al(l)}else cg(l);else if(L=h.m,L==3||L==0&&h.X>0||!(w==1&&gE(l,h)||w==2&&id(l)))switch(p&&p.length>0&&(h=l.h,h.i=h.i.concat(p)),L){case 1:Es(l,5);break;case 4:Es(l,10);break;case 3:Es(l,6);break;default:Es(l,2)}}}function hg(l,h){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*h}function Es(l,h){if(l.j.info("Error code "+h),h==2){var p=d(l.bb,l),w=l.Ua;const L=!w;w=new vr(w||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||_o(w,"https"),rl(w),L?uE(w.toString(),p):dE(w.toString(),p)}else St(2);l.I=0,l.l&&l.l.pa(h),fg(l),og(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),St(2)):(this.j.info("Failed to ping google.com"),St(1))};function fg(l){if(l.I=0,l.ja=[],l.l){const h=Hp(l.h);(h.length!=0||l.i.length!=0)&&(k(l.ja,h),k(l.ja,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.oa()}}function mg(l,h,p){var w=p instanceof vr?xn(p):new vr(p);if(w.g!="")h&&(w.g=h+"."+w.g),Eo(w,w.u);else{var L=o.location;w=L.protocol,h=h?h+"."+L.hostname:L.hostname,L=+L.port;const M=new vr(null);w&&_o(M,w),h&&(M.g=h),L&&Eo(M,L),p&&(M.h=p),w=M}return p=l.G,h=l.wa,p&&h&&Ne(w,p,h),Ne(w,"VER",l.ka),ko(l,w),w}function pg(l,h,p){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new Oe(new nd({ab:p})):new Oe(l.ma),h.Fa(l.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function gg(){}t=gg.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function cl(){}cl.prototype.g=function(l,h){return new Ft(l,h)};function Ft(l,h){He.call(this),this.g=new ig(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!I(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!I(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new oi(this)}f(Ft,He),Ft.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ft.prototype.close=function(){sd(this.g)},Ft.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=U(l),l=p);h.i.push(new nE(h.Ya++,l)),h.I==3&&al(h)},Ft.prototype.N=function(){this.g.l=null,delete this.j,sd(this.g),delete this.g,Ft.Z.N.call(this)};function yg(l){Wu.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}f(yg,Wu);function vg(){Gu.call(this),this.status=1}f(vg,Gu);function oi(l){this.g=l}f(oi,gg),oi.prototype.ra=function(){Xe(this.g,"a")},oi.prototype.qa=function(l){Xe(this.g,new yg(l))},oi.prototype.pa=function(l){Xe(this.g,new vg)},oi.prototype.oa=function(){Xe(this.g,"b")},cl.prototype.createWebChannel=cl.prototype.g,Ft.prototype.send=Ft.prototype.o,Ft.prototype.open=Ft.prototype.m,Ft.prototype.close=Ft.prototype.close,z_=function(){return new cl},B_=function(){return el()},U_=ws,ef={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},tl.NO_ERROR=0,tl.TIMEOUT=8,tl.HTTP_ERROR=6,Zl=tl,Dp.COMPLETE="complete",F_=Dp,mt.EventType=po,po.OPEN="a",po.CLOSE="b",po.ERROR="c",po.MESSAGE="d",He.prototype.listen=He.prototype.J,qo=mt,Oe.prototype.listenOnce=Oe.prototype.K,Oe.prototype.getLastError=Oe.prototype.Ha,Oe.prototype.getLastErrorCode=Oe.prototype.ya,Oe.prototype.getStatus=Oe.prototype.ca,Oe.prototype.getResponseJson=Oe.prototype.La,Oe.prototype.getResponseText=Oe.prototype.la,Oe.prototype.send=Oe.prototype.ea,Oe.prototype.setWithCredentials=Oe.prototype.Fa,V_=Oe}).apply(typeof kl<"u"?kl:typeof self<"u"?self:typeof window<"u"?window:{});const l0="@firebase/firestore",c0="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vt.UNAUTHENTICATED=new vt(null),vt.GOOGLE_CREDENTIALS=new vt("google-credentials-uid"),vt.FIRST_PARTY=new vt("first-party-uid"),vt.MOCK_USER=new vt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let io="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs=new xm("@firebase/firestore");function li(){return Hs.logLevel}function ee(t,...e){if(Hs.logLevel<=pe.DEBUG){const n=e.map(Pm);Hs.debug(`Firestore (${io}): ${t}`,...n)}}function lr(t,...e){if(Hs.logLevel<=pe.ERROR){const n=e.map(Pm);Hs.error(`Firestore (${io}): ${t}`,...n)}}function qi(t,...e){if(Hs.logLevel<=pe.WARN){const n=e.map(Pm);Hs.warn(`Firestore (${io}): ${t}`,...n)}}function Pm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,$_(t,r,n)}function $_(t,e,n){let r=`FIRESTORE (${io}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw lr(r),new Error(r)}function xe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||$_(e,s,r)}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Fn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(vt.UNAUTHENTICATED))}shutdown(){}}class _k{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Ek{constructor(e){this.t=e,this.currentUser=vt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){xe(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(xe(typeof r.accessToken=="string",31837,{l:r}),new q_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xe(e===null||typeof e=="string",2055,{h:e}),new vt(e)}}class bk{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=vt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Tk{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new bk(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(vt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class u0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ik{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Jt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){xe(this.o===void 0,3512);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new u0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(xe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new u0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sk(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Sk(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function ge(t,e){return t<e?-1:t>e?1:0}function tf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return zd(s)===zd(i)?ge(s,i):zd(s)?1:-1}return ge(t.length,e.length)}const Nk=55296,Ak=57343;function zd(t){const e=t.charCodeAt(0);return e>=Nk&&e<=Ak}function Hi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0="__name__";class Tn{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Tn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Tn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Tn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return ge(e.length,n.length)}static compareSegments(e,n){const r=Tn.isNumericId(e),s=Tn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Tn.extractNumericId(e).compare(Tn.extractNumericId(n)):tf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qr.fromString(e.substring(4,e.length-2))}}class Te extends Tn{construct(e,n,r){return new Te(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Te(n)}static emptyPath(){return new Te([])}}const kk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Tn{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return kk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===d0}static keyField(){return new ct([d0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new J($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new J($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new J($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new J($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(Te.fromString(e))}static fromName(e){return new ie(Te.fromString(e).popFirst(5))}static empty(){return new ie(Te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Te.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new Te(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(t,e,n){if(!n)throw new J($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ck(t,e,n,r){if(e===!0&&r===!0)throw new J($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function h0(t){if(!ie.isDocumentKey(t))throw new J($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function f0(t){if(ie.isDocumentKey(t))throw new J($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function W_(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function bu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function Vt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bu(t);throw new J($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t,e){const n={typeString:t};return e&&(n.value=e),n}function Ka(t,e){if(!W_(t))throw new J($.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new J($.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0=-62135596800,p0=1e6;class Ce{static now(){return Ce.fromMillis(Date.now())}static fromDate(e){return Ce.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*p0);return new Ce(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<m0)throw new J($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/p0}_compareTo(e){return this.seconds===e.seconds?ge(this.nanoseconds,e.nanoseconds):ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ka(e,Ce._jsonSchema))return new Ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-m0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ce._jsonSchemaVersion="firestore/timestamp/1.0",Ce._jsonSchema={type:Ye("string",Ce._jsonSchemaVersion),seconds:Ye("number"),nanoseconds:Ye("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{static fromTimestamp(e){return new ue(e)}static min(){return new ue(new Ce(0,0))}static max(){return new ue(new Ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=-1;function jk(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new Ce(n+1,0):new Ce(n,r));return new ns(s,ie.empty(),e)}function Pk(t){return new ns(t.readTime,t.key,ka)}class ns{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ns(ue.min(),ie.empty(),ka)}static max(){return new ns(ue.max(),ie.empty(),ka)}}function Rk(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oo(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==Dk)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new H((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof H?n:H.resolve(n)}catch(n){return H.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):H.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):H.reject(n)}static resolve(e){return new H((n,r)=>{n(e)})}static reject(e){return new H((n,r)=>{r(e)})}static waitFor(e){return new H((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=H.resolve(!1);for(const r of e)n=n.next(s=>s?H.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new H((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(m=>{o[d]=m,++c,c===i&&r(o)},m=>s(m))}})}static doWhile(e,n){return new H((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Mk(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ao(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Tu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm=-1;function Iu(t){return t==null}function Uc(t){return t===0&&1/t==-1/0}function Ok(t){return typeof t=="number"&&Number.isInteger(t)&&!Uc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="";function Vk(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=g0(e)),e=Fk(t.get(n),e);return g0(e)}function Fk(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case G_:n+="";break;default:n+=i}}return n}function g0(t){return t+G_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function fs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function K_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e,n){this.comparator=e,this.root=n||lt.EMPTY}insert(e,n){return new Me(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(e){return new Me(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cl(this.root,e,this.comparator,!0)}}class Cl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??lt.RED,this.left=s??lt.EMPTY,this.right=i??lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new lt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return lt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return lt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}}lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1;lt.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new lt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.comparator=e,this.data=new Me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new v0(this.data.getIterator())}getIteratorFrom(e){return new v0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof tt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new tt(this.comparator);return n.data=e,n}}class v0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new qt([])}unionWith(e){let n=new tt(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new qt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Hi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Q_("Invalid base64 string: "+i):i}}(e);return new ht(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ht(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const Uk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rs(t){if(xe(!!t,39018),typeof t=="string"){let e=0;const n=Uk.exec(t);if(xe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(t.seconds),nanos:$e(t.nanos)}}function $e(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ss(t){return typeof t=="string"?ht.fromBase64String(t):ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_="server_timestamp",X_="__type__",J_="__previous_value__",Z_="__local_write_time__";function Lm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[X_])==null?void 0:r.stringValue)===Y_}function Su(t){const e=t.mapValue.fields[J_];return Lm(e)?Su(e):e}function Ca(t){const e=rs(t.mapValue.fields[Z_].timestampValue);return new Ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,n,r,s,i,o,c,u,d,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=m}}const Bc="(default)";class ja{constructor(e,n){this.projectId=e,this.database=n||Bc}static empty(){return new ja("","")}get isDefaultDatabase(){return this.database===Bc}isEqual(e){return e instanceof ja&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="__type__",zk="__max__",jl={mapValue:{}},t1="__vector__",zc="value";function is(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lm(t)?4:qk(t)?9007199254740991:$k(t)?10:11:le(28295,{value:t})}function Vn(t,e){if(t===e)return!0;const n=is(t);if(n!==is(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ca(t).isEqual(Ca(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=rs(s.timestampValue),c=rs(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ss(s.bytesValue).isEqual(ss(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return $e(s.geoPointValue.latitude)===$e(i.geoPointValue.latitude)&&$e(s.geoPointValue.longitude)===$e(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return $e(s.integerValue)===$e(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=$e(s.doubleValue),c=$e(i.doubleValue);return o===c?Uc(o)===Uc(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Hi(t.arrayValue.values||[],e.arrayValue.values||[],Vn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(y0(o)!==y0(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Vn(o[u],c[u])))return!1;return!0}(t,e);default:return le(52216,{left:t})}}function Pa(t,e){return(t.values||[]).find(n=>Vn(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;const n=is(t),r=is(e);if(n!==r)return ge(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ge(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=$e(i.integerValue||i.doubleValue),u=$e(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return w0(t.timestampValue,e.timestampValue);case 4:return w0(Ca(t),Ca(e));case 5:return tf(t.stringValue,e.stringValue);case 6:return function(i,o){const c=ss(i),u=ss(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const m=ge(c[d],u[d]);if(m!==0)return m}return ge(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=ge($e(i.latitude),$e(o.latitude));return c!==0?c:ge($e(i.longitude),$e(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return x0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,x,k,j;const c=i.fields||{},u=o.fields||{},d=(g=c[zc])==null?void 0:g.arrayValue,m=(x=u[zc])==null?void 0:x.arrayValue,f=ge(((k=d==null?void 0:d.values)==null?void 0:k.length)||0,((j=m==null?void 0:m.values)==null?void 0:j.length)||0);return f!==0?f:x0(d,m)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===jl.mapValue&&o===jl.mapValue)return 0;if(i===jl.mapValue)return 1;if(o===jl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=o.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let f=0;f<u.length&&f<m.length;++f){const g=tf(u[f],m[f]);if(g!==0)return g;const x=Wi(c[u[f]],d[m[f]]);if(x!==0)return x}return ge(u.length,m.length)}(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function w0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ge(t,e);const n=rs(t),r=rs(e),s=ge(n.seconds,r.seconds);return s!==0?s:ge(n.nanos,r.nanos)}function x0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Wi(n[s],r[s]);if(i)return i}return ge(n.length,r.length)}function Gi(t){return nf(t)}function nf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=rs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ss(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=nf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${nf(n.fields[o])}`;return s+"}"}(t.mapValue):le(61005,{value:t})}function ec(t){switch(is(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Su(t);return e?16+ec(e):16;case 5:return 2*t.stringValue.length;case 6:return ss(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ec(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return fs(r.fields,(i,o)=>{s+=i.length+ec(o)}),s}(t.mapValue);default:throw le(13486,{value:t})}}function _0(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rf(t){return!!t&&"integerValue"in t}function Mm(t){return!!t&&"arrayValue"in t}function E0(t){return!!t&&"nullValue"in t}function b0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tc(t){return!!t&&"mapValue"in t}function $k(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[e1])==null?void 0:r.stringValue)===t1}function ia(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return fs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ia(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ia(t.arrayValue.values[n]);return e}return{...t}}function qk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===zk}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.value=e}static empty(){return new Rt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ia(n)}setAll(e){let n=ct.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=ia(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());tc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Vn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];tc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){fs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Rt(ia(this.value))}}function n1(t){const e=[];return fs(t.fields,(n,r)=>{const s=new ct([n]);if(tc(r)){const i=n1(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new qt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new _t(e,0,ue.min(),ue.min(),ue.min(),Rt.empty(),0)}static newFoundDocument(e,n,r,s){return new _t(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new _t(e,2,n,ue.min(),ue.min(),Rt.empty(),0)}static newUnknownDocument(e,n){return new _t(e,3,n,ue.min(),ue.min(),Rt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,n){this.position=e,this.inclusive=n}}function T0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ie.comparator(ie.fromName(o.referenceValue),n.key):r=Wi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function I0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Vn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n="asc"){this.field=e,this.dir=n}}function Hk(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{}class Qe extends r1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Gk(e,n,r):n==="array-contains"?new Yk(e,r):n==="in"?new Xk(e,r):n==="not-in"?new Jk(e,r):n==="array-contains-any"?new Zk(e,r):new Qe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Kk(e,r):new Qk(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Wi(n,this.value)):n!==null&&is(this.value)===is(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class wn extends r1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new wn(e,n)}matches(e){return s1(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function s1(t){return t.op==="and"}function i1(t){return Wk(t)&&s1(t)}function Wk(t){for(const e of t.filters)if(e instanceof wn)return!1;return!0}function sf(t){if(t instanceof Qe)return t.field.canonicalString()+t.op.toString()+Gi(t.value);if(i1(t))return t.filters.map(e=>sf(e)).join(",");{const e=t.filters.map(n=>sf(n)).join(",");return`${t.op}(${e})`}}function o1(t,e){return t instanceof Qe?function(r,s){return s instanceof Qe&&r.op===s.op&&r.field.isEqual(s.field)&&Vn(r.value,s.value)}(t,e):t instanceof wn?function(r,s){return s instanceof wn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&o1(o,s.filters[c]),!0):!1}(t,e):void le(19439)}function a1(t){return t instanceof Qe?function(n){return`${n.field.canonicalString()} ${n.op} ${Gi(n.value)}`}(t):t instanceof wn?function(n){return n.op.toString()+" {"+n.getFilters().map(a1).join(" ,")+"}"}(t):"Filter"}class Gk extends Qe{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class Kk extends Qe{constructor(e,n){super(e,"in",n),this.keys=l1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Qk extends Qe{constructor(e,n){super(e,"not-in",n),this.keys=l1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function l1(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class Yk extends Qe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Mm(n)&&Pa(n.arrayValue,this.value)}}class Xk extends Qe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Pa(this.value.arrayValue,n)}}class Jk extends Qe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Pa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Pa(this.value.arrayValue,n)}}class Zk extends Qe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Mm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Pa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function S0(t,e=null,n=[],r=[],s=null,i=null,o=null){return new eC(t,e,n,r,s,i,o)}function Om(t){const e=de(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>sf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Iu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Gi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Gi(r)).join(",")),e.Te=n}return e.Te}function Vm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Hk(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!o1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!I0(t.startAt,e.startAt)&&I0(t.endAt,e.endAt)}function of(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tC(t,e,n,r,s,i,o,c){return new Qa(t,e,n,r,s,i,o,c)}function Nu(t){return new Qa(t)}function N0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function c1(t){return t.collectionGroup!==null}function oa(t){const e=de(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new tt(ct.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new qc(i,r))}),n.has(ct.keyField().canonicalString())||e.Ie.push(new qc(ct.keyField(),r))}return e.Ie}function Rn(t){const e=de(t);return e.Ee||(e.Ee=nC(e,oa(t))),e.Ee}function nC(t,e){if(t.limitType==="F")return S0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new qc(s.field,i)});const n=t.endAt?new $c(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new $c(t.startAt.position,t.startAt.inclusive):null;return S0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function af(t,e){const n=t.filters.concat([e]);return new Qa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function lf(t,e,n){return new Qa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Au(t,e){return Vm(Rn(t),Rn(e))&&t.limitType===e.limitType}function u1(t){return`${Om(Rn(t))}|lt:${t.limitType}`}function ci(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>a1(s)).join(", ")}]`),Iu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Gi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Gi(s)).join(",")),`Target(${r})`}(Rn(t))}; limitType=${t.limitType})`}function ku(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ie.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of oa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const d=T0(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,oa(r),s)||r.endAt&&!function(o,c,u){const d=T0(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,oa(r),s))}(t,e)}function rC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function d1(t){return(e,n)=>{let r=!1;for(const s of oa(t)){const i=sC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function sC(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),d=c.data.field(i);return u!==null&&d!==null?Wi(u,d):le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){fs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return K_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=new Me(ie.comparator);function cr(){return iC}const h1=new Me(ie.comparator);function Ho(...t){let e=h1;for(const n of t)e=e.insert(n.key,n);return e}function f1(t){let e=h1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ps(){return aa()}function m1(){return aa()}function aa(){return new Js(t=>t.toString(),(t,e)=>t.isEqual(e))}const oC=new Me(ie.comparator),aC=new tt(ie.comparator);function ye(...t){let e=aC;for(const n of t)e=e.add(n);return e}const lC=new tt(ge);function cC(){return lC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uc(e)?"-0":e}}function p1(t){return{integerValue:""+t}}function g1(t,e){return Ok(e)?p1(e):Fm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(){this._=void 0}}function uC(t,e,n){return t instanceof Ra?function(s,i){const o={fields:{[X_]:{stringValue:Y_},[Z_]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Lm(i)&&(i=Su(i)),i&&(o.fields[J_]=i),{mapValue:o}}(n,e):t instanceof Ki?v1(t,e):t instanceof Da?w1(t,e):function(s,i){const o=y1(s,i),c=A0(o)+A0(s.Ae);return rf(o)&&rf(s.Ae)?p1(c):Fm(s.serializer,c)}(t,e)}function dC(t,e,n){return t instanceof Ki?v1(t,e):t instanceof Da?w1(t,e):n}function y1(t,e){return t instanceof La?function(r){return rf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ra extends Cu{}class Ki extends Cu{constructor(e){super(),this.elements=e}}function v1(t,e){const n=x1(e);for(const r of t.elements)n.some(s=>Vn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Da extends Cu{constructor(e){super(),this.elements=e}}function w1(t,e){let n=x1(e);for(const r of t.elements)n=n.filter(s=>!Vn(s,r));return{arrayValue:{values:n}}}class La extends Cu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function A0(t){return $e(t.integerValue||t.doubleValue)}function x1(t){return Mm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e,n){this.field=e,this.transform=n}}function hC(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ki&&s instanceof Ki||r instanceof Da&&s instanceof Da?Hi(r.elements,s.elements,Vn):r instanceof La&&s instanceof La?Vn(r.Ae,s.Ae):r instanceof Ra&&s instanceof Ra}(t.transform,e.transform)}class fC{constructor(e,n){this.version=e,this.transformResults=n}}class rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ju{}function _1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Bm(t.key,rn.none()):new Ya(t.key,t.data,rn.none());{const n=t.data,r=Rt.empty();let s=new tt(ct.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ms(t.key,r,new qt(s.toArray()),rn.none())}}function mC(t,e,n){t instanceof Ya?function(s,i,o){const c=s.value.clone(),u=C0(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof ms?function(s,i,o){if(!nc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=C0(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(E1(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function la(t,e,n,r){return t instanceof Ya?function(i,o,c,u){if(!nc(i.precondition,o))return c;const d=i.value.clone(),m=j0(i.fieldTransforms,u,o);return d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof ms?function(i,o,c,u){if(!nc(i.precondition,o))return c;const d=j0(i.fieldTransforms,u,o),m=o.data;return m.setAll(E1(i)),m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,c){return nc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function pC(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=y1(r.transform,s||null);i!=null&&(n===null&&(n=Rt.empty()),n.set(r.field,i))}return n||null}function k0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Hi(r,s,(i,o)=>hC(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ya extends ju{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ms extends ju{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function E1(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function C0(t,e,n){const r=new Map;xe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,dC(o,c,n[s]))}return r}function j0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,uC(i,o,e))}return r}class Bm extends ju{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gC extends ju{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&mC(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=la(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=la(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=m1();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=_1(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ye())}isEqual(e){return this.batchId===e.batchId&&Hi(this.mutations,e.mutations,(n,r)=>k0(n,r))&&Hi(this.baseMutations,e.baseMutations,(n,r)=>k0(n,r))}}class zm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){xe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return oC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new zm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We,ve;function xC(t){switch(t){case $.OK:return le(64938);case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function b1(t){if(t===void 0)return lr("GRPC error has no .code"),$.UNKNOWN;switch(t){case We.OK:return $.OK;case We.CANCELLED:return $.CANCELLED;case We.UNKNOWN:return $.UNKNOWN;case We.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case We.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case We.INTERNAL:return $.INTERNAL;case We.UNAVAILABLE:return $.UNAVAILABLE;case We.UNAUTHENTICATED:return $.UNAUTHENTICATED;case We.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case We.NOT_FOUND:return $.NOT_FOUND;case We.ALREADY_EXISTS:return $.ALREADY_EXISTS;case We.PERMISSION_DENIED:return $.PERMISSION_DENIED;case We.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case We.ABORTED:return $.ABORTED;case We.OUT_OF_RANGE:return $.OUT_OF_RANGE;case We.UNIMPLEMENTED:return $.UNIMPLEMENTED;case We.DATA_LOSS:return $.DATA_LOSS;default:return le(39323,{code:t})}}(ve=We||(We={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _C(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC=new Qr([4294967295,4294967295],0);function P0(t){const e=_C().encode(t),n=new O_;return n.update(e),new Uint8Array(n.digest())}function R0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Qr([n,r],0),new Qr([s,i],0)]}class $m{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Wo(`Invalid padding: ${n}`);if(r<0)throw new Wo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Wo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Qr.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Qr.fromNumber(r)));return s.compare(EC)===1&&(s=new Qr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=P0(e),[r,s]=R0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $m(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=P0(e),[r,s]=R0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Wo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Xa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Pu(ue.min(),s,new Me(ge),cr(),ye())}}class Xa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Xa(r,n,ye(),ye(),ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class T1{constructor(e,n){this.targetId=e,this.Ce=n}}class I1{constructor(e,n,r=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class D0{constructor(){this.ve=0,this.Fe=L0(),this.Me=ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ye(),n=ye(),r=ye();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le(38017,{changeType:i})}}),new Xa(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=L0()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,xe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bC{constructor(e){this.Ge=e,this.ze=new Map,this.je=cr(),this.Je=Pl(),this.He=Pl(),this.Ye=new Me(ge)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(of(i))if(r===0){const o=new ie(i.path);this.et(n,o,_t.newNoDocument(o,ue.min()))}else xe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=ss(r).toUint8Array()}catch(u){if(u instanceof Q_)return qi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new $m(o,s,i)}catch(u){return qi(u instanceof Wo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const c=this.ot(o);if(c){if(i.current&&of(c.target)){const u=new ie(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,_t.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=ye();this.He.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Pu(e,n,this.Ye,this.je,r);return this.je=cr(),this.Je=Pl(),this.He=Pl(),this.Ye=new Me(ge),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new D0,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tt(ge),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tt(ge),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new D0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Pl(){return new Me(ie.comparator)}function L0(){return new Me(ie.comparator)}const TC={asc:"ASCENDING",desc:"DESCENDING"},IC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},SC={and:"AND",or:"OR"};class NC{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function cf(t,e){return t.useProto3Json||Iu(e)?e:{value:e}}function Hc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function AC(t,e){return Hc(t,e.toTimestamp())}function Dn(t){return xe(!!t,49232),ue.fromTimestamp(function(n){const r=rs(n);return new Ce(r.seconds,r.nanos)}(t))}function qm(t,e){return uf(t,e).canonicalString()}function uf(t,e){const n=function(s){return new Te(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function N1(t){const e=Te.fromString(t);return xe(P1(e),10190,{key:e.toString()}),e}function df(t,e){return qm(t.databaseId,e.path)}function $d(t,e){const n=N1(e);if(n.get(1)!==t.databaseId.projectId)throw new J($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(k1(n))}function A1(t,e){return qm(t.databaseId,e)}function kC(t){const e=N1(t);return e.length===4?Te.emptyPath():k1(e)}function hf(t){return new Te(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function k1(t){return xe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function M0(t,e,n){return{name:df(t,e),fields:n.value.mapValue.fields}}function CC(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:le(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,m){return d.useProto3Json?(xe(m===void 0||typeof m=="string",58123),ht.fromBase64String(m||"")):(xe(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),ht.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const m=d.code===void 0?$.UNKNOWN:b1(d.code);return new J(m,d.message||"")}(o);n=new I1(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=$d(t,r.document.name),i=Dn(r.document.updateTime),o=r.document.createTime?Dn(r.document.createTime):ue.min(),c=new Rt({mapValue:{fields:r.document.fields}}),u=_t.newFoundDocument(s,i,o,c),d=r.targetIds||[],m=r.removedTargetIds||[];n=new rc(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=$d(t,r.document),i=r.readTime?Dn(r.readTime):ue.min(),o=_t.newNoDocument(s,i),c=r.removedTargetIds||[];n=new rc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=$d(t,r.document),i=r.removedTargetIds||[];n=new rc([],i,s,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new wC(s,i),c=r.targetId;n=new T1(c,o)}}return n}function jC(t,e){let n;if(e instanceof Ya)n={update:M0(t,e.key,e.value)};else if(e instanceof Bm)n={delete:df(t,e.key)};else if(e instanceof ms)n={update:M0(t,e.key,e.data),updateMask:UC(e.fieldMask)};else{if(!(e instanceof gC))return le(16599,{Vt:e.type});n={verify:df(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Ra)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ki)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Da)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof La)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:AC(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le(27497)}(t,e.precondition)),n}function PC(t,e){return t&&t.length>0?(xe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Dn(s.updateTime):Dn(i);return o.isEqual(ue.min())&&(o=Dn(i)),new fC(o,s.transformResults||[])}(n,e))):[]}function RC(t,e){return{documents:[A1(t,e.path)]}}function DC(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=A1(t,s);const i=function(d){if(d.length!==0)return j1(wn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(m=>function(g){return{field:ui(g.field),direction:OC(g.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=cf(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function LC(t){let e=kC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){xe(r===1,65062);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let i=[];n.where&&(i=function(f){const g=C1(f);return g instanceof wn&&i1(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(g=>function(k){return new qc(di(k.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(g))}(n.orderBy));let c=null;n.limit&&(c=function(f){let g;return g=typeof f=="object"?f.value:f,Iu(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(f){const g=!!f.before,x=f.values||[];return new $c(x,g)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const g=!f.before,x=f.values||[];return new $c(x,g)}(n.endAt)),tC(e,s,o,i,c,"F",u,d)}function MC(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function C1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=di(n.unaryFilter.field);return Qe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=di(n.unaryFilter.field);return Qe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=di(n.unaryFilter.field);return Qe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=di(n.unaryFilter.field);return Qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}}(t):t.fieldFilter!==void 0?function(n){return Qe.create(di(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return wn.create(n.compositeFilter.filters.map(r=>C1(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le(1026)}}(n.compositeFilter.op))}(t):le(30097,{filter:t})}function OC(t){return TC[t]}function VC(t){return IC[t]}function FC(t){return SC[t]}function ui(t){return{fieldPath:t.canonicalString()}}function di(t){return ct.fromServerFormat(t.fieldPath)}function j1(t){return t instanceof Qe?function(n){if(n.op==="=="){if(b0(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NAN"}};if(E0(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(b0(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NOT_NAN"}};if(E0(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ui(n.field),op:VC(n.op),value:n.value}}}(t):t instanceof wn?function(n){const r=n.getFilters().map(s=>j1(s));return r.length===1?r[0]:{compositeFilter:{op:FC(n.op),filters:r}}}(t):le(54877,{filter:t})}function UC(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function P1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,r,s,i=ue.min(),o=ue.min(),c=ht.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Fr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e){this.yt=e}}function zC(t){const e=LC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(){this.Cn=new qC}addToCollectionParentIndex(e,n){return this.Cn.add(n),H.resolve()}getCollectionParents(e,n){return H.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return H.resolve()}deleteFieldIndex(e,n){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,n){return H.resolve()}getDocumentsMatchingTarget(e,n){return H.resolve(null)}getIndexType(e,n){return H.resolve(0)}getFieldIndexes(e,n){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,n){return H.resolve(ns.min())}getMinOffsetFromCollectionGroup(e,n){return H.resolve(ns.min())}updateCollectionGroup(e,n,r){return H.resolve()}updateIndexEntries(e,n){return H.resolve()}}class qC{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new tt(Te.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new tt(Te.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},R1=41943040;class jt{static withCacheSize(e){return new jt(e,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt.DEFAULT_COLLECTION_PERCENTILE=10,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jt.DEFAULT=new jt(R1,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jt.DISABLED=new jt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qi(0)}static cr(){return new Qi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="LruGarbageCollector",HC=1048576;function F0([t,e],[n,r]){const s=ge(t,n);return s===0?ge(e,r):s}class WC{constructor(e){this.Ir=e,this.buffer=new tt(F0),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();F0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class GC{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(V0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ao(n)?ee(V0,"Ignoring IndexedDB error during garbage collection: ",n):await oo(n)}await this.Vr(3e5)})}}class KC{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return H.resolve(Tu.ce);const r=new WC(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(O0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),O0):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,c,u,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,c=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),li()<=pe.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${f} documents in `+(d-u)+`ms
Total Duration: ${d-m}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function QC(t,e){return new KC(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(){this.changes=new Js(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_t.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?H.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&la(r.mutation,s,qt.empty(),Ce.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ye()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ye()){const s=Ps();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ho();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ps();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ye()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=cr();const o=aa(),c=function(){return aa()}();return n.forEach((u,d)=>{const m=r.get(d.key);s.has(d.key)&&(m===void 0||m.mutation instanceof ms)?i=i.insert(d.key,d):m!==void 0?(o.set(d.key,m.mutation.getFieldMask()),la(m.mutation,d,m.mutation.getFieldMask(),Ce.now())):o.set(d.key,qt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,m)=>o.set(d,m)),n.forEach((d,m)=>c.set(d,new XC(m,o.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=aa();let s=new Me((o,c)=>o-c),i=ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let m=r.get(u)||qt.empty();m=c.applyToLocalView(d,m),r.set(u,m);const f=(s.get(c.batchId)||ye()).add(u);s=s.insert(c.batchId,f)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,m=u.value,f=m1();m.forEach(g=>{if(!i.has(g)){const x=_1(n.get(g),r.get(g));x!==null&&f.set(g,x),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return H.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):c1(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):H.resolve(Ps());let c=ka,u=i;return o.next(d=>H.forEach(d,(m,f)=>(c<f.largestBatchId&&(c=f.largestBatchId),i.get(m)?H.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{u=u.insert(m,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ye())).next(m=>({batchId:c,changes:f1(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let s=Ho();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ho();return this.indexManager.getCollectionParents(e,i).next(c=>H.forEach(c,u=>{const d=function(f,g){return new Qa(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(m=>{m.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const m=d.getKey();o.get(m)===null&&(o=o.insert(m,_t.newInvalidDocument(m)))});let c=Ho();return o.forEach((u,d)=>{const m=i.get(u);m!==void 0&&la(m.mutation,d,qt.empty(),Ce.now()),ku(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return H.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Dn(s.createTime)}}(n)),H.resolve()}getNamedQuery(e,n){return H.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:zC(s.bundledQuery),readTime:Dn(s.readTime)}}(n)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(){this.overlays=new Me(ie.comparator),this.qr=new Map}getOverlay(e,n){return H.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ps();return H.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),H.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),H.resolve()}getOverlaysForCollection(e,n,r){const s=Ps(),i=n.length+1,o=new ie(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return H.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Me((d,m)=>d-m);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let m=i.get(d.largestBatchId);m===null&&(m=Ps(),i=i.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const c=Ps(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>c.set(d,m)),!(c.size()>=s)););return H.resolve(c)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new vC(n,r));let i=this.qr.get(n);i===void 0&&(i=ye(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(){this.Qr=new tt(rt.$r),this.Ur=new tt(rt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new rt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new rt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ie(new Te([])),r=new rt(n,e),s=new rt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ie(new Te([])),r=new rt(n,e),s=new rt(n,e+1);let i=ye();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new rt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class rt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ie.comparator(e.key,n.key)||ge(e.Yr,n.Yr)}static Kr(e,n){return ge(e.Yr,n.Yr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tt(rt.$r)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yC(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new rt(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,n){return H.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return H.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?Dm:this.tr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new rt(n,0),s=new rt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const c=this.Xr(o.Yr);i.push(c)}),H.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tt(ge);return n.forEach(s=>{const i=new rt(s,0),o=new rt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],c=>{r=r.add(c.Yr)})}),H.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ie.isDocumentKey(i)||(i=i.child(""));const o=new rt(new ie(i),0);let c=new tt(ge);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},o),H.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){xe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return H.forEach(n.mutations,s=>{const i=new rt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new rt(n,0),s=this.Zr.firstAfterOrEqual(r);return H.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.ri=e,this.docs=function(){return new Me(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return H.resolve(r?r.document.mutableCopy():_t.newInvalidDocument(n))}getEntries(e,n){let r=cr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():_t.newInvalidDocument(s))}),H.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=cr();const o=n.path,c=new ie(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:m}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Rk(Pk(m),r)<=0||(s.has(m.key)||ku(n,m))&&(i=i.insert(m.key,m.mutableCopy()))}return H.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le(9500)}ii(e,n){return H.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new sj(this)}getSize(e){return H.resolve(this.size)}}class sj extends YC{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),H.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e){this.persistence=e,this.si=new Js(n=>Om(n),Vm),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.oi=0,this._i=new Hm,this.targetCount=0,this.ai=Qi.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),H.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Qi(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,H.resolve()}updateTargetData(e,n){return this.Pr(n),H.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),H.waitFor(i).next(()=>s)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return H.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),H.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),H.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),H.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return H.resolve(r)}containsKey(e,n){return H.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,n){this.ui={},this.overlays={},this.ci=new Tu(0),this.li=!1,this.li=!0,this.hi=new tj,this.referenceDelegate=e(this),this.Pi=new ij(this),this.indexManager=new $C,this.remoteDocumentCache=function(s){return new rj(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new BC(n),this.Ii=new ZC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ej,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new nj(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new oj(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return H.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class oj extends Lk{constructor(e){super(),this.currentSequenceNumber=e}}class Wm{constructor(e){this.persistence=e,this.Ri=new Hm,this.Vi=null}static mi(e){return new Wm(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),H.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),H.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.fi,r=>{const s=ie.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return H.or([()=>H.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Wc{constructor(e,n){this.persistence=e,this.pi=new Js(r=>Vk(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=QC(this,n)}static mi(e,n){return new Wc(e,n)}Ei(){}di(e){return H.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return H.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?H.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(c=>{c||(r++,i.removeEntry(o,ue.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),H.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),H.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),H.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ec(e.data.value)),n}br(e,n,r){return H.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return H.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=ye(),s=ye();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Gm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return qI()?8:Mk(Tt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new aj;return this.Ss(e,n,o).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,o,c.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(li()<=pe.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",ci(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),H.resolve()):(li()<=pe.DEBUG&&ee("QueryEngine","Query:",ci(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(li()<=pe.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",ci(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Rn(n))):H.resolve())}ys(e,n){if(N0(n))return H.resolve(null);let r=Rn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=lf(n,null,"F"),r=Rn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ye(...i);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,lf(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return N0(n)||s.isEqual(ue.min())?H.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?H.resolve(null):(li()<=pe.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ci(n)),this.vs(e,o,n,jk(s,ka)).next(c=>c))})}Ds(e,n){let r=new tt(d1(e));return n.forEach((s,i)=>{ku(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return li()<=pe.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",ci(n)),this.ps.getDocumentsMatchingQuery(e,n,ns.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="LocalStore",cj=3e8;class uj{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Me(ge),this.xs=new Js(i=>Om(i),Vm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function dj(t,e,n,r){return new uj(t,e,n,r)}async function L1(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=ye();for(const d of s){o.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}for(const d of i){c.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:c}))})})}function hj(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,m){const f=d.batch,g=f.keys();let x=H.resolve();return g.forEach(k=>{x=x.next(()=>m.getEntry(u,k)).next(j=>{const E=d.docVersions.get(k);xe(E!==null,48541),j.version.compareTo(E)<0&&(f.applyToRemoteDocument(j,d),j.isValidDocument()&&(j.setReadTime(d.commitVersion),m.addEntry(j)))})}),x.next(()=>c.mutationQueue.removeMutationBatch(u,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=ye();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function M1(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function fj(t,e){const n=de(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const c=[];e.targetChanges.forEach((m,f)=>{const g=s.get(f);if(!g)return;c.push(n.Pi.removeMatchingKeys(i,m.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(i,m.addedDocuments,f)));let x=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?x=x.withResumeToken(ht.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,r)),s=s.insert(f,x),function(j,E,b){return j.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=cj?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,x,m)&&c.push(n.Pi.updateTargetData(i,x))});let u=cr(),d=ye();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,m))}),c.push(mj(i,o,e.documentUpdates).next(m=>{u=m.ks,d=m.qs})),!r.isEqual(ue.min())){const m=n.Pi.getLastRemoteSnapshotVersion(i).next(f=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(m)}return H.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=s,i))}function mj(t,e,n){let r=ye(),s=ye();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=cr();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ue.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ee(Km,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:o,qs:s}})}function pj(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Dm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gj(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,H.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Fr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function ff(t,e,n){const r=de(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ao(o))throw o;ee(Km,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function U0(t,e,n){const r=de(t);let s=ue.min(),i=ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,m){const f=de(u),g=f.xs.get(m);return g!==void 0?H.resolve(f.Ms.get(g)):f.Pi.getTargetData(d,m)}(r,o,Rn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:ue.min(),n?i:ye())).next(c=>(yj(r,rC(e),c),{documents:c,Qs:i})))}function yj(t,e,n){let r=t.Os.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class B0{constructor(){this.activeTargetIds=cC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vj{constructor(){this.Mo=new B0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new B0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0="ConnectivityMonitor";class $0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(z0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(z0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rl=null;function mf(){return Rl===null?Rl=function(){return 268435456+Math.round(2147483648*Math.random())}():Rl++,"0x"+Rl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="RestConnection",xj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _j{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Bc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=mf(),c=this.zo(e,n.toUriEncodedString());ee(qd,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(c),m=to(d);return this.Jo(e,c,u,r,m).then(f=>(ee(qd,`Received RPC '${e}' ${o}: `,f),f),f=>{throw qi(qd,`RPC '${e}' ${o} failed with error: `,f,"url: ",c,"request:",r),f})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+io}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=xj[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt="WebChannelConnection";class bj extends _j{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=mf();return new Promise((c,u)=>{const d=new V_;d.setWithCredentials(!0),d.listenOnce(F_.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Zl.NO_ERROR:const f=d.getResponseJson();ee(yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),c(f);break;case Zl.TIMEOUT:ee(yt,`RPC '${e}' ${o} timed out`),u(new J($.DEADLINE_EXCEEDED,"Request time out"));break;case Zl.HTTP_ERROR:const g=d.getStatus();if(ee(yt,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const k=x==null?void 0:x.error;if(k&&k.status&&k.message){const j=function(b){const _=b.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(_)>=0?_:$.UNKNOWN}(k.status);u(new J(j,k.message))}else u(new J($.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new J($.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ee(yt,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(s);ee(yt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",m,r,15)})}T_(e,n,r){const s=mf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=z_(),c=B_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=i.join("");ee(yt,`Creating RPC '${e}' stream ${s}: ${m}`,u);const f=o.createWebChannel(m,u);this.I_(f);let g=!1,x=!1;const k=new Ej({Yo:E=>{x?ee(yt,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(g||(ee(yt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),ee(yt,`RPC '${e}' stream ${s} sending:`,E),f.send(E))},Zo:()=>f.close()}),j=(E,b,_)=>{E.listen(b,S=>{try{_(S)}catch(R){setTimeout(()=>{throw R},0)}})};return j(f,qo.EventType.OPEN,()=>{x||(ee(yt,`RPC '${e}' stream ${s} transport opened.`),k.o_())}),j(f,qo.EventType.CLOSE,()=>{x||(x=!0,ee(yt,`RPC '${e}' stream ${s} transport closed`),k.a_(),this.E_(f))}),j(f,qo.EventType.ERROR,E=>{x||(x=!0,qi(yt,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),k.a_(new J($.UNAVAILABLE,"The operation could not be completed")))}),j(f,qo.EventType.MESSAGE,E=>{var b;if(!x){const _=E.data[0];xe(!!_,16349);const S=_,R=(S==null?void 0:S.error)||((b=S[0])==null?void 0:b.error);if(R){ee(yt,`RPC '${e}' stream ${s} received error:`,R);const F=R.status;let B=function(T){const A=We[T];if(A!==void 0)return b1(A)}(F),y=R.message;B===void 0&&(B=$.INTERNAL,y="Unknown error status: "+F+" with message "+R.message),x=!0,k.a_(new J(B,y)),f.close()}else ee(yt,`RPC '${e}' stream ${s} received:`,_),k.u_(_)}}),j(c,U_.STAT_EVENT,E=>{E.stat===ef.PROXY?ee(yt,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===ef.NOPROXY&&ee(yt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.__()},0),k}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Hd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(t){return new NC(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="PersistentStream";class V1{constructor(e,n,r,s,i,o,c,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new O1(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(lr(n.toString()),lr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new J($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(q0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(q0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Tj extends V1{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=CC(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ue.min():o.readTime?Dn(o.readTime):ue.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=hf(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=of(u)?{documents:RC(i,u)}:{query:DC(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=S1(i,o.resumeToken);const d=cf(i,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(ue.min())>0){c.readTime=Hc(i,o.snapshotVersion.toTimestamp());const d=cf(i,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=MC(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=hf(this.serializer),n.removeTarget=e,this.q_(n)}}class Ij extends V1{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return xe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,xe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){xe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=PC(e.writeResults,e.commitTime),r=Dn(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=hf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>jC(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{}class Nj extends Sj{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new J($.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,uf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J($.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,uf(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new J($.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Aj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(lr(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="RemoteStore";class kj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Zs(this)&&(ee(Ws,"Restarting streams for network reachability change."),await async function(u){const d=de(u);d.Ea.add(4),await Ja(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Du(d)}(this))})}),this.Ra=new Aj(r,s)}}async function Du(t){if(Zs(t))for(const e of t.da)await e(!0)}async function Ja(t){for(const e of t.da)await e(!1)}function F1(t,e){const n=de(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Jm(n)?Xm(n):lo(n).O_()&&Ym(n,e))}function Qm(t,e){const n=de(t),r=lo(n);n.Ia.delete(e),r.O_()&&U1(n,e),n.Ia.size===0&&(r.O_()?r.L_():Zs(n)&&n.Ra.set("Unknown"))}function Ym(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}lo(t).Y_(e)}function U1(t,e){t.Va.Ue(e),lo(t).Z_(e)}function Xm(t){t.Va=new bC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),lo(t).start(),t.Ra.ua()}function Jm(t){return Zs(t)&&!lo(t).x_()&&t.Ia.size>0}function Zs(t){return de(t).Ea.size===0}function B1(t){t.Va=void 0}async function Cj(t){t.Ra.set("Online")}async function jj(t){t.Ia.forEach((e,n)=>{Ym(t,e)})}async function Pj(t,e){B1(t),Jm(t)?(t.Ra.ha(e),Xm(t)):t.Ra.set("Unknown")}async function Rj(t,e,n){if(t.Ra.set("Online"),e instanceof I1&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(r){ee(Ws,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gc(t,r)}else if(e instanceof rc?t.Va.Ze(e):e instanceof T1?t.Va.st(e):t.Va.tt(e),!n.isEqual(ue.min()))try{const r=await M1(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const m=i.Ia.get(d);m&&i.Ia.set(d,m.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const m=i.Ia.get(u);if(!m)return;i.Ia.set(u,m.withResumeToken(ht.EMPTY_BYTE_STRING,m.snapshotVersion)),U1(i,u);const f=new Fr(m.target,u,d,m.sequenceNumber);Ym(i,f)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ee(Ws,"Failed to raise snapshot:",r),await Gc(t,r)}}async function Gc(t,e,n){if(!ao(e))throw e;t.Ea.add(1),await Ja(t),t.Ra.set("Offline"),n||(n=()=>M1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(Ws,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Du(t)})}function z1(t,e){return e().catch(n=>Gc(t,n,e))}async function Lu(t){const e=de(t),n=os(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Dm;for(;Dj(e);)try{const s=await pj(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,Lj(e,s)}catch(s){await Gc(e,s)}$1(e)&&q1(e)}function Dj(t){return Zs(t)&&t.Ta.length<10}function Lj(t,e){t.Ta.push(e);const n=os(t);n.O_()&&n.X_&&n.ea(e.mutations)}function $1(t){return Zs(t)&&!os(t).x_()&&t.Ta.length>0}function q1(t){os(t).start()}async function Mj(t){os(t).ra()}async function Oj(t){const e=os(t);for(const n of t.Ta)e.ea(n.mutations)}async function Vj(t,e,n){const r=t.Ta.shift(),s=zm.from(r,e,n);await z1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Lu(t)}async function Fj(t,e){e&&os(t).X_&&await async function(r,s){if(function(o){return xC(o)&&o!==$.ABORTED}(s.code)){const i=r.Ta.shift();os(r).B_(),await z1(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Lu(r)}}(t,e),$1(t)&&q1(t)}async function H0(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),ee(Ws,"RemoteStore received new credentials");const r=Zs(n);n.Ea.add(3),await Ja(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Du(n)}async function Uj(t,e){const n=de(t);e?(n.Ea.delete(2),await Du(n)):e||(n.Ea.add(2),await Ja(n),n.Ra.set("Unknown"))}function lo(t){return t.ma||(t.ma=function(n,r,s){const i=de(n);return i.sa(),new Tj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:Cj.bind(null,t),t_:jj.bind(null,t),r_:Pj.bind(null,t),H_:Rj.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Jm(t)?Xm(t):t.Ra.set("Unknown")):(await t.ma.stop(),B1(t))})),t.ma}function os(t){return t.fa||(t.fa=function(n,r,s){const i=de(n);return i.sa(),new Ij(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Mj.bind(null,t),r_:Fj.bind(null,t),ta:Oj.bind(null,t),na:Vj.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Lu(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(Ws,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new Zm(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ep(t,e){if(lr("AsyncQueue",`${e}: ${t}`),ao(t))return new J($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{static emptySet(e){return new Li(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=Ho(),this.sortedSet=new Me(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Li)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Li;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(){this.ga=new Me(ie.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Yi{constructor(e,n,r,s,i,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Yi(e,n,Li.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Au(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class zj{constructor(){this.queries=G0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=de(n),i=s.queries;s.queries=G0(),i.forEach((o,c)=>{for(const u of c.Sa)u.onError(r)})})(this,new J($.ABORTED,"Firestore shutting down"))}}function G0(){return new Js(t=>u1(t),Au)}async function tp(t,e){const n=de(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new Bj,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=ep(o,`Initialization of query '${ci(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&rp(n)}async function np(t,e){const n=de(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function $j(t,e){const n=de(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(r=!0);o.wa=s}}r&&rp(n)}function qj(t,e,n){const r=de(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function rp(t){t.Ca.forEach(e=>{e.next()})}var pf,K0;(K0=pf||(pf={})).Ma="default",K0.Cache="cache";class sp{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Yi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Yi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e){this.key=e}}class W1{constructor(e){this.key=e}}class Hj{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ye(),this.mutatedKeys=ye(),this.eu=d1(e),this.tu=new Li(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new W0,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,f)=>{const g=s.get(m),x=ku(this.query,f)?f:null,k=!!g&&this.mutatedKeys.has(g.key),j=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let E=!1;g&&x?g.data.isEqual(x.data)?k!==j&&(r.track({type:3,doc:x}),E=!0):this.su(g,x)||(r.track({type:2,doc:x}),E=!0,(u&&this.eu(x,u)>0||d&&this.eu(x,d)<0)&&(c=!0)):!g&&x?(r.track({type:0,doc:x}),E=!0):g&&!x&&(r.track({type:1,doc:g}),E=!0,(u||d)&&(c=!0)),E&&(x?(o=o.add(x),i=j?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{tu:o,iu:r,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((m,f)=>function(x,k){const j=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:E})}};return j(x)-j(k)}(m.type,f.type)||this.eu(m.doc,f.doc)),this.ou(r),s=s??!1;const c=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Yi(this.query,e.tu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new W0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ye(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new W1(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new H1(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ye();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Yi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ip="SyncEngine";class Wj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Gj{constructor(e){this.key=e,this.hu=!1}}class Kj{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Js(c=>u1(c),Au),this.Iu=new Map,this.Eu=new Set,this.du=new Me(ie.comparator),this.Au=new Map,this.Ru=new Hm,this.Vu={},this.mu=new Map,this.fu=Qi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Qj(t,e,n=!0){const r=J1(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await G1(r,e,n,!0),s}async function Yj(t,e){const n=J1(t);await G1(n,e,!0,!1)}async function G1(t,e,n,r){const s=await gj(t.localStore,Rn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await Xj(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&F1(t.remoteStore,s),c}async function Xj(t,e,n,r,s){t.pu=(f,g,x)=>async function(j,E,b,_){let S=E.view.ru(b);S.Cs&&(S=await U0(j.localStore,E.query,!1).then(({documents:y})=>E.view.ru(y,S)));const R=_&&_.targetChanges.get(E.targetId),F=_&&_.targetMismatches.get(E.targetId)!=null,B=E.view.applyChanges(S,j.isPrimaryClient,R,F);return Y0(j,E.targetId,B.au),B.snapshot}(t,f,g,x);const i=await U0(t.localStore,e,!0),o=new Hj(e,i.Qs),c=o.ru(i.documents),u=Xa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);Y0(t,n,d.au);const m=new Wj(e,n,o);return t.Tu.set(e,m),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function Jj(t,e,n){const r=de(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Au(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ff(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Qm(r.remoteStore,s.targetId),gf(r,s.targetId)}).catch(oo)):(gf(r,s.targetId),await ff(r.localStore,s.targetId,!0))}async function Zj(t,e){const n=de(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Qm(n.remoteStore,r.targetId))}async function eP(t,e,n){const r=aP(t);try{const s=await function(o,c){const u=de(o),d=Ce.now(),m=c.reduce((x,k)=>x.add(k.key),ye());let f,g;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let k=cr(),j=ye();return u.Ns.getEntries(x,m).next(E=>{k=E,k.forEach((b,_)=>{_.isValidDocument()||(j=j.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,k)).next(E=>{f=E;const b=[];for(const _ of c){const S=pC(_,f.get(_.key).overlayedDocument);S!=null&&b.push(new ms(_.key,S,n1(S.value.mapValue),rn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,b,c)}).next(E=>{g=E;const b=E.applyToLocalDocumentSet(f,j);return u.documentOverlayCache.saveOverlays(x,E.batchId,b)})}).then(()=>({batchId:g.batchId,changes:f1(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new Me(ge)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Za(r,s.changes),await Lu(r.remoteStore)}catch(s){const i=ep(s,"Failed to persist write");n.reject(i)}}async function K1(t,e){const n=de(t);try{const r=await fj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(xe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?xe(o.hu,14607):s.removedDocuments.size>0&&(xe(o.hu,42227),o.hu=!1))}),await Za(n,r,e)}catch(r){await oo(r)}}function Q0(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=de(o);u.onlineState=c;let d=!1;u.queries.forEach((m,f)=>{for(const g of f.Sa)g.va(c)&&(d=!0)}),d&&rp(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tP(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Me(ie.comparator);o=o.insert(i,_t.newNoDocument(i,ue.min()));const c=ye().add(i),u=new Pu(ue.min(),new Map,new Me(ge),o,c);await K1(r,u),r.du=r.du.remove(i),r.Au.delete(e),op(r)}else await ff(r.localStore,e,!1).then(()=>gf(r,e,n)).catch(oo)}async function nP(t,e){const n=de(t),r=e.batch.batchId;try{const s=await hj(n.localStore,e);Y1(n,r,null),Q1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Za(n,s)}catch(s){await oo(s)}}async function rP(t,e,n){const r=de(t);try{const s=await function(o,c){const u=de(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,c).next(f=>(xe(f!==null,37113),m=f.keys(),u.mutationQueue.removeMutationBatch(d,f))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(r.localStore,e);Y1(r,e,n),Q1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Za(r,s)}catch(s){await oo(s)}}function Q1(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Y1(t,e,n){const r=de(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function gf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||X1(t,r)})}function X1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Qm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),op(t))}function Y0(t,e,n){for(const r of n)r instanceof H1?(t.Ru.addReference(r.key,e),sP(t,r)):r instanceof W1?(ee(ip,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||X1(t,r.key)):le(19791,{wu:r})}function sP(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(ip,"New document in limbo: "+n),t.Eu.add(r),op(t))}function op(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ie(Te.fromString(e)),r=t.fu.next();t.Au.set(r,new Gj(n)),t.du=t.du.insert(n,r),F1(t.remoteStore,new Fr(Rn(Nu(n.path)),r,"TargetPurposeLimboResolution",Tu.ce))}}async function Za(t,e,n){const r=de(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{o.push(r.pu(u,e,n).then(d=>{var m;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Gm.As(u.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,d){const m=de(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>H.forEach(d,g=>H.forEach(g.Es,x=>m.persistence.referenceDelegate.addReference(f,g.targetId,x)).next(()=>H.forEach(g.ds,x=>m.persistence.referenceDelegate.removeReference(f,g.targetId,x)))))}catch(f){if(!ao(f))throw f;ee(Km,"Failed to update sequence numbers: "+f)}for(const f of d){const g=f.targetId;if(!f.fromCache){const x=m.Ms.get(g),k=x.snapshotVersion,j=x.withLastLimboFreeSnapshotVersion(k);m.Ms=m.Ms.insert(g,j)}}}(r.localStore,i))}async function iP(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){ee(ip,"User change. New user:",e.toKey());const r=await L1(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new J($.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Za(n,r.Ls)}}function oP(t,e){const n=de(t),r=n.Au.get(e);if(r&&r.hu)return ye().add(r.key);{let s=ye();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const c=n.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function J1(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=K1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tP.bind(null,e),e.Pu.H_=$j.bind(null,e.eventManager),e.Pu.yu=qj.bind(null,e.eventManager),e}function aP(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rP.bind(null,e),e}class Kc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ru(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return dj(this.persistence,new lj,e.initialUser,this.serializer)}Cu(e){return new D1(Wm.mi,this.serializer)}Du(e){return new vj}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Kc.provider={build:()=>new Kc};class lP extends Kc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){xe(this.persistence.referenceDelegate instanceof Wc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new GC(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new D1(r=>Wc.mi(r,n),this.serializer)}}class yf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Q0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=iP.bind(null,this.syncEngine),await Uj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new zj}()}createDatastore(e){const n=Ru(e.databaseInfo.databaseId),r=function(i){return new bj(i)}(e.databaseInfo);return function(i,o,c,u){return new Nj(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new kj(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Q0(this.syncEngine,n,0),function(){return $0.v()?new $0:new wj}())}createSyncEngine(e,n){return function(s,i,o,c,u,d,m){const f=new Kj(s,i,o,c,u,d);return m&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=de(s);ee(Ws,"RemoteStore shutting down."),i.Ea.add(5),await Ja(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}yf.provider={build:()=>new yf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):lr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const as="FirestoreClient";class cP{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=vt.UNAUTHENTICATED,this.clientId=Rm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ee(as,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(as,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ep(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Wd(t,e){t.asyncQueue.verifyOperationInProgress(),ee(as,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await L1(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function X0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await uP(t);ee(as,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>H0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>H0(e.remoteStore,s)),t._onlineComponents=e}async function uP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(as,"Using user provided OfflineComponentProvider");try{await Wd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===$.FAILED_PRECONDITION||s.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;qi("Error using user provided cache. Falling back to memory cache: "+n),await Wd(t,new Kc)}}else ee(as,"Using default OfflineComponentProvider"),await Wd(t,new lP(void 0));return t._offlineComponents}async function Z1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(as,"Using user provided OnlineComponentProvider"),await X0(t,t._uninitializedComponentsProvider._online)):(ee(as,"Using default OnlineComponentProvider"),await X0(t,new yf))),t._onlineComponents}function dP(t){return Z1(t).then(e=>e.syncEngine)}async function Qc(t){const e=await Z1(t),n=e.eventManager;return n.onListen=Qj.bind(null,e.syncEngine),n.onUnlisten=Jj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Yj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Zj.bind(null,e.syncEngine),n}function hP(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const m=new ap({next:g=>{m.Nu(),o.enqueueAndForget(()=>np(i,f));const x=g.docs.has(c);!x&&g.fromCache?d.reject(new J($.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&u&&u.source==="server"?d.reject(new J($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),f=new sp(Nu(c.path),m,{includeMetadataChanges:!0,qa:!0});return tp(i,f)}(await Qc(t),t.asyncQueue,e,n,r)),r.promise}function fP(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const m=new ap({next:g=>{m.Nu(),o.enqueueAndForget(()=>np(i,f)),g.fromCache&&u.source==="server"?d.reject(new J($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),f=new sp(c,m,{includeMetadataChanges:!0,qa:!0});return tp(i,f)}(await Qc(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="firestore.googleapis.com",Z0=!0;class ev{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new J($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=t2,this.ssl=Z0}else this.host=e.host,this.ssl=e.ssl??Z0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=R1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HC)throw new J($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ck("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=e2(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new J($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new J($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new J($.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Mu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ev({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ev(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new xk;switch(r.type){case"firstParty":return new Tk(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=J0.get(n);r&&(ee("ComponentProvider","Removing Datastore"),J0.delete(n),r.terminate())}(this),Promise.resolve()}}function mP(t,e,n,r={}){var d;t=Vt(t,Mu);const s=to(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;s&&(qx(`https://${c}`),Hx("Firestore",!0)),i.host!==t2&&i.host!==c&&qi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:r};if(!ts(u,o)&&(t._setSettings(u),r.mockUserToken)){let m,f;if(typeof r.mockUserToken=="string")m=r.mockUserToken,f=vt.MOCK_USER;else{m=LI(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new J($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new vt(g)}t._authCredentials=new _k(new q_(m,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ei(this.firestore,e,this._query)}}class Be{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Be(this.firestore,e,this._key)}toJSON(){return{type:Be._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Ka(n,Be._jsonSchema))return new Be(e,r||null,new ie(Te.fromString(n.referencePath)))}}Be._jsonSchemaVersion="firestore/documentReference/1.0",Be._jsonSchema={type:Ye("string",Be._jsonSchemaVersion),referencePath:Ye("string")};class Yr extends ei{constructor(e,n,r){super(e,n,Nu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new ie(e))}withConverter(e){return new Yr(this.firestore,e,this._path)}}function Ge(t,e,...n){if(t=ze(t),H_("collection","path",e),t instanceof Mu){const r=Te.fromString(e,...n);return f0(r),new Yr(t,null,r)}{if(!(t instanceof Be||t instanceof Yr))throw new J($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Te.fromString(e,...n));return f0(r),new Yr(t.firestore,null,r)}}function ke(t,e,...n){if(t=ze(t),arguments.length===1&&(e=Rm.newId()),H_("doc","path",e),t instanceof Mu){const r=Te.fromString(e,...n);return h0(r),new Be(t,null,new ie(r))}{if(!(t instanceof Be||t instanceof Yr))throw new J($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Te.fromString(e,...n));return h0(r),new Be(t.firestore,t instanceof Yr?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv="AsyncQueue";class nv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new O1(this,"async_queue_retry"),this._c=()=>{const r=Hd();r&&ee(tv,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Hd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Hd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Zn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ao(e))throw e;ee(tv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,lr("INTERNAL UNHANDLED ERROR: ",rv(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Zm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&le(47125,{Pc:rv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function rv(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ur extends Mu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new nv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nv(e),this._firestoreClient=void 0,await e}}}function n2(t,e){const n=typeof t=="object"?t:bm(),r=typeof t=="string"?t:Bc,s=no(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=RI("firestore");i&&mP(s,...i)}return s}function Ou(t){if(t._terminated)throw new J($.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||pP(t),t._firestoreClient}function pP(t){var r,s,i;const e=t._freezeSettings(),n=function(c,u,d,m){return new Bk(c,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,e2(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new cP(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zt(ht.fromBase64String(e))}catch(n){throw new J($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Zt(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ka(e,Zt._jsonSchema))return Zt.fromBase64String(e.bytes)}}Zt._jsonSchemaVersion="firestore/bytes/1.0",Zt._jsonSchema={type:Ye("string",Zt._jsonSchemaVersion),bytes:Ye("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new J($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ge(this._lat,e._lat)||ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ln._jsonSchemaVersion}}static fromJSON(e){if(Ka(e,Ln._jsonSchema))return new Ln(e.latitude,e.longitude)}}Ln._jsonSchemaVersion="firestore/geoPoint/1.0",Ln._jsonSchema={type:Ye("string",Ln._jsonSchemaVersion),latitude:Ye("number"),longitude:Ye("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Mn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ka(e,Mn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Mn(e.vectorValues);throw new J($.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Mn._jsonSchemaVersion="firestore/vectorValue/1.0",Mn._jsonSchema={type:Ye("string",Mn._jsonSchemaVersion),vectorValues:Ye("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=/^__.*__$/;class yP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ms(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ya(e,this.data,n,this.fieldTransforms)}}class r2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ms(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function s2(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class Fu{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Fu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Yc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(s2(this.Ac)&&gP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class vP{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ru(e)}Cc(e,n,r,s=!1){return new Fu({Ac:e,methodName:n,Dc:r,path:ct.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uu(t){const e=t._freezeSettings(),n=Ru(t._databaseId);return new vP(t._databaseId,!!e.ignoreUndefinedProperties,n)}function i2(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);dp("Data must be an object, but it was:",o,r);const c=o2(r,o);let u,d;if(i.merge)u=new qt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const f of i.mergeFields){const g=vf(e,f,n);if(!o.contains(g))throw new J($.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);l2(m,g)||m.push(g)}u=new qt(m),d=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,d=o.fieldTransforms;return new yP(new Rt(c),u,d)}class Bu extends co{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bu}}function wP(t,e,n){return new Fu({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class lp extends co{_toFieldTransform(e){return new Um(e.path,new Ra)}isEqual(e){return e instanceof lp}}class cp extends co{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=wP(this,e,!0),r=this.vc.map(i=>uo(i,n)),s=new Ki(r);return new Um(e.path,s)}isEqual(e){return e instanceof cp&&ts(this.vc,e.vc)}}class up extends co{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new La(e.serializer,g1(e.serializer,this.Fc));return new Um(e.path,n)}isEqual(e){return e instanceof up&&this.Fc===e.Fc}}function xP(t,e,n,r){const s=t.Cc(1,e,n);dp("Data must be an object, but it was:",s,r);const i=[],o=Rt.empty();fs(r,(u,d)=>{const m=hp(e,u,n);d=ze(d);const f=s.yc(m);if(d instanceof Bu)i.push(m);else{const g=uo(d,f);g!=null&&(i.push(m),o.set(m,g))}});const c=new qt(i);return new r2(o,c,s.fieldTransforms)}function _P(t,e,n,r,s,i){const o=t.Cc(1,e,n),c=[vf(e,r,n)],u=[s];if(i.length%2!=0)throw new J($.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(vf(e,i[g])),u.push(i[g+1]);const d=[],m=Rt.empty();for(let g=c.length-1;g>=0;--g)if(!l2(d,c[g])){const x=c[g];let k=u[g];k=ze(k);const j=o.yc(x);if(k instanceof Bu)d.push(x);else{const E=uo(k,j);E!=null&&(d.push(x),m.set(x,E))}}const f=new qt(d);return new r2(m,f,o.fieldTransforms)}function EP(t,e,n,r=!1){return uo(n,t.Cc(r?4:3,e))}function uo(t,e){if(a2(t=ze(t)))return dp("Unsupported field value:",e,t),o2(t,e);if(t instanceof co)return function(r,s){if(!s2(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=uo(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return g1(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ce.fromDate(r);return{timestampValue:Hc(s.serializer,i)}}if(r instanceof Ce){const i=new Ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Hc(s.serializer,i)}}if(r instanceof Ln)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zt)return{bytesValue:S1(s.serializer,r._byteString)};if(r instanceof Be){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:qm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Mn)return function(o,c){return{mapValue:{fields:{[e1]:{stringValue:t1},[zc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Fm(c.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${bu(r)}`)}(t,e)}function o2(t,e){const n={};return K_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fs(t,(r,s)=>{const i=uo(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function a2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ce||t instanceof Ln||t instanceof Zt||t instanceof Be||t instanceof co||t instanceof Mn)}function dp(t,e,n){if(!a2(n)||!W_(n)){const r=bu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function vf(t,e,n){if((e=ze(e))instanceof Vu)return e._internalPath;if(typeof e=="string")return hp(t,e);throw Yc("Field path arguments must be of type string or ",t,!1,void 0,n)}const bP=new RegExp("[~\\*/\\[\\]]");function hp(t,e,n){if(e.search(bP)>=0)throw Yc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Vu(...e.split("."))._internalPath}catch{throw Yc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new J($.INVALID_ARGUMENT,c+t+u)}function l2(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(fp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class TP extends c2{data(){return super.data()}}function fp(t,e){return typeof e=="string"?hp(t,e):e instanceof Vu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new J($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mp{}class IP extends mp{}function Sn(t,e,...n){let r=[];e instanceof mp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof pp).length,c=i.filter(u=>u instanceof zu).length;if(o>1||o>0&&c>0)throw new J($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class zu extends IP{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new zu(e,n,r)}_apply(e){const n=this._parse(e);return d2(e._query,n),new ei(e.firestore,e.converter,af(e._query,n))}_parse(e){const n=Uu(e.firestore);return function(i,o,c,u,d,m,f){let g;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new J($.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){ov(f,m);const k=[];for(const j of f)k.push(iv(u,i,j));g={arrayValue:{values:k}}}else g=iv(u,i,f)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||ov(f,m),g=EP(c,o,f,m==="in"||m==="not-in");return Qe.create(d,m,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Mi(t,e,n){const r=e,s=fp("where",t);return zu._create(s,r,n)}class pp extends mp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new pp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:wn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)d2(o,u),o=af(o,u)}(e._query,n),new ei(e.firestore,e.converter,af(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function iv(t,e,n){if(typeof(n=ze(n))=="string"){if(n==="")throw new J($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!c1(e)&&n.indexOf("/")!==-1)throw new J($.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Te.fromString(n));if(!ie.isDocumentKey(r))throw new J($.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _0(t,new ie(r))}if(n instanceof Be)return _0(t,n._key);throw new J($.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bu(n)}.`)}function ov(t,e){if(!Array.isArray(t)||t.length===0)throw new J($.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function d2(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new J($.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J($.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class SP{convertValue(e,n="none"){switch(is(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return fs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[zc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>$e(o.doubleValue));return new Mn(n)}convertGeoPoint(e){return new Ln($e(e.latitude),$e(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Su(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ca(e));default:return null}}convertTimestamp(e){const n=rs(e);return new Ce(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Te.fromString(e);xe(P1(r),9688,{name:e});const s=new ja(r.get(1),r.get(3)),i=new ie(r.popFirst(5));return s.isEqual(n)||lr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Go{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ms extends c2{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(fp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new J($.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ms._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ms._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ms._jsonSchema={type:Ye("string",Ms._jsonSchemaVersion),bundleSource:Ye("string","DocumentSnapshot"),bundleName:Ye("string"),bundle:Ye("string")};class sc extends Ms{data(e={}){return super.data(e)}}class Os{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Go(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sc(this._firestore,this._userDataWriter,r.key,r,new Go(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new sc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Go(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new sc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Go(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,m=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:NP(c.type),doc:u,oldIndex:d,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new J($.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Os._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Rm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xc(t){t=Vt(t,Be);const e=Vt(t.firestore,ur);return hP(Ou(e),t._key).then(n=>p2(e,t,n))}Os._jsonSchemaVersion="firestore/querySnapshot/1.0",Os._jsonSchema={type:Ye("string",Os._jsonSchemaVersion),bundleSource:Ye("string","QuerySnapshot"),bundleName:Ye("string"),bundle:Ye("string")};class gp extends SP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,n)}}function f2(t){t=Vt(t,ei);const e=Vt(t.firestore,ur),n=Ou(e),r=new gp(e);return u2(t._query),fP(n,t._query).then(s=>new Os(e,r,t,s))}function m2(t,e,n){t=Vt(t,Be);const r=Vt(t.firestore,ur),s=h2(t.converter,e);return $u(r,[i2(Uu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,rn.none())])}function st(t,e,n,...r){t=Vt(t,Be);const s=Vt(t.firestore,ur),i=Uu(s);let o;return o=typeof(e=ze(e))=="string"||e instanceof Vu?_P(i,"updateDoc",t._key,e,n,r):xP(i,"updateDoc",t._key,e),$u(s,[o.toMutation(t._key,rn.exists(!0))])}function Jc(t){return $u(Vt(t.firestore,ur),[new Bm(t._key,rn.none())])}function Nn(t,e){const n=Vt(t.firestore,ur),r=ke(t),s=h2(t.converter,e);return $u(n,[i2(Uu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,rn.exists(!1))]).then(()=>r)}function An(t,...e){var u,d,m;t=ze(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||sv(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(sv(e[r])){const f=e[r];e[r]=(u=f.next)==null?void 0:u.bind(f),e[r+1]=(d=f.error)==null?void 0:d.bind(f),e[r+2]=(m=f.complete)==null?void 0:m.bind(f)}let i,o,c;if(t instanceof Be)o=Vt(t.firestore,ur),c=Nu(t._key.path),i={next:f=>{e[r]&&e[r](p2(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=Vt(t,ei);o=Vt(f.firestore,ur),c=f._query;const g=new gp(o);i={next:x=>{e[r]&&e[r](new Os(o,g,f,x))},error:e[r+1],complete:e[r+2]},u2(t._query)}return function(g,x,k,j){const E=new ap(j),b=new sp(x,E,k);return g.asyncQueue.enqueueAndForget(async()=>tp(await Qc(g),b)),()=>{E.Nu(),g.asyncQueue.enqueueAndForget(async()=>np(await Qc(g),b))}}(Ou(o),c,s,i)}function $u(t,e){return function(r,s){const i=new Zn;return r.asyncQueue.enqueueAndForget(async()=>eP(await dP(r),s,i)),i.promise}(Ou(t),e)}function p2(t,e,n){const r=n.docs.get(e._key),s=new gp(t);return new Ms(t,s,e._key,r,new Go(n.hasPendingWrites,n.fromCache),e.converter)}function wt(){return new lp("serverTimestamp")}function Zc(...t){return new cp("arrayUnion",t)}function eu(t){return new up("increment",t)}(function(e,n=!0){(function(s){io=s})(ro),On(new yn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new ur(new Ek(r.getProvider("auth-internal")),new Ik(o,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new J($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ja(d.options.projectId,m)}(o,s),o);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),nn(l0,c0,e),nn(l0,c0,"esm2020")})();const g2="@firebase/installations",yp="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=1e4,v2=`w:${yp}`,w2="FIS_v2",AP="https://firebaseinstallations.googleapis.com/v1",kP=60*60*1e3,CP="installations",jP="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Gs=new Xs(CP,jP,PP);function x2(t){return t instanceof Fn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _2({projectId:t}){return`${AP}/projects/${t}/installations`}function E2(t){return{token:t.token,requestStatus:2,expiresIn:DP(t.expiresIn),creationTime:Date.now()}}async function b2(t,e){const r=(await e.json()).error;return Gs.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function T2({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function RP(t,{refreshToken:e}){const n=T2(t);return n.append("Authorization",LP(e)),n}async function I2(t){const e=await t();return e.status>=500&&e.status<600?t():e}function DP(t){return Number(t.replace("s","000"))}function LP(t){return`${w2} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MP({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=_2(t),s=T2(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:w2,appId:t.appId,sdkVersion:v2},c={method:"POST",headers:s,body:JSON.stringify(o)},u=await I2(()=>fetch(r,c));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:E2(d.authToken)}}else throw await b2("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S2(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP=/^[cdef][\w-]{21}$/,wf="";function FP(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=UP(t);return VP.test(n)?n:wf}catch{return wf}}function UP(t){return OP(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2=new Map;function A2(t,e){const n=qu(t);k2(n,e),BP(n,e)}function k2(t,e){const n=N2.get(t);if(n)for(const r of n)r(e)}function BP(t,e){const n=zP();n&&n.postMessage({key:t,fid:e}),$P()}let Rs=null;function zP(){return!Rs&&"BroadcastChannel"in self&&(Rs=new BroadcastChannel("[Firebase] FID Change"),Rs.onmessage=t=>{k2(t.data.key,t.data.fid)}),Rs}function $P(){N2.size===0&&Rs&&(Rs.close(),Rs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP="firebase-installations-database",HP=1,Ks="firebase-installations-store";let Gd=null;function vp(){return Gd||(Gd=wu(qP,HP,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ks)}}})),Gd}async function tu(t,e){const n=qu(t),s=(await vp()).transaction(Ks,"readwrite"),i=s.objectStore(Ks),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&A2(t,e.fid),e}async function C2(t){const e=qu(t),r=(await vp()).transaction(Ks,"readwrite");await r.objectStore(Ks).delete(e),await r.done}async function Hu(t,e){const n=qu(t),s=(await vp()).transaction(Ks,"readwrite"),i=s.objectStore(Ks),o=await i.get(n),c=e(o);return c===void 0?await i.delete(n):await i.put(c,n),await s.done,c&&(!o||o.fid!==c.fid)&&A2(t,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wp(t){let e;const n=await Hu(t.appConfig,r=>{const s=WP(r),i=GP(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===wf?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function WP(t){const e=t||{fid:FP(),registrationStatus:0};return j2(e)}function GP(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Gs.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=KP(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:QP(t)}:{installationEntry:e}}async function KP(t,e){try{const n=await MP(t,e);return tu(t.appConfig,n)}catch(n){throw x2(n)&&n.customData.serverCode===409?await C2(t.appConfig):await tu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function QP(t){let e=await av(t.appConfig);for(;e.registrationStatus===1;)await S2(100),e=await av(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await wp(t);return r||n}return e}function av(t){return Hu(t,e=>{if(!e)throw Gs.create("installation-not-found");return j2(e)})}function j2(t){return YP(t)?{fid:t.fid,registrationStatus:0}:t}function YP(t){return t.registrationStatus===1&&t.registrationTime+y2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XP({appConfig:t,heartbeatServiceProvider:e},n){const r=JP(t,n),s=RP(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:v2,appId:t.appId}},c={method:"POST",headers:s,body:JSON.stringify(o)},u=await I2(()=>fetch(r,c));if(u.ok){const d=await u.json();return E2(d)}else throw await b2("Generate Auth Token",u)}function JP(t,{fid:e}){return`${_2(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xp(t,e=!1){let n;const r=await Hu(t.appConfig,i=>{if(!P2(i))throw Gs.create("not-registered");const o=i.authToken;if(!e&&t5(o))return i;if(o.requestStatus===1)return n=ZP(t,e),i;{if(!navigator.onLine)throw Gs.create("app-offline");const c=r5(i);return n=e5(t,c),c}});return n?await n:r.authToken}async function ZP(t,e){let n=await lv(t.appConfig);for(;n.authToken.requestStatus===1;)await S2(100),n=await lv(t.appConfig);const r=n.authToken;return r.requestStatus===0?xp(t,e):r}function lv(t){return Hu(t,e=>{if(!P2(e))throw Gs.create("not-registered");const n=e.authToken;return s5(n)?{...e,authToken:{requestStatus:0}}:e})}async function e5(t,e){try{const n=await XP(t,e),r={...e,authToken:n};return await tu(t.appConfig,r),n}catch(n){if(x2(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await C2(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await tu(t.appConfig,r)}throw n}}function P2(t){return t!==void 0&&t.registrationStatus===2}function t5(t){return t.requestStatus===2&&!n5(t)}function n5(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+kP}function r5(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function s5(t){return t.requestStatus===1&&t.requestTime+y2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i5(t){const e=t,{installationEntry:n,registrationPromise:r}=await wp(e);return r?r.catch(console.error):xp(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o5(t,e=!1){const n=t;return await a5(n),(await xp(n,e)).token}async function a5(t){const{registrationPromise:e}=await wp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(t){if(!t||!t.options)throw Kd("App Configuration");if(!t.name)throw Kd("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Kd(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Kd(t){return Gs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2="installations",c5="installations-internal",u5=t=>{const e=t.getProvider("app").getImmediate(),n=l5(e),r=no(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},d5=t=>{const e=t.getProvider("app").getImmediate(),n=no(e,R2).getImmediate();return{getId:()=>i5(n),getToken:s=>o5(n,s)}};function h5(){On(new yn(R2,u5,"PUBLIC")),On(new yn(c5,d5,"PRIVATE"))}h5();nn(g2,yp);nn(g2,yp,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5="/firebase-messaging-sw.js",m5="/firebase-cloud-messaging-push-scope",D2="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",p5="https://fcmregistrations.googleapis.com/v1",L2="google.c.a.c_id",g5="google.c.a.c_l",y5="google.c.a.ts",v5="google.c.a.e",cv=1e4;var uv;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(uv||(uv={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Ma;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Ma||(Ma={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function w5(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="fcm_token_details_db",x5=5,dv="fcm_token_object_Store";async function _5(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Qd))return null;let e=null;return(await wu(Qd,x5,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(dv))return;const c=o.objectStore(dv),u=await c.index("fcmSenderId").get(t);if(await c.clear(),!!u){if(s===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Bn(d.vapidKey)}}}else if(s===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bn(d.auth),p256dh:Bn(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bn(d.vapidKey)}}}else if(s===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Bn(d.auth),p256dh:Bn(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Bn(d.vapidKey)}}}}}})).close(),await Od(Qd),await Od("fcm_vapid_details_db"),await Od("undefined"),E5(e)?e:null}function E5(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5="firebase-messaging-database",T5=1,Oa="firebase-messaging-store";let Yd=null;function M2(){return Yd||(Yd=wu(b5,T5,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Oa)}}})),Yd}async function I5(t){const e=O2(t),r=await(await M2()).transaction(Oa).objectStore(Oa).get(e);if(r)return r;{const s=await _5(t.appConfig.senderId);if(s)return await _p(t,s),s}}async function _p(t,e){const n=O2(t),s=(await M2()).transaction(Oa,"readwrite");return await s.objectStore(Oa).put(e,n),await s.done,e}function O2({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Et=new Xs("messaging","Messaging",S5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N5(t,e){const n=await bp(t),r=V2(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(Ep(t.appConfig),s)).json()}catch(o){throw Et.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Et.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw Et.create("token-subscribe-no-token");return i.token}async function A5(t,e){const n=await bp(t),r=V2(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${Ep(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw Et.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Et.create("token-update-failed",{errorInfo:o})}if(!i.token)throw Et.create("token-update-no-token");return i.token}async function k5(t,e){const r={method:"DELETE",headers:await bp(t)};try{const i=await(await fetch(`${Ep(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw Et.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw Et.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function Ep({projectId:t}){return`${p5}/projects/${t}/registrations`}async function bp({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function V2({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==D2&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C5=7*24*60*60*1e3;async function j5(t){const e=await R5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Bn(e.getKey("auth")),p256dh:Bn(e.getKey("p256dh"))},r=await I5(t.firebaseDependencies);if(r){if(D5(r.subscriptionOptions,n))return Date.now()>=r.createTime+C5?P5(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await k5(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return hv(t.firebaseDependencies,n)}else return hv(t.firebaseDependencies,n)}async function P5(t,e){try{const n=await A5(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await _p(t.firebaseDependencies,r),n}catch(n){throw n}}async function hv(t,e){const r={token:await N5(t,e),createTime:Date.now(),subscriptionOptions:e};return await _p(t,r),r.token}async function R5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:w5(e)})}function D5(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return L5(e,t),M5(e,t),O5(e,t),e}function L5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function M5(t,e){e.data&&(t.data=e.data)}function O5(t,e){var s,i,o,c;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(c=e.fcmOptions)==null?void 0:c.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V5(t){return typeof t=="object"&&!!t&&L2 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(t){if(!t||!t.options)throw Xd("App Configuration Object");if(!t.name)throw Xd("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Xd(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Xd(t){return Et.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U5{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=F5(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5(t){try{t.swRegistration=await navigator.serviceWorker.register(f5,{scope:m5}),t.swRegistration.update().catch(()=>{}),await z5(t.swRegistration)}catch(e){throw Et.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function z5(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${cv} ms`)),cv),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $5(t,e){if(!e&&!t.swRegistration&&await B5(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Et.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q5(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=D2)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F2(t,e){if(!navigator)throw Et.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Et.create("permission-blocked");return await q5(t,e==null?void 0:e.vapidKey),await $5(t,e==null?void 0:e.serviceWorkerRegistration),j5(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H5(t,e,n){const r=W5(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[L2],message_name:n[g5],message_time:n[y5],message_device_time:Math.floor(Date.now()/1e3)})}function W5(t){switch(t){case Ma.NOTIFICATION_CLICKED:return"notification_open";case Ma.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G5(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Ma.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(fv(n)):t.onMessageHandler.next(fv(n)));const r=n.data;V5(r)&&r[v5]==="1"&&await H5(t,n.messageType,r)}const mv="@firebase/messaging",pv="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5=t=>{const e=new U5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>G5(e,n)),e},Q5=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>F2(e,r)}};function Y5(){On(new yn("messaging",K5,"PUBLIC")),On(new yn("messaging-internal",Q5,"PRIVATE")),nn(mv,pv),nn(mv,pv,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X5(){try{await Gx()}catch{return!1}return typeof window<"u"&&Wx()&&HI()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J5(t,e){if(!navigator)throw Et.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t=bm()){return X5().then(e=>{if(!e)throw Et.create("unsupported-browser")},e=>{throw Et.create("indexed-db-unsupported")}),no(ze(t),"messaging").getImmediate()}async function B2(t,e){return t=ze(t),F2(t,e)}function z2(t,e){return t=ze(t),J5(t,e)}Y5();const Z5={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},Tp=Em(Z5),Ts=M_(Tp),Ve=n2(Tp),Dl=typeof window<"u"?U2(Tp):null,Ut=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],gv=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Ut[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Ut[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Ut[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Ut[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Ut[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Ut[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Ut[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Ut[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Ut[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Ut[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Ut[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Ut[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Ut[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],eR=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[c,u]=P.useState(0),[d,m]=P.useState(!1),[f,g]=P.useState(!1),x=P.useRef(null);P.useEffect(()=>()=>{x.current&&clearTimeout(x.current)},[]),P.useEffect(()=>{const S=R=>{R.key==="Escape"&&n()};return window.addEventListener("keydown",S),()=>{window.removeEventListener("keydown",S)}},[n]);const k=async()=>{d||(f?(x.current&&(clearTimeout(x.current),x.current=null),m(!0),await i(t.id)||(m(!1),g(!1))):(g(!0),x.current=window.setTimeout(()=>{g(!1),x.current=null},4e3)))},j=(e==null?void 0:e.role)==="admin",E=(e==null?void 0:e.id)===t.seller.id,b=t.imageUrls&&t.imageUrls.length>0,_=S=>typeof S!="number"||isNaN(S)?"N/A":S.toFixed(2);return a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[a.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:S=>S.stopPropagation(),children:[a.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:a.jsx(ir,{className:"w-6 h-6"})}),a.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[a.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:b&&a.jsx("img",{src:t.imageUrls[c],alt:`${t.title} - imatge ${c+1}`,className:`w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer ${t.tag==="vendido"?"grayscale":""}`,onClick:()=>o(t.imageUrls,c)})}),b&&t.imageUrls.length>1&&a.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((S,R)=>a.jsx("button",{onClick:()=>u(R),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${c===R?"border-primary":"border-transparent hover:border-gray-400"}`,children:a.jsx("img",{src:S,alt:`miniatura ${R+1}`,className:`w-full h-full object-cover ${t.tag==="vendido"?"grayscale":""}`})},R))})]}),a.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[t.tag&&Hn[t.tag]&&a.jsxs("div",{className:`w-fit text-sm font-semibold px-3 py-1 rounded-full mb-3 ${Hn[t.tag].className}`,children:[Hn[t.tag].emoji," ",Hn[t.tag].label]}),a.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),a.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[_(t.price)," "]}),a.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),a.jsx("div",{children:a.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),a.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),a.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&!t.hideOrderButton&&a.jsxs("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLSfux48JDT3BFqAlhNqPfM5BirPosepNYO_88zz1fwWk-Gmwwg/viewform",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[a.jsx(Mx,{className:"w-5 h-5"}),a.jsx("span",{children:"Realitzar comanda"})]}),!E&&e&&(t.isMerchandise?!t.hideContactButton&&a.jsxs("a",{href:`mailto:robaesportiva@handbolmolins.cat?subject=${encodeURIComponent("Consulta sobre: "+t.title)}`,className:"w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors bg-gray-600 text-white hover:bg-gray-700",children:[a.jsx(qh,{className:"w-5 h-5"}),a.jsx("span",{children:"Contacta amb el club"})]}):a.jsxs("button",{onClick:()=>s(t),className:"w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors bg-primary text-white hover:bg-primary-700 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:t.tag==="vendido",children:[a.jsx(qh,{className:"w-5 h-5"}),a.jsx("span",{children:t.tag==="vendido"?"Article venut":"Contacta amb el venedor"})]})),(j||E)&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>r(t),disabled:d||f,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[a.jsx(Dx,{className:"w-5 h-5"})," Edita"]}),a.jsx("button",{onClick:k,disabled:d,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${f?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:d?a.jsxs(a.Fragment,{children:[a.jsx(Yn,{className:"w-5 h-5"}),a.jsx("span",{children:"Eliminant..."})]}):f?"Confirmar eliminaci":a.jsxs(a.Fragment,{children:[a.jsx(ym,{className:"w-5 h-5"}),a.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},tR=()=>{const[t,e]=P.useState("home"),[n,r]=P.useState([]),[s,i]=P.useState([]),[o,c]=P.useState(null),[u,d]=P.useState(null),[m,f]=P.useState(null),[g,x]=P.useState(null),[k,j]=P.useState(null),[E,b]=P.useState(null),[_,S]=P.useState([]),[R,F]=P.useState(!1),[B,y]=P.useState([]),[v,T]=P.useState(null),[A,N]=P.useState([]),[C,I]=P.useState(0),W=P.useRef(new Set),[fe,Z]=P.useState(!1);P.useEffect(()=>{const D=()=>{u&&d(null)};return window.addEventListener("popstate",D),()=>window.removeEventListener("popstate",D)},[u]);const te=()=>{var D;(D=window.history.state)!=null&&D.modalOpen?window.history.back():d(null)};P.useEffect(()=>{if(!E)return;if((async()=>{var z;if(!Dl){console.log("Firebase Messaging no est disponible en aquest navegador.");return}try{if(await window.Notification.requestPermission()==="granted"){const G=await B2(Dl,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(G){const K=ke(Ve,"users",E.id);(((z=(await Xc(K)).data())==null?void 0:z.fcmTokens)||[]).includes(G)||await st(K,{fcmTokens:Zc(G)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(O){console.error("Ha ocorregut un error en configurar les notificacions:",O)}})(),Dl){const z=z2(Dl,O=>{var V,G;console.log("Missatge rebut en primer pla: ",O),c({message:`${(V=O.notification)==null?void 0:V.title}: ${(G=O.notification)==null?void 0:G.body}`,type:"success"})});return()=>z()}},[E]),P.useEffect(()=>{let D=null;const z=I_(Ts,O=>{if(D&&(D(),D=null),O){const V=ke(Ve,"users",O.uid);D=An(V,G=>{G.exists()?b({id:O.uid,...G.data()}):(Di(Ts),b(null))},G=>{console.error("Error en escoltar el document d'usuari:",G),Di(Ts),b(null)})}else b(null)});return()=>{z(),D&&D()}},[]),P.useEffect(()=>{if((E==null?void 0:E.role)==="admin"){const D=Sn(Ge(Ve,"users")),z=An(D,O=>{const V=O.docs.map(G=>({id:G.id,...G.data()}));S(V.filter(G=>G.id!==E.id))});return()=>z()}else S([])},[E]),P.useEffect(()=>{const D=Sn(Ge(Ve,"products")),z=An(D,O=>{const V=O.docs.map(U=>{var oe;const X=U.data(),re=(oe=X.createdAt)!=null&&oe.toDate?X.createdAt.toDate():new Date;return{id:U.id,...X,createdAt:re}}),G=V.filter(U=>U.isMerchandise),K=V.filter(U=>!U.isMerchandise);G.sort((U,X)=>{const re=U.displayOrder??0,oe=X.displayOrder??0;return re===0&&oe===0?X.createdAt.getTime()-U.createdAt.getTime():re!==oe?re-oe:X.createdAt.getTime()-U.createdAt.getTime()}),K.sort((U,X)=>{const re=U.tag==="vendido",oe=X.tag==="vendido";return re&&!oe?1:!re&&oe?-1:X.createdAt.getTime()-U.createdAt.getTime()}),i(G),r(K),x(null)},O=>{console.error("Error en el listener de Firestore (products):",O),x(O),c({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const V=gv.filter(K=>K.isMerchandise).map(K=>({...K,createdAt:new Date(K.createdAt)})),G=gv.filter(K=>!K.isMerchandise).map(K=>({...K,createdAt:new Date(K.createdAt)}));V.sort((K,U)=>U.createdAt.getTime()-K.createdAt.getTime()),G.sort((K,U)=>U.createdAt.getTime()-K.createdAt.getTime()),i(V),r(G)});return()=>z()},[]),P.useEffect(()=>{if(!E){y([]);return}const D=Sn(Ge(Ve,"chats"),Mi("participantIds","array-contains",E.id)),z=An(D,O=>{let V=O.docs.map(K=>({id:K.id,...K.data()}));V=V.filter(K=>{var U;return!((U=K.hiddenFor)!=null&&U.includes(E.id))&&!W.current.has(K.id)}),V.sort((K,U)=>{var oe,mt;const X=((oe=K.updatedAt)==null?void 0:oe.toMillis())||0;return(((mt=U.updatedAt)==null?void 0:mt.toMillis())||0)-X});const G=V.reduce((K,U)=>K+(U.unreadCount[E.id]||0),0);I(G),y(V),x(null)},O=>{console.error("Error fetching chats:",O),x(O)});return()=>z()},[E]),P.useEffect(()=>{if(!v){N([]);return}const D=Sn(Ge(Ve,"chats",v.id,"messages")),z=An(D,O=>{const V=O.docs.map(G=>({id:G.id,...G.data()}));V.sort((G,K)=>{var re,oe;const U=((re=G.timestamp)==null?void 0:re.toMillis())||0,X=((oe=K.timestamp)==null?void 0:oe.toMillis())||0;return U-X}),N(V)});return()=>z()},[v]),P.useEffect(()=>{if(o){const D=setTimeout(()=>c(null),8e3);return()=>clearTimeout(D)}},[o]),P.useEffect(()=>{const D="LABOTIGA";C>0?document.title=`(${C}) ${D}`:document.title=D},[C]),P.useEffect(()=>(u||R||!E||fe||k?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u,R,E,fe,k]);const q=async(D,z)=>{await T_(Ts,D,z),c({message:"Benvingut/da de nou!",type:"success"})},se=(D,z)=>{const G=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(K=>{let U=0;for(let re=0;re<K.length;re++)U=K.charCodeAt(re)+((U<<5)-U);let X="#";for(let re=0;re<3;re++){const oe=U>>re*8&255;X+=("00"+oe.toString(16)).substr(-2)}return X})(z)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${D}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(G)}`},ce=async(D,z,O,V)=>{let G="",K=V;if(!K){const oe=D.split(" ").map(mt=>mt[0]).slice(0,2).join("").toUpperCase();K=se(oe,D)}try{G=await Kl(K)}catch(oe){throw console.error("La pujada de la imatge ha fallat:",oe),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!G)throw new Error("Cloudinary no ha retornat una URL vlida.");const X=(await b_(Ts,z,O)).user,re={name:D,email:z,avatarUrl:G,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await m2(ke(Ve,"users",X.uid),re),b({id:X.uid,...re}),c({message:`Benvingut/da, ${D}! El teu compte ha estat creat.`,type:"success"})},Ee=async D=>{try{await E_(Ts,D),c({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(z){throw console.error("Error en restablir la contrasenya:",z),z}},Se=async()=>{e("home"),await Di(Ts),c({message:"Sessi tancada correctament.",type:"success"})},an=()=>{e("home"),f(null)},ft=()=>{f(null),e("listing")},ln=()=>{E&&e("profile")},It=async(D,z,O)=>{if(!E||E.id!==D)throw c({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(z===E.name&&!O){c({message:"No s'han detectat canvis.",type:"success"});return}try{const V={name:z};O&&(V.avatarUrl=await Kl(O));const G=ke(Ve,"users",D);await st(G,V),c({message:"Perfil actualitzat correctament!",type:"success"})}catch(V){throw console.error("Error actualitzant l'usuari:",V),c({message:`Error en actualitzar: ${V.message||"Error desconegut."}`,type:"error"}),V}},Qt=async(D,z)=>{var O;if(!E)throw c({message:"Has d'iniciar la sessi per desar un producte.",type:"error"}),new Error("L'usuari no ha iniciat la sessi.");try{const V=D.imageUrls.map(U=>U.startsWith("data:image")?Kl(U):Promise.resolve(U)),G=await Promise.all(V),K={...D,imageUrls:G};if(z){const U=ke(Ve,"products",z),X=(O=(await Xc(U)).data())==null?void 0:O.seller;await st(U,{...K,seller:X}),c({message:"Anunci actualitzat correctament!",type:"success"})}else{const U={...K,seller:{id:E.id,name:E.name,avatarUrl:E.avatarUrl},createdAt:new Date,displayOrder:0};await Nn(Ge(Ve,"products"),U),c({message:"Anunci publicat amb xit!",type:"success"})}e("home"),f(null)}catch(V){throw console.error("Error al desar el producte:",V),c({message:`Error en desar: ${V.message||"Error desconegut."}`,type:"error"}),V}},ps=D=>{f(D),te(),e("listing")},ti=async D=>{try{return await Jc(ke(Ve,"products",D)),c({message:"Anunci eliminat correctament.",type:"success"}),te(),!0}catch(z){console.error("Error en eliminar el producte: ",z);const O=`Error en eliminar: ${z.code||z.message||"Error desconegut."}`;return c({message:O,type:"error"}),!1}},ho=D=>{window.history.pushState({modalOpen:!0},""),d(D)},fo=()=>{te()},ni=async(D,z)=>{if(!E||E.role!=="admin")return;const O=s.findIndex(U=>U.id===D),V=s.findIndex(U=>U.id===z);if(O===-1||V===-1||O===V)return;const G=[...s],[K]=G.splice(O,1);G.splice(V,0,K);try{const U=G.map((X,re)=>{const oe=re*100;if(X.displayOrder!==oe){const mt=ke(Ve,"products",X.id);return st(mt,{displayOrder:oe})}return Promise.resolve()});await Promise.all(U)}catch(U){console.error("Error reordering products:",U),c({message:"Error en moure el producte.",type:"error"})}},gs=async D=>{if(!E)return;const z=D.seller.id,O=E.id,V=Ge(Ve,"chats"),G=Sn(V,Mi("productId","==",D.id),Mi("participantIds","array-contains",O)),K=await f2(G);let U=null;if(K.forEach(X=>{const re={id:X.id,...X.data()};re.participantIds.includes(z)&&(U=re)}),U)await pr(U);else{const X={participantIds:[O,z],participants:{[O]:{name:E.name,avatarUrl:E.avatarUrl},[z]:{name:D.seller.name,avatarUrl:D.seller.avatarUrl}},productId:D.id,productTitle:D.title,productImageUrl:D.imageUrls[0]||"",lastMessage:null,createdAt:wt(),updatedAt:wt(),unreadCount:{[O]:0,[z]:0},hiddenFor:[]},re=await Nn(Ge(Ve,"chats"),X);T({id:re.id,...X})}te(),F(!0)},pr=async D=>{if(T(D),E&&(D.unreadCount[E.id]||0)>0){const z=ke(Ve,"chats",D.id);await st(z,{[`unreadCount.${E.id}`]:0})}},mo=async(D,z)=>{if(!E||!v)return;const O=E.id,V=v.participantIds.find(U=>U!==O);if(!V)return;const G={senderId:O,text:D,timestamp:wt(),...z&&{imageUrl:z}};await Nn(Ge(Ve,"chats",v.id,"messages"),G);const K=ke(Ve,"chats",v.id);await st(K,{lastMessage:{...G,timestamp:new Date},updatedAt:wt(),[`unreadCount.${V}`]:eu(1)})},ys=()=>{T(null)},vs=()=>{F(!1),T(null)},ri=async D=>{if(!E)return;W.current.add(D),y(O=>O.filter(V=>V.id!==D)),(v==null?void 0:v.id)===D&&T(null);const z=ke(Ve,"chats",D);try{await st(z,{hiddenFor:Zc(E.id)}),W.current.delete(D)}catch(O){console.error("Error en eliminar el xat:",O),c({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),W.current.delete(D)}},He=async(D,z)=>{if(!E||E.role!=="admin"){c({message:"No autoritzat.",type:"error"});return}const O=D==="all"?_:_.filter(V=>V.id===D);if(O.length===0){c({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const V of O){const G=`admin-message-${E.id}-${V.id}-${Date.now()}`,K={participantIds:[E.id,V.id],participants:{[E.id]:{name:E.name,avatarUrl:E.avatarUrl},[V.id]:{name:V.name,avatarUrl:V.avatarUrl}},productId:G,productTitle:"Missatge de l'administrador",productImageUrl:E.avatarUrl,lastMessage:null,createdAt:wt(),updatedAt:wt(),unreadCount:{[E.id]:0,[V.id]:0},hiddenFor:[]},U=await Nn(Ge(Ve,"chats"),K),X={senderId:E.id,text:z,timestamp:wt()};await Nn(Ge(Ve,"chats",U.id,"messages"),X),await st(U,{lastMessage:{...X,timestamp:new Date},updatedAt:wt(),[`unreadCount.${V.id}`]:eu(1)})}c({message:`Missatge enviat a ${O.length} usuari(s).`,type:"success"})}catch(V){throw console.error("Error en enviar el missatge d'administrador:",V),c({message:"No s'ha pogut enviar el missatge.",type:"error"}),V}},Xe=async(D,z)=>{if(!E||E.role!=="admin")throw c({message:"No autoritzat per realitzar aquesta acci.",type:"error"}),new Error("No autoritzat.");try{const O=ke(Ve,"users",D);await st(O,{role:z}),c({message:"El rol de l'usuari ha estat actualitzat.",type:"success"})}catch(O){throw console.error("Error actualitzant el rol de l'usuari:",O),c({message:"Error en actualitzar el rol.",type:"error"}),O}},gr=async D=>{if(!E||E.role!=="admin")return c({message:"No autoritzat per realitzar aquesta acci.",type:"error"}),!1;try{return await Jc(ke(Ve,"users",D)),c({message:"L'usuari ha estat eliminat correctament.",type:"success"}),!0}catch(z){console.error("Error eliminant l'usuari:",z);let O="Error en eliminar l'usuari.";return z.code==="permission-denied"&&(O="Error de permisos: Assegura't que les regles de Firestore permeten aquesta acci."),c({message:O,type:"error"}),!1}};return E?a.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[a.jsx(eI,{user:E,onNavigateHome:an,onNavigateToListing:ft,onNavigateToProfile:ln,onOpenTutorial:()=>Z(!0)}),a.jsx(mI,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>c(null)}),t==="home"&&a.jsx(tI,{userProducts:n,merchProducts:s,onProductSelect:ho,firebaseError:g,currentUser:E,onMoveProduct:ni}),t==="listing"&&a.jsx(fI,{onSave:Qt,productToEdit:m,currentUser:E}),t==="profile"&&a.jsx(yI,{user:E,onUpdateUser:It,onBack:()=>e("home"),onLogout:Se,allUsers:_,onSendAdminMessage:He,onUpdateUserRole:Xe,onDeleteUserByAdmin:gr}),u&&a.jsx(eR,{product:u,currentUser:E,onClose:fo,onEdit:ps,onContactSeller:gs,onDelete:ti,onOpenImageViewer:(D,z)=>j({images:D,startIndex:z})}),fe&&a.jsx(bI,{onClose:()=>Z(!1)}),k&&a.jsx(TI,{images:k.images,startIndex:k.startIndex,onClose:()=>j(null)}),a.jsx(vI,{isOpen:R,onClick:()=>F(!R),unreadCount:C}),a.jsx(EI,{isOpen:R,onClose:vs,chats:B,activeChat:v,messages:A,currentUser:E,onSendMessage:mo,onSelectChat:pr,onBackToList:ys,onDeleteChat:ri})]}):a.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),a.jsx("div",{className:"relative z-10",children:a.jsx(pI,{onLogin:q,onRegister:ce,onPasswordReset:Ee,isDismissable:!1})})]})},$2=document.getElementById("root");if(!$2)throw new Error("Could not find root element to mount to");const nR=oc.createRoot($2);nR.render(a.jsx(jv.StrictMode,{children:a.jsx(tR,{})}));const Ip=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),xf=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-.443.034-.884.176-1.286.448l-4.486 2.872c-.18.115-.383.115-.564 0l-4.486-2.873a1.875 1.875 0 01-1.286-.447l-3.722-.281a2.25 2.25 0 01-1.98-2.192v-4.286c0-.97.616-1.813 1.5-2.097m14.25-1.118a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928c.378-.04.757-.067 1.143-.082l3.722-.281c.443-.034.884-.176 1.286-.448l4.486-2.872c.18-.115.383.115.564 0l4.486 2.873c.402.27.843.414 1.286.448l3.722.28c.386.016.764.042 1.143.082v-.928a2.25 2.25 0 00-2.25-2.25h-8.25a2.25 2.25 0 00-2.25 2.25v.928"})}),dr=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Sp=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),q2=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),H2=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25z"})}),er=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`animate-spin ${t.className}`,children:a.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),rR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),sR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81"})}),iR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),W2=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c.51 0 .962-.343 1.087-.835l1.821-6.831a1.5 1.5 0 00-1.422-2.098H5.168L4.659 3.563A1.5 1.5 0 003.132 2.25H2.25m5.25 9h10.5m-10.5-9h10.5"})}),oR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),aR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.5 21.75l-.398-1.188a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.188-.398a2.25 2.25 0 001.423-1.423L16.5 15.75l.398 1.188a2.25 2.25 0 001.423 1.423L19.5 18.75l-1.188.398a2.25 2.25 0 00-1.423 1.423z"})}),yv=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),_f=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),lR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"})}),cR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.5-2.962a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5zM3.75 18.75a3 3 0 013-3h1.5a3 3 0 013 3v.5a.75.75 0 01-.75.75h-5.5a.75.75 0 01-.75-.75v-.5z"})}),uR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),dR=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),hR=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"})}),G2=t=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),fR=({user:t,onNavigateHome:e,onNavigateToListing:n,onNavigateToProfile:r,onOpenTutorial:s})=>a.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:a.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-4 flex items-center justify-between",children:[a.jsxs("button",{onClick:e,className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-10 w-auto"}),a.jsxs("span",{className:"text-2xl font-bold",children:[a.jsx("span",{className:"text-gray-900",children:"LA"}),a.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),a.jsx("div",{className:"flex items-center gap-4",children:t&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-primary hover:bg-gray-100 rounded-full transition-colors","aria-label":"Obre el tutorial",children:a.jsx(G2,{className:"w-7 h-7"})}),a.jsxs("button",{onClick:n,className:"bg-primary text-white font-semibold p-2 sm:px-4 sm:py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[a.jsx(_f,{className:"h-5 w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Puja un article"})]}),a.jsxs("button",{onClick:r,className:"flex items-center gap-2 cursor-pointer p-1 rounded-md hover:bg-gray-100",children:[a.jsx("img",{src:t.avatarUrl,alt:t.name,className:"w-9 h-9 rounded-full border-2 border-primary-200"}),a.jsx("span",{className:"font-semibold text-gray-700 hidden md:block",children:t.name})]})]})})]})}),Kn={novedad:{label:"Novetat",emoji:"",className:"bg-blue-500 text-white"},ultimas_unidades:{label:"ltimes Unitats",emoji:"",className:"bg-yellow-500 text-black"},reservado:{label:"Reservat",emoji:"",className:"bg-orange-500 text-white"},vendido:{label:"Tracte Fet",emoji:"",className:"bg-gray-700 text-white"}},vv=({product:t,onSelect:e,isAdmin:n,onMove:r})=>{const s=t.imageUrls&&t.imageUrls.length>0,i=g=>typeof g!="number"||isNaN(g)?"N/A":g.toFixed(2),o=t.tag?Kn[t.tag]:null,c=n&&t.isMerchandise,u=g=>{c&&(g.dataTransfer.setData("text/plain",t.id),g.dataTransfer.effectAllowed="move",g.currentTarget.style.opacity="0.5")},d=g=>{g.currentTarget.style.opacity="1"},m=g=>{c&&(g.preventDefault(),g.dataTransfer.dropEffect="move")},f=g=>{if(!c)return;g.preventDefault();const x=g.dataTransfer.getData("text/plain");r&&x&&x!==t.id&&r(x,t.id)};return a.jsx("div",{className:"relative group",draggable:c,onDragStart:u,onDragEnd:d,onDragOver:m,onDrop:f,style:{cursor:c?"move":"pointer"},children:a.jsxs("button",{onClick:e,className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden text-left w-full hover:shadow-lg transition-shadow duration-200 ${t.tag==="vendido"?"opacity-70":""}`,children:[a.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",children:[s&&a.jsx("img",{src:t.imageUrls[0],alt:t.title,className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 ${t.tag==="vendido"?"grayscale":""}`}),o&&a.jsxs("div",{className:`absolute top-2 left-2 text-xs font-bold px-2 py-1 rounded-full shadow-md ${o.className}`,children:[o.emoji," ",o.label]})]}),a.jsxs("div",{className:"p-3",children:[a.jsxs("p",{className:"font-bold text-gray-800 text-lg",children:[i(t.price)," "]}),a.jsx("h3",{className:"text-gray-600 text-sm truncate",children:t.title}),a.jsxs("div",{className:"flex items-center mt-2 pt-2 border-t border-gray-100",children:[a.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-6 h-6 rounded-full mr-2"}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.seller.name})]})]})]})})},mR=({userProducts:t,merchProducts:e,onProductSelect:n,firebaseError:r,currentUser:s,onMoveProduct:i})=>{const[o,c]=P.useState(t),[u,d]=P.useState("");P.useEffect(()=>{const f=u.toLowerCase();if(f==="")c(t);else{const g=t.filter(x=>x.title.toLowerCase().includes(f)||x.description.toLowerCase().includes(f));c(g)}},[u,t]);const m=f=>{d(f.target.value)};return a.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[r&&a.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-8 rounded-r-lg",role:"alert",children:[a.jsx("p",{className:"font-bold",children:"Avs de connexi"}),a.jsx("p",{children:"No s'ha pogut connectar a la base de dades. S'estan mostrant dades d'exemple."})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200 p-6 mb-8",children:[a.jsx("h1",{className:"text-xl md:text-3xl font-bold text-gray-800 mb-2",children:s?`Hola, ${s.name.split(" ")[0]}! Benvingut al nostre espai de Marxandatge i intercanvi de roba del Club.`:"Benvingut al nostre espai de Marxandatge i intercanvi de roba del Club."}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Busca al nostre club els articles de segona m que et calguin."}),a.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(iR,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Busca el que et calgui per practicar el millor esport del mn",value:u,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary bg-white text-gray-900"})]})})]}),e.length>0&&a.jsx("section",{className:"mb-12",children:a.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-2xl p-6 shadow-sm",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Marxandatge del Club."})}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6 mb-8",children:e.map(f=>a.jsx(vv,{product:f,onSelect:()=>n(f),isAdmin:(s==null?void 0:s.role)==="admin",onMove:i},f.id))}),a.jsx("div",{className:"flex justify-center",children:a.jsxs("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLSfux48JDT3BFqAlhNqPfM5BirPosepNYO_88zz1fwWk-Gmwwg/viewform",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-primary text-white font-bold py-3 px-8 rounded-full hover:bg-primary-700 transition-all transform hover:scale-105 shadow-md",children:[a.jsx(W2,{className:"w-5 h-5"}),a.jsx("span",{children:"Realitzar comanda"})]})})]})}),a.jsxs("section",{className:"mb-12",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4 text-center",children:"Accedeix a les nostres equipacions oficials."}),a.jsx("a",{href:"https://tcequipacions.cat/ca/search?controller=search&s=handbol+molins",target:"_blank",rel:"noopener noreferrer",className:"block w-full max-w-xs mx-auto rounded-2xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 transform hover:scale-[1.01]",children:a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/tc%20equipacions%20esportives.png",alt:"TC Equipacions Esportives - Handbol Molins",className:"w-full h-auto object-cover"})})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Articles que et poden interessar."}),o.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6",children:o.map(f=>a.jsx(vv,{product:f,onSelect:()=>n(f)},f.id))}):a.jsx("div",{className:"text-center py-16",children:a.jsx("p",{className:"text-gray-600",children:"No s'han trobat articles que coincideixin amb la teva cerca."})})]})]})},pR=({onClose:t,onCapture:e})=>{const n=P.useRef(null),r=P.useRef(null),s=P.useRef(null),[i,o]=P.useState(null);P.useEffect(()=>((async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("La cmera no s compatible amb aquest navegador.");const d=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});s.current=d,n.current&&(n.current.srcObject=d)}catch(d){console.error("Error en accedir a la cmera:",d),o("No s'ha pogut accedir a la cmera. Assegura't que has donat perms al navegador.")}})(),()=>{s.current&&s.current.getTracks().forEach(d=>d.stop())}),[]);const c=()=>{if(n.current&&r.current){const u=n.current,d=r.current;d.width=u.videoWidth,d.height=u.videoHeight;const m=d.getContext("2d");m&&(m.drawImage(u,0,0,u.videoWidth,u.videoHeight),d.toBlob(f=>{f&&e(f)},"image/jpeg",.9))}};return a.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col justify-center items-center","aria-modal":"true",role:"dialog",children:[a.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),a.jsx("canvas",{ref:r,className:"hidden"}),i&&a.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white p-4 rounded-lg text-center",children:[a.jsx("p",{children:i}),a.jsx("button",{onClick:t,className:"mt-2 px-4 py-2 bg-white text-red-500 font-bold rounded",children:"Tancar"})]}),a.jsx("button",{onClick:t,className:"absolute top-4 left-4 text-white bg-black bg-opacity-50 rounded-full p-3","aria-label":"Tancar la cmera",children:a.jsx(dr,{className:"w-6 h-6"})}),a.jsx("div",{className:"absolute bottom-8 flex justify-center w-full",children:a.jsx("button",{onClick:c,className:"w-20 h-20 bg-white rounded-full border-4 border-black border-opacity-25 flex items-center justify-center","aria-label":"Fes una foto",children:a.jsx("div",{className:"w-16 h-16 bg-white rounded-full border-2 border-black"})})})]})},Nr=5,gR=({imagePreviews:t,onImagesAdded:e,onDeleteImage:n})=>{const[r,s]=P.useState(!1),[i,o]=P.useState(null),[c,u]=P.useState(!1),[d,m]=P.useState(!1),f=P.useRef(null),g=async E=>{const b=E.target.files;if(!b)return;const _=Array.from(b).slice(0,Nr-t.length);if(b.length>_.length?o(`Noms pots pujar un mxim de ${Nr} imatges.`):o(null),_.length!==0){s(!0);try{const S=_.map(F=>Zr(F)),R=await Promise.all(S);e(R)}catch(S){const R=S instanceof Error?S.message:String(S);o(`No s'ha pogut carregar una o ms imatges: ${R}`),console.error(S)}finally{s(!1)}E.target.value=""}},x=()=>{var E;u(!1),(E=f.current)==null||E.click()},k=()=>{u(!1),m(!0)},j=async E=>{m(!1),s(!0);try{const b=await Zr(E);e([b])}catch(b){const _=b instanceof Error?b.message:String(b);o(`No s'ha pogut processar la foto capturada: ${_}`),console.error(b)}finally{s(!1)}};return a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(_f,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"1. Puja les teves fotos"})]}),a.jsxs("p",{className:"text-sm font-medium text-gray-500",children:[t.length," / ",Nr]})]}),a.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4",children:[t.map((E,b)=>a.jsxs("div",{className:"relative aspect-square group",children:[a.jsx("img",{src:E,alt:`Product image ${b+1}`,className:"w-full h-full object-cover rounded-lg border"}),a.jsx("button",{onClick:()=>n(b),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Eliminar imatge",children:a.jsx(dr,{className:"w-4 h-4"})})]},b)),r&&a.jsx("div",{className:"aspect-square flex justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:a.jsx(er,{className:"w-8 h-8 text-primary"})}),t.length<Nr&&!r&&a.jsxs("button",{onClick:()=>u(!0),className:"aspect-square flex flex-col justify-center items-center w-full h-full border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary-50 transition-colors text-center","aria-label":`Puja ${Nr-t.length} imatges ms`,children:[a.jsx(_f,{className:"mx-auto h-8 w-8 text-gray-400"}),a.jsx("p",{className:"mt-1 text-xs text-gray-600",children:a.jsx("span",{className:"font-semibold text-primary",children:"Afegeix fotos"})})]})]}),a.jsx("input",{ref:f,type:"file",onChange:g,className:"hidden",accept:"image/*",multiple:!0,disabled:t.length>=Nr}),i&&a.jsx("p",{className:"text-red-500 text-sm mt-4",children:i}),c&&a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 animate-fade-in-fast",onClick:()=>u(!1),"aria-modal":"true",role:"dialog",children:[a.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
            @keyframes scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
            .animate-scale-in { animation: scale-in 0.2s ease-out; }
          `}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl animate-scale-in",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Tria una opci"}),a.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(dr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:k,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Nr,children:[a.jsx(Ip,{className:"w-6 h-6 text-primary"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Fes una foto"})]}),a.jsxs("button",{onClick:x,className:"w-full flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors disabled:opacity-50",disabled:t.length>=Nr,children:[a.jsx(H2,{className:"w-6 h-6 text-primary"}),a.jsx("span",{className:"font-semibold text-gray-700",children:"Tria de la galeria"})]})]})]})]}),d&&a.jsx(pR,{onCapture:j,onClose:()=>m(!1)})]})},yR=({title:t,setTitle:e,description:n,setDescription:r})=>a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(aR,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"2. Descriu el teu article"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"product-title",className:"block text-sm font-medium text-gray-700",children:"Ttol del producte"}),a.jsx("input",{id:"product-title",type:"text",value:t,onChange:s=>e(s.target.value),placeholder:'p. ex., "Jaqueta de cuir vintage"',className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("label",{htmlFor:"product-description",className:"block text-sm font-medium text-gray-700",children:"Descripci"}),a.jsx("textarea",{id:"product-description",rows:6,value:n,onChange:s=>r(s.target.value),placeholder:"Descriu el teu article amb detall...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]})]}),vR=({imagePreviews:t,title:e,description:n,price:r,onPublish:s,isEditing:i,isPublishing:o})=>{const c=t.length>0&&e&&r;return a.jsx("div",{className:"sticky top-28",children:a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Vista prvia de l'anunci"}),a.jsx("div",{className:"w-full aspect-square bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:t&&t.length>0?a.jsx("img",{src:t[0],alt:"Vista prvia del producte",className:"w-full h-full object-cover rounded-lg"}):a.jsx(H2,{className:"w-16 h-16 text-gray-300"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:e||"Ttol del producte"}),a.jsx("p",{className:"text-3xl font-extrabold text-primary",children:r?`${parseFloat(r).toFixed(2)} `:"0.00 "}),a.jsx("div",{className:"border-t pt-3",children:a.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap h-32 overflow-y-auto",children:n||"La teva descripci generada apareixer aqu..."})}),a.jsx("button",{onClick:s,disabled:!c||o,className:"w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?a.jsxs(a.Fragment,{children:[a.jsx(er,{className:"w-5 h-5"}),a.jsx("span",{children:i?"Desant...":"Publicant..."})]}):i?"Desa els canvis":"Publica l'anunci"})]})]})})},wR="dfmkfeqzt",xR="BOTIGAHANDBOL",ic=async t=>{try{const e=new FormData;e.append("file",t),e.append("upload_preset",xR);const n=await fetch(`https://api.cloudinary.com/v1_1/${wR}/image/upload`,{method:"POST",body:e});if(!n.ok){const s=await n.json();throw new Error(`Error en pujar a Cloudinary: ${s.error.message}`)}return(await n.json()).secure_url}catch(e){throw console.error("Error en la crrega a Cloudinary:",e),e}},_R="ListingDraftDB",ER=1,ls="listingDrafts",Np="currentListingDraft",Ap=()=>new Promise((t,e)=>{const n=indexedDB.open(_R,ER);n.onerror=()=>e("Error en obrir la base de dades IndexedDB."),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const s=r.target.result;s.objectStoreNames.contains(ls)||s.createObjectStore(ls)}}),bR=async t=>{const n=(await Ap()).transaction(ls,"readwrite");return n.objectStore(ls).put(t,Np),new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i("Error en desar l'esborrany a IndexedDB.")})},TR=async()=>{const r=(await Ap()).transaction(ls,"readonly").objectStore(ls).get(Np);return new Promise((s,i)=>{r.onsuccess=()=>{s(r.result||null)},r.onerror=()=>i("Error en llegir l'esborrany.")})},IR=async()=>{(await Ap()).transaction(ls,"readwrite").objectStore(ls).delete(Np)},SR=({onSave:t,productToEdit:e,currentUser:n})=>{const[r,s]=P.useState([]),[i,o]=P.useState([]),[c,u]=P.useState(""),[d,m]=P.useState(""),[f,g]=P.useState(""),[x,k]=P.useState(!1),[j,E]=P.useState(""),[b,_]=P.useState(!1),[S,R]=P.useState(!1),[F,B]=P.useState(!0),[y,v]=P.useState(!1),T=!!e,A=P.useRef(null);P.useEffect(()=>{const Z=r.map(te=>typeof te=="string"?te:URL.createObjectURL(te));return o(Z),()=>{Z.forEach(te=>{te.startsWith("blob:")&&URL.revokeObjectURL(te)})}},[r]),P.useEffect(()=>{(async()=>{var te;if(T&&e)u(e.title),m(e.description),g(((te=e.price)==null?void 0:te.toString())||""),s(e.imageUrls||[]),k(e.isMerchandise||!1),E(e.tag||""),_(e.hideOrderButton||!1),R(e.hideContactButton||!1);else if(!T)try{const q=await TR();q&&(s(q.imagesData||[]),u(q.title||""),m(q.description||""),g(q.price||""),k(q.isMerchandise||!1),E(q.tag||""),_(q.hideOrderButton||!1),R(q.hideContactButton||!1))}catch(q){console.error("Error en restaurar l'esborrany:",q)}B(!1)})()},[e,T]),P.useEffect(()=>{if(!(F||T))return A.current&&clearTimeout(A.current),A.current=window.setTimeout(()=>{bR({imagesData:r,title:c,description:d,price:f,isMerchandise:x,tag:j,hideOrderButton:b,hideContactButton:S}).catch(te=>console.error("Error en desar l'esborrany:",te))},500),()=>{A.current&&clearTimeout(A.current)}},[r,c,d,f,x,j,b,S,F,T]);const N=async()=>{s([]),u(""),m(""),g(""),k(!1),E(""),_(!1),R(!1),await IR()},C=async()=>{if(i.length>0&&c&&f){v(!0);try{const Z=r.map(se=>typeof se=="string"?Promise.resolve(se):eo(se).then(ce=>ic(ce))),te=await Promise.all(Z),q={title:c,description:d,price:parseFloat(f),imageUrls:te,isMerchandise:x,tag:j||"",hideOrderButton:b,hideContactButton:S};await t(q,e==null?void 0:e.id),await N()}catch{console.error("La publicaci ha fallat. L'usuari ja ha estat notificat.")}finally{v(!1)}}},I={novedad:Kn.novedad,ultimas_unidades:Kn.ultimas_unidades},W={reservado:Kn.reservado,vendido:Kn.vendido},fe=(n==null?void 0:n.role)==="admin"&&x?I:W;return F&&!T?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("p",{className:"text-gray-600",children:"Recuperant l'esborrany..."})}):a.jsx("main",{className:"container mx-auto p-4 md:p-8",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:T?"Edita el teu anunci":"Crea el teu anunci"}),a.jsx("p",{className:"text-gray-600 mb-8",children:T?"Actualitza els detalls del teu producte.":"Fes servir les nostres eines per fer destacar el teu producte."}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[a.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-8",children:[a.jsx(gR,{imagePreviews:i,onImagesAdded:Z=>s(te=>[...te,...Z]),onDeleteImage:Z=>s(te=>te.filter((q,se)=>se!==Z))}),a.jsx(yR,{title:c,setTitle:u,description:d,setDescription:m}),a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(yv,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"3. Afegeix un preu"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Introdueix el preu de venda del teu article."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"product-price",className:"block text-sm font-medium text-gray-700",children:"Preu ()"}),a.jsx("input",{id:"product-price",type:"number",value:f,onChange:Z=>g(Z.target.value),placeholder:"p. ex., 25.50",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",step:"0.01",min:"0",required:!0})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg",children:a.jsx(yv,{className:"h-6 w-6 text-primary"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"4. Etiqueta (Opcional)"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecciona un estat per al teu article."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[a.jsx("input",{type:"radio",name:"tag",value:"",checked:j==="",onChange:Z=>E(Z.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Cap etiqueta"})]}),Object.entries(fe).map(([Z,te])=>a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50",children:[a.jsx("input",{type:"radio",name:"tag",value:Z,checked:j===Z,onChange:q=>E(q.target.value),className:"h-5 w-5 text-primary focus:ring-primary border-gray-300"}),a.jsxs("span",{className:`text-sm font-semibold px-2 py-1 rounded-full ${te.className}`,children:[te.emoji," ",te.label]})]},Z))]})]}),(n==null?void 0:n.role)==="admin"&&a.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"bg-primary-50 p-2 rounded-lg flex items-center justify-center h-10 w-10",children:a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-6 w-auto"})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Opcions d'Administrador"})]}),a.jsxs("div",{className:"mt-4 space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:x,onChange:Z=>k(Z.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsx("span",{className:"text-gray-700 font-medium",children:"Afegeix com a article de merchandising oficial"})]}),x&&a.jsxs("div",{className:"pl-8 space-y-3 border-l-2 border-gray-100",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:b,onChange:Z=>_(Z.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsx("span",{className:"text-gray-600 text-sm",children:'Oculta el bot "Realitzar comanda"'})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:S,onChange:Z=>R(Z.target.checked),className:"h-5 w-5 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsx("span",{className:"text-gray-600 text-sm",children:'Oculta el bot "Contacta amb el club"'})]})]})]})]})]}),a.jsx("div",{className:"lg:col-span-2",children:a.jsx(vR,{imagePreviews:i,title:c,description:d,price:f,onPublish:C,isEditing:T,isPublishing:y})})]})]})})},NR=({message:t,type:e="success",onClose:n})=>{if(!t)return null;const r="text-white text-sm font-semibold px-4 py-3 rounded-lg shadow-lg flex items-center justify-between gap-4",s={success:"bg-green-500",error:"bg-red-500"},i={success:"hover:bg-green-600",error:"hover:bg-red-600"};return a.jsxs("div",{className:"fixed bottom-6 left-6 z-50 animate-slide-in-up",children:[a.jsx("style",{children:`
        @keyframes slide-in-up {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }
          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-slide-in-up {
          animation: slide-in-up 0.3s ease-out forwards;
        }
      `}),a.jsxs("div",{className:`${r} ${s[e]}`,children:[a.jsx("span",{children:t}),a.jsx("button",{onClick:n,className:`p-1 rounded-full flex-shrink-0 ${i[e]}`,children:a.jsx(dr,{className:"w-4 h-4"})})]})]})},AR=({onClose:t,onLogin:e,onRegister:n,onPasswordReset:r,isDismissable:s=!0})=>{const[i,o]=P.useState("login"),[c,u]=P.useState(""),[d,m]=P.useState(""),[f,g]=P.useState(""),[x,k]=P.useState(!1),[j,E]=P.useState(null),b=P.useRef(null),[_,S]=P.useState(!1),[R,F]=P.useState(null),[B,y]=P.useState(null),v=async N=>{var I;const C=(I=N.target.files)==null?void 0:I[0];if(C)try{const W=await Zr(C,512,512,.9),fe=await eo(W);E(fe)}catch(W){console.error("Error en llegir el fitxer:",W),F("No s'ha pogut processar la imatge.")}},T=async N=>{N.preventDefault(),S(!0),F(null),y(null);try{i==="login"?await e(d,f):await n(c,d,f,j)}catch(C){let I="Hi ha hagut un error. Si us plau, torna-ho a provar.";if(C.code)switch(C.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":I="Correu electrnic o contrasenya incorrectes.";break;case"auth/email-already-in-use":I="Aquest correu electrnic ja est en s.";break;case"auth/weak-password":I="La contrasenya ha de tenir almenys 6 carcters.";break;case"auth/invalid-email":I="El format del correu electrnic no s vlid.";break}else C.message&&(C.message.includes("Cloudinary")?I="Error amb la imatge: Assegura't que el 'preset' de crrega a Cloudinary estigui configurat com a 'unsigned'.":I=C.message);F(I),console.error(C)}finally{S(!1)}},A=async N=>{N.preventDefault(),S(!0),F(null),y(null);try{await r(d),y("S'ha enviat l'enlla de recuperaci. Revisa el teu correu (i la carpeta de correu brossa).")}catch(C){let I="Hi ha hagut un error en enviar el correu.";(C.code==="auth/user-not-found"||C.code==="auth/invalid-email")&&(I="No s'ha trobat cap usuari amb aquest correu electrnic."),F(I)}finally{S(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:s?t:void 0,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",onClick:N=>N.stopPropagation(),children:[s&&a.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 p-1 transition-colors","aria-label":"Tancar",children:a.jsx(dr,{className:"w-6 h-6"})}),a.jsx("div",{className:"p-6 sm:p-8",children:i==="forgotPassword"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),a.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Restableix la contrasenya"}),a.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Introdueix el teu correu i t'enviarem un enlla per recuperar-la."})]}),a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email-reset",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),a.jsx("input",{id:"email-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:N=>m(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),R&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:R}),B&&a.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:_,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:_?a.jsx(er,{className:"w-5 h-5"}):"Envia l'enlla"})}),a.jsx("div",{children:a.jsx("button",{type:"button",onClick:()=>{o("login"),F(null),y(null),k(!1)},className:"w-full text-sm font-medium text-primary hover:underline",children:"Tornar a l'inici de sessi"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS%20COLOR.png",alt:"LABOTIGA Logo",className:"h-12 w-auto mx-auto"}),a.jsx("h2",{className:"mt-2 text-2xl font-bold text-gray-900",children:i==="login"?a.jsxs(a.Fragment,{children:["Benvingut/da a LA",a.jsx("span",{className:"text-primary",children:"BOTIGA"})]}):"Crea el teu compte"}),a.jsx("p",{className:"text-gray-600 text-sm mt-1 px-4",children:i==="login"?"La botiga de segona m i marxandatge del Club Handbol Molins.":"Registra't per comprar i vendre material del club i molt ms."})]}),a.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[a.jsx("button",{onClick:()=>{o("login"),F(null),y(null),k(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="login"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Inicia la sessi"}),a.jsx("button",{onClick:()=>{o("register"),F(null),y(null),k(!1)},className:`flex-1 py-3 text-sm font-semibold text-center transition-colors ${i==="register"?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"}`,children:"Registra't"})]}),a.jsxs("form",{onSubmit:T,className:"space-y-4",children:[i==="register"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-center",children:[a.jsx("input",{type:"file",ref:b,onChange:v,className:"hidden",accept:"image/*"}),a.jsxs("button",{type:"button",onClick:()=>{var N;return(N=b.current)==null?void 0:N.click()},className:"relative w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors",children:[j?a.jsx("img",{src:j,alt:"Avatar Preview",className:"w-full h-full object-cover rounded-full"}):a.jsx(Ip,{className:"w-10 h-10"}),a.jsx("div",{className:"absolute bottom-0 right-0 bg-primary text-white rounded-full p-1 text-xs",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),a.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:c,onChange:N=>u(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"El teu nom"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),a.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:N=>m(N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",placeholder:"correu@exemple.com"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasenya"}),i==="login"&&a.jsx("button",{type:"button",onClick:()=>{o("forgotPassword"),F(null),y(null)},className:"text-sm font-medium text-primary hover:underline",children:"Heu oblidat la contrasenya?"})]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx("input",{id:"password",name:"password",type:x?"text":"password",autoComplete:"current-password",required:!0,value:f,onChange:N=>g(N.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900 pr-10",placeholder:""}),a.jsx("button",{type:"button",onClick:()=>k(!x),className:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":x?"Oculta la contrasenya":"Mostra la contrasenya",children:x?a.jsx(hR,{className:"w-5 h-5"}):a.jsx(dR,{className:"w-5 h-5"})})]})]}),R&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:R}),B&&a.jsx("p",{className:"text-green-600 text-sm text-center",children:B}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:_,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:_?a.jsx(er,{className:"w-5 h-5"}):i==="login"?"Inicia la sessi":"Crea el compte"})})]})]})})]})})},kR=({allUsers:t,onSendAdminMessage:e})=>{const[n,r]=P.useState("all"),[s,i]=P.useState(""),[o,c]=P.useState(!1),u=async d=>{if(d.preventDefault(),!!s.trim()){c(!0);try{await e(n,s),i(""),r("all")}catch{}finally{c(!1)}}};return a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[a.jsx(rR,{className:"h-10 w-10 text-primary"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Panell d'Administrador"}),a.jsx("p",{className:"text-gray-600",children:"Envia comunicats a usuaris individuals o a tothom."})]})]}),a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"recipient",className:"block text-sm font-medium text-gray-700",children:"Destinatari"}),a.jsxs("select",{id:"recipient",value:n,onChange:d=>r(d.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[a.jsx("option",{value:"all",children:"Tots els usuaris"}),t.map(d=>a.jsxs("option",{value:d.id,children:[d.name," (",d.email,")"]},d.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"admin-message",className:"block text-sm font-medium text-gray-700",children:"Missatge"}),a.jsx("textarea",{id:"admin-message",rows:5,value:s,onChange:d=>i(d.target.value),placeholder:"Escriu el teu comunicat aqu...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",required:!0})]}),a.jsx("button",{type:"submit",disabled:o||!s.trim(),className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400 disabled:cursor-not-allowed",children:o?a.jsx(er,{className:"w-5 h-5"}):"Envia el missatge"})]})]})},CR=({user:t,onUpdateUser:e,onBack:n,onLogout:r,allUsers:s,onSendAdminMessage:i,onUpdateUserRole:o,onDeleteUserByAdmin:c})=>{const[u,d]=P.useState(t.name),[m,f]=P.useState(null),g=P.useRef(null),[x,k]=P.useState(!1),[j,E]=P.useState(null),[b,_]=P.useState(!1),[S,R]=P.useState(!1),[F,B]=P.useState("user");P.useEffect(()=>{d(t.name)},[t]);const y=async W=>{var Z;const fe=(Z=W.target.files)==null?void 0:Z[0];if(fe)try{const te=await Zr(fe,512,512,.9),q=await eo(te);f(q)}catch(te){console.error("Error en llegir el fitxer:",te)}},v=async W=>{W.preventDefault(),k(!0);try{await e(t.id,u,m),f(null)}catch(fe){console.error(fe)}finally{k(!1)}},T=W=>{E(W),B(W.role),_(!0)},A=W=>{E(W),R(!0)},N=()=>{E(null),_(!1),R(!1)},C=async W=>{if(W.preventDefault(),!!j){k(!0);try{await o(j.id,F),N()}catch{}finally{k(!1)}}},I=async()=>{if(j){k(!0);try{await c(j.id)&&N()}catch(W){console.error("Error durant la confirmaci de l'eliminaci:",W)}finally{k(!1)}}};return a.jsxs(a.Fragment,{children:[a.jsx("main",{className:"container mx-auto p-4 md:p-8",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b",children:[a.jsx(lR,{className:"h-10 w-10 text-primary"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"El Meu Perfil"}),a.jsx("p",{className:"text-gray-600",children:"Actualitza la teva informaci personal."})]})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("input",{type:"file",ref:g,onChange:y,className:"hidden",accept:"image/*"}),a.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Foto de perfil"}),a.jsxs("button",{type:"button",onClick:()=>{var W;return(W=g.current)==null?void 0:W.click()},className:"relative w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 hover:bg-gray-200 transition-colors group",children:[a.jsx("img",{src:m||t.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}),a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center rounded-full transition-opacity cursor-pointer",children:a.jsx(Ip,{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nom"}),a.jsx("input",{id:"name",type:"text",required:!0,value:u,onChange:W=>d(W.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correu electrnic"}),a.jsx("input",{id:"email",type:"email",value:t.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"joinDate",className:"block text-sm font-medium text-gray-700",children:"Membre des de"}),a.jsx("input",{id:"joinDate",type:"text",value:new Date(t.joinDate).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"}),disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm bg-gray-100 text-gray-500 cursor-not-allowed"})]}),a.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:n,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Cancella"}),a.jsx("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-primary-400",children:x?a.jsx(er,{className:"w-5 h-5"}):"Desa els canvis"})]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-red-200",children:a.jsx("button",{onClick:r,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Tanca la sessi"})})]}),t.role==="admin"&&a.jsxs(a.Fragment,{children:[a.jsx(kR,{allUsers:s,onSendAdminMessage:i}),a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-2xl shadow-md border border-gray-200 mt-8",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx(cR,{className:"h-10 w-10 text-primary"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gesti d'Usuaris"}),a.jsx("p",{className:"text-gray-600",children:"Edita rols o elimina usuaris de la plataforma."})]})]}),a.jsx("div",{className:"space-y-3",children:s.length>0?s.map(W=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[a.jsx("img",{src:W.avatarUrl,alt:W.name,className:"w-10 h-10 rounded-full"}),a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("p",{className:"font-semibold text-gray-800 truncate",children:W.name}),a.jsx("p",{className:"text-sm text-gray-500 truncate",children:W.email})]})]}),a.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[a.jsx("button",{onClick:()=>T(W),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-100 rounded-md transition-colors","aria-label":`Edita ${W.name}`,children:a.jsx(q2,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>A(W),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-100 rounded-md transition-colors","aria-label":`Elimina ${W.name}`,children:a.jsx(Sp,{className:"w-5 h-5"})})]})]},W.id)):a.jsx("p",{className:"text-center text-gray-500 py-4",children:"No hi ha altres usuaris per gestionar."})})]})]})]})}),b&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:N,children:a.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md",onClick:W=>W.stopPropagation(),children:a.jsxs("form",{onSubmit:C,className:"p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Edita l'Usuari"}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[a.jsx("strong",{children:"Nom:"})," ",j.name]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[a.jsx("strong",{children:"Email:"})," ",j.email]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Rol"}),a.jsxs("select",{id:"role",value:F,onChange:W=>B(W.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm bg-white text-gray-900",children:[a.jsx("option",{value:"user",children:"Usuari"}),a.jsx("option",{value:"admin",children:"Administrador"})]})]}),a.jsxs("div",{className:"mt-6 flex gap-3",children:[a.jsx("button",{type:"button",onClick:N,className:"w-full text-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancella"}),a.jsx("button",{type:"submit",disabled:x,className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-700 disabled:bg-primary-300",children:x?a.jsx(er,{className:"w-5 h-5 mx-auto"}):"Desa els canvis"})]})]})})}),S&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:N,children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",onClick:W=>W.stopPropagation(),children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Confirmar Eliminaci"}),a.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Ests segur que vols eliminar l'usuari ",a.jsx("strong",{children:j.name}),"? Aquesta acci no es pot desfer. L'usuari perdr l'accs a l'aplicaci."]}),a.jsxs("div",{className:"mt-6 flex gap-3",children:[a.jsx("button",{type:"button",onClick:N,className:"w-full text-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancella"}),a.jsx("button",{onClick:I,disabled:x,className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 disabled:bg-red-300",children:x?a.jsx(er,{className:"w-5 h-5 mx-auto"}):"S, elimina'l"})]})]})})]})},jR=({onClick:t,unreadCount:e,isOpen:n})=>n?null:a.jsxs(a.Fragment,{children:[a.jsx("style",{children:`
        @keyframes pulse-strong {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.95; }
        }
        .animate-pulse-strong { animation: pulse-strong 1.5s infinite ease-in-out; }
      `}),a.jsxs("button",{onClick:t,className:"fixed bottom-4 right-4 md:bottom-8 md:right-8 z-30 bg-primary text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center hover:bg-primary-700 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary","aria-label":"Obrir el xat",children:[e>0&&a.jsx("span",{className:"absolute top-0 right-0 h-6 w-6 rounded-full bg-red-500 border-2 border-white flex items-center justify-center text-xs font-bold animate-pulse-strong",children:e}),a.jsx("div",{className:"w-9 h-9",children:a.jsx("img",{src:"https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/MOLINS.png",alt:"Xat",className:"w-full h-auto p-1"})})]})]}),PR=({message:t,currentUser:e})=>{var s,i;const n=t.senderId===e.id,r=((i=(s=t.timestamp)==null?void 0:s.toDate())==null?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"";return a.jsx("div",{className:`flex items-end gap-2 ${n?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg rounded-2xl px-4 py-2 ${n?"bg-primary text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"}`,children:[t.text&&a.jsx("p",{className:"text-sm break-words",children:t.text}),t.imageUrl&&a.jsx("div",{className:"mt-2",children:a.jsx("img",{src:t.imageUrl,alt:"Uploaded content",className:"rounded-lg max-h-60 w-full object-cover"})}),a.jsx("p",{className:`text-xs mt-1 ${n?"text-primary-200":"text-gray-500"} text-right`,children:r})]})})},RR=(t,e=1280,n=1280)=>new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=o=>{var u;if(!((u=o.target)!=null&&u.result))return s(new Error("No s'ha pogut llegir el fitxer."));const c=new Image;c.src=o.target.result,c.onload=()=>{const d=document.createElement("canvas");let{width:m,height:f}=c;m>f?m>e&&(f=Math.round(f*(e/m)),m=e):f>n&&(m=Math.round(m*(n/f)),f=n),d.width=m,d.height=f;const g=d.getContext("2d");if(!g)return s(new Error("No s'ha pogut obtenir el context del canvas"));g.drawImage(c,0,0,m,f),r(d.toDataURL("image/jpeg",.85))},c.onerror=d=>s(new Error(`Error en carregar la imatge: ${d}`))},i.onerror=o=>s(new Error(`Error en llegir el fitxer: ${o}`))}),DR=({chat:t,onSelect:e,currentUser:n,onDelete:r,isConfirmingDelete:s,onStartConfirmDelete:i,onCancelConfirmDelete:o})=>{var g,x,k,j,E;const c=t.participantIds.find(b=>b!==n.id);if(!c)return null;const u=t.participants[c],d=t.unreadCount[n.id]||0,m=((k=(x=(g=t.lastMessage)==null?void 0:g.timestamp)==null?void 0:x.toDate())==null?void 0:k.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"",f=()=>{r(t.id),o()};return a.jsxs("div",{className:"w-full relative bg-white overflow-hidden group",children:[a.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end px-4 gap-2 bg-white",children:[a.jsx("button",{onClick:o,className:"text-sm font-semibold py-2 px-3 rounded-md bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors","aria-label":"Cancella l'eliminaci",children:"Cancella"}),a.jsx("button",{onClick:f,className:"text-sm font-semibold py-2 px-3 rounded-md bg-red-600 text-white hover:bg-red-700 transition-colors","aria-label":"Confirma l'eliminaci",children:"Elimina"})]}),a.jsxs("div",{className:`w-full flex items-center gap-2 px-2 py-1 bg-white relative transition-transform duration-300 ease-in-out ${s?"-translate-x-44":"translate-x-0"}`,children:[a.jsxs("button",{onClick:e,className:"w-full text-left p-2 flex items-center gap-3 rounded-lg hover:bg-gray-100 transition-colors flex-1",children:[a.jsxs("div",{className:"relative flex-shrink-0",children:[a.jsx("img",{src:u.avatarUrl,alt:u.name,className:"w-12 h-12 rounded-full object-cover"}),a.jsx("img",{src:t.productImageUrl,alt:t.productTitle,className:"w-6 h-6 rounded-full object-cover absolute -bottom-1 -right-1 border-2 border-white"})]}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("p",{className:"font-bold text-gray-800 truncate",children:u.name}),a.jsx("p",{className:"text-xs text-gray-500 flex-shrink-0",children:m})]}),a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("p",{className:"text-sm text-gray-600 truncate pr-2",children:((j=t.lastMessage)==null?void 0:j.text)||((E=t.lastMessage)!=null&&E.imageUrl?"Imatge":"Cap missatge encara")}),d>0&&a.jsx("span",{className:"bg-primary text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center flex-shrink-0",children:d})]})]})]}),a.jsx("button",{onClick:i,className:"p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100","aria-label":`Elimina el xat amb ${u.name}`,children:a.jsx(Sp,{className:"w-5 h-5"})})]})]})},LR=({isOpen:t,onClose:e,chats:n,activeChat:r,messages:s,currentUser:i,onSendMessage:o,onSelectChat:c,onBackToList:u,onDeleteChat:d})=>{const[m,f]=P.useState(""),[g,x]=P.useState(null),k=P.useRef(null),j=P.useRef(null),E=()=>{var y;(y=j.current)==null||y.scrollIntoView({behavior:"smooth"})};P.useEffect(()=>{t&&r&&E()},[s,t,r]),P.useEffect(()=>{(!t||!r)&&x(null)},[t,r]);const b=()=>{m.trim()&&(o(m),f(""))},_=y=>{y.key==="Enter"&&(y.preventDefault(),b())},S=async y=>{var T;const v=(T=y.target.files)==null?void 0:T[0];if(v)try{const A=await RR(v);o("",A)}catch(A){console.error("No s'ha pogut llegir el fitxer",A)}y.target&&(y.target.value="")},R=()=>{var y;(y=k.current)==null||y.click()};if(!t||!i)return null;const F=r==null?void 0:r.participantIds.find(y=>y!==i.id),B=F?r==null?void 0:r.participants[F]:null;return a.jsxs("div",{className:"fixed bottom-0 right-0 sm:bottom-4 md:bottom-8 sm:right-4 md:right-8 z-20 w-full sm:w-96 h-[90vh] sm:h-[60vh] sm:max-h-[600px] bg-white rounded-t-lg sm:rounded-lg shadow-2xl flex flex-col border border-gray-200 transform transition-transform duration-300 ease-in-out animate-slide-in",children:[a.jsx("style",{children:`
        @keyframes slide-in {
          from { transform: translateY(100%); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-in { 
            animation: slide-in 0.3s ease-out; 
        }
        @keyframes fade-in-fast {
          from { opacity: 0; transform: scale(0.8); }
          to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in-fast { 
          animation: fade-in-fast 0.2s ease-out; 
        }
      `}),a.jsxs("header",{className:"bg-primary text-white p-3 flex justify-between items-center rounded-t-lg flex-shrink-0",children:[r?a.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[a.jsx("button",{onClick:u,className:"hover:bg-primary-700 p-1 rounded-full -ml-1",children:a.jsx(uR,{className:"w-6 h-6"})}),a.jsx("img",{src:B==null?void 0:B.avatarUrl,alt:B==null?void 0:B.name,className:"w-8 h-8 rounded-full object-cover"}),a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("h3",{className:"font-bold text-lg truncate",children:B==null?void 0:B.name}),a.jsx("p",{className:"text-xs opacity-80 truncate",children:r.productTitle})]})]}):a.jsx("div",{className:"flex items-center justify-between w-full",children:a.jsx("h3",{className:"font-bold text-lg",children:"Converses"})}),a.jsx("button",{onClick:e,className:"hover:bg-primary-700 p-1 rounded-full",children:a.jsx(dr,{className:"w-6 h-6"})})]}),r?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4 bg-gray-50",children:[s.map(y=>a.jsx(PR,{message:y,currentUser:i},y.id)),a.jsx("div",{ref:j})]}),a.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-100 flex-shrink-0",children:a.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-2",children:[a.jsx("input",{type:"text",value:m,onChange:y=>f(y.target.value),onKeyPress:_,placeholder:"Escriu un missatge...",className:"flex-1 py-2 px-2 border-none focus:ring-0 text-sm bg-transparent text-gray-900","aria-label":"Entrada de missatge del xat"}),a.jsx("input",{ref:k,type:"file",onChange:S,className:"hidden",accept:"image/*"}),a.jsx("button",{onClick:R,className:"text-gray-500 hover:text-primary p-2","aria-label":"Adjunta una imatge",children:a.jsx(sR,{className:"w-5 h-5"})}),a.jsx("button",{onClick:b,className:"text-white bg-primary hover:bg-primary-700 rounded-md p-2 ml-1 disabled:bg-gray-400",disabled:!m.trim(),"aria-label":"Envia el missatge",children:a.jsx(oR,{className:"w-5 h-5"})})]})})]}):a.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length>0?n.map(y=>a.jsx(DR,{chat:y,onSelect:()=>c(y),currentUser:i,onDelete:d,isConfirmingDelete:g===y.id,onStartConfirmDelete:()=>x(y.id),onCancelConfirmDelete:()=>x(null)},y.id)):a.jsxs("div",{className:"text-center p-8 text-gray-500 h-full flex flex-col justify-center items-center",children:[a.jsx(xf,{className:"w-16 h-16 text-gray-300 mb-4"}),a.jsx("p",{className:"font-semibold",children:"No tens cap conversa."}),a.jsx("p",{className:"text-sm mt-1",children:"Contacta amb un venedor des d'un anunci per comenar a xatejar."})]})})]})},Ar=({title:t,children:e})=>a.jsxs("section",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-primary mb-3",children:t}),a.jsx("div",{className:"space-y-2 text-gray-700",children:e})]}),MR=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:t,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col relative",onClick:e=>e.stopPropagation(),children:[a.jsxs("header",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(G2,{className:"w-8 h-8 text-primary"}),a.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Guia Rpida de ",a.jsx("span",{className:"text-gray-900",children:"LA"}),a.jsx("span",{className:"text-primary",children:"BOTIGA"})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100","aria-label":"Tancar",children:a.jsx(dr,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto",children:[a.jsxs("section",{className:"mb-6",children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-3",children:[" Benvingut/da a ",a.jsx("span",{className:"text-gray-900",children:"LA"}),a.jsx("span",{className:"text-primary",children:"BOTIGA"}),"!"]}),a.jsx("div",{className:"space-y-2 text-gray-700",children:a.jsx("p",{children:"Aquesta s la botiga virtual del Club Handbol Molins, on pots comprar i vendre material d'handbol de segona m i adquirir el marxandatge oficial del club."})})]}),a.jsx(Ar,{title:"1. Explora els Articles",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["A la pgina principal, trobars les seccions ",a.jsx("strong",{children:"'Marxandatge del Club.'"})," i ",a.jsx("strong",{children:"'Articles que et poden interessar.'"}),"."]}),a.jsxs("li",{children:["Fes servir la ",a.jsx("strong",{children:"barra de cerca"})," per trobar articles especfics pel seu nom o descripci."]}),a.jsx("li",{children:"Fes clic a qualsevol article per veure'n els detalls."})]})}),a.jsx(Ar,{title:"2. Comprar un Article de Segona M",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"Quan trobis un article que t'interessi, fes-hi clic per obrir la vista detallada."}),a.jsxs("li",{children:[a.jsx("strong",{children:"Visualitza les imatges:"})," Fes clic a la imatge principal d'un producte per obrir-la a pantalla completa. Llisca el dit o fes servir les fletxes per veure la resta de fotos."]}),a.jsx("li",{children:"Llegeix la descripci i comprova el preu."}),a.jsxs("li",{children:["Per parlar amb el venedor, fes clic al bot ",a.jsx("strong",{children:"'Contacta amb el venedor'"}),". Aix obrir un xat privat."]}),a.jsx("li",{children:"Al xat, podeu acordar els detalls del pagament i l'entrega de forma segura."})]})}),a.jsxs(Ar,{title:"3. Vendre un Article",children:[a.jsxs("p",{children:["Fes clic al bot ",a.jsx("strong",{children:"'Puja un article'"})," a la capalera per comenar."]}),a.jsxs("ul",{className:"list-decimal list-inside space-y-2 pl-4",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Puja les teves fotos:"})," Fes clic a 'Afegeix fotos'. Podrs triar entre fer una foto amb la cmera o seleccionar-ne de la teva galeria. Pots pujar fins a 5 imatges. La primera ser la principal."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Descriu el teu article:"})," Afegeix un ttol clar i una descripci detallada. Com ms informaci, millor!"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Afegeix un preu:"})," Introdueix el preu que demanes per l'article. Pots demanar un suggeriment de preu automtic."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Vista prvia i publicaci:"})," A la dreta, veurs una vista prvia del teu anunci. Quan estiguis satisfet/a, fes clic a ",a.jsx("strong",{children:"'Publica l'anunci'"}),"."]})]})]}),a.jsx(Ar,{title:"4. Gestiona els Teus Xats",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Fes clic a la ",a.jsx("strong",{children:"bombolla de xat"})," a la cantonada inferior dreta per veure les teves converses."]}),a.jsx("li",{children:"Un nmero vermell indicar els missatges nous que no has llegit."}),a.jsx("li",{children:"Pots enviar text i imatges a travs del xat per comunicar-te amb altres usuaris."}),a.jsx("li",{children:"Per eliminar un xat, a la llista de converses, fes clic a la icona de la paperera que apareix a la dreta en passar el cursor per sobre (ordinador). Haurs de confirmar l'acci."})]})}),a.jsx(Ar,{title:"5. El Teu Perfil",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Fes clic a la teva ",a.jsx("strong",{children:"foto de perfil"})," a la capalera per anar a la pgina del teu perfil."]}),a.jsx("li",{children:"Aqu pots canviar el teu nom i la teva foto de perfil."}),a.jsxs("li",{children:["Tamb pots ",a.jsx("strong",{children:"tancar la sessi"})," des d'aquesta pgina de manera segura."]})]})}),a.jsx(Ar,{title:"6. Comprar Marxandatge Oficial",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"Els articles de la secci 'Marxandatge del Club.' sn productes oficials."}),a.jsxs("li",{children:["Per comprar-ne un, fes clic a l'article i desprs al bot ",a.jsx("strong",{children:"'Realitzar comanda'"}),". Sers redirigit/da a un formulari per completar la comanda."]}),a.jsxs("li",{children:["Si tens dubtes, ara tamb pots fer clic a ",a.jsx("strong",{children:"'Contacta amb el club'"})," per enviar un correu electrnic amb la teva consulta."]})]})}),a.jsx(Ar,{title:"7. Equipacions Oficials",children:a.jsxs("p",{children:["Tamb pots accedir directament a la botiga del nostre provedor ",a.jsx("strong",{children:"TC Equipacions"})," fent clic al banner corresponent a la pgina principal per comprar les equipacions oficials de joc."]})}),a.jsxs(Ar,{title:"8. Eines d'Administrador",children:[a.jsx("p",{children:"Si tens el rol d'administrador, tens accs a funcionalitats extra:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Panell de Comunicats:"})," A la teva pgina de perfil, pots enviar missatges a tots els usuaris o a un en concret."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Ordenaci de Productes:"})," Pots canviar l'ordre dels productes de 'Marxandatge del Club.' simplement ",a.jsx("strong",{children:"arrossegant-los i deixant-los anar"})," (Drag & Drop) a la nova posici."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Configuraci de Marxandatge:"}),' En crear o editar un producte oficial, pots marcar opcions per ocultar els botons de "Realitzar comanda" o "Contacta amb el club" si s necessari.']})]})]})]})]})}),wv=({direction:t,onClick:e})=>a.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:`absolute top-1/2 -translate-y-1/2 ${t==="left"?"left-2 md:left-4":"right-2 md:right-4"} z-10 bg-black bg-opacity-40 text-white p-2 rounded-full hover:bg-opacity-60 transition-all`,"aria-label":t==="left"?"Imatge anterior":"Imatge segent",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:t==="left"?"M15 19l-7-7 7-7":"M9 5l7 7-7 7"})})}),OR=({images:t,startIndex:e=0,onClose:n})=>{const[r,s]=P.useState(e),[i,o]=P.useState(null),c=P.useCallback(()=>{s(f=>f===0?t.length-1:f-1)},[t.length]),u=P.useCallback(()=>{s(f=>f===t.length-1?0:f+1)},[t.length]);P.useEffect(()=>{const f=g=>{g.key==="ArrowLeft"&&c(),g.key==="ArrowRight"&&u(),g.key==="Escape"&&n()};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[c,u,n]);const d=f=>{o(f.touches[0].clientX)},m=f=>{if(i===null)return;const g=f.touches[0].clientX,x=i-g;x>50?(u(),o(null)):x<-50&&(c(),o(null))};return a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex flex-col justify-center items-center animate-fade-in-fast",onClick:n,role:"dialog","aria-modal":"true",children:[a.jsx("style",{children:`
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out; }
        `}),a.jsx("button",{onClick:f=>{f.stopPropagation(),n()},className:"absolute top-4 right-4 text-white bg-black bg-opacity-40 p-2 rounded-full hover:bg-opacity-60 transition-all","aria-label":"Tancar visor",children:a.jsx(dr,{className:"w-6 h-6"})}),a.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.length>1&&a.jsx(wv,{direction:"left",onClick:c}),a.jsx("div",{className:"w-full h-full flex items-center justify-center",onTouchStart:d,onTouchMove:m,children:a.jsx("img",{src:t[r],alt:`Imatge ${r+1} de ${t.length}`,className:"max-w-full max-h-full object-contain select-none"})}),t.length>1&&a.jsx(wv,{direction:"right",onClick:u})]}),t.length>1&&a.jsxs("div",{className:"absolute bottom-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm",children:[r+1," / ",t.length]})]})},VR={apiKey:"AIzaSyDgTGIPoHLYy9rfdpiQo07Y7F-1ytphaQM",authDomain:"botiga-35dc0.firebaseapp.com",projectId:"botiga-35dc0",storageBucket:"botiga-35dc0.firebasestorage.app",messagingSenderId:"671047302164",appId:"1:671047302164:web:2cc6065f3055dbd8fdbb01",measurementId:"G-C3X8Y6GG88"},kp=Em(VR),Is=M_(kp),Fe=n2(kp),Ll=typeof window<"u"?U2(kp):null,Bt=[{id:"user-0",name:"Admin CHMolins",avatarUrl:"https://i.pravatar.cc/150?u=admin",email:"admin@chmolins.com",joinDate:"2023-01-01",role:"admin"},{id:"user-1",name:"Anna L.",avatarUrl:"https://i.pravatar.cc/150?u=anna",email:"anna@example.com",joinDate:"2023-05-12",role:"user"},{id:"user-2",name:"Carles B.",avatarUrl:"https://i.pravatar.cc/150?u=carles",email:"carles@example.com",joinDate:"2023-08-20",role:"user"},{id:"user-3",name:"Laura M.",avatarUrl:"https://i.pravatar.cc/150?u=laura",email:"laura@example.com",joinDate:"2023-11-01",role:"user"},{id:"user-4",name:"David S.",avatarUrl:"https://i.pravatar.cc/150?u=david",email:"david@example.com",joinDate:"2024-02-15",role:"user"}],xv=[{id:"1",title:"Jaqueta de cuir vintage",description:"Jaqueta de cuir genu dels anys 80, en perfecte estat. Talla M.",price:75,imageUrls:["https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=800"],seller:Bt[1],createdAt:new Date("2024-07-20T10:00:00Z")},{id:"2",title:"Bicicleta de muntanya Scott",description:"Bicicleta Scott Aspect 970, rodes de 29 polzades, frens de disc. Poc s.",price:350,imageUrls:["https://images.unsplash.com/photo-1576426863848-c21f68c6aa98?q=80&w=800"],seller:Bt[2],createdAt:new Date("2024-07-19T15:30:00Z")},{id:"3",title:"Cmera rflex Canon EOS 2000D",description:"Inclou objectiu 18-55mm, bossa de transport i targeta de memria. Ideal per a principiants.",price:320,imageUrls:["https://images.unsplash.com/photo-1512790182412-b19e6d62bc39?q=80&w=800"],seller:Bt[3],createdAt:new Date("2024-07-19T12:00:00Z")},{id:"4",title:"Sof de 3 places gris",description:"Sof cmode i modern. Fundes rentables. Mides: 200x90cm.",price:180,imageUrls:["https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800"],seller:Bt[4],createdAt:new Date("2024-07-18T18:45:00Z")},{id:"5",title:"Guitarra acstica Yamaha",description:"Model F310. So excellent. Perfecta per aprendre a tocar.",price:90,imageUrls:["https://images.unsplash.com/photo-1558021211-65140282a3f8?q=80&w=800"],seller:Bt[1],createdAt:new Date("2024-07-18T11:20:00Z")},{id:"6",title:"iPhone 12 - 128GB Blau",description:"En bon estat, sempre amb protector de pantalla. Salut de la bateria al 88%.",price:450,imageUrls:["https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=800"],seller:Bt[3],createdAt:new Date("2024-07-17T20:00:00Z")},{id:"7",title:"Vambes Nike Air Max",description:"Talla 43. Edici limitada. Noms utilitzades un parell de vegades.",price:85,imageUrls:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=800"],seller:Bt[2],createdAt:new Date("2024-07-17T09:05:00Z")},{id:"8",title:"Patinet elctric Xiaomi",description:"Model Mi Electric Scooter 3. Fins a 30 km d'autonomia. Plegable i lleuger.",price:250,imageUrls:["https://images.unsplash.com/photo-1598214013444-96379d71c664?q=80&w=800"],seller:Bt[4],createdAt:new Date("2024-07-16T14:00:00Z")},{id:"9",title:"Collecci de llibres de Harry Potter",description:"Els 7 llibres de la saga, tapa dura. Edici Salamandra.",price:60,imageUrls:["https://images.unsplash.com/photo-1618965907452-a8a235327546?q=80&w=800"],seller:Bt[1],createdAt:new Date("2024-07-15T21:30:00Z")},{id:"10",title:"Planta Monstera Deliciosa",description:"Planta d'interior gran i saludable. Inclou test de cermica.",price:30,imageUrls:["https://images.unsplash.com/photo-1614594975525-e4d524c48996?q=80&w=800"],seller:Bt[3],createdAt:new Date("2024-07-15T10:15:00Z")},{id:"11",title:"Samarreta Oficial CHM",description:"Samarreta oficial del club, 100% cot. Totes les talles disponibles.",price:25,imageUrls:["https://images.unsplash.com/photo-1571455789393-8a76380c5435?q=80&w=800"],seller:Bt[0],createdAt:new Date("2024-07-21T10:00:00Z"),isMerchandise:!0},{id:"12",title:"Tassa CHM",description:"Tassa de cermica amb el logo del club. Resistent al microones i rentaplats.",price:12.5,imageUrls:["https://images.unsplash.com/photo-1594225026210-5a9b71b83b63?q=80&w=800"],seller:Bt[0],createdAt:new Date("2024-07-21T10:05:00Z"),isMerchandise:!0},{id:"13",title:"Bufanda CHM Fans",description:"Bufanda de llana per animar l'equip els dies de partit.",price:18,imageUrls:["https://images.unsplash.com/photo-1610295313555-252a71383713?q=80&w=800"],seller:Bt[0],createdAt:new Date("2024-07-21T10:10:00Z"),isMerchandise:!0}],FR=({product:t,currentUser:e,onClose:n,onEdit:r,onContactSeller:s,onDelete:i,onOpenImageViewer:o})=>{const[c,u]=P.useState(0),[d,m]=P.useState(!1),[f,g]=P.useState(!1),x=P.useRef(null);P.useEffect(()=>()=>{x.current&&clearTimeout(x.current)},[]),P.useEffect(()=>{const S=R=>{R.key==="Escape"&&n()};return window.addEventListener("keydown",S),()=>{window.removeEventListener("keydown",S)}},[n]);const k=async()=>{d||(f?(x.current&&(clearTimeout(x.current),x.current=null),m(!0),await i(t.id)||(m(!1),g(!1))):(g(!0),x.current=window.setTimeout(()=>{g(!1),x.current=null},4e3)))},j=(e==null?void 0:e.role)==="admin",E=(e==null?void 0:e.id)===t.seller.id,b=t.imageUrls&&t.imageUrls.length>0,_=S=>typeof S!="number"||isNaN(S)?"N/A":S.toFixed(2);return a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40 flex justify-center items-center p-4 animate-fade-in",onClick:n,"aria-modal":"true",role:"dialog",children:[a.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in { animation: fade-in 0.2s ease-out; }
      `}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col lg:flex-row relative",onClick:S=>S.stopPropagation(),children:[a.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-800 z-10 bg-white bg-opacity-50 rounded-full p-1 transition-colors","aria-label":"Tancar",children:a.jsx(dr,{className:"w-6 h-6"})}),a.jsxs("div",{className:"w-full lg:w-3/5 flex-shrink-0 flex flex-col",children:[a.jsx("div",{className:"w-full bg-gray-100 h-80 lg:h-full flex items-center justify-center lg:flex-grow",children:b&&a.jsx("img",{src:t.imageUrls[c],alt:`${t.title} - imatge ${c+1}`,className:`w-full h-full object-cover lg:rounded-l-2xl rounded-t-2xl lg:rounded-t-none cursor-pointer ${t.tag==="vendido"?"grayscale":""}`,onClick:()=>o(t.imageUrls,c)})}),b&&t.imageUrls.length>1&&a.jsx("div",{className:"flex-shrink-0 p-2 bg-white lg:bg-gray-50 flex gap-2 justify-center",children:t.imageUrls.map((S,R)=>a.jsx("button",{onClick:()=>u(R),className:`w-12 h-12 rounded-md overflow-hidden border-2 transition-colors bg-gray-100 ${c===R?"border-primary":"border-transparent hover:border-gray-400"}`,children:a.jsx("img",{src:S,alt:`miniatura ${R+1}`,className:`w-full h-full object-cover ${t.tag==="vendido"?"grayscale":""}`})},R))})]}),a.jsxs("div",{className:"p-4 md:p-6 flex flex-col flex-1 overflow-y-auto",children:[t.tag&&Kn[t.tag]&&a.jsxs("div",{className:`w-fit text-sm font-semibold px-3 py-1 rounded-full mb-3 ${Kn[t.tag].className}`,children:[Kn[t.tag].emoji," ",Kn[t.tag].label]}),a.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-2",children:t.title}),a.jsxs("p",{className:"text-3xl lg:text-4xl font-extrabold text-primary mb-4",children:[_(t.price)," "]}),a.jsxs("div",{className:"flex-grow pr-2 space-y-4",children:[a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Venedor"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("img",{src:t.seller.avatarUrl,alt:t.seller.name,className:"w-12 h-12 rounded-full mr-4"}),a.jsx("div",{children:a.jsx("p",{className:"font-semibold text-gray-800",children:t.seller.name})})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Descripci"}),a.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.description})]})]}),a.jsxs("div",{className:"mt-6 flex-shrink-0 space-y-3",children:[t.isMerchandise&&!t.hideOrderButton&&a.jsxs("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLSfux48JDT3BFqAlhNqPfM5BirPosepNYO_88zz1fwWk-Gmwwg/viewform",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center justify-center gap-2 bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:[a.jsx(W2,{className:"w-5 h-5"}),a.jsx("span",{children:"Realitzar comanda"})]}),!E&&e&&(t.isMerchandise?!t.hideContactButton&&a.jsxs("a",{href:`mailto:robaesportiva@handbolmolins.cat?subject=${encodeURIComponent("Consulta sobre: "+t.title)}`,className:"w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors bg-gray-600 text-white hover:bg-gray-700",children:[a.jsx(xf,{className:"w-5 h-5"}),a.jsx("span",{children:"Contacta amb el club"})]}):a.jsxs("button",{onClick:()=>s(t),className:"w-full flex items-center justify-center gap-2 font-bold py-3 px-4 rounded-lg transition-colors bg-primary text-white hover:bg-primary-700 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:t.tag==="vendido",children:[a.jsx(xf,{className:"w-5 h-5"}),a.jsx("span",{children:t.tag==="vendido"?"Article venut":"Contacta amb el venedor"})]})),(j||E)&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>r(t),disabled:d||f,className:"w-full flex items-center justify-center gap-2 bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:[a.jsx(q2,{className:"w-5 h-5"})," Edita"]}),a.jsx("button",{onClick:k,disabled:d,className:`w-full flex items-center justify-center gap-2 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 ${f?"bg-red-700 hover:bg-red-800":"bg-red-500 hover:bg-red-600"} disabled:bg-red-400 disabled:cursor-wait`,children:d?a.jsxs(a.Fragment,{children:[a.jsx(er,{className:"w-5 h-5"}),a.jsx("span",{children:"Eliminant..."})]}):f?"Confirmar eliminaci":a.jsxs(a.Fragment,{children:[a.jsx(Sp,{className:"w-5 h-5"}),a.jsx("span",{children:"Elimina"})]})})]})]})]})]})]})},UR=()=>{const[t,e]=P.useState("home"),[n,r]=P.useState([]),[s,i]=P.useState([]),[o,c]=P.useState(null),[u,d]=P.useState(null),[m,f]=P.useState(null),[g,x]=P.useState(null),[k,j]=P.useState(null),[E,b]=P.useState(null),[_,S]=P.useState([]),[R,F]=P.useState(!1),[B,y]=P.useState([]),[v,T]=P.useState(null),[A,N]=P.useState([]),[C,I]=P.useState(0),W=P.useRef(new Set),[fe,Z]=P.useState(!1);P.useEffect(()=>{const D=()=>{u&&d(null)};return window.addEventListener("popstate",D),()=>window.removeEventListener("popstate",D)},[u]);const te=()=>{var D;(D=window.history.state)!=null&&D.modalOpen?window.history.back():d(null)};P.useEffect(()=>{if(!E)return;if((async()=>{var z;if(!Ll){console.log("Firebase Messaging no est disponible en aquest navegador.");return}try{if(await window.Notification.requestPermission()==="granted"){const G=await B2(Ll,{vapidKey:"BL2B5V3vjPkyyPrTo-aW-5s5t7oW3_Ni_M9XANqYdM1uO9jY3yA9k84Xo7Z-yL3p0M_sF3g4d2c1qWj9k7l4z5k"});if(G){const K=ke(Fe,"users",E.id);(((z=(await Xc(K)).data())==null?void 0:z.fcmTokens)||[]).includes(G)||await st(K,{fcmTokens:Zc(G)})}else console.log("No s'ha pogut obtenir el token de registre.")}}catch(O){console.error("Ha ocorregut un error en configurar les notificacions:",O)}})(),Ll){const z=z2(Ll,O=>{var V,G;console.log("Missatge rebut en primer pla: ",O),c({message:`${(V=O.notification)==null?void 0:V.title}: ${(G=O.notification)==null?void 0:G.body}`,type:"success"})});return()=>z()}},[E]),P.useEffect(()=>{let D=null;const z=I_(Is,O=>{if(D&&(D(),D=null),O){const V=ke(Fe,"users",O.uid);D=An(V,G=>{G.exists()?b({id:O.uid,...G.data()}):(Di(Is),b(null))},G=>{console.error("Error en escoltar el document d'usuari:",G),Di(Is),b(null)})}else b(null)});return()=>{z(),D&&D()}},[]),P.useEffect(()=>{if((E==null?void 0:E.role)==="admin"){const D=Sn(Ge(Fe,"users")),z=An(D,O=>{const V=O.docs.map(G=>({id:G.id,...G.data()}));S(V.filter(G=>G.id!==E.id))});return()=>z()}else S([])},[E]),P.useEffect(()=>{const D=Sn(Ge(Fe,"products")),z=An(D,O=>{const V=O.docs.map(U=>{var oe;const X=U.data(),re=(oe=X.createdAt)!=null&&oe.toDate?X.createdAt.toDate():new Date;return{id:U.id,...X,createdAt:re}}),G=V.filter(U=>U.isMerchandise),K=V.filter(U=>!U.isMerchandise);G.sort((U,X)=>{const re=U.displayOrder??0,oe=X.displayOrder??0;return re===0&&oe===0?X.createdAt.getTime()-U.createdAt.getTime():re!==oe?re-oe:X.createdAt.getTime()-U.createdAt.getTime()}),K.sort((U,X)=>{const re=U.tag==="vendido",oe=X.tag==="vendido";return re&&!oe?1:!re&&oe?-1:X.createdAt.getTime()-U.createdAt.getTime()}),i(G),r(K),x(null)},O=>{console.error("Error en el listener de Firestore (products):",O),x(O),c({message:"Error de connexi. Mostrant articles d'exemple.",type:"error"});const V=xv.filter(K=>K.isMerchandise).map(K=>({...K,createdAt:new Date(K.createdAt)})),G=xv.filter(K=>!K.isMerchandise).map(K=>({...K,createdAt:new Date(K.createdAt)}));V.sort((K,U)=>U.createdAt.getTime()-K.createdAt.getTime()),G.sort((K,U)=>U.createdAt.getTime()-K.createdAt.getTime()),i(V),r(G)});return()=>z()},[]),P.useEffect(()=>{if(!E){y([]);return}const D=Sn(Ge(Fe,"chats"),Mi("participantIds","array-contains",E.id)),z=An(D,O=>{let V=O.docs.map(K=>({id:K.id,...K.data()}));V=V.filter(K=>{var U;return!((U=K.hiddenFor)!=null&&U.includes(E.id))&&!W.current.has(K.id)}),V.sort((K,U)=>{var oe,mt;const X=((oe=K.updatedAt)==null?void 0:oe.toMillis())||0;return(((mt=U.updatedAt)==null?void 0:mt.toMillis())||0)-X});const G=V.reduce((K,U)=>K+(U.unreadCount[E.id]||0),0);I(G),y(V),x(null)},O=>{console.error("Error fetching chats:",O),x(O)});return()=>z()},[E]),P.useEffect(()=>{if(!v){N([]);return}const D=Sn(Ge(Fe,"chats",v.id,"messages")),z=An(D,O=>{const V=O.docs.map(G=>({id:G.id,...G.data()}));V.sort((G,K)=>{var re,oe;const U=((re=G.timestamp)==null?void 0:re.toMillis())||0,X=((oe=K.timestamp)==null?void 0:oe.toMillis())||0;return U-X}),N(V)});return()=>z()},[v]),P.useEffect(()=>{if(o){const D=setTimeout(()=>c(null),8e3);return()=>clearTimeout(D)}},[o]),P.useEffect(()=>{const D="LABOTIGA";C>0?document.title=`(${C}) ${D}`:document.title=D},[C]),P.useEffect(()=>(u||R||!E||fe||k?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u,R,E,fe,k]);const q=async(D,z)=>{await T_(Is,D,z),c({message:"Benvingut/da de nou!",type:"success"})},se=(D,z)=>{const G=`<svg xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150">
                    <rect width="100%" height="100%" fill="${(K=>{let U=0;for(let re=0;re<K.length;re++)U=K.charCodeAt(re)+((U<<5)-U);let X="#";for(let re=0;re<3;re++){const oe=U>>re*8&255;X+=("00"+oe.toString(16)).substr(-2)}return X})(z)}" />
                    <text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial, sans-serif" font-size="60" fill="#ffffff">${D}</text>
                 </svg>`;return`data:image/svg+xml;base64,${btoa(G)}`},ce=async(D,z,O,V)=>{let G="",K=V;if(!K){const oe=D.split(" ").map(mt=>mt[0]).slice(0,2).join("").toUpperCase();K=se(oe,D)}try{G=await ic(K)}catch(oe){throw console.error("La pujada de la imatge ha fallat:",oe),new Error("No s'ha pogut pujar la imatge. Revisa la teva configuraci de Cloudinary i que el 'preset' sigui 'unsigned'.")}if(!G)throw new Error("Cloudinary no ha retornat una URL vlida.");const X=(await b_(Is,z,O)).user,re={name:D,email:z,avatarUrl:G,joinDate:new Date().toISOString(),role:"user",fcmTokens:[]};await m2(ke(Fe,"users",X.uid),re),b({id:X.uid,...re}),c({message:`Benvingut/da, ${D}! El teu compte ha estat creat.`,type:"success"})},Ee=async D=>{try{await E_(Is,D),c({message:"S'ha enviat un correu per restablir la contrasenya. Revisa la teva bstia d'entrada.",type:"success"})}catch(z){throw console.error("Error en restablir la contrasenya:",z),z}},Se=async()=>{e("home"),await Di(Is),c({message:"Sessi tancada correctament.",type:"success"})},an=()=>{e("home"),f(null)},ft=()=>{f(null),e("listing")},ln=()=>{E&&e("profile")},It=async(D,z,O)=>{if(!E||E.id!==D)throw c({message:"No autoritzat.",type:"error"}),new Error("No autoritzat.");if(z===E.name&&!O){c({message:"No s'han detectat canvis.",type:"success"});return}try{const V={name:z};O&&(V.avatarUrl=await ic(O));const G=ke(Fe,"users",D);await st(G,V),c({message:"Perfil actualitzat correctament!",type:"success"})}catch(V){throw console.error("Error actualitzant l'usuari:",V),c({message:`Error en actualitzar: ${V.message||"Error desconegut."}`,type:"error"}),V}},Qt=async(D,z)=>{var O;if(!E)throw c({message:"Has d'iniciar la sessi per desar un producte.",type:"error"}),new Error("L'usuari no ha iniciat la sessi.");try{const V=D.imageUrls.map(U=>U.startsWith("data:image")?ic(U):Promise.resolve(U)),G=await Promise.all(V),K={...D,imageUrls:G};if(z){const U=ke(Fe,"products",z),X=(O=(await Xc(U)).data())==null?void 0:O.seller;await st(U,{...K,seller:X}),c({message:"Anunci actualitzat correctament!",type:"success"})}else{const U={...K,seller:{id:E.id,name:E.name,avatarUrl:E.avatarUrl},createdAt:new Date,displayOrder:0};await Nn(Ge(Fe,"products"),U),c({message:"Anunci publicat amb xit!",type:"success"})}e("home"),f(null)}catch(V){throw console.error("Error al desar el producte:",V),c({message:`Error en desar: ${V.message||"Error desconegut."}`,type:"error"}),V}},ps=D=>{f(D),te(),e("listing")},ti=async D=>{try{return await Jc(ke(Fe,"products",D)),c({message:"Anunci eliminat correctament.",type:"success"}),te(),!0}catch(z){console.error("Error en eliminar el producte: ",z);const O=`Error en eliminar: ${z.code||z.message||"Error desconegut."}`;return c({message:O,type:"error"}),!1}},ho=D=>{window.history.pushState({modalOpen:!0},""),d(D)},fo=()=>{te()},ni=async(D,z)=>{if(!E||E.role!=="admin")return;const O=s.findIndex(U=>U.id===D),V=s.findIndex(U=>U.id===z);if(O===-1||V===-1||O===V)return;const G=[...s],[K]=G.splice(O,1);G.splice(V,0,K);try{const U=G.map((X,re)=>{const oe=re*100;if(X.displayOrder!==oe){const mt=ke(Fe,"products",X.id);return st(mt,{displayOrder:oe})}return Promise.resolve()});await Promise.all(U)}catch(U){console.error("Error reordering products:",U),c({message:"Error en moure el producte.",type:"error"})}},gs=async D=>{if(!E)return;const z=D.seller.id,O=E.id,V=Ge(Fe,"chats"),G=Sn(V,Mi("productId","==",D.id),Mi("participantIds","array-contains",O)),K=await f2(G);let U=null;if(K.forEach(X=>{const re={id:X.id,...X.data()};re.participantIds.includes(z)&&(U=re)}),U)await pr(U);else{const X={participantIds:[O,z],participants:{[O]:{name:E.name,avatarUrl:E.avatarUrl},[z]:{name:D.seller.name,avatarUrl:D.seller.avatarUrl}},productId:D.id,productTitle:D.title,productImageUrl:D.imageUrls[0]||"",lastMessage:null,createdAt:wt(),updatedAt:wt(),unreadCount:{[O]:0,[z]:0},hiddenFor:[]},re=await Nn(Ge(Fe,"chats"),X);T({id:re.id,...X})}te(),F(!0)},pr=async D=>{if(T(D),E&&(D.unreadCount[E.id]||0)>0){const z=ke(Fe,"chats",D.id);await st(z,{[`unreadCount.${E.id}`]:0})}},mo=async(D,z)=>{if(!E||!v)return;const O=E.id,V=v.participantIds.find(U=>U!==O);if(!V)return;const G={senderId:O,text:D,timestamp:wt(),...z&&{imageUrl:z}};await Nn(Ge(Fe,"chats",v.id,"messages"),G);const K=ke(Fe,"chats",v.id);await st(K,{lastMessage:{...G,timestamp:new Date},updatedAt:wt(),[`unreadCount.${V}`]:eu(1)})},ys=()=>{T(null)},vs=()=>{F(!1),T(null)},ri=async D=>{if(!E)return;W.current.add(D),y(O=>O.filter(V=>V.id!==D)),(v==null?void 0:v.id)===D&&T(null);const z=ke(Fe,"chats",D);try{await st(z,{hiddenFor:Zc(E.id)}),W.current.delete(D)}catch(O){console.error("Error en eliminar el xat:",O),c({message:"No s'ha pogut eliminar el xat. La conversa es restaurar.",type:"error"}),W.current.delete(D)}},He=async(D,z)=>{if(!E||E.role!=="admin"){c({message:"No autoritzat.",type:"error"});return}const O=D==="all"?_:_.filter(V=>V.id===D);if(O.length===0){c({message:"No s'han trobat destinataris.",type:"error"});return}try{for(const V of O){const G=`admin-message-${E.id}-${V.id}-${Date.now()}`,K={participantIds:[E.id,V.id],participants:{[E.id]:{name:E.name,avatarUrl:E.avatarUrl},[V.id]:{name:V.name,avatarUrl:V.avatarUrl}},productId:G,productTitle:"Missatge de l'administrador",productImageUrl:E.avatarUrl,lastMessage:null,createdAt:wt(),updatedAt:wt(),unreadCount:{[E.id]:0,[V.id]:0},hiddenFor:[]},U=await Nn(Ge(Fe,"chats"),K),X={senderId:E.id,text:z,timestamp:wt()};await Nn(Ge(Fe,"chats",U.id,"messages"),X),await st(U,{lastMessage:{...X,timestamp:new Date},updatedAt:wt(),[`unreadCount.${V.id}`]:eu(1)})}c({message:`Missatge enviat a ${O.length} usuari(s).`,type:"success"})}catch(V){throw console.error("Error en enviar el missatge d'administrador:",V),c({message:"No s'ha pogut enviar el missatge.",type:"error"}),V}},Xe=async(D,z)=>{if(!E||E.role!=="admin")throw c({message:"No autoritzat per realitzar aquesta acci.",type:"error"}),new Error("No autoritzat.");try{const O=ke(Fe,"users",D);await st(O,{role:z}),c({message:"El rol de l'usuari ha estat actualitzat.",type:"success"})}catch(O){throw console.error("Error actualitzant el rol de l'usuari:",O),c({message:"Error en actualitzar el rol.",type:"error"}),O}},gr=async D=>{if(!E||E.role!=="admin")return c({message:"No autoritzat per realitzar aquesta acci.",type:"error"}),!1;try{return await Jc(ke(Fe,"users",D)),c({message:"L'usuari ha estat eliminat correctament.",type:"success"}),!0}catch(z){console.error("Error eliminant l'usuari:",z);let O="Error en eliminar l'usuari.";return z.code==="permission-denied"&&(O="Error de permisos: Assegura't que les regles de Firestore permeten aquesta acci."),c({message:O,type:"error"}),!1}};return E?a.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans text-gray-800",children:[a.jsx(fR,{user:E,onNavigateHome:an,onNavigateToListing:ft,onNavigateToProfile:ln,onOpenTutorial:()=>Z(!0)}),a.jsx(NR,{message:(o==null?void 0:o.message)||null,type:o==null?void 0:o.type,onClose:()=>c(null)}),t==="home"&&a.jsx(mR,{userProducts:n,merchProducts:s,onProductSelect:ho,firebaseError:g,currentUser:E,onMoveProduct:ni}),t==="listing"&&a.jsx(SR,{onSave:Qt,productToEdit:m,currentUser:E}),t==="profile"&&a.jsx(CR,{user:E,onUpdateUser:It,onBack:()=>e("home"),onLogout:Se,allUsers:_,onSendAdminMessage:He,onUpdateUserRole:Xe,onDeleteUserByAdmin:gr}),u&&a.jsx(FR,{product:u,currentUser:E,onClose:fo,onEdit:ps,onContactSeller:gs,onDelete:ti,onOpenImageViewer:(D,z)=>j({images:D,startIndex:z})}),fe&&a.jsx(MR,{onClose:()=>Z(!1)}),k&&a.jsx(OR,{images:k.images,startIndex:k.startIndex,onClose:()=>j(null)}),a.jsx(jR,{isOpen:R,onClick:()=>F(!R),unreadCount:C}),a.jsx(LR,{isOpen:R,onClose:vs,chats:B,activeChat:v,messages:A,currentUser:E,onSendMessage:mo,onSelectChat:pr,onBackToList:ys,onDeleteChat:ri})]}):a.jsxs("div",{className:"min-h-screen bg-cover bg-center flex items-center justify-center p-4",style:{backgroundImage:"url('https://raw.githubusercontent.com/handbolmolins/URLimagenes/refs/heads/main/Bandera%20Club%20Handbol%20Molins.png')"},children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),a.jsx("div",{className:"relative z-10",children:a.jsx(AR,{onLogin:q,onRegister:ce,onPasswordReset:Ee,isDismissable:!1})})]})},K2=document.getElementById("root");if(!K2)throw new Error("Could not find root element to mount to");const BR=oc.createRoot(K2);BR.render(a.jsx(jv.StrictMode,{children:a.jsx(UR,{})}));
